(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{CGMW:function(e,t,i){"use strict";i.r(t);var n=i("pWxA"),r=i("BFfR"),a=i("gbLn"),o=i("nUuu"),s=i("mqw2"),l=i("omYt"),u=i("zjfJ"),c=i("9fIP"),g=i("MMYH"),h=i("K/z8"),d=i("sRHE"),p=i("PRnZ"),v=i("8K1b"),f=i("02NV"),m=i("D8sA"),y=i("YVXj"),b=i("8eia"),_=i("TjKm"),S=i("CPJl"),L=i("9+Q7");function O(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function P(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?O(Object(i),!0).forEach((function(t){Object(u.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):O(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var j=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,t);var i=e.id,n=void 0===i?Object(L.c)("column-geometry"):i,r=w(e),a=r.indices,o=r.attributes;return Object(h.a)(this,Object(d.a)(t).call(this,P({},e,{id:n,indices:a,attributes:o})))}return Object(v.a)(t,e),t}(i("u/Ma").a);function w(e){var t=e.radius,i=e.height,n=void 0===i?1:i,r=e.nradial,a=void 0===r?10:r,o=e.vertices;f.a.assert(!o||o.length>=a);for(var s=a+1,l=3*s,u=2*Math.PI/a,c=new Uint16Array(3*a*2),g=new Float32Array(3*l),h=new Float32Array(3*l),d=0,p=0;p<s;p++)for(var v=p*u,m=o&&o[p%a],y=o&&o[(p+1)%a],b=Math.sin(v),_=Math.cos(v),S=0;S<2;S++)g[d+0]=m?m[0]:_*t,g[d+1]=m?m[1]:b*t,g[d+2]=(.5-S)*n,h[d+0]=m?y[0]-m[0]:_,h[d+1]=m?y[1]-m[1]:b,d+=3;for(var L=0;L<s;L++){var O=Math.floor(L/2)*Math.sign(L%2-.5),P=O*u,j=o&&o[(O+a)%a],w=Math.sin(P),x=Math.cos(P);g[d+0]=j?j[0]:x*t,g[d+1]=j?j[1]:w*t,g[d+2]=n/2,h[d+2]=1,d+=3}for(var C=0,k=0;k<a;k++)c[C++]=2*k+0,c[C++]=2*k+2,c[C++]=2*k+0,c[C++]=2*k+1,c[C++]=2*k+1,c[C++]=2*k+3;return{indices:c,attributes:{POSITION:{size:3,value:g},NORMAL:{size:3,value:h}}}}var x=[0,0,0,255],C={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:function(e){return e.position}},getFillColor:{type:"accessor",value:x},getLineColor:{type:"accessor",value:x},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}},k=function(e){function t(){return Object(c.a)(this,t),Object(h.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(g.a)(t,[{key:"getShaders",value:function(){return Object(p.a)(Object(d.a)(t.prototype),"getShaders",this).call(this,{vs:"\n#define SHADER_NAME column-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 normals;\n\nattribute vec3 instancePositions;\nattribute float instanceElevations;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute float instanceStrokeWidths;\n\nattribute vec3 instancePickingColors;\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform bool extruded;\nuniform bool isStroke;\nuniform float coverage;\nuniform float elevationScale;\nuniform float edgeDistance;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nvarying vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  vec4 color = isStroke ? instanceLineColors : instanceFillColors;\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  float elevation = 0.0;\n  float strokeOffsetRatio = 1.0;\n\n  if (extruded) {\n    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;\n  } else if (isStroke) {\n    float widthPixels = clamp(project_size_to_pixel(instanceStrokeWidths * widthScale),\n      widthMinPixels, widthMaxPixels) / 2.0;\n    strokeOffsetRatio += sign(positions.z) * project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);\n  }\n  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\n  float dotRadius = radius * coverage * shouldRender;\n\n  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\n  geometry.pickingColor = instancePickingColors;\n  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\n  vec3 centroidPosition64Low = instancePositions64Low;\n  vec3 pos = vec3(project_size(rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius, 0.);\n  DECKGL_FILTER_SIZE(pos, geometry);\n\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  if (extruded && !isStroke) {\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n    vColor = vec4(lightColor, color.a * opacity);\n  } else {\n    vColor = vec4(color.rgb, color.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME column-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[m.a,y.a,b.a]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:x},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:x},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}},{key:"updateState",value:function(e){var i=e.props,n=e.oldProps,r=e.changeFlags;Object(p.a)(Object(d.a)(t.prototype),"updateState",this).call(this,{props:i,oldProps:n,changeFlags:r});var a=r.extensionsChanged;if(a){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}(a||i.diskResolution!==n.diskResolution||i.vertices!==n.vertices)&&this._updateGeometry(i)}},{key:"getGeometry",value:function(e,t){var i=new j({radius:1,height:2,vertices:t,nradial:e}),n=0;if(t)for(var r=0;r<e;r++){var a=t[r];n+=Math.sqrt(a[0]*a[0]+a[1]*a[1])/e}else n=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*n}),i}},{key:"_getModel",value:function(e){return new S.a(e,Object.assign({},this.getShaders(),{id:this.props.id,isInstanced:!0}))}},{key:"_updateGeometry",value:function(e){var t=e.diskResolution,i=e.vertices,n=this.getGeometry(t,i);this.setState({fillVertexCount:n.attributes.POSITION.value.length/3,wireframeVertexCount:n.indices.value.length}),this.state.model.setProps({geometry:n})}},{key:"draw",value:function(e){var t=e.uniforms,i=this.context.viewport,n=this.props,r=n.lineWidthUnits,a=n.lineWidthScale,o=n.lineWidthMinPixels,s=n.lineWidthMaxPixels,l=n.elevationScale,u=n.extruded,c=n.filled,g=n.stroked,h=n.wireframe,d=n.offset,p=n.coverage,v=n.radius,f=n.angle,m=this.state,y=m.model,b=m.fillVertexCount,_=m.wireframeVertexCount,S=m.edgeDistance,L="pixels"===r?i.metersPerPixel:1;y.setUniforms(Object.assign({},t,{radius:v,angle:f/180*Math.PI,offset:d,extruded:u,coverage:p,elevationScale:l,edgeDistance:S,widthScale:a*L,widthMinPixels:o,widthMaxPixels:s})),u&&h&&(y.setProps({isIndexed:!0}),y.setVertexCount(_).setDrawMode(1).setUniforms({isStroke:!0}).draw()),c&&(y.setProps({isIndexed:!1}),y.setVertexCount(b).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!u&&g&&(y.setProps({isIndexed:!1}),y.setVertexCount(2*b/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}]),t}(_.a);k.layerName="ColumnLayer",k.defaultProps=C;var D=Math.PI/3,A=[0,D,2*D,3*D,4*D,5*D];function M(e){return e[0]}function T(e){return e[1]}var E=i("RX7e");var F=i("4wDe"),I=i("zygG");function R(e,t,i){var n=i;return n.domain=function(){return e},n.range=function(){return t},n}function N(e,t){return R(e,t,(function(i){return function(e,t,i){var n=e[1]-e[0];if(n<=0)return f.a.warn("quantizeScale: invalid domain, returning range[0]")(),t[0];var r=n/t.length,a=Math.floor((i-e[0])/r),o=Math.max(Math.min(a,t.length-1),0);return t[o]}(e,t,i)}))}function U(e,t){return R(e,t,(function(i){return function(e,t,i){return(i-e[0])/(e[1]-e[0])*(t[1]-t[0])+t[0]}(e,t,i)}))}function z(e,t){for(var i=e.sort(V),n=0,r=Math.max(1,t.length),a=new Array(r-1);++n<r;)a[n-1]=B(i,n/r);var o=function(e){return function(e,t,i){return t[function(e,t){var i=0,n=e.length;for(;i<n;){var r=i+n>>>1;V(e[r],t)>0?n=r:i=r+1}return i}(e,i)]}(a,t,e)};return o.thresholds=function(){return a},R(e,t,o)}function V(e,t){return e-t}function B(e,t){var i=e.length;if(t<=0||i<2)return e[0];if(t>=1)return e[i-1];var n=(i-1)*t,r=Math.floor(n),a=e[r];return a+(e[r+1]-a)*(n-r)}function G(e,t){var i=new Map,n=[],r=!0,a=!1,o=void 0;try{for(var s,l=e[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value,c="".concat(u);i.has(c)||i.set(c,n.push(u))}}catch(g){a=!0,o=g}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return R(e,t,(function(e){return function(e,t,i,n){var r="".concat(n),a=t.get(r);return void 0===a&&(a=e.push(n),t.set(r,a)),i[(a-1)%i.length]}(n,i,t,e)}))}function H(e){return null!=e}function W(e,t){return("function"==typeof t?e.map(t):e).filter(H)}function X(e,t){return W(e,t)}function K(e,t){return i=W(e,t),n=[],i.forEach((function(e){!n.includes(e)&&H(e)&&n.push(e)})),n;var i,n}var q=function(e){return e.length},Y=function(e){return e.points},J=function(e){return e.index},Z=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},Q={getValue:q,getPoints:Y,getIndex:J,filterData:null},$=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q;Object(c.a)(this,e),this.aggregatedBins=this.getAggregatedBins(t,i),this._updateMinMaxValues(),this.binMap=this.getBinMap()}return Object(g.a)(e,[{key:"getAggregatedBins",value:function(e,t){for(var i=t.getValue,n=void 0===i?q:i,r=t.getPoints,a=void 0===r?Y:r,o=t.getIndex,s=void 0===o?J:o,l=t.filterData,u="function"==typeof l,c=e.length,g=[],h=0,d=0;d<c;d++){var p=e[d],v=a(p),f=s(p),m=u?v.filter(l):v;p.filteredPoints=u?m:null;var y=m.length?n(m):null;null!=y&&(g[h]={i:Number.isFinite(f)?f:d,value:y,counts:m.length},h++)}return g}},{key:"_percentileToIndex",value:function(e){var t=this.sortedBins.length;if(t<2)return[0,0];var i=e.map((function(e){return t=e,i=0,n=100,Math.max(i,Math.min(n,t));var t,i,n})),n=Object(I.a)(i,2),r=n[0],a=n[1];return[Math.ceil(r/100*(t-1)),Math.floor(a/100*(t-1))]}},{key:"getBinMap",value:function(){var e={},t=!0,i=!1,n=void 0;try{for(var r,a=this.aggregatedBins[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;e[o.i]=o}}catch(s){i=!0,n=s}finally{try{t||null==a.return||a.return()}finally{if(i)throw n}}return e}},{key:"_updateMinMaxValues",value:function(){var e=0,t=0,i=3402823466e29,n=0,r=!0,a=!1,o=void 0;try{for(var s,l=this.aggregatedBins[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value;e=e>u.counts?e:u.counts,t=t>u.value?t:u.value,i=i<u.value?i:u.value,n+=u.counts}}catch(c){a=!0,o=c}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}this.maxCount=e,this.maxValue=t,this.minValue=i,this.totalCount=n}},{key:"getValueRange",value:function(e){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((function(e,t){return Z(e.value,t.value)}))),!this.sortedBins.length)return[];var t=0,i=this.sortedBins.length-1;if(Array.isArray(e)){var n=this._percentileToIndex(e);t=n[0],i=n[1]}return[this.sortedBins[t].value,this.sortedBins[i].value]}},{key:"getValueDomainByScale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=Object(I.a)(t,2),n=i[0],r=void 0===n?0:n,a=i[1],o=void 0===a?100:a;if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((function(e,t){return Z(e.value,t.value)}))),!this.sortedBins.length)return[];var s=this._percentileToIndex([r,o]);return this._getScaleDomain(e,s)}},{key:"_getScaleDomain",value:function(e,t){var i=Object(I.a)(t,2),n=i[0],r=i[1],a=this.sortedBins;switch(e){case"quantize":case"linear":return[a[n].value,a[r].value];case"quantile":return X(a.slice(n,r+1),(function(e){return e.value}));case"ordinal":return K(a,(function(e){return e.value}));default:return[a[n].value,a[r].value]}}}]),e}(),ee={SUM:1,MEAN:2,MIN:3,MAX:4};function te(e,t){return e+t}function ie(e,t){return t>e?t:e}function ne(e,t){return t<e?t:e}function re(e,t){switch(ee[e]||ee.SUM){case ee.MIN:return function(e){return function(e,t){var i=e.map(t).filter(Number.isFinite);return i.length?i.reduce(ne,1/0):null}(e,t)};case ee.SUM:return function(e){return function(e,t){var i=e.map(t).filter(Number.isFinite);return i.length?i.reduce(te,0):null}(e,t)};case ee.MEAN:return function(e){return function(e,t){var i=e.map(t).filter(Number.isFinite);return i.length?i.reduce(te,0)/i.length:null}(e,t)};case ee.MAX:return function(e){return function(e,t){var i=e.map(t).filter(Number.isFinite);return i.length?i.reduce(ie,-1/0):null}(e,t)};default:return null}}function ae(){}var oe=["getBins","getDomain","getScaleFunc"],se=[{key:"fillColor",accessor:"getFillColor",pickingInfo:"colorValue",getBins:{triggers:{value:{prop:"getColorValue",updateTrigger:"getColorValue"},weight:{prop:"getColorWeight",updateTrigger:"getColorWeight"},aggregation:{prop:"colorAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"lowerPercentile"},upperPercentile:{prop:"upperPercentile"},scaleType:{prop:"colorScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"colorDomain"},range:{prop:"colorRange"}},onSet:{props:"onSetColorDomain"}},nullValue:[0,0,0,0]},{key:"elevation",accessor:"getElevation",pickingInfo:"elevationValue",getBins:{triggers:{value:{prop:"getElevationValue",updateTrigger:"getElevationValue"},weight:{prop:"getElevationWeight",updateTrigger:"getElevationWeight"},aggregation:{prop:"elevationAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"elevationLowerPercentile"},upperPercentile:{prop:"elevationUpperPercentile"},scaleType:{prop:"elevationScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"elevationDomain"},range:{prop:"elevationRange"}},onSet:{props:"onSetElevationDomain"}},nullValue:-1}],le=function(e){return e.cellSize},ue=function(){function e(t){Object(c.a)(this,e),this.state={layerData:{},dimensions:{}},this.changeFlags={},this.dimensionUpdaters={},this._getCellSize=t.getCellSize||le,this._getAggregator=t.getAggregator,this._addDimension(t.dimensions||se)}return Object(g.a)(e,[{key:"updateState",value:function(e,t){var i=e.oldProps,n=e.props,r=e.changeFlags;this.updateGetValueFuncs(i,n,r);var a=this.needsReProjectPoints(i,n,r),o=!1;r.dataChanged||a?(this.getAggregatedData(n,t),o=!0):((this.getDimensionChanges(i,n,r)||[]).forEach((function(e){return"function"==typeof e&&e()})),o=!0);return this.setState({aggregationDirty:o}),this.state}},{key:"setState",value:function(e){this.state=Object.assign({},this.state,e)}},{key:"setDimensionState",value:function(e,t){this.setState({dimensions:Object.assign({},this.state.dimensions,Object(u.a)({},e,Object.assign({},this.state.dimensions[e],t)))})}},{key:"normalizeResult",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.hexagons?Object.assign({data:e.hexagons},e):e.layerData?Object.assign({data:e.layerData},e):e}},{key:"getAggregatedData",value:function(e,t){var i=this._getAggregator(e)(e,t);this.setState({layerData:this.normalizeResult(i)}),this.changeFlags={layerData:!0},this.getSortedBins(e)}},{key:"updateGetValueFuncs",value:function(e,t,i){for(var n in this.dimensionUpdaters){var r=this.dimensionUpdaters[n].getBins.triggers,a=r.value,o=r.weight,s=r.aggregation,l=t[a.prop];this.needUpdateDimensionStep(this.dimensionUpdaters[n].getBins,e,t,i)&&null===l&&(l=re(t[s.prop],t[o.prop])),l&&this.setDimensionState(n,{getValue:l})}}},{key:"needsReProjectPoints",value:function(e,t,i){return this._getCellSize(e)!==this._getCellSize(t)||this._getAggregator(e)!==this._getAggregator(t)||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPosition)}},{key:"addDimension",value:function(e){this._addDimension(e)}},{key:"_addDimension",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach((function(t){var i=t.key;e.dimensionUpdaters[i]=e.getDimensionUpdaters(t),e.state.dimensions[i]={getValue:null,domain:null,sortedBins:null,scaleFunc:ae}}))}},{key:"getDimensionUpdaters",value:function(e){var t=e.key,i=e.accessor,n=e.pickingInfo,r=e.getBins,a=e.getDomain,o=e.getScaleFunc,s=e.nullValue;return{key:t,accessor:i,pickingInfo:n,getBins:Object.assign({updater:this.getDimensionSortedBins},r),getDomain:Object.assign({updater:this.getDimensionValueDomain},a),getScaleFunc:Object.assign({updater:this.getDimensionScale},o),attributeAccessor:this.getSubLayerDimensionAttribute(t,s)}}},{key:"needUpdateDimensionStep",value:function(e,t,i,n){return Object.values(e.triggers).some((function(e){return e.updateTrigger?n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged[e.updateTrigger]):t[e.prop]!==i[e.prop]}))}},{key:"getDimensionChanges",value:function(e,t,i){var n=this,r=[],a=function(a){var o=oe.find((function(r){return n.needUpdateDimensionStep(n.dimensionUpdaters[a][r],e,t,i)}));o&&r.push(n.dimensionUpdaters[a][o].updater.bind(n,t,n.dimensionUpdaters[a]))};for(var o in this.dimensionUpdaters)a(o);return r.length?r:null}},{key:"getUpdateTriggers",value:function(e){var t=this,i=e.updateTriggers||{},n={},r=function(r){var a=t.dimensionUpdaters[r].accessor;n[a]={},oe.forEach((function(o){Object.values(t.dimensionUpdaters[r][o].triggers).forEach((function(t){var r=t.prop,o=t.updateTrigger;if(o){var s=i[o];"object"!==Object(F.a)(s)||Array.isArray(s)?void 0!==s&&(n[a][r]=s):Object.assign(n[a],s)}else n[a][r]=e[r]}))}))};for(var a in this.dimensionUpdaters)r(a);return n}},{key:"getSortedBins",value:function(e){for(var t in this.dimensionUpdaters)this.getDimensionSortedBins(e,this.dimensionUpdaters[t])}},{key:"getDimensionSortedBins",value:function(e,t){var i=t.key,n=this.state.dimensions[i].getValue,r=new $(this.state.layerData.data||[],{getValue:n,filterData:e._filterData});this.setDimensionState(i,{sortedBins:r}),this.getDimensionValueDomain(e,t)}},{key:"getDimensionValueDomain",value:function(e,t){var i=t.getDomain,n=t.key,r=i.triggers,a=r.lowerPercentile,o=r.upperPercentile,s=r.scaleType,l=this.state.dimensions[n].sortedBins.getValueDomainByScale(e[s.prop],[e[a.prop],e[o.prop]]);this.setDimensionState(n,{valueDomain:l}),this.getDimensionScale(e,t)}},{key:"getDimensionScale",value:function(e,t){var i=t.key,n=t.getScaleFunc,r=t.getDomain,a=n.triggers,o=a.domain,s=a.range,l=r.triggers.scaleType,u=n.onSet,c=e[s.prop],g=e[o.prop]||this.state.dimensions[i].valueDomain,h=function(e){switch(e){case"quantize":return N;case"linear":return U;case"quantile":return z;case"ordinal":return G;default:return N}}(l&&e[l.prop])(g,c);"object"===Object(F.a)(u)&&"function"==typeof e[u.props]&&e[u.props](h.domain()),this.setDimensionState(i,{scaleFunc:h})}},{key:"getSubLayerDimensionAttribute",value:function(e,t){var i=this;return function(n){var r=i.state.dimensions[e],a=r.sortedBins,o=r.scaleFunc,s=a.binMap[n.index];if(s&&0===s.counts)return t;var l=s&&s.value,u=o.domain();return l>=u[0]&&l<=u[u.length-1]?o(l):t}}},{key:"getSubLayerAccessors",value:function(e){var t={};for(var i in this.dimensionUpdaters){t[this.dimensionUpdaters[i].accessor]=this.getSubLayerDimensionAttribute(e,i)}return t}},{key:"getPickingInfo",value:function(e){var t=e.info,i=null;if(t.picked&&t.index>-1){var n=this.state.layerData.data[t.index],r={};for(var a in this.dimensionUpdaters){var o=this.dimensionUpdaters[a].pickingInfo,s=this.state.dimensions[a].sortedBins,l=s.binMap[n.index]&&s.binMap[n.index].value;r[o]=l}i=Object.assign(r,n,{points:n.filteredPoints||n.points})}return Object.assign(t,{picked:Boolean(i),object:i})}},{key:"getAccessor",value:function(e){return this.dimensionUpdaters.hasOwnProperty(e)?this.dimensionUpdaters[e].attributeAccessor:ae}}],[{key:"defaultDimensions",value:function(){return se}}]),e}(),ce=i("hJbI"),ge=i("jGXP"),he=i("N+vi"),de=i("Sj1n");function pe(e,t){var i={};for(var n in e)t.includes(n)||(i[n]=e[n]);return i}var ve=function(e){function t(){return Object(c.a)(this,t),Object(h.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(g.a)(t,[{key:"initializeState",value:function(e){Object(p.a)(Object(d.a)(t.prototype),"initializeState",this).call(this),this.setState({ignoreProps:pe(this.constructor._propTypes,e.data.props),dimensions:e})}},{key:"updateState",value:function(e){if(Object(p.a)(Object(d.a)(t.prototype),"updateState",this).call(this,e),e.changeFlags.extensionsChanged){var i=this.getShaders({});i&&i.defines&&(i.defines.NON_INSTANCED_MODEL=1),this.updateShaders(i)}this._updateAttributes(e.props)}},{key:"updateAttributes",value:function(e){this.setState({changedAttributes:e})}},{key:"getAttributes",value:function(){return this.getAttributeManager().getShaderAttributes()}},{key:"getModuleSettings",value:function(){var e=this.context,t=e.viewport,i=e.mousePosition,n=e.gl;return Object.assign(Object.create(this.props),{viewport:t,mousePosition:i,pickingActive:0,devicePixelRatio:Object(de.c)(n)})}},{key:"updateShaders",value:function(e){}},{key:"isAggregationDirty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.props,n=e.oldProps,r=e.changeFlags,a=t.compareAll,o=void 0!==a&&a,s=t.dimension,l=this.state.ignoreProps,u=s.props,c=s.accessors,g=void 0===c?[]:c,h=r.updateTriggersChanged;if(h){if(h.all)return!0;var d=!0,p=!1,v=void 0;try{for(var f,m=g[Symbol.iterator]();!(d=(f=m.next()).done);d=!0){var y=f.value;if(h[y])return!0}}catch(j){p=!0,v=j}finally{try{d||null==m.return||m.return()}finally{if(p)throw v}}}if(o)return!!r.extensionsChanged||Object(ce.a)({oldProps:n,newProps:i,ignoreProps:l,propTypes:this.constructor._propTypes});var b=!0,_=!1,S=void 0;try{for(var L,O=u[Symbol.iterator]();!(b=(L=O.next()).done);b=!0){var P=L.value;if(i[P]!==n[P])return!0}}catch(j){_=!0,S=j}finally{try{b||null==O.return||O.return()}finally{if(_)throw S}}return!1}},{key:"isAttributeChanged",value:function(e){var t=this.state.changedAttributes;return e?t&&void 0!==t[e]:!function(e){var t=!0;for(var i in e){t=!1;break}return t}(t)}},{key:"_getAttributeManager",value:function(){return new ge.a(this.context.gl,{id:this.props.id,stats:this.context.stats})}}]),t}(he.a);function fe(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function me(){}ve.layerName="AggregationLayer";var ye={colorDomain:null,colorRange:[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]],getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:function(e){return 1}},colorAggregation:"SUM",lowerPercentile:{type:"number",value:0,min:0,max:100},upperPercentile:{type:"number",value:100,min:0,max:100},colorScaleType:"quantize",onSetColorDomain:me,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:function(e){return 1}},elevationAggregation:"SUM",elevationLowerPercentile:{type:"number",value:0,min:0,max:100},elevationUpperPercentile:{type:"number",value:100,min:0,max:100},elevationScale:{type:"number",min:0,value:1},elevationScaleType:"linear",onSetElevationDomain:me,radius:{type:"number",value:1e3,min:1},coverage:{type:"number",min:0,max:1,value:1},extruded:!1,hexagonAggregator:function(e,t){var i=e.data,n=e.radius,r=t.viewport,a=t.attributes,o=i.length?function(e,t){var i,n=t.attributes,r=n.positions.value,a=n.positions.getAccessor().size,o=1/0,s=1/0,l=-1/0,u=-1/0;for(i=0;i<a*e.length;i+=a){var c=r[i],g=r[i+1];Number.isFinite(c)&&Number.isFinite(g)&&(o=Math.min(c,o),l=Math.max(c,l),s=Math.min(g,s),u=Math.max(g,u))}return[o,s,l,u].every(Number.isFinite)?[(o+l)/2,(s+u)/2]:null}(i,t):null,s=function(e,t,i){var n=t.getDistanceScales(i).unitsPerMeter;return e*n[0]}(n,r,o),l=[],u=Object(E.a)(i),c=u.iterable,g=u.objectInfo,h=a.positions.value,d=a.positions.getAccessor().size,p=!0,v=!1,m=void 0;try{for(var y,b=c[Symbol.iterator]();!(p=(y=b.next()).done);p=!0){var _=y.value;g.index++;var S=g.index*d,L=[h[S],h[S+1]];Number.isFinite(L[0])&&Number.isFinite(L[1])?l.push(Object.assign({screenCoord:r.projectFlat(L)},_)):f.a.warn("HexagonLayer: invalid position")()}}catch(O){v=!0,m=O}finally{try{p||null==b.return||b.return()}finally{if(v)throw m}}return{hexagons:function(){var e,t,i,n=0,r=0,a=1,o=1,s=M,l=T;function u(e){var n,r={},a=[],o=e.length;for(n=0;n<o;++n)if(!isNaN(c=+s.call(null,u=e[n],n,e))&&!isNaN(g=+l.call(null,u,n,e))){var u,c,g,h=Math.round(g/=i),d=Math.round(c=c/t-(1&h)/2),p=g-h;if(3*Math.abs(p)>1){var v=c-d,f=d+(c<d?-1:1)/2,m=h+(g<h?-1:1),y=c-f,b=g-m;v*v+p*p>y*y+b*b&&(d=f+(1&h?1:-1)/2,h=m)}var _=d+"-"+h,S=r[_];S?S.push(u):(a.push(S=r[_]=[u]),S.x=(d+(1&h)/2)*t,S.y=h*i)}return a}function c(e){var t=0,i=0;return A.map((function(n){var r=Math.sin(n)*e,a=-Math.cos(n)*e,o=r-t,s=a-i;return t=r,i=a,[o,s]}))}return u.hexagon=function(t){return"m"+c(null==t?e:+t).join("l")+"z"},u.centers=function(){for(var s=[],l=Math.round(r/i),u=Math.round(n/t),c=l*i;c<o+e;c+=i,++l)for(var g=u*t+(1&l)*t/2;g<a+t/2;g+=t)s.push([g,c]);return s},u.mesh=function(){var t=c(e).slice(0,4).join("l");return u.centers().map((function(e){return"M"+e+"m"+t})).join("")},u.x=function(e){return arguments.length?(s=e,u):s},u.y=function(e){return arguments.length?(l=e,u):l},u.radius=function(n){return arguments.length?(t=2*(e=+n)*Math.sin(D),i=1.5*e,u):e},u.size=function(e){return arguments.length?(n=r=0,a=+e[0],o=+e[1],u):[a-n,o-r]},u.extent=function(e){return arguments.length?(n=+e[0][0],r=+e[0][1],a=+e[1][0],o=+e[1][1],u):[[n,r],[a,o]]},u.radius(1)}().radius(s).x((function(e){return e.screenCoord[0]})).y((function(e){return e.screenCoord[1]}))(l).map((function(e,t){return{position:r.unprojectFlat([e.x,e.y]),points:e,index:t}})),radiusCommon:s}},getPosition:{type:"accessor",value:function(e){return e.position}},material:!0,_filterData:{type:"function",value:null,optional:!0}},be=function(e){function t(){return Object(c.a)(this,t),Object(h.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(g.a)(t,[{key:"shouldUpdateState",value:function(e){return e.changeFlags.somethingChanged}},{key:"initializeState",value:function(){var e=new ue({getAggregator:function(e){return e.hexagonAggregator},getCellSize:function(e){return e.radius}});this.state={cpuAggregator:e,aggregatorState:e.state,hexagonVertices:null},this.getAttributeManager().add({positions:{size:3,accessor:"getPosition"}})}},{key:"updateState",value:function(e){Object(p.a)(Object(d.a)(t.prototype),"updateState",this).call(this,e);var i=this.state,n=i.cpuAggregator,r=i.hexagonVertices;e.changeFlags.propsOrDataChanged&&this.setState({aggregatorState:n.updateState(e,{viewport:this.context.viewport,attributes:this.getAttributes()})});var a=(n.state.layerData||{}).hexagonVertices;if(a&&r!==a){var o=this.convertLatLngToMeterOffset(a);o&&this.setState({hexagonVertices:a,vertices:o})}else this.updateRadiusAngle()}},{key:"updateRadiusAngle",value:function(e){var t=this.context.viewport.getDistanceScales().unitsPerMeter,i=this.state.cpuAggregator;if(i.state.layerData&&i.state.layerData.radiusCommon){var n=i.state.layerData.radiusCommon/t[0];this.setState({angle:90,radius:n})}}},{key:"convertLatLngToMeterOffset",value:function(e){var t=this.context.viewport;if(Array.isArray(e)&&6===e.length){var i=e[0],n=e[3],r=[(i[0]+n[0])/2,(i[1]+n[1])/2],a=t.projectFlat(r),o=t.getDistanceScales(r).metersPerUnit;return e.map((function(e){var i=t.projectFlat(e);return[(i[0]-a[0])*o[0],(i[1]-a[1])*o[1]]}))}return f.a.error("HexagonLayer: hexagonVertices needs to be an array of 6 points")(),null}},{key:"getPickingInfo",value:function(e){var t=e.info;return this.state.cpuAggregator.getPickingInfo({info:t})}},{key:"_onGetSublayerColor",value:function(e){return this.state.cpuAggregator.getAccessor("fillColor")(e)}},{key:"_onGetSublayerElevation",value:function(e){return this.state.cpuAggregator.getAccessor("elevation")(e)}},{key:"_getSublayerUpdateTriggers",value:function(){return this.state.cpuAggregator.getUpdateTriggers(this.props)}},{key:"renderLayers",value:function(){var e=this.props,t=e.elevationScale,i=e.extruded,n=e.coverage,r=e.material,a=e.transitions,o=this.state,s=o.angle,l=o.radius,c=o.cpuAggregator,g=o.vertices,h=this.getSubLayerClass("hexagon-cell",k),d=this._getSublayerUpdateTriggers();return new h(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(i),!0).forEach((function(t){Object(u.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):fe(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},g&&g.length?{vertices:g,radius:1}:{radius:l,angle:s},{diskResolution:6,elevationScale:t,extruded:i,coverage:n,material:r,getFillColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:a&&{getFillColor:a.getColorValue||a.getColorWeight,getElevation:a.getElevationValue||a.getElevationWeight}}),this.getSubLayerProps({id:"hexagon-cell",updateTriggers:d}),{data:c.state.layerData.data})}}]),t}(ve);be.layerName="HexagonLayer",be.defaultProps=ye;var _e=i("NMl0"),Se=i("/PUF"),Le=i("ERkP"),Oe=i.n(Le),Pe=new o.a({color:[255,255,255],intensity:1}),je=new s.a({color:[255,255,255],intensity:.8,position:[-.144528,49.739968,8e4]}),we=new s.a({color:[255,255,255],intensity:.8,position:[-3.807751,54.104682,8e3]}),xe=new l.a({ambientLight:Pe,pointLight1:je,pointLight2:we}),Ce={lightsPosition:[-.144528,49.739968,8e3,-3.807751,54.104682,8e3],ambientRatio:.4,diffuseRatio:.6,specularRatio:.2,lightsStrength:[.8,0,.8,0],numberOfLights:2},ke={ambient:.64,diffuse:.6,shininess:32,specularColor:[51,51,51]},De=[[1,152,189],[73,227,206],[216,254,181],[254,237,177],[254,173,84],[209,55,78]],Ae=1,Me=50;var Te=function(e){function t(t){var i;return(i=e.call(this,t)||this).state={elevationScale:Ae,radius:1e3,upperPercentile:100,coverage:1,data:[]},i.onHover=function(e){var t=e.x,n=e.y,r=e.object;i.setState({x:t,y:n,hoveredObject:r})},i.deckLayer=null,i.viewState={center:[-1.415727,52.232395],zoom:6.6,pitch:40.5,bearing:-27},i.startAnimationTimer=void 0,i.intervalTimer=void 0,i._startAnimate=i._startAnimate.bind(Object(n.a)(i)),i._animateHeight=i._animateHeight.bind(Object(n.a)(i)),i}Object(r.a)(t,e);var i=t.prototype;return i.initMap=function(){var t=this;e.prototype.initMap.call(this),a.a("https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/3d-heatmap/heatmap-data.csv",(function(e,i){if(!e){var n=i.map((function(e){return[Number(e.lng),Number(e.lat)]}));t._animate(n)}}))},i.componentWillUnmount=function(){this.deckLayer&&this.deckLayer.remove(),e.prototype.componentWillUnmount.call(this)},i.renderTooltip=function(){var e=this.state,t=e.x,i=e.y,n=e.hoveredObject;return n&&Oe.a.createElement("div",{className:"tooltip",style:{top:i,left:t}},function(e){if(!e)return null;var t=e.position[1],i=e.position[0],n=e.points.length;return"    latitude: "+(Number.isFinite(t)?t.toFixed(6):"")+"\n    longitude: "+(Number.isFinite(i)?i.toFixed(6):"")+"\n    "+n+" Accidents"}(n))},i._renderLayers=function(){var e=this.state,t=e.data,i=e.radius,n=e.upperPercentile,r=e.coverage,a={layers:[new be({id:"heatmap",colorRange:De,coverage:r,data:t,elevationRange:[0,3e3],elevationScale:this.state.elevationScale,extruded:!0,getPosition:function(e){return e},lightSettings:Ce,onHover:this.onHover,opacity:1,pickable:Boolean(this.onHover),radius:i,upperPercentile:n,material:ke,transitions:{elevationScale:3e3}})],effects:[xe]};this.deckLayer?this.deckLayer.setProps(a):(this.deckLayer=new _e.a("deck",a,{animation:!0,forceRenderOnMoving:!0,forceRenderOnZooming:!0,renderStart:function(){}}),this.map.addLayer(this.deckLayer))},i._animate=function(e){this.setState({data:e}),this._stopAnimate(),this.startAnimationTimer=window.setTimeout(this._startAnimate,1500)},i._startAnimate=function(){this.intervalTimer=window.setInterval(this._animateHeight,20)},i._stopAnimate=function(){window.clearTimeout(this.startAnimationTimer),window.clearTimeout(this.intervalTimer)},i._animateHeight=function(){var e=this;this.state.elevationScale===Me?this._stopAnimate():this.setState({elevationScale:this.state.elevationScale+1},(function(){var t;null===(t=e.renderState)||void 0===t||t.update(),e._renderLayers()}))},t}(Se.default);t.default=Te},J9yz:function(e,t,i){"use strict";var n="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",r=(t.a={name:"lights",vs:n,fs:n,getUniforms:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;if("lightSources"in t){var i=t.lightSources||{},n=i.ambientLight,a=i.pointLights,s=i.directionalLights,l=n||a&&a.length>0||s&&s.length>0;return l?Object.assign({},o({ambientLight:n,pointLights:a,directionalLights:s}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){var u={pointLights:[],directionalLights:[]},c=!0,g=!1,h=void 0;try{for(var d,p=(t.lights||[])[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var v=d.value;switch(v.type){case"ambient":u.ambientLight=v;break;case"directional":u.directionalLights.push(v);break;case"point":u.pointLights.push(v)}}}catch(f){g=!0,h=f}finally{try{c||null==p.return||p.return()}finally{if(g)throw h}}return e({lightSources:u})}return{}},defines:{MAX_LIGHTS:3}},{});function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.color,i=void 0===t?[0,0,0]:t,n=e.intensity,r=void 0===n?1:n;return i.map((function(e){return e*r/255}))}function o(e){var t=e.ambientLight,i=e.pointLights,n=void 0===i?[]:i,r=e.directionalLights,o=void 0===r?[]:r,s={};return s["lighting_uAmbientLight.color"]=t?a(t):[0,0,0],n.forEach((function(e,t){s["lighting_uPointLight[".concat(t,"].color")]=a(e),s["lighting_uPointLight[".concat(t,"].position")]=e.position,s["lighting_uPointLight[".concat(t,"].attenuation")]=e.attenuation||[1,0,0]})),s.lighting_uPointLightCount=n.length,o.forEach((function(e,t){s["lighting_uDirectionalLight[".concat(t,"].color")]=a(e),s["lighting_uDirectionalLight[".concat(t,"].direction")]=e.direction})),s.lighting_uDirectionalLightCount=o.length,s}},"N+vi":function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("9fIP"),r=i("MMYH"),a=i("K/z8"),o=i("sRHE"),s=i("PRnZ"),l=i("8K1b"),u=i("TjKm"),c=i("RXYT"),g=i("soLn"),h=function(e){function t(){return Object(n.a)(this,t),Object(a.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"getSubLayers",value:function(){return this.internalState&&this.internalState.subLayers||[]}},{key:"initializeState",value:function(){}},{key:"setState",value:function(e){Object(s.a)(Object(o.a)(t.prototype),"setState",this).call(this,e),this.setNeedsUpdate()}},{key:"getPickingInfo",value:function(e){var t=e.info,i=t.object;return i&&i.__source&&i.__source.parent&&i.__source.parent.id===this.id?Object.assign(t,{object:i.__source.object,index:i.__source.index}):t}},{key:"renderLayers",value:function(){return null}},{key:"shouldRenderSubLayer",value:function(e,t){var i=this.props._subLayerProps;return t&&t.length||i&&i[e]}},{key:"getSubLayerClass",value:function(e,t){var i=this.props._subLayerProps;return i&&i[e]&&i[e].type||t}},{key:"getSubLayerRow",value:function(e,t,i){return e.__source={parent:this,object:t,index:i},e}},{key:"getSubLayerAccessor",value:function(e){if("function"==typeof e){var t={data:this.props.data,target:[]};return function(i,n){return i.__source?(t.index=i.__source.index,e(i.__source.object,t)):e(i,n)}}return e}},{key:"getSubLayerProps",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.props,i=t.opacity,n=t.pickable,r=t.visible,a=t.parameters,o=t.getPolygonOffset,s=t.highlightedObjectIndex,l=t.autoHighlight,u=t.highlightColor,c=t.coordinateSystem,g=t.coordinateOrigin,h=t.wrapLongitude,d=t.positionFormat,p=t.modelMatrix,v=t.extensions,f=t._subLayerProps,m={opacity:i,pickable:n,visible:r,parameters:a,getPolygonOffset:o,highlightedObjectIndex:s,autoHighlight:l,highlightColor:u,coordinateSystem:c,coordinateOrigin:g,wrapLongitude:h,positionFormat:d,modelMatrix:p,extensions:v},y=f&&f[e.id],b=y&&y.updateTriggers,_=e.id||"sublayer";if(y){var S=this.constructor._propTypes;for(var L in y){var O=S[L];O&&"accessor"===O.type&&(y[L]=this.getSubLayerAccessor(y[L]))}}Object.assign(m,e,y,{id:"".concat(this.props.id,"-").concat(_),updateTriggers:Object.assign({all:this.props.updateTriggers.all},e.updateTriggers,b)});var P=!0,j=!1,w=void 0;try{for(var x,C=v[Symbol.iterator]();!(P=(x=C.next()).done);P=!0){var k=x.value,D=k.getSubLayerProps.call(this,k);D&&Object.assign(m,D,{updateTriggers:Object.assign(m.updateTriggers,D.updateTriggers)})}}catch(A){j=!0,w=A}finally{try{P||null==C.return||C.return()}finally{if(j)throw w}}return m}},{key:"_getAttributeManager",value:function(){return null}},{key:"_renderLayers",value:function(){var e=this.internalState.subLayers,t=!e||this.needsUpdate();t&&(e=this.renderLayers(),e=Object(g.b)(e,Boolean),this.internalState.subLayers=e),Object(c.a)("compositeLayer.renderLayers",this,t,e);var i=!0,n=!1,r=void 0;try{for(var a,o=e[Symbol.iterator]();!(i=(a=o.next()).done);i=!0){a.value.parent=this}}catch(s){n=!0,r=s}finally{try{i||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"isComposite",get:function(){return!0}},{key:"isLoaded",get:function(){return Object(s.a)(Object(o.a)(t.prototype),"isLoaded",this)&&this.getSubLayers().every((function(e){return e.isLoaded}))}}]),t}(u.a);h.layerName="CompositeLayer"},YVXj:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return o}));var n=i("J9yz"),r="\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",a={name:"gouraud-lighting",dependencies:[n.a],vs:r,defines:{LIGHTING_VERTEX:1},getUniforms:u},o={name:"phong-lighting",dependencies:[n.a],fs:r,defines:{LIGHTING_FRAGMENT:1},getUniforms:u},s={};function l(e){var t=e.ambient,i=void 0===t?.35:t,n=e.diffuse,r=void 0===n?.6:n,a=e.shininess,o=void 0===a?32:a,s=e.specularColor;return{lighting_uAmbient:i,lighting_uDiffuse:r,lighting_uShininess:o,lighting_uSpecularColor:(void 0===s?[30,30,30]:s).map((function(e){return e/255}))}}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;if(!("material"in e))return{};var t=e.material;return t?l(t):{lighting_uEnabled:!1}}},mqw2:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("9fIP"),r=i("MMYH"),a=i("us+3"),o=i("Vind"),s=[255,255,255],l=[0,0,1],u=[0,0,1],c=0,g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(n.a)(this,e);var i=t.color,r=void 0===i?s:i,a=t.intensity,o=void 0===a?1:a,l=t.position,g=void 0===l?u:l;this.id=t.id||"point-".concat(c++),this.color=r,this.intensity=o,this.type="point",this.position=g,this.attenuation=h(t),this.projectedLight=Object.assign({},this)}return Object(r.a)(e,[{key:"getProjectedLight",value:function(e){var t=e.layer,i=this.projectedLight,n=t.context.viewport,r=t.props,s=r.coordinateSystem,l=r.coordinateOrigin,u=Object(a.b)(this.position,{viewport:n,coordinateSystem:s,coordinateOrigin:l,fromCoordinateSystem:n.isGeospatial?o.a.LNGLAT:o.a.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return i.color=this.color,i.intensity=this.intensity,i.position=u,i}}]),e}();function h(e){return"attenuation"in e?e.attenuation:"intensity"in e?[0,0,e.intensity]:l}}}]);
//# sourceMappingURL=component---src-pages-hexagon-tsx-0dbcbce2089c52411eb5.js.map