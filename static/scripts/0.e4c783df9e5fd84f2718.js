(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"+Ik0":function(t,e){t.exports=function(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t}},"+mLN":function(t,e,n){},"+sJh":function(t,e){t.exports=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}},"+wdc":function(t,e,n){"use strict";(function(t){
/** @license React v0.12.0
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
Object.defineProperty(e,"__esModule",{value:!0});var n=null,r=!1,i=3,o=-1,a=-1,s=!1,u=!1;function c(){if(!s){var t=n.expirationTime;u?E():u=!0,x(f,t)}}function l(){var t=n,e=n.next;if(n===e)n=null;else{var r=n.previous;n=r.next=e,e.previous=r}t.next=t.previous=null,r=t.callback,e=t.expirationTime,t=t.priorityLevel;var o=i,s=a;i=t,a=e;try{var u=r()}finally{i=o,a=s}if("function"==typeof u)if(u={callback:u,priorityLevel:t,expirationTime:e,next:null,previous:null},null===n)n=u.next=u.previous=u;else{r=null,t=n;do{if(t.expirationTime>=e){r=t;break}t=t.next}while(t!==n);null===r?r=n:r===n&&(n=u,c()),(e=r.previous).next=r.previous=u,u.next=r,u.previous=e}}function h(){if(-1===o&&null!==n&&1===n.priorityLevel){s=!0;try{do{l()}while(null!==n&&1===n.priorityLevel)}finally{s=!1,null!==n?c():u=!1}}}function f(t){s=!0;var i=r;r=t;try{if(t)for(;null!==n;){var o=e.unstable_now();if(!(n.expirationTime<=o))break;do{l()}while(null!==n&&n.expirationTime<=o)}else if(null!==n)do{l()}while(null!==n&&!O())}finally{s=!1,r=i,null!==n?c():u=!1,h()}}var d,p,v=Date,g="function"==typeof setTimeout?setTimeout:void 0,y="function"==typeof clearTimeout?clearTimeout:void 0,m="function"==typeof requestAnimationFrame?requestAnimationFrame:void 0,_="function"==typeof cancelAnimationFrame?cancelAnimationFrame:void 0;function b(t){d=m(function(e){y(p),t(e)}),p=g(function(){_(d),t(e.unstable_now())},100)}if("object"==typeof performance&&"function"==typeof performance.now){var w=performance;e.unstable_now=function(){return w.now()}}else e.unstable_now=function(){return v.now()};var x,E,O,P=null;if("undefined"!=typeof window?P=window:void 0!==t&&(P=t),P&&P._schedMock){var S=P._schedMock;x=S[0],E=S[1],O=S[2],e.unstable_now=S[3]}else if("undefined"==typeof window||"function"!=typeof MessageChannel){var T=null,C=function(t){if(null!==T)try{T(t)}finally{T=null}};x=function(t){null!==T?setTimeout(x,0,t):(T=t,setTimeout(C,0,!1))},E=function(){T=null},O=function(){return!1}}else{"undefined"!=typeof console&&("function"!=typeof m&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!=typeof _&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"));var A=null,M=!1,k=-1,j=!1,R=!1,L=0,I=33,D=33;O=function(){return L<=e.unstable_now()};var F=new MessageChannel,N=F.port2;F.port1.onmessage=function(){M=!1;var t=A,n=k;A=null,k=-1;var r=e.unstable_now(),i=!1;if(0>=L-r){if(!(-1!==n&&n<=r))return j||(j=!0,b(B)),A=t,void(k=n);i=!0}if(null!==t){R=!0;try{t(i)}finally{R=!1}}};var B=function(t){if(null!==A){b(B);var e=t-L+D;e<D&&I<D?(8>e&&(e=8),D=e<I?I:e):I=e,L=t+D,M||(M=!0,N.postMessage(void 0))}else j=!1};x=function(t,e){A=t,k=e,R||0>e?N.postMessage(void 0):j||(j=!0,b(B))},E=function(){A=null,M=!1,k=-1}}e.unstable_ImmediatePriority=1,e.unstable_UserBlockingPriority=2,e.unstable_NormalPriority=3,e.unstable_IdlePriority=5,e.unstable_LowPriority=4,e.unstable_runWithPriority=function(t,n){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var r=i,a=o;i=t,o=e.unstable_now();try{return n()}finally{i=r,o=a,h()}},e.unstable_scheduleCallback=function(t,r){var a=-1!==o?o:e.unstable_now();if("object"==typeof r&&null!==r&&"number"==typeof r.timeout)r=a+r.timeout;else switch(i){case 1:r=a+-1;break;case 2:r=a+250;break;case 5:r=a+1073741823;break;case 4:r=a+1e4;break;default:r=a+5e3}if(t={callback:t,priorityLevel:i,expirationTime:r,next:null,previous:null},null===n)n=t.next=t.previous=t,c();else{a=null;var s=n;do{if(s.expirationTime>r){a=s;break}s=s.next}while(s!==n);null===a?a=n:a===n&&(n=t,c()),(r=a.previous).next=a.previous=t,t.next=a,t.previous=r}return t},e.unstable_cancelCallback=function(t){var e=t.next;if(null!==e){if(e===t)n=null;else{t===n&&(n=e);var r=t.previous;r.next=e,e.previous=r}t.next=t.previous=null}},e.unstable_wrapCallback=function(t){var n=i;return function(){var r=i,a=o;i=n,o=e.unstable_now();try{return t.apply(this,arguments)}finally{i=r,o=a,h()}}},e.unstable_getCurrentPriorityLevel=function(){return i},e.unstable_shouldYield=function(){return!r&&(null!==n&&n.expirationTime<a||O())},e.unstable_continueExecution=function(){null!==n&&c()},e.unstable_pauseExecution=function(){},e.unstable_getFirstCallbackNode=function(){return n}}).call(this,n("yLpj"))},"/BFQ":function(t,e){t.exports=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],h=e[6],f=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+h*r,t[3]=u*i+f*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=h*i-s*r,t[7]=f*i-u*r,t}},"/sWY":function(t,e){t.exports=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},0:function(t,e){},"0cfB":function(module,exports,__webpack_require__){"use strict";var evalAllowed=!1;try{eval("evalAllowed = true")}catch(t){}var platformSupported=!!Object.setPrototypeOf&&evalAllowed;module.exports=__webpack_require__("7B0+")},"0vGO":function(t,e,n){"use strict";var r=n("d3wX");e.a=new r.a({id:"luma"}).enable()},"0z1g":function(t,e,n){"use strict";(function(t){var e,r=n("rePB"),i=n("TjS6");function o(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function a(t){return t&&!0}var s=(e={},Object(r.a)(e,"OES_vertex_array_object",{meta:{suffix:"OES"},createVertexArray:function(){o(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:function(){},bindVertexArray:function(){},isVertexArray:function(){return!1}}),Object(r.a)(e,"ANGLE_instanced_arrays",{meta:{suffix:"ANGLE"},vertexAttribDivisor:function(t,e){o(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:function(){},drawArraysInstanced:function(){}}),Object(r.a)(e,"WEBGL_draw_buffers",{meta:{suffix:"WEBGL"},drawBuffers:function(){o(!1)}}),Object(r.a)(e,"EXT_disjoint_timer_query",{meta:{suffix:"EXT"},createQuery:function(){o(!1)},deleteQuery:function(){o(!1)},beginQuery:function(){o(!1)},endQuery:function(){},getQuery:function(t,e){return this.getQueryObject(t,e)},getQueryParameter:function(t,e){return this.getQueryObject(t,e)},queryCounter:function(){},getQueryObject:function(){}}),Object(r.a)(e,"EXT_disjoint_timer_query_webgl2",{meta:{suffix:"EXT"},queryCounter:null}),Object(r.a)(e,"OVERRIDES",{readBuffer:function(t,e,n){a(t)&&e(n)},getVertexAttrib:function(t,e,n,r){var i,o=function(t,e){return{webgl2:a(t),ext:t.getExtension(e)}}(t,"ANGLE_instanced_arrays"),s=o.webgl2,u=o.ext;switch(r){case 35069:i=!!s&&void 0;break;case 35070:i=s||u?void 0:0}return void 0!==i?i:e(n,r)},getProgramParameter:function(t,e,n,r){if(!a(t))switch(r){case 35967:return 35981;case 35971:case 35382:return 0}return e(n,r)},getInternalformatParameter:function(t,e,n,r,i){if(!a(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter:function(t,e,n,r){switch(r){case 34046:var i=t.luma.extensions.EXT_texture_filter_anisotropic;r=i&&i.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(n,r)},getParameter:i.a,hint:function(t,e,n,r){return e(n,r)}}),e);function u(t,e){var n=e.extension,r=e.target,i=e.target2,a=s[n];o(a);var u=a.meta,c=(void 0===u?{}:u).suffix,l=void 0===c?"":c,h=t.getExtension(n);Object.keys(a).forEach(function(e){var n="".concat(e).concat(l),o=null;"meta"===e||"function"==typeof t[e]||(h&&"function"==typeof h[n]?o=function(){return h[n].apply(h,arguments)}:"function"==typeof a[e]&&(o=a[e].bind(r))),o&&(r[e]=o,i[e]=o)})}(void 0!==t?t:window).polyfillContext=function(t){if(t.luma=t.luma||{},function(t){t.luma.extensions={};var e=t.getSupportedExtensions()||[],n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;t.luma[s]=t.getExtension(s)}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}(t),!t.luma.polyfilled){for(var e in s)"overrides"!==e&&u(t,{extension:e,target:t.luma,target2:t});!function(t,e){var n=e.target,r=e.target2,i=s.OVERRIDES;Object.keys(i).forEach(function(e){if("function"==typeof i[e]){var o=t[e]?t[e].bind(t):function(){},a=i[e].bind(null,t,o);n[e]=a,r[e]=a}})}(t,{target:t.luma,target2:t}),t.luma.polyfilled=!0}return t}}).call(this,n("yLpj"))},1:function(t,e){},"16Al":function(t,e,n){"use strict";var r=n("WbBG");function i(){}t.exports=function(){function t(t,e,n,i,o,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e};return n.checkPropTypes=i,n.PropTypes=n,n}},"17x9":function(t,e,n){t.exports=n("16Al")()},"19qB":function(t,e){t.exports=function(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),c=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t}},"1OyB":function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return r})},"1gqn":function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},"1o6E":function(t,e,n){},2:function(t,e){},"2W6z":function(t,e,n){"use strict";var r=function(){};t.exports=r},"2cIc":function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}},"54ZI":function(t,e,n){"use strict";function r(t){if(!t)throw new Error("viewport-mercator-project: assertion failed.")}n.d(e,"a",function(){return r})},"5Eg2":function(t,e){t.exports=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}},"5YEP":function(t,e,n){var r=n("/sWY");t.exports=function(t,e,n,i){var o,a,s,u,c,l,h,f,d,p,v=e[0],g=e[1],y=e[2],m=i[0],_=i[1],b=i[2],w=n[0],x=n[1],E=n[2];if(Math.abs(v-w)<1e-6&&Math.abs(g-x)<1e-6&&Math.abs(y-E)<1e-6)return r(t);h=v-w,f=g-x,d=y-E,p=1/Math.sqrt(h*h+f*f+d*d),o=_*(d*=p)-b*(f*=p),a=b*(h*=p)-m*d,s=m*f-_*h,(p=Math.sqrt(o*o+a*a+s*s))?(o*=p=1/p,a*=p,s*=p):(o=0,a=0,s=0);u=f*s-d*a,c=d*o-h*s,l=h*a-f*o,(p=Math.sqrt(u*u+c*c+l*l))?(u*=p=1/p,c*=p,l*=p):(u=0,c=0,l=0);return t[0]=o,t[1]=u,t[2]=h,t[3]=0,t[4]=a,t[5]=c,t[6]=f,t[7]=0,t[8]=s,t[9]=l,t[10]=d,t[11]=0,t[12]=-(o*v+a*g+s*y),t[13]=-(u*v+c*g+l*y),t[14]=-(h*v+f*g+d*y),t[15]=1,t}},"5cL1":function(t,e,n){"use strict";var r=n("V3d6"),i=n("V8ep"),o=n("bl9R"),a=n("yU0y");var s,u,c=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},l=(s=new a.a(3),a.a!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),u=s,n("B7nP"));function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function f(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=h(t,3),i=r[0],o=r[1],a=r[2],s=void 0===a?0:a,u=h(e.projectFlat(t),2);return[u[0],u[1],s*(n?Object(l.b)({longitude:i,latitude:o,scale:e.scale}):e.getDistanceScales()).pixelsPerMeter[2]]}function d(t,e){var n=e.viewport,i=e.modelMatrix,a=e.coordinateSystem,s=e.coordinateOrigin,u=e.offsetMode,c=h(t,3),d=c[0],p=c[1],v=c[2];if(i){var g=h(o.b([],[d,p,v,1],i),3);d=g[0],p=g[1],v=g[2]}switch(a){case r.a.LNGLAT:case r.a.LNGLAT_DEPRECATED:return f([d,p,v],n,u);case r.a.LNGLAT_OFFSETS:return f([d+s[0],p+s[1],v+(s[2]||0)],n,u);case r.a.METER_OFFSETS:return f(Object(l.a)(s,[d,p,v]),n,u);case r.a.IDENTITY:default:return[d,p,v]}}function p(t,e){var n=function(t){var e=Object.assign({},t),n=t.viewport,o=t.coordinateSystem,a=t.coordinateOrigin,s=t.fromCoordinateSystem,u=t.fromCoordinateOrigin;return void 0===s&&(e.fromCoordinateSystem=o),void 0===u&&(e.fromCoordinateOrigin=a),o===r.a.LNGLAT&&n.zoom>=i.a&&(e.coordinateSystem=r.a.LNGLAT_OFFSETS,e.coordinateOrigin=[Math.fround(n.longitude),Math.fround(n.latitude)]),e}(e),o=n.viewport,a=n.coordinateSystem,s=n.coordinateOrigin,u=n.modelMatrix,l=n.fromCoordinateSystem,h=n.fromCoordinateOrigin;switch(a){case r.a.LNGLAT_OFFSETS:case r.a.METER_OFFSETS:var p=d(t,{viewport:o,modelMatrix:u,coordinateSystem:l,coordinateOrigin:h,offsetMode:!0}),v=f(s,o,!0);return c(p,p,v),p;case r.a.LNGLAT:case r.a.LNGLAT_DEPRECATED:case r.a.IDENTITY:default:return d(t,{viewport:o,modelMatrix:u,coordinateSystem:l,coordinateOrigin:h,offsetMode:!1})}}n.d(e,"a",function(){return d}),n.d(e,"b",function(){return p})},"5ku3":function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return o});var r=n("U8pU"),i=n("I0ug");function o(){return!("object"===(void 0===t?"undefined":Object(r.a)(t))&&"[object process]"===String(t)&&!t.browser)||Object(i.a)()}}).call(this,n("8oxB"))},"62Ki":function(t,e,n){"use strict";n.d(e,"a",function(){return c}),n.d(e,"d",function(){return y}),n.d(e,"b",function(){return _}),n.d(e,"c",function(){return b});var r,i,o,a=n("KQm4"),s=n("rePB"),u=n("xo4u"),c=(n("lvHR"),r={},Object(s.a)(r,3042,!1),Object(s.a)(r,32773,new Float32Array([0,0,0,0])),Object(s.a)(r,32777,32774),Object(s.a)(r,34877,32774),Object(s.a)(r,32969,1),Object(s.a)(r,32968,0),Object(s.a)(r,32971,1),Object(s.a)(r,32970,0),Object(s.a)(r,3106,new Float32Array([0,0,0,0])),Object(s.a)(r,3107,[!0,!0,!0,!0]),Object(s.a)(r,2884,!1),Object(s.a)(r,2885,1029),Object(s.a)(r,2929,!1),Object(s.a)(r,2931,1),Object(s.a)(r,2932,513),Object(s.a)(r,2928,new Float32Array([0,1])),Object(s.a)(r,2930,!0),Object(s.a)(r,3024,!0),Object(s.a)(r,36006,null),Object(s.a)(r,2886,2305),Object(s.a)(r,33170,4352),Object(s.a)(r,2849,1),Object(s.a)(r,32823,!1),Object(s.a)(r,32824,0),Object(s.a)(r,10752,0),Object(s.a)(r,32938,1),Object(s.a)(r,32939,!1),Object(s.a)(r,3089,!1),Object(s.a)(r,3088,new Int32Array([0,0,1024,1024])),Object(s.a)(r,2960,!1),Object(s.a)(r,2961,0),Object(s.a)(r,2968,4294967295),Object(s.a)(r,36005,4294967295),Object(s.a)(r,2962,519),Object(s.a)(r,2967,0),Object(s.a)(r,2963,4294967295),Object(s.a)(r,34816,519),Object(s.a)(r,36003,0),Object(s.a)(r,36004,4294967295),Object(s.a)(r,2964,7680),Object(s.a)(r,2965,7680),Object(s.a)(r,2966,7680),Object(s.a)(r,34817,7680),Object(s.a)(r,34818,7680),Object(s.a)(r,34819,7680),Object(s.a)(r,2978,new Int32Array([0,0,1024,1024])),Object(s.a)(r,3333,4),Object(s.a)(r,3317,4),Object(s.a)(r,37440,!1),Object(s.a)(r,37441,!1),Object(s.a)(r,37443,37444),Object(s.a)(r,35723,4352),Object(s.a)(r,36010,null),Object(s.a)(r,35977,!1),Object(s.a)(r,3330,0),Object(s.a)(r,3332,0),Object(s.a)(r,3331,0),Object(s.a)(r,3314,0),Object(s.a)(r,32878,0),Object(s.a)(r,3316,0),Object(s.a)(r,3315,0),Object(s.a)(r,32877,0),r),l=function(t,e,n){return e?t.enable(n):t.disable(n)},h=function(t,e,n){return t.hint(n,e)},f=function(t,e,n){return t.pixelStorei(n,e)},d=(i={},Object(s.a)(i,3042,l),Object(s.a)(i,32773,function(t,e){return t.blendColor.apply(t,Object(a.a)(e))}),Object(s.a)(i,32777,"blendEquation"),Object(s.a)(i,34877,"blendEquation"),Object(s.a)(i,32969,"blendFunc"),Object(s.a)(i,32968,"blendFunc"),Object(s.a)(i,32971,"blendFunc"),Object(s.a)(i,32970,"blendFunc"),Object(s.a)(i,3106,function(t,e){return t.clearColor.apply(t,Object(a.a)(e))}),Object(s.a)(i,3107,function(t,e){return t.colorMask.apply(t,Object(a.a)(e))}),Object(s.a)(i,2884,l),Object(s.a)(i,2885,function(t,e){return t.cullFace(e)}),Object(s.a)(i,2929,l),Object(s.a)(i,2931,function(t,e){return t.clearDepth(e)}),Object(s.a)(i,2932,function(t,e){return t.depthFunc(e)}),Object(s.a)(i,2928,function(t,e){return t.depthRange.apply(t,Object(a.a)(e))}),Object(s.a)(i,2930,function(t,e){return t.depthMask(e)}),Object(s.a)(i,3024,l),Object(s.a)(i,35723,h),Object(s.a)(i,36006,function(t,e){var n=Object(u.n)(t)?36009:36160;return t.bindFramebuffer(n,e)}),Object(s.a)(i,2886,function(t,e){return t.frontFace(e)}),Object(s.a)(i,33170,h),Object(s.a)(i,2849,function(t,e){return t.lineWidth(e)}),Object(s.a)(i,32823,l),Object(s.a)(i,32824,"polygonOffset"),Object(s.a)(i,10752,"polygonOffset"),Object(s.a)(i,35977,l),Object(s.a)(i,32938,"sampleCoverage"),Object(s.a)(i,32939,"sampleCoverage"),Object(s.a)(i,3089,l),Object(s.a)(i,3088,function(t,e){return t.scissor.apply(t,Object(a.a)(e))}),Object(s.a)(i,2960,l),Object(s.a)(i,2961,function(t,e){return t.clearStencil(e)}),Object(s.a)(i,2968,function(t,e){return t.stencilMaskSeparate(1028,e)}),Object(s.a)(i,36005,function(t,e){return t.stencilMaskSeparate(1029,e)}),Object(s.a)(i,2962,"stencilFuncFront"),Object(s.a)(i,2967,"stencilFuncFront"),Object(s.a)(i,2963,"stencilFuncFront"),Object(s.a)(i,34816,"stencilFuncBack"),Object(s.a)(i,36003,"stencilFuncBack"),Object(s.a)(i,36004,"stencilFuncBack"),Object(s.a)(i,2964,"stencilOpFront"),Object(s.a)(i,2965,"stencilOpFront"),Object(s.a)(i,2966,"stencilOpFront"),Object(s.a)(i,34817,"stencilOpBack"),Object(s.a)(i,34818,"stencilOpBack"),Object(s.a)(i,34819,"stencilOpBack"),Object(s.a)(i,2978,function(t,e){return t.viewport.apply(t,Object(a.a)(e))}),Object(s.a)(i,3333,f),Object(s.a)(i,3317,f),Object(s.a)(i,37440,f),Object(s.a)(i,37441,f),Object(s.a)(i,37443,f),Object(s.a)(i,3330,f),Object(s.a)(i,3332,f),Object(s.a)(i,3331,f),Object(s.a)(i,36010,function(t,e){return t.bindFramebuffer(36008,e)}),Object(s.a)(i,3314,f),Object(s.a)(i,32878,f),Object(s.a)(i,3316,f),Object(s.a)(i,3315,f),Object(s.a)(i,32877,f),i),p={blendEquation:function(t,e){return t.blendEquationSeparate(e[32777],e[34877])},blendFunc:function(t,e){return t.blendFuncSeparate(e[32969],e[32968],e[32971],e[32970])},polygonOffset:function(t,e){return t.polygonOffset(e[32824],e[10752])},sampleCoverage:function(t,e){return t.sampleCoverage(e[32938],e[32939])},stencilFuncFront:function(t,e){return t.stencilFuncSeparate(1028,e[2962],e[2967],e[2963])},stencilFuncBack:function(t,e){return t.stencilFuncSeparate(1029,e[34816],e[36003],e[36004])},stencilOpFront:function(t,e){return t.stencilOpSeparate(1028,e[2964],e[2965],e[2966])},stencilOpBack:function(t,e){return t.stencilOpSeparate(1029,e[34817],e[34818],e[34819])}},v=function(t,e){return t.isEnabled(e)},g=(o={},Object(s.a)(o,3042,v),Object(s.a)(o,2884,v),Object(s.a)(o,2929,v),Object(s.a)(o,3024,v),Object(s.a)(o,32823,v),Object(s.a)(o,32926,v),Object(s.a)(o,32928,v),Object(s.a)(o,3089,v),Object(s.a)(o,2960,v),Object(s.a)(o,35977,v),o);function y(t,e){var n={};for(var r in e){var i=Number(r),o=d[r];o&&("string"==typeof o?n[o]=!0:o(t,e[r],i))}var a=t.state&&t.state.cache;if(a){var s=Object.assign({},a,e);for(var u in n){(0,p[u])(t,s)}}}function m(t,e){var n=g[e];return n?n(t,Number(e)):t.getParameter(Number(e))}function _(t,e){e=e||c;var n=Array.isArray(e)?e:Object.keys(e),r={},i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;r[l]=m(t,l)}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return r}function b(t){y(t,Object.assign({},c,{}))}},"6Sts":function(t,e,n){"use strict";n.d(e,"a",function(){return m});var r,i=n("1OyB"),o=n("md7G"),a=n("foSv"),s=n("vuIU"),u=n("Ji7U"),c=n("rePB"),l=n("NaB/"),h=n("Gujg"),f=n("Sr2d"),d=n("xo4u"),p=n("ket5"),v=n("lvHR"),g=[9729,9728],y=(r={},Object(c.a)(r,6407,{dataFormat:6407,types:[5121,33635]}),Object(c.a)(r,6408,{dataFormat:6408,types:[5121,32819,32820]}),Object(c.a)(r,6406,{dataFormat:6406,types:[5121]}),Object(c.a)(r,6409,{dataFormat:6409,types:[5121]}),Object(c.a)(r,6410,{dataFormat:6410,types:[5121]}),Object(c.a)(r,33326,{dataFormat:6403,types:[5126],gl2:!0}),Object(c.a)(r,33328,{dataFormat:33319,types:[5126],gl2:!0}),Object(c.a)(r,34837,{dataFormat:6407,types:[5126],gl2:!0}),Object(c.a)(r,34836,{dataFormat:6408,types:[5126],gl2:!0}),r);var m=function(t){function e(t,n){var r;Object(i.a)(this,e);var s=n.id,u=void 0===s?Object(p.i)("texture"):s,c=n.handle,l=n.target;return(r=Object(o.a)(this,Object(a.a)(e).call(this,t,{id:u,handle:c}))).target=l,r.hasFloatTexture=t.getExtension("OES_texture_float"),r.textureUnit=void 0,r}return Object(u.a)(e,t),Object(s.a)(e,null,[{key:"isSupported",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.format,r=e.linearFiltering,i=!0;return n&&(i=(i=i&&function(t,e){var n=y[e];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;var r=Object(d.n)(t)&&n.gl2||n.gl1;return"string"==typeof r?t.getExtension(r):r}(t,n))&&(!r||function(t,e){var n=y[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}(t,n))),i}}]),Object(s.a)(e,[{key:"toString",value:function(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.data,n=t.pixels,r=void 0===n?null:n,i=t.format,o=void 0===i?6408:i,a=t.type,s=void 0===a?5121:a,u=t.border,l=void 0===u?0:u,h=t.recreate,f=void 0!==h&&h,d=t.parameters,v=void 0===d?{}:d,g=t.pixelStore,y=void 0===g?{}:g,m=t.textureUnit,_=void 0===m?void 0:m,b=t.unpackFlipY,w=void 0===b||b,x=t.mipmaps,E=void 0===x||x;e||(e=r);var O=t.width,P=t.height,S=t.dataFormat,T=this._deduceParameters({format:o,type:s,dataFormat:S,compressed:!1,data:e,width:O,height:P});O=T.width,P=T.height,S=T.dataFormat,this.width=O,this.height=P,this.format=o,this.type=s,this.dataFormat=S,this.border=l,this.textureUnit=_,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle));var C=Object(c.a)({},37440,w),A=Object.assign({},C,y);this._isNPOT()&&E&&(p.g.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),E=!1,this._updateForNPOT(v)),this.mipmaps=E,this.setImageData({data:e,width:O,height:P,format:o,type:s,dataFormat:S,border:l,mipmaps:E,parameters:A}),E&&this.generateMipmap(),this.setParameters(v),f&&(this.data=e)}},{key:"resize",value:function(t){var e=t.width,n=t.height;return e!==this.width||n!==this.height?this.initialize({width:e,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:!1}):this}},{key:"generateMipmap",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindTexture(this.target,this.handle),Object(f.c)(this.gl,e,function(){t.gl.generateMipmap(t.target)}),this.gl.bindTexture(this.target,null),this}},{key:"setImageData",value:function(t){var e=t.target,n=void 0===e?this.target:e,r=t.pixels,i=void 0===r?null:r,o=t.data,a=void 0===o?null:o,s=t.width,u=void 0===s?this.width:s,c=t.height,l=void 0===c?this.height:c,h=t.level,p=void 0===h?0:h,g=t.format,y=void 0===g?this.format:g,m=t.type,_=void 0===m?this.type:m,b=t.dataFormat,w=void 0===b?this.dataFormat:b,x=t.offset,E=void 0===x?0:x,O=t.border,P=void 0===O?this.border:O,S=t.compressed,T=void 0!==S&&S,C=t.parameters,A=void 0===C?{}:C;a||(a=i);var M=this._deduceParameters({format:y,type:_,dataFormat:w,compressed:T,data:a,width:u,height:l});_=M.type,w=M.dataFormat,T=M.compressed,u=M.width,l=M.height;var k=this.gl;k.bindTexture(this.target,this.handle);var j,R=this._getDataType({data:a,compressed:T});a=R.data,j=R.dataType,Object(f.c)(this.gl,A,function(){switch(j){case"null":k.texImage2D(n,p,y,u,l,P,w,_,a);break;case"typed-array":k.texImage2D(n,p,y,u,l,P,w,_,a,E);break;case"buffer":Object(d.d)(k),k.bindBuffer(35052,a.handle||a),k.texImage2D(n,p,y,u,l,P,w,_,E),k.bindBuffer(35052,null);break;case"browser-object":Object(d.n)(k)?k.texImage2D(n,p,y,u,l,P,w,_,a):k.texImage2D(n,p,y,w,_,a);break;case"compressed":k.compressedTexImage2D(n,p,y,u,l,P,a);break;default:Object(v.a)(!1,"Unknown image data type")}})}},{key:"setSubImageData",value:function(t){var e=this,n=t.target,r=void 0===n?this.target:n,i=t.pixels,o=void 0===i?null:i,a=t.data,s=void 0===a?null:a,u=t.x,c=void 0===u?0:u,l=t.y,p=void 0===l?0:l,v=t.width,g=void 0===v?this.width:v,y=t.height,m=void 0===y?this.height:y,_=t.level,b=void 0===_?0:_,w=t.format,x=void 0===w?this.format:w,E=t.type,O=void 0===E?this.type:E,P=t.dataFormat,S=void 0===P?this.dataFormat:P,T=t.compressed,C=void 0!==T&&T,A=t.offset,M=void 0===A?0:A,k=t.border,j=(void 0===k&&this.border,t.parameters),R=void 0===j?{}:j,L=this._deduceParameters({format:x,type:O,dataFormat:S,compressed:C,data:s,width:g,height:m});if(O=L.type,S=L.dataFormat,C=L.compressed,g=L.width,m=L.height,s||(s=o),s&&s.data){var I=s;s=I.data,g=I.shape[0],m=I.shape[1]}s instanceof h.a&&(s=s.handle),this.gl.bindTexture(this.target,this.handle),Object(f.c)(this.gl,R,function(){C?e.gl.compressedTexSubImage2D(r,b,c,p,g,m,x,s):null===s?e.gl.texSubImage2D(r,b,c,p,g,m,S,O,null):ArrayBuffer.isView(s)?e.gl.texSubImage2D(r,b,c,p,g,m,S,O,s,M):s instanceof d.b?(Object(d.d)(e.gl),e.gl.bindBuffer(35052,s),e.gl.texSubImage2D(r,b,c,p,g,m,S,O,M),e.gl.bindBuffer(35052,null)):Object(d.n)(e.gl)?e.gl.texSubImage2D(r,b,c,p,g,m,S,O,s):e.gl.texSubImage2D(r,b,c,p,S,O,s)}),this.gl.bindTexture(this.target,null)}},{key:"copyFramebuffer",value:function(t){var e=t.target,n=(void 0===e&&this.target,t.framebuffer),r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o,s=t.width,u=t.height,c=t.level,l=void 0===c?0:c,h=t.internalFormat,f=void 0===h?6408:h,d=t.border,p=void 0===d?0:d;n&&n.bind(),this.bind(0),this.gl.copyTexImage2D(this.target,l,f,i,a,s,u,p),this.unbind(),n&&n.unbind()}},{key:"getActiveUnit",value:function(){return this.gl.getParameter(34016)-33984}},{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;if(void 0===t)throw new Error("Texture.bind: must specify texture unit");return this.textureUnit=t,this.gl.activeTexture(33984+t),this.gl.bindTexture(this.target,this.handle),t}},{key:"unbind",value:function(){if(void 0===this.textureUnit)throw new Error("Texture.unbind: texture unit not specified");return this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,null),this.textureUnit}},{key:"_getDataType",value:function(t){var e=t.data,n=t.compressed;return void 0!==n&&n?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof h.a?{data:e.handle,dataType:"buffer"}:e instanceof d.b?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}},{key:"setImage3D",value:function(t){var e=t.level,n=void 0===e?0:e,r=t.internalformat,i=void 0===r?6408:r,o=t.width,a=t.height,s=t.depth,u=void 0===s?1:s,c=t.border,l=void 0===c?0:c,f=t.format,d=t.type,p=void 0===d?5121:d,v=t.offset,g=void 0===v?0:v,y=t.pixels;return ArrayBuffer.isView(y)?(this.gl.texImage3D(this.target,n,i,o,a,u,l,f,p,y),this):(y instanceof h.a&&(this.gl.bindBuffer(35052,y.handle),this.gl.texImage3D(this.target,n,i,o,a,u,l,f,p,g)),this)}},{key:"_deduceParameters",value:function(t){var e=t.format,n=t.data,r=t.width,i=t.height,o=t.dataFormat,a=t.type,s=t.compressed,u=y[e];o=o||u&&u.dataFormat,a=a||u&&u.types[0],s=s||u&&u.compressed;var c=this._deduceImageSize(n,r,i);return{dataFormat:o,type:a,compressed:s,width:r=c.width,height:i=c.height,format:e,data:n}}},{key:"_deduceImageSize",value:function(t,e,n){var r;return r="undefined"!=typeof ImageData&&t instanceof ImageData?{width:t.width,height:t.height}:"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement?{width:t.width,height:t.height}:"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:n}:{width:e>=0?e:1,height:n>=0?n:1},Object(v.a)(r,"Could not deduced texture size"),Object(v.a)(void 0===e||r.width===e,"Deduced texture width does not match supplied width"),Object(v.a)(void 0===n||r.height===n,"Deduced texture height does not match supplied height"),r}},{key:"_createHandle",value:function(){return this.gl.createTexture()}},{key:"_deleteHandle",value:function(){this.gl.deleteTexture(this.handle)}},{key:"_getParameter",value:function(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);var e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}},{key:"_setParameter",value:function(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:Object(v.a)(!1);break;default:this.gl.texParameteri(this.target,t,e)}return this.gl.bindTexture(this.target,null),this}},{key:"_isNPOT",value:function(){return!(Object(d.n)(this.gl)||Object(p.f)(this.width)&&Object(p.f)(this.height))}},{key:"_updateForNPOT",value:function(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}},{key:"_getNPOTParam",value:function(t,e){if(this._isNPOT())switch(t){case 10241:-1===g.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071)}return e}}]),e}(l.a)},"6eGt":function(t,e){t.exports=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],h=e[10],f=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+h*r,t[7]=u*i+f*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=h*i-s*r,t[11]=f*i-u*r,t}},"7B0+":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=(r=n("q1tI"))&&"object"==typeof r&&"default"in r?r.default:r,o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},s=function(t){function e(){return o(this,e),a(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.render=function(){return i.Children.only(this.props.children)},e}(i.Component);e.AppContainer=s,e.hot=function(){return function(t){return t}},e.areComponentsEqual=function(t,e){return t===e},e.setConfig=function(){},e.cold=function(t){return t},e.configureComponent=function(){}},"7GCR":function(t,e,n){"use strict";(function(t,r){n.d(e,"e",function(){return ta}),n.d(e,"a",function(){return ee}),n.d(e,"c",function(){return Jn}),n.d(e,"d",function(){return go}),n.d(e,"b",function(){return Lo});
/*!
 * maptalks v0.42.2
 * LICENSE : BSD-3-Clause
 * (c) 2016-2018 maptalks.org
 */
var i=["MultiPoint","MultiLineString","MultiPolygon","GeometryCollection"],o=["FeatureCollection","Feature","Point","LineString","Polygon"].concat(i),a=["markerFile","polygonPatternFile","linePatternFile","markerFillPatternFile","markerLinePatternFile"],s=[["markerWidth","markerHeight"],[],[null,"lineWidth"],[],[null,"markerLineWidth"]],u={lineWidth:1,lineOpacity:1,lineDx:1,lineDy:1,polygonOpacity:1,markerWidth:1,markerHeight:1,markerDx:1,markerDy:1,markerOpacity:1,markerFillOpacity:1,markerLineWidth:1,markerLineOpacity:1,textSize:1,textOpacity:1,textHaloRadius:1,textWrapWidth:1,textLineSpacing:1,textDx:1,textDy:1},c=["lineColor","polygonFill","markerFill","markerLineColor","textFill"];function l(){return Date.now()}function h(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function f(t){return null==t}function d(t){return"number"==typeof t&&!isNaN(t)}function p(t){return(0|t)===t}function v(t){return"object"==typeof t&&!!t}function g(t){return!f(t)&&("string"==typeof t||null!==t.constructor&&t.constructor===String)}function y(t){return!f(t)&&("function"==typeof t||null!==t.constructor&&t.constructor===Function)}var m=Object.prototype.hasOwnProperty;function _(t,e){return m.call(t,e)}var b=Math.PI/180;function w(t){return t*b}function x(t){return t/b}var E,O,P="[object process]"===Object.prototype.toString.call(void 0!==t?t:0)&&!t.versions.electron&&!t.versions.nw&&!t.versions["node-webkit"];function S(t){return t.length>4&&".svg"===t.slice(-4)?1:"data:image/svg+xml"===t.slice(0,"data:image/svg+xml".length)?2:0}function T(t,e){P&&T.node?T.node(t,e):t.src=e[0]}!function(){if(P)return E=function(t){return setTimeout(t,16)},void(O=clearTimeout);var t,e,n=1e3/30;function r(t){return setTimeout(t,n)}function i(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}"undefined"!=typeof window?(t=window.requestAnimationFrame||i("RequestAnimationFrame")||r,e=window.cancelAnimationFrame||i("CancelAnimationFrame")||i("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)}):(t=r,e=clearTimeout),E=function(e){return t(e)},O=function(t){t&&e(t)}}();var C=0;function A(){return C++}function M(t){return t&&g(t)?JSON.parse(t):t}function k(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n)for(var r=0,i=n.length;r<i;r++)t.push(n[r])}return t.length}function j(t,e){var n=e.indexOf(t);n>-1&&e.splice(n,1)}function R(t,e,n){if(!Array.isArray(t))return n?e.call(n,t):e(t);for(var r,i,o=[],a=0,s=t.length;a<s;a++)f(r=t[a])?o.push(null):Array.isArray(r)?o.push(R(r,e,n)):(i=n?e.call(n,r):e(r),o.push(i));return o}function L(t,e){return void 0===t?e:t}function I(t){return Math.sign?Math.sign(t):0===(t=+t)||isNaN(t)?Number(t):t>0?1:-1}function D(t){if(Math.log2)return Math.log2(t);var e=Math.log(t)*Math.LOG2E,n=Math.round(e);return Math.abs(n-e)<1e-14?n:e}function F(t,e,n){return t*(1-n)+e*n}function N(t,e,n){if(t===n||t===e)return t;var r=n-e;return((t-e)%r+r)%r+e}function B(t,e,n){return Math.min(n,Math.max(e,t))}function U(t){return Array.isArray(t)&&t.length>0}function z(t){if(!t)return!1;var e=t.slice(0,6);return"http:/"===e||"https:"===e||"file:/"===e}var G=/^url\((['"])(.+)\1\)$/i,V=/^url\(([^'"].*[^'"])\)$/i;function W(t){if(!g(t))return 0;var e=t.slice(0,6);return"http:/"===e||"https:"===e?3:V.test(t)?1:G.test(t)?2:0}function Z(t){var e=W(t);return 3===e?t:1===e?V.exec(t)[1]:2===e?G.exec(t)[2]:t}var H="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function X(t){if("undefined"!=typeof window&&window.btoa)return window.btoa(t);for(var e,n,r=String(t),i="",o=0,a=H;r.charAt(0|o)||(a="=",o%1);i+=a.charAt(63&e>>8-o%1*8)){if((n=r.charCodeAt(o+=.75))>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");e=e<<8|n}return i}function Y(t,e){for(var n=atob(t),r=new ArrayBuffer(n.length),i=new Uint8Array(r),o=0;o<n.length;o++)i[o]=255&n.charCodeAt(o);return new Blob([r],{type:e})}function J(t,e,n,r){var i=n-t,o=r-e;return Math.atan2(o,i)}var q="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";function Q(t,e){if(!t&&!e)return!0;if(!t||!e)return!1;for(var n in t)if("center"===n){if(!e[n]||!K(t[n][0],e[n][0])||!K(t[n][1],e[n][1]))return!1}else if(t[n]!==e[n])return!1;return!0}function K(t,e,n){return null==n&&(n=1e-6),t>=e-n&&t<=e+n}function $(t,e,n,r){t||(t=100),e||(e=4);var i=this;return e*=2,this._flashTimeout&&clearTimeout(this._flashTimeout),this._flashTimeout=setTimeout(function o(){if(0===e)return i.show(),void(n&&(r?n.call(r):n()));e%2==0?i.hide():i.show(),e--,i._flashTimeout=setTimeout(o,t)},t),this}var tt=["Unknown","Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon","GeometryCollection"];function et(t){return new Function("f","var p = (f && f.properties || {}); return "+nt(t))}function nt(t){if(!t)return"true";var e=t[0];return t.length<=1?"any"===e?"false":"true":"("+("=="===e?it(t[1],t[2],"===",!1):"!="===e?it(t[1],t[2],"!==",!1):"<"===e||">"===e||"<="===e||">="===e?it(t[1],t[2],e,!0):"any"===e?ot(t.slice(1),"||"):"all"===e?ot(t.slice(1),"&&"):"none"===e?ut(ot(t.slice(1),"||")):"in"===e?at(t[1],t.slice(2)):"!in"===e?ut(at(t[1],t.slice(2))):"has"===e?st(t[1]):"!has"===e?ut(st(t[1])):"true")+")"}function rt(t){return"$"===t[0]?"f."+t.substring(1):"p["+JSON.stringify(t)+"]"}function it(t,e,n,r){var i=rt(t),o="$type"===t?tt.indexOf(e):JSON.stringify(e);return(r?"typeof "+i+"=== typeof "+o+"&&":"")+i+n+o}function ot(t,e){return t.map(nt).join(e)}function at(t,e){"$type"===t&&(e=e.map(function(t){return tt.indexOf(t)}));var n=JSON.stringify(e.sort(ct)),r=rt(t);return e.length<=200?n+".indexOf("+r+") !== -1":"function(v, a, i, j) {\n        while (i <= j) { var m = (i + j) >> 1;\n            if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;\n        }\n    return false; }("+r+", "+n+",0,"+(e.length-1)+")"}function st(t){return"$id"===t?'"id" in f':JSON.stringify(t)+" in p"}function ut(t){return"!("+t+")"}function ct(t,e){return t<e?-1:t>e?1:0}function lt(t){var e=t._toJSON(),n=e.feature;return n.type=tt.indexOf(n.geometry.type),n.subType=e.subType,n}function ht(t){if(!Array.isArray(t))return ht([t]);for(var e=[],n=0;n<t.length;n++){var r=void 0;r=!0===t[n].filter?function(){return!0}:et(t[n].filter),e.push(ft({},t[n],{filter:r}))}return e}function ft(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function dt(t,e){var n;if(_t(t)){var r,i=t.stops&&"object"==typeof t.stops[0][0],o=i||void 0!==t.property,a=i||!o,s=t.type||e||"exponential";if("exponential"===s)r=gt;else if("interval"===s)r=vt;else if("categorical"===s)r=pt;else{if("identity"!==s)throw new Error('Unknown function type "'+s+'"');r=yt}if(i){for(var u={},c=[],l=0;l<t.stops.length;l++){var h=t.stops[l];void 0===u[h[0].zoom]&&(u[h[0].zoom]={zoom:h[0].zoom,type:t.type,property:t.property,stops:[]}),u[h[0].zoom].stops.push([h[0].value,h[1]])}for(var f in u)c.push([u[f].zoom,dt(u[f])]);(n=function(e,n){return gt({stops:c,base:t.base},e)(e,n)}).isFeatureConstant=!1,n.isZoomConstant=!1}else a?((n=function(e){return r(t,e)}).isFeatureConstant=!0,n.isZoomConstant=!1):((n=function(e,n){return r(t,n[t.property])}).isFeatureConstant=!1,n.isZoomConstant=!0)}else(n=function(){return t}).isFeatureConstant=!0,n.isZoomConstant=!0;return n}function pt(t,e){for(var n=0;n<t.stops.length;n++)if(e===t.stops[n][0])return t.stops[n][1];return t.stops[0][1]}function vt(t,e){for(var n=0;n<t.stops.length&&!(e<t.stops[n][0]);n++);return t.stops[Math.max(n-1,0)][1]}function gt(t,e){for(var n=void 0!==t.base?t.base:1,r=0;!(r>=t.stops.length||e<=t.stops[r][0]);)r++;return 0===r?t.stops[r][1]:r===t.stops.length?t.stops[r-1][1]:function t(e,n,r,i,o,a){return"function"==typeof o?function(){var s=o.apply(void 0,arguments),u=a.apply(void 0,arguments);return t(e,n,r,i,s,u)}:o.length?function(t,e,n,r,i,o){for(var a=[],s=0;s<i.length;s++)a[s]=mt(t,e,n,r,i[s],o[s]);return a}(e,n,r,i,o,a):mt(e,n,r,i,o,a)}(e,n,t.stops[r-1][0],t.stops[r][0],t.stops[r-1][1],t.stops[r][1])}function yt(t,e){return e}function mt(t,e,n,r,i,o){var a,s=r-n,u=t-n;return i*(1-(a=1===e?u/s:(Math.pow(e,u)-1)/(Math.pow(e,s)-1)))+o*a}function _t(t){return t&&"object"==typeof t&&(t.stops||t.property&&"identity"===t.type)}function bt(t){for(var e in t)if(_t(t[e]))return!0;return!1}function wt(t){return dt(t,"exponential")}function xt(t,e){if(!t)return null;var n=!1;if(Array.isArray(t)){for(var r,i=[],o=0;o<t.length;o++)(r=xt(t[o],e))?(i.push(r),n=!0):i.push(t[o]);return n?i:t}var a,s={__fn_types_loaded:!0},u=[];for(a in t)t.hasOwnProperty(a)&&u.push(a);for(var c=0,l=u.length;c<l;c++)_t(t[a=u[c]])?(n=!0,s["_"+a]=t[a],function(t){Object.defineProperty(s,t,{get:function(){return this["__fn_"+t]||(this["__fn_"+t]=wt(this["_"+t])),this["__fn_"+t].apply(this,e())},set:function(e){this["_"+t]=e},configurable:!0,enumerable:!0})}(a)):s[a]=t[a];return n?s:t}function Et(t){if(!t||!t.stops)return[];for(var e=[],n=0,r=t.stops.length;n<r;n++)e.push(t.stops[n][1]);return e}function Ot(t){var e={stroke:{stroke:t.markerLineColor,"stroke-width":t.markerLineWidth,"stroke-opacity":t.markerLineOpacity,"stroke-dasharray":null,"stroke-linecap":"butt","stroke-linejoin":"round"},fill:{fill:t.markerFill,"fill-opacity":t.markerFillOpacity}};return 0===e.stroke["stroke-width"]&&(e.stroke["stroke-opacity"]=0),e}function Pt(t,e,n){if(!t.markerPath)return null;var r=1,i=Ot(t);d(t.markerOpacity)&&(r=t.markerOpacity),d(t.opacity)&&(r*=t.opacity);var o={};if(i){for(var a in i.stroke)i.stroke.hasOwnProperty(a)&&(f(i.stroke[a])||(o[a]=i.stroke[a]));for(var s in i.fill)i.fill.hasOwnProperty(s)&&(f(i.fill[s])||(o[s]=i.fill[s]))}for(var u,c=Array.isArray(t.markerPath)?t.markerPath:[t.markerPath],l=[],p=0;p<c.length;p++)(u=h({},u=g(c[p])?{path:c[p]}:c[p],o)).d=u.path,delete u.path,l.push(u);var v=['<svg version="1.1"','xmlns="http://www.w3.org/2000/svg"'];r<1&&v.push('opacity="'+r+'"'),t.markerPathWidth&&t.markerPathHeight&&v.push('viewBox="0 0 '+t.markerPathWidth+" "+t.markerPathHeight+'"'),v.push('preserveAspectRatio="none"'),e&&v.push('width="'+e+'"'),n&&v.push('height="'+n+'"'),v.push("><defs></defs>");for(var y=0;y<l.length;y++){var m="<path ";for(var _ in l[y])l[y].hasOwnProperty(_)&&(m+=" "+_+'="'+l[y][_]+'"');m+="></path>",v.push(m)}return v.push("</svg>"),"data:image/svg+xml;base64,"+X(v.join(" "))}function St(t,e){if(!t)return[];var n=t;Array.isArray(t)||(n=[t]);for(var r,i,o,u,c=[],l=a,h=n.length-1;h>=0;h--)if(t=n[h]){e&&(t=Tt(t));for(var f=0;f<l.length;f++)if(_t(r=t[l[f]])&&(r=Et(r)),r){Array.isArray(r)||(r=[r]);for(var d=0;d<r.length;d++)"url("===r[d].slice(0,4)&&(r[d]=Z(r[d])),i=s[f],c.push([r[d],t[i[0]],t[i[1]]])}if("path"===t.markerType&&t.markerPath)if(o=_t(t.markerWidth)?200:t.markerWidth,u=_t(t.markerHeight)?200:t.markerHeight,_t(t.markerPath)){r=Et(t.markerPath);for(var p=t.markerPath,v=0;v<r.length;v++)t.markerPath=r[v],c.push([Pt(t),o,u]);t.markerPath=p}else c.push([Pt(t),o,u])}return c}function Tt(t){if(!t)return null;var e=t;if(P)return e;for(var n,r=a,i=0,o=r.length;i<o;i++)(n=e[r[i]])&&(e[r[i]]=Ct(n));return e}function Ct(t){if(_t(t)){for(var e=t.stops,n=0;n<e.length;n++)e[n][1]=Ct(e[n][1]);return t}return"url("===t.slice(0,4)&&(t=Z(t)),!z(t)&&(t.length<="data:".length||"data:"!==t.substring(0,"data:".length))&&(t=function(t,e){var n=t.split("/"),r=e.split("/");if(0===e.slice(0,1))return n.slice(0,3).join("/")+e;n.pop();for(var i=0;i<r.length;i++)"."!==r[i]&&(".."===r[i]?n.pop():n.push(r[i]));return n.join("/")}(location.href,t)),t}function At(t){return t&&t.colorStops}function Mt(t){var e=[t.type];if(t.places&&e.push(t.places.join()),t.colorStops){for(var n=[],r=t.colorStops.length-1;r>=0;r--)n.push(t.colorStops[r].join());e.push(n.join(","))}return e.join("_")}function kt(t,e){function n(t,e){f(t.opacity)?t.opacity=e:t.opacity*=e}var r;if(Array.isArray(t)){r=[];for(var i=0;i<t.length;i++){var o=h({},t[i]);n(o,e),r.push(o)}}else n(r=h({},t),e);return r}function jt(t){var e=Array.prototype.slice.call(arguments,1);if(e&&e.length||(e=[{}]),Array.isArray(t)){for(var n,r,i=[],o=0,a=t.length;o<a;o++){n=t[o],r={};for(var s=0,u=e.length;s<u;s++)Array.isArray(e[s])?f(e[s][o])?h(r,n||{}):h(r,n,e[s][o]):h(r,n,e[s]?e[s]:{});i.push(r)}return i}var c=[{},t];return c.push.apply(c,e),h.apply(this,c)}var Rt={};if(!P){var Lt=navigator.userAgent.toLowerCase(),It=document.documentElement,Dt="ActiveXObject"in window,Ft=-1!==Lt.indexOf("webkit"),Nt=-1!==Lt.indexOf("phantom"),Bt=-1!==Lt.search("android [23]"),Ut=-1!==Lt.indexOf("chrome"),zt=-1!==Lt.indexOf("gecko")&&!Ft&&!window.opera&&!Dt,Gt="undefined"!=typeof orientation||-1!==Lt.indexOf("mobile"),Vt=!window.PointerEvent&&window.MSPointerEvent,Wt=window.PointerEvent&&navigator.pointerEnabled||Vt,Zt=Dt&&"transition"in It.style,Ht="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Bt,Xt="MozPerspective"in It.style,Yt="OTransition"in It.style,Jt=(Zt||Ht||Xt)&&!Yt&&!Nt,qt=0;Ut&&(qt=Lt.match(/chrome\/([\d.]+)/)[1]);var Qt,Kt=!Nt&&(Wt||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch);try{var $t=document.createElement("canvas"),te=$t.getContext("webgl")||$t.getContext("experimental-webgl");Qt=te&&te instanceof WebGLRenderingContext}catch(t){Qt=!1}Rt={ie:Dt,ielt9:Dt&&!document.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in document),webkit:Ft,gecko:zt,android:-1!==Lt.indexOf("android"),android23:Bt,chrome:Ut,chromeVersion:qt,safari:!Ut&&-1!==Lt.indexOf("safari"),phantomjs:Nt,ie3d:Zt,webkit3d:Ht,gecko3d:Xt,opera12:Yt,any3d:Jt,mobile:Gt,mobileWebkit:Gt&&Ft,mobileWebkit3d:Gt&&Ht,mobileOpera:Gt&&window.opera,mobileGecko:Gt&&zt,touch:!!Kt,msPointer:!!Vt,pointer:!!Wt,retina:(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,language:navigator.browserLanguage?navigator.browserLanguage:navigator.language,ie9:Dt&&9===document.documentMode,ie10:Dt&&10===document.documentMode,webgl:Qt}}var ee=Rt;function ne(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function re(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var ie=function(){function t(t,e){if(f(t)||f(e)?f(t.x)||f(t.y)?Array.isArray(t)&&(this.x=+t[0],this.y=+t[1]):(this.x=+t.x,this.y=+t.y):(this.x=+t,this.y=+e),this._isNaN())throw new Error("Position is NaN")}var e=t.prototype;return e.abs=function(){return new this.constructor(Math.abs(this.x),Math.abs(this.y))},e._abs=function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this},e._round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},e.round=function(){return new this.constructor(Math.round(this.x),Math.round(this.y))},e._ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},e.ceil=function(){return new this.constructor(Math.ceil(this.x),Math.ceil(this.y))},e._floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},e.floor=function(){return new this.constructor(Math.floor(this.x),Math.floor(this.y))},e.copy=function(){return new this.constructor(this.x,this.y)},e._add=function(t,e){return f(t.x)?f(t[0])?(this.x+=t,this.y+=e):(this.x+=t[0],this.y+=t[1]):(this.x+=t.x,this.y+=t.y),this},e.add=function(t,e){var n,r;return f(t.x)?f(t[0])?(n=this.x+t,r=this.y+e):(n=this.x+t[0],r=this.y+t[1]):(n=this.x+t.x,r=this.y+t.y),new this.constructor(n,r)},e._sub=function(t,e){return f(t.x)?f(t[0])?(this.x-=t,this.y-=e):(this.x-=t[0],this.y-=t[1]):(this.x-=t.x,this.y-=t.y),this},e._substract=function(){return this._sub.apply(this,arguments)},e.sub=function(t,e){var n,r;return f(t.x)?f(t[0])?(n=this.x-t,r=this.y-e):(n=this.x-t[0],r=this.y-t[1]):(n=this.x-t.x,r=this.y-t.y),new this.constructor(n,r)},e.substract=function(){return this.sub.apply(this,arguments)},e.multi=function(t){return new this.constructor(this.x*t,this.y*t)},e._multi=function(t){return this.x*=t,this.y*=t,this},e.div=function(t){return this.multi(1/t)},e._div=function(t){return this._multi(1/t)},e.equals=function(t){return t instanceof this.constructor&&(this.x===t.x&&this.y===t.y)},e._isNaN=function(){return isNaN(this.x)||isNaN(this.y)},e.isZero=function(){return 0===this.x&&0===this.y},e.toArray=function(){return[this.x,this.y]},e.toFixed=function(t){return new this.constructor(this.x.toFixed(t),this.y.toFixed(t))},e.toJSON=function(){return{x:this.x,y:this.y}},t}(),oe=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.closeTo=function(t,e){return e||(e=0),this.x>=t.x-e&&this.x<=t.x+e&&this.y>=t.y-e&&this.y<=t.y+e},n.distanceTo=function(t){var e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},n.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},n.unit=function(){return this.copy()._unit()},n._unit=function(){return this._div(this.mag()),this},n.perp=function(){return this.copy()._perp()},n._perp=function(){var t=this.y;return this.y=this.x,this.x=-t,this},n.angleWith=function(t){return this.angleWithSep(t.x,t.y)},n.angleWithSep=function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},n._rotate=function(t){var e=Math.cos(t),n=Math.sin(t),r=e*this.x-n*this.y,i=n*this.x+e*this.y;return this.x=r,this.y=i,this},n.rotate=function(t){return this.copy()._rotate(t)},e}(ie),ae=function(){function t(t,e){d(t)&&d(e)?(this.width=t,this.height=e):d(t.width)?(this.width=t.width,this.height=t.height):Array.isArray(t)&&(this.width=t[0],this.height=t[1])}var e=t.prototype;return e.copy=function(){return new t(this.width,this.height)},e.add=function(e,n){var r,i;return e instanceof t?(r=this.width+e.width,i=this.height+e.height):(r=this.width+e,i=this.height+n),new t(r,i)},e.equals=function(t){return this.width===t.width&&this.height===t.height},e.multi=function(e){return new t(this.width*e,this.height*e)},e._multi=function(t){return this.width*=t,this.height*=t,this},e._round=function(){return this.width=Math.round(this.width),this.height=Math.round(this.height),this},e.toPoint=function(){return new oe(this.width,this.height)},e.toArray=function(){return[this.width,this.height]},e.toJSON=function(){return{width:this.width,height:this.height}},t}();function se(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}var ue=/[\b\t\r\v\f]/gim;function ce(t){return g(t)?t.replace(ue,""):t}function le(t){return se(t).split(/\s+/)}var he="undefined"!=typeof document?document.createElement("canvas").getContext("2d"):null;function fe(t,e){return fe.node?fe.node(t,e):(he.font=e,he.measureText(t).width)}var de={};function pe(t,e){if(pe.node)return pe.node(t,e);var n=fe(t,e);return e||(e="_default_"),de[e]||(de[e]=ve(e)),new ae(n,de[e])}function ve(t){var e=Xe();"_default_"!==t&&(e.style.font=t),e.innerHTML="";var n=e.clientHeight;return Ae(e),n}function ge(t,e,n,r){if(!t||0===t.length)return[{text:"",width:0}];var i=f(r)?fe(t,e):r,o=i/t.length,a=Math.floor(n/o/2);if(o>=n||a<=0)return[{text:"",width:n}];if(i<=n)return[{text:t,width:i}];for(var s=[],u=t.substring(0,a),c=o*a,l=a,h=t.length;l<h;l++){var d=t[l],p=fe(u+d);p>=n?(s.push({text:u,width:c}),u=t.substring(l,a+l),l+=a-1,c=o*a):(u+=d,c=p),l>=h-1&&(c=fe(u),s.push({text:u,width:c}))}return s}var ye=/\{([\w_]+)\}/g;function me(t,e){return g(t)?t.replace(ye,function(t,n){if(!e)return"";var r=e[n];return f(r)?"":Array.isArray(r)?r.join():r}):t}function _e(t,e,n){var r=t.width,i=t.height;return new oe("left"===e?-r:"right"===e?0:-r/2,"top"===n?-i:"bottom"===n?0:-i/2)}var be="monospace";function we(t){return t.textFont?t.textFont:(t.textStyle&&"normal"!==t.textStyle?t.textStyle+" ":"")+(t.textWeight&&"normal"!==t.textWeight?t.textWeight+" ":"")+t.textSize+"px "+(t.textFaceName?'"'===t.textFaceName[0]?t.textFaceName:'"'+t.textFaceName+'"':be)}function xe(t,e){var n=we(e),r=e.textLineSpacing||0,i=pe(t,n),o=i.width,a=i.height,s=e.textWrapCharacter,u=[],c=e.textWrapWidth;(!c||c>o)&&(c=o),g(t)||(t+="");var l=0;if(s&&t.indexOf(s)>=0)for(var h=t.split(s),f=0,d=h.length;f<d;f++){var p=h[f],v=fe(p,n);if(v>c)for(var y=ge(p,n,c,v),m=0,_=y.length;m<_;m++){var b=y[m].width;b>l&&(l=b),u.push({text:y[m].text,size:new ae(b,a)})}else v>l&&(l=v),u.push({text:p,size:new ae(v,a)})}else if(o>c)for(var w=ge(t,n,c,o),x=0;x<w.length;x++){var E=w[x].width;E>l&&(l=E),u.push({text:w[x].text,size:new ae(E,a)})}else o>l&&(l=o),u.push({text:t,size:i});var O=u.length;return{total:O,size:new ae(l,a*O+r*(O-1)),rows:u,rawSize:i}}var Ee=P?function(t){return t[0]}:function(t){for(var e=document.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1},Oe=Ee(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),Pe=Ee(["transformOrigin","WebkitTransformOrigin","OTransformOrigin","MozTransformOrigin","msTransformOrigin"]),Se=Ee(["transition","WebkitTransition","OTransition","MozTransition","msTransition"]);Ee(["filter","WebkitFilter","OFilter","MozFilter","msFilter"]);function Te(t,e){var n=document.createElement(t);return e&&Ge(n,e),n}function Ce(t,e,n){var r=Te(t);return e&&Be(r,e),n&&n.appendChild(r),r}function Ae(t){if(!t)return this;if(ee.ielt9||ee.ie9){var e=Te("div");e.appendChild(t),e.innerHTML="",e=null}else t.parentNode&&t.parentNode.removeChild(t);return this}function Me(t,e,n,r){if(!(t&&t.addEventListener&&e&&n))return this;for(var i=function(e){e||(e=window.event),n.call(r||t,e)},o=e.split(" "),a=o.length-1;a>=0;a--){var s=o[a];if(s)t["Z__"+s]||(t["Z__"+s]=[]),je(t,s,n)>=0&&ke(t,s,n),t["Z__"+s].push({callback:i,src:n}),"mousewheel"===s&&ee.gecko&&(s="DOMMouseScroll"),t.addEventListener(s,i,!1)}return this}function ke(t,e,n){function r(e,n){"mousewheel"===e&&ee.gecko&&(e="DOMMouseScroll"),t.removeEventListener(e,n,!1)}if(!t||!t.removeEventListener||!e)return this;for(var i=e.split(" "),o=i.length-1;o>=0;o--){var a=i[o];if(a){if(!n&&t["Z__"+a]){for(var s=t["Z__"+a],u=0,c=s.length;u<c;u++)r(s[u].callback);return delete t["Z__"+a],this}var l=je(t,a,n);if(l<0)return this;r(a,t["Z__"+a][l].callback),t["Z__"+a].splice(l,1)}}return this}function je(t,e,n){if(!t||!t["Z__"+e]||!n)return-1;for(var r=t["Z__"+e],i=0,o=r.length;i<o;i++)if(r[i].src===n)return i;return-1}function Re(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Le(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,this}function Ie(t){return t.onselectstart=function(){return!1},t.ondragstart=function(){return!1},t.setAttribute("unselectable","on"),this}function De(t,e){return t?(ee.any3d?We(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px"),e):null}function Fe(t){var e=window.getComputedStyle(t),n=[parseInt(e["padding-left"]),parseInt(e["padding-top"])],r=t.getBoundingClientRect(),i=t.offsetWidth,o=t.offsetHeight,a=i?r.width/i:1,s=o?r.height/o:1;return t.__position=[r.left+n[0],r.top+n[1],a,s],t.__position}function Ne(t,e){t||(t=window.event);var n=e.__position;return n||(n=Fe(e)),new oe((t.clientX-n[0]-e.clientLeft)/n[2],(t.clientY-n[1]-e.clientTop)/n[3])}function Be(t,e){var n,r,i,o=t.style.cssText;return r=";",(i=(n=o).length-r.length)>=0&&n.indexOf(r,i)===i||(o+=";"),t.style.cssText=o+e,this}function Ue(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=Ve(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)}function ze(t,e){if(void 0===t.classList||Ue(t,e)){var n=Ve(t);Ge(t,(n?n+" ":"")+e)}else for(var r=le(e),i=0,o=r.length;i<o;i++)t.classList.add(r[i]);return this}function Ge(t,e){return f(t.className.baseVal)?t.className=e:t.className.baseVal=e,this}function Ve(t){return f(t.className.baseVal)?t.className:t.className.baseVal}function We(t,e){var n=e||new oe(0,0);return t.style[Oe]=ee.any3d?"translate3d("+n.x+"px,"+n.y+"px,0px)":"translate("+n.x+"px,"+n.y+"px)",this}function Ze(t){return/<[a-z\][\s\S]*>/i.test(t)}function He(t,e){var n=Xe(t);g(e)?n.innerHTML=e:n.appendChild(e);var r=new ae(n.clientWidth,n.clientHeight);return Ae(n),r}function Xe(t){var e=document.createElement(t);return e.style.cssText="position:absolute;left:-10000px;top:-10000px;",document.body.appendChild(e),e}var Ye=Me,Je=ke,qe={jsonp:function(t,e){var n="_maptalks_jsonp_"+A();t.match(/\?/)?t+="&callback="+n:t+="?callback="+n;var r=document.createElement("script");return r.type="text/javascript",r.src=t,window[n]=function(t){e(null,t),document.getElementsByTagName("head")[0].removeChild(r),r=null,delete window[n]},document.getElementsByTagName("head")[0].appendChild(r),this},get:function(t,e,n){if(y(e)){var r=n;n=e,e=r}if(P&&qe.get.node)return qe.get.node(t,n,e);var i=qe._getClient(n);if(i.open("GET",t,!0),e){for(var o in e.headers)i.setRequestHeader(o,e.headers[o]);i.withCredentials="include"===e.credentials,e.responseType&&(i.responseType=e.responseType)}return i.send(null),i},post:function(t,e,n){var r;if(g(t)){if(y(e)){var i=n;n=e,e=i}r=(e=e||{}).postData}else{var o=n;r=e,t=(e=t).url,n=o}if(P&&qe.post.node)return e.url=t,qe.post.node(e,r,n);var a=qe._getClient(n);if(a.open("POST",e.url,!0),e.headers||(e.headers={}),e.headers["Content-Type"]||(e.headers["Content-Type"]="application/x-www-form-urlencoded"),"setRequestHeader"in a)for(var s in e.headers)e.headers.hasOwnProperty(s)&&a.setRequestHeader(s,e.headers[s]);return g(r)||(r=JSON.stringify(r)),a.send(r),a},_wrapCallback:function(t,e){return function(){4===t.readyState&&(200===t.status?"arraybuffer"===t.responseType?0===t.response.byteLength?e(new Error("http status 200 returned without content.")):e(null,{data:t.response,cacheControl:t.getResponseHeader("Cache-Control"),expires:t.getResponseHeader("Expires"),contentType:t.getResponseHeader("Content-Type")}):e(null,t.responseText):e(new Error(t.statusText+","+t.status)))}},_getClient:function(t){var e;try{e=new XMLHttpRequest}catch(t){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}}return e.onreadystatechange=qe._wrapCallback(e,t),e},getArrayBuffer:function(t,e,n){if(y(e)){var r=n;n=e,e=r}return e||(e={}),e.responseType="arraybuffer",qe.get(t,e,n)},getImage:function(t,e,n){return qe.getArrayBuffer(e,n,function(e,n){if(e)t.onerror&&t.onerror(e);else if(n){var r=window.URL||window.webkitURL,i=t.onload;t.onload=function(){i&&i(),r.revokeObjectURL(t.src)};var o=new Blob([new Uint8Array(n.data)],{type:n.contentType});t.cacheControl=n.cacheControl,t.expires=n.expires,t.src=n.data.byteLength?r.createObjectURL(o):q}})},getJSON:function(t,e,n){if(y(e)){var r=n;n=e,e=r}var i=function(t,e){var r=e?M(e):null;n(t,r)};return e&&e.jsonp?qe.jsonp(t,i):qe.get(t,e,i)}},Qe=!1,Ke={setHitTesting:function(t){Qe=t},createCanvas:function(t,e,n){var r;return P?r=new n(t,e):((r=Te("canvas")).width=t,r.height=e),r},prepareCanvasFont:function(t,e){t.textBaseline="top",t.font=we(e);var n=e.textFill;n||(n="#000"),t.fillStyle=Ke.getRgba(n,e.textOpacity)},prepareCanvas:function(t,e,n,r){if(e){var i=e.lineWidth;f(i)||t.lineWidth===i||(t.lineWidth=i);var o=e.linePatternFile||e.lineColor||"#000";if(r)t.strokeStyle="#000";else if(en(o)&&n){var a;(e.linePatternDx||e.linePatternDy)&&(a=[e.linePatternDx,e.linePatternDy]),Ke._setStrokePattern(t,o,i,a,n),e.lineDasharray=[]}else At(o)?e.lineGradientExtent?t.strokeStyle=Ke._createGradient(t,o,e.lineGradientExtent):t.strokeStyle="#000":t.strokeStyle=o;e.lineJoin&&(t.lineJoin=e.lineJoin),e.lineCap&&(t.lineCap=e.lineCap),t.setLineDash&&U(e.lineDasharray)&&t.setLineDash(e.lineDasharray);var s=e.polygonPatternFile||e.polygonFill||"rgba(255,255,255,0)";if(r)t.fillStyle="#000";else if(en(s)&&n){var u=nn(s),c=n.getImage([u,null,null]);if(c||(c=n.getImage([u+"-texture",null,i])),S(u)&&c instanceof Image&&(ee.edge||ee.ie)){var l=c.width||20,h=c.height||20,d=Ke.createCanvas(l,h);Ke.image(d.getContext("2d"),c,0,0,l,h),c=d}c?(t.fillStyle=t.createPattern(c,"repeat"),(e.polygonPatternDx||e.polygonPatternDy)&&(t.fillStyle.polygonPatternOffset=[e.polygonPatternDx,e.polygonPatternDy])):"undefined"!=typeof console&&console.warn("img not found for",u)}else At(s)?e.polygonGradientExtent?t.fillStyle=Ke._createGradient(t,s,e.polygonGradientExtent):t.fillStyle="rgba(255,255,255,0)":t.fillStyle=s}},_createGradient:function(t,e,n){var r=null,i=e.places,o=n.getMin(),a=n.getMax(),s=n.getWidth(),u=n.getHeight();if(e.type&&"linear"!==e.type){if("radial"===e.type){if(i){if(6!==i.length)throw new Error("A radial gradient's places should have 6 numbers.");i=[o.x+i[0]*s,o.y+i[1]*u,s*i[2],o.x+i[3]*s,o.y+i[4]*u,s*i[5]]}else{var c=n.getCenter()._round();i=[c.x,c.y,Math.abs(c.x-o.x),c.x,c.y,0]}r=t.createRadialGradient.apply(t,i)}}else{if(i){if(4!==i.length)throw new Error("A linear gradient's places should have 4 numbers.");i=[o.x+i[0]*s,o.y+i[1]*u,o.x+i[2]*s,o.y+i[3]*u]}else i=[o.x,o.y,a.x,o.y];r=t.createLinearGradient.apply(t,i)}return e.colorStops.forEach(function(t){r.addColorStop.apply(r,t)}),r},_setStrokePattern:function(t,e,n,r,i){var o,a=nn(e);if(P)o=i.getImage([a,null,n]);else{var s=a+"-texture-"+n;if(!(o=i.getImage(s))){var u=i.getImage([a,null,null]);if(u){var c;c=u.width&&u.height?Math.round(u.width*n/u.height):n;var l=Ke.createCanvas(c,n,t.canvas.constructor);Ke.image(l.getContext("2d"),u,0,0,c,n),i.addResource([s,null,n],l),o=l}}}o?(t.strokeStyle=t.createPattern(o,"repeat"),t.strokeStyle.linePatternOffset=r):"undefined"!=typeof console&&console.warn("img not found for",a)},clearRect:function(t,e,n,r,i){t.canvas._drawn=!1,t.clearRect(e,n,r,i)},fillCanvas:function(t,e,n,r){if(Qe&&(e=1),t.canvas._drawn=!0,0!==e){var i,o=Ke._isPattern(t.fillStyle),a=t.fillStyle&&t.fillStyle.polygonPatternOffset,s=a?a[0]:0,u=a?a[1]:0;f(e)&&(e=1),e<1&&(i=t.globalAlpha,t.globalAlpha*=e),o&&(n=n||0,r=r||0,t.translate(n+s,r+u)),t.fill(),o&&t.translate(-n-s,-r-u),e<1&&(t.globalAlpha=i)}},getRgba:function(t,e){return f(e)&&(e=1),"#"!==t[0]?t:(7===t.length?(n=parseInt(t.substring(1,3),16),r=parseInt(t.substring(3,5),16),i=parseInt(t.substring(5,7),16)):(n=17*parseInt(t.substring(1,2),16),r=17*parseInt(t.substring(2,3),16),i=17*parseInt(t.substring(3,4),16)),"rgba("+n+","+r+","+i+","+e+")");var n,r,i},image:function(t,e,n,r,i,o){t.canvas._drawn=!0;try{d(i)&&d(o)?t.drawImage(e,n,r,i,o):t.drawImage(e,n,r)}catch(t){console&&(console.warn("error when drawing image on canvas:",t),console.warn(e))}},text:function(t,e,n,r,i){Ke._textOnMultiRow(t,i.rows,r,n,i.size,i.rawSize)},_textOnMultiRow:function(t,e,n,r,i,o){for(var a,s,u=_e(i,n.textHorizontalAlignment,n.textVerticalAlignment),c=o.height+n.textLineSpacing,l=r.add(0,u.y),h=n.textMaxHeight,f=0,d=0,p=e.length;d<p&&(a=e[d].text,s=_e(e[d].size,n.textHorizontalAlignment,n.textVerticalAlignment),Ke._textOnLine(t,a,l.add(s.x,d*c),n.textHaloRadius,n.textHaloFill,n.textHaloOpacity),!(h>0&&(f+=c)+o.height>=h));d++);},_textOnLine:function(t,e,n,r,i,o){Qe&&(o=1);var a,s,u=0!==o&&0!==r;t.textBaseline="top";var c=t.shadowBlur,l=t.shadowOffsetX,h=t.shadowOffsetY;if(u){var f=t.globalAlpha;t.globalAlpha*=o,t.miterLimit=2,t.lineJoin="round",t.lineCap="round",t.lineWidth=2*r,t.strokeStyle=i,t.strokeText(e,Math.round(n.x),Math.round(n.y)),t.miterLimit=10,t.globalAlpha=f,a=t.globalCompositeOperation,t.globalCompositeOperation="destination-out",s=t.fillStyle,t.fillStyle="#000"}c&&u&&(t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0),Ke.fillText(t,e,n),a&&(t.globalCompositeOperation=a,Ke.fillText(t,e,n,s),c&&(t.shadowBlur=c,t.shadowOffsetX=l,t.shadowOffsetY=h))},fillText:function(t,e,n,r){t.canvas._drawn=!0,r&&(t.fillStyle=r),t.fillText(e,Math.round(n.x),Math.round(n.y))},_stroke:function(t,e,n,r){if(Qe&&(e=1),t.canvas._drawn=!0,0!==e){var i,o=t.strokeStyle&&t.strokeStyle.linePatternOffset,a=o?o[0]:0,s=o?o[1]:0,u=Ke._isPattern(t.strokeStyle)&&(!f(n)&&!f(r)||!f(a)&&!f(s));f(e)&&(e=1),e<1&&(i=t.globalAlpha,t.globalAlpha*=e),u&&(n=n||0,r=r||0,t.translate(n+a,r+s)),t.stroke(),u&&t.translate(-n-a,-r-s),e<1&&(t.globalAlpha=i)}},_path:function(t,e,n,r,i){if(U(e))for(var o,a,s,u,c,l,h=U(n),f=!0!==i&&Ke._isPattern(t.strokeStyle),d=0,p=e.length;d<p;d++)if(o=e[d],!h||t.setLineDash)t.lineTo(o.x,o.y),f&&d>0&&(a=e[d-1],c=o,l=void 0,l=J((u=a).x,u.y,c.x,c.y),t.save(),t.translate(u.x,u.y-t.lineWidth/2/Math.cos(l)),t.rotate(l),Ke._stroke(t,r),t.restore(),t.beginPath(),t.moveTo(o.x,o.y));else if(h){if(d===p-1)break;s=e[d+1],$e(t,o,s,n)}},path:function(t,e,n,r,i){U(e)&&(t.beginPath(),t.moveTo(e[0].x,e[0].y),Ke._path(t,e,i,n),Ke._stroke(t,n))},_multiClip:function(t,e){if(e&&0!==e.length)for(var n=0,r=(e=e[0]).length;n<r;n++){var i=e[n],o=i.x,a=i.y;0===n?t.moveTo(o,a):t.lineTo(o,a),n===r-1&&(o=e[0].x,a=e[0].y,t.lineTo(o,a))}},polygon:function(t,e,n,r,i,o){if(t.isMultiClip)Ke._multiClip(t,e);else if(U(e)){var a,s,u,c=Ke._isPattern(t.strokeStyle),l=U(i)&&!t.setLineDash||c&&!o;if(U(e[0])||(e=[e]),l){for(t.save(),s=0,u=e.length;s<u;s++)U(e[s])&&(Ke._ring(t,e[s],null,0,!0),a=r,s>0&&(t.globalCompositeOperation="destination-out",a=1),h(e,s,a),s>0?t.globalCompositeOperation="source-over":u>1&&(t.fillStyle="#fff"),Ke._stroke(t,0));t.restore()}for(s=0,u=e.length;s<u;s++)U(e[s])&&(o?(Ke.paintSmoothLine(t,e[s],n,o,!0),t.closePath()):Ke._ring(t,e[s],i,n),l||(a=r,s>0&&(t.globalCompositeOperation="destination-out",a=1),h(e,s,a),s>0?t.globalCompositeOperation="source-over":u>1&&(t.fillStyle="#fff")),Ke._stroke(t,n))}function h(e,n,r){Ke.fillCanvas(t,r,e[n][0].x,e[n][0].y)}},_ring:function(t,e,n,r,i){var o=Ke._isPattern(t.strokeStyle);i||!o||e[0].equals(e[e.length-1])||(e=e.concat([e[0]])),t.beginPath(),t.moveTo(e[0].x,e[0].y),Ke._path(t,e,n,r,i),o||t.closePath()},paintSmoothLine:function(t,e,n,r,i,o,a){if(e)if(e.length<=2||!r)Ke.path(t,e,n);else{var s,u=e.length,c=i?u:u-1;t.beginPath(),t.moveTo(e[0].x,e[0].y),void 0!==a&&(c-=Math.max(c-o-1,0));for(var l=0;l<c;l++){var h=e[l].x,f=e[l].y,d=void 0,p=void 0,v=void 0,g=void 0,y=void 0,m=void 0;l-1<0?i?(d=e[c-1].x,p=e[c-1].y):(d=e[l+1].x,p=e[l+1].y):(d=e[l-1].x,p=e[l-1].y),l+1<u?(v=e[l+1].x,g=e[l+1].y):(v=e[l+1-u].x,g=e[l+1-u].y),l+2<u?(y=e[l+2].x,m=e[l+2].y):i?(y=e[l+2-u].x,m=e[l+2-u].y):(y=e[l].x,m=e[l].y);var _=w(d,p,h,f,v,g,y,m,r,l===c-1?a:1);if(l===c-1&&a>=0&&a<1){t.bezierCurveTo(_[0],_[1],_[2],_[3],_[4],_[5]),e.splice(c-1,u-(c-1)-1);var b=new oe(_[4],_[5]);b.prevCtrlPoint=new oe(_[2],_[3]),e.push(b),u=e.length}else t.bezierCurveTo(_[0],_[1],_[2],_[3],v,g);e[l].nextCtrlPoint=_.slice(0,2),e[l].prevCtrlPoint=s?s.slice(2):null,s=_}!i&&e[1].prevCtrlPoint&&(e[0].nextCtrlPoint=e[1].prevCtrlPoint,delete e[0].prevCtrlPoint),e[u-1].prevCtrlPoint||(e[u-1].prevCtrlPoint=e[u-2].nextCtrlPoint),Ke._stroke(t,n)}function w(t,e,n,r,i,o,a,s,u,c){var l=(t+n)/2,h=(e+r)/2,f=(n+i)/2,d=(r+o)/2,p=(i+a)/2,v=(o+s)/2,g=Math.sqrt((n-t)*(n-t)+(r-e)*(r-e)),y=Math.sqrt((i-n)*(i-n)+(o-r)*(o-r)),m=g/(g+y),_=y/(y+Math.sqrt((a-i)*(a-i)+(s-o)*(s-o))),b=l+(f-l)*m,w=h+(d-h)*m,x=f+(p-f)*_,E=d+(v-d)*_,O=b+(f-b)*u+n-b,P=w+(d-w)*u+r-w,S=x+(f-x)*u+i-x,T=E+(d-E)*u+o-E,C=[O,P,S,T];return c<1?function(t,e,n,r,i,o,a,s,u,c){var l=1-t,h=1-e,f=n*h*h+2*i*e*h+a*e*e,d=i*h*h+2*a*e*h+u*e*e,p=r*h*h+2*o*e*h+s*e*e,v=o*h*h+2*s*e*h+c*e*e;return[(n*l*l+2*i*t*l+a*t*t)*h+(i*l*l+2*a*t*l+u*t*t)*e,(r*l*l+2*o*t*l+s*t*t)*h+(o*l*l+2*s*t*l+c*t*t)*e,f*l+d*t,p*l+v*t,f*h+d*e,p*h+v*e]}(0,c,n,r,O,P,S,T,i,o):C}},_arcBetween:function(t,e,n,r){var i=r,o=e.distanceTo(n),a=o/2/Math.sin(i/2),s=Math.asin((n.y-e.y)/o);e.x>n.x&&(s=Math.PI-s);var u=s-(90*Math.PI/180-i/2),c=Math.cos(u)*a,l=Math.sin(u)*a,h=e.x+c,f=e.y+l,d=Math.asin((n.y-f)/a);h>n.x&&(d=Math.PI-d);var p=d+i;return t.beginPath(),t.arc(h,f,a,d,p),[h,f]},_lineTo:function(t,e){t.lineTo(e.x,e.y)},bezierCurveAndFill:function(t,e,n,r){t.beginPath();var i=e[0];t.moveTo(i.x,i.y);var o=[t];o.push.apply(o,e.splice(1)),Ke._bezierCurveTo.apply(Ke,o),Ke.fillCanvas(t,r),Ke._stroke(t,n)},_bezierCurveTo:function(t,e,n,r){t.bezierCurveTo(e.x,e.y,n.x,n.y,r.x,r.y)},ellipse:function(t,e,n,r,i,o){var a,s,u,c,l,h,f;t.beginPath(),n===r?t.arc(e.x,e.y,n,0,2*Math.PI):t.ellipse?t.ellipse(e.x,e.y,n,r,0,0,Math.PI/180*360):(a=e.x,s=e.y,h=(u=n)*(l=.5522848),f=(c=r)*l,t.moveTo(a-u,s),t.bezierCurveTo(a-u,s-f,a-h,s-c,a,s-c),t.bezierCurveTo(a+h,s-c,a+u,s-f,a+u,s),t.bezierCurveTo(a+u,s+f,a+h,s+c,a,s+c),t.bezierCurveTo(a-h,s+c,a-u,s+f,a-u,s),t.closePath()),Ke.fillCanvas(t,o,e.x-n,e.y-r),Ke._stroke(t,i,e.x-n,e.y-r)},rectangle:function(t,e,n,r,i){t.beginPath(),t.rect(e.x,e.y,n.width,n.height),Ke.fillCanvas(t,i,e.x,e.y),Ke._stroke(t,r,e.x,e.y)},sector:function(t,e,n,r,i,o){var a=Math.PI/180,s=r[0],u=r[1];function c(t,e,n,r,s,u){var c=a*-u,l=a*-s;t.beginPath(),t.moveTo(e,n),t.arc(e,n,r,c,l),t.lineTo(e,n),Ke.fillCanvas(t,o,e-r,n-r),Ke._stroke(t,i,e-r,n-r)}c(t,e.x,e.y,n,s,u)},_isPattern:function(t){return!(g(t)||"addColorStop"in t)},drawCross:function(t,e,n,r){t.canvas._drawn=!0,t.strokeStyle=r,t.lineWidth=n,t.beginPath(),t.moveTo(e.x-5,e.y),t.lineTo(e.x+5,e.y),t.moveTo(e.x,e.y-5),t.lineTo(e.x,e.y+5),t.stroke()},copy:function(t,e){var n=e||Te("canvas");return n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(t,0,0),n}};function $e(t,e,n,r){var i=e.x,o=e.y,a=n.x,s=n.y,u=r,c=function(t,e){return t<=e},l=function(t,e){return t>=e},h=function(t,e){return Math.min(t,e)},f=function(t,e){return Math.max(t,e)},d={thereYet:l,cap:h},p={thereYet:l,cap:h};o-s>0&&(p.thereYet=c,p.cap=f),i-a>0&&(d.thereYet=c,d.cap=f),t.moveTo(i,o);for(var v,g,y=i,m=o,_=0,b=!0;!d.thereYet(y,a)||!p.thereYet(m,s);)v=Math.atan2(s-o,a-i),g=u[_],y=d.cap(a,y+Math.cos(v)*g),m=p.cap(s,m+Math.sin(v)*g),b?t.lineTo(y,m):t.moveTo(y,m),_=(_+1)%u.length,b=!b}var tn="data:image/";function en(t){return t.length>tn.length&&t.substring(0,tn.length)===tn||W(t)}function nn(t){return t.substring(0,tn.length)===tn?t:Z(t)}var rn=function(t){return function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.on=function(t,e,n){if(!t)return this;if(!g(t))return this._switch("on",t,e);if(!e)return this;this._eventMap||(this._eventMap={});var r,i,o=t.toLowerCase().split(" ");n||(n=this);for(var a=0,s=o.length;a<s;a++){r=o[a],(i=this._eventMap[r])||(i=[],this._eventMap[r]=i);var u=i.length;if(u>0)for(var c=0;c<u;c++)if(e===i[c].handler&&i[c].context===n)return this;i.push({handler:e,context:n})}return this},n.addEventListener=function(){return this.on.apply(this,arguments)},n.once=function(t,e,n){if(!g(t)){var r={};for(var i in t)t.hasOwnProperty(i)&&(r[i]=this._wrapOnceHandler(i,t[i],n));return this._switch("on",r)}for(var o=t.split(" "),a=0,s=o.length;a<s;a++)this.on(o[a],this._wrapOnceHandler(o[a],e,n));return this},n.off=function(t,e,n){if(!this._eventMap||!t)return this;if(!g(t))return this._switch("off",t,e);if(!e)return this;var r,i,o,a=t.split(" ");n||(n=this);for(var s=0,u=a.length;s<u;s++){if(o="Z__"+(r=a[s].toLowerCase()),!(i=this._eventMap[r]))return this;for(var c=i.length-1;c>=0;c--){var l=i[c];e!==l.handler&&e!==l.handler[o]||l.context!==n||(delete l.handler[o],i.splice(c,1))}}return this},n.removeEventListener=function(){return this.off.apply(this,arguments)},n.listens=function(t,e,n){if(!this._eventMap||!g(t))return 0;var r=this._eventMap[t.toLowerCase()];if(!r||!r.length)return 0;for(var i=0,o=0,a=r.length;o<a;o++)if(e){if(e===r[o].handler&&(f(n)||r[o].context===n))return 1}else i++;return i},n.copyEventListeners=function(t){var e,n=t._eventMap;if(!n)return this;for(var r in n)for(var i=0,o=(e=n[r]).length;i<o;i++)this.on(r,e[i].handler,e[i].context);return this},n.fire=function(){return this._eventParent?this._eventParent.fire.apply(this._eventParent,arguments):this._fire.apply(this,arguments)},n._wrapOnceHandler=function(t,e,n){var r=this,i="Z__"+t,o=!1,a=function s(){o||(delete a[i],o=!0,n?e.apply(n,arguments):e.apply(this,arguments),r.off(t,s,this))};return a[i]=e,a},n._switch=function(t,e,n){for(var r in e)e.hasOwnProperty(r)&&this[t](r,e[r],n);return this},n._clearListeners=function(t){this._eventMap&&g(t)&&(this._eventMap[t.toLowerCase()]&&(this._eventMap[t]=null))},n._clearAllListeners=function(){this._eventMap=null},n._setEventParent=function(t){return this._eventParent=t,this},n._fire=function(t,e){if(!this._eventMap)return this;var n=this._eventMap[t.toLowerCase()];if(!n)return this;e||(e={}),e.type=t,e.target=this;for(var r,i,o=n.slice(0),a=0,s=o.length;a<s;a++)o[a]&&(r=o[a].context,!0,i=h({},e),!1===(r?o[a].handler.call(r,i):o[a].handler(i))&&e.domEvent&&Le(e.domEvent));return this},e}(t)},on=rn(function(){function t(t){this.target=t}var e=t.prototype;return e.enable=function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},e.disable=function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},e.enabled=function(){return!!this._enabled},e.remove=function(){this.disable(),delete this.target,delete this.dom},t}()),an=function(){function t(t){if(!this||!this.setOptions)throw new Error('Class instance is being created without "new" operator.');this.setOptions(t),this.callInitHooks()}var e=t.prototype;return e.callInitHooks=function(){var t=Object.getPrototypeOf(this);return this._visitInitHooks(t),this},e.setOptions=function(t){if(this.hasOwnProperty("options")||(this.options=this.options?Object.create(this.options):{}),!t)return this;for(var e in t)this.options[e]=t[e];return this},e.config=function(t){if(!t){var e={};for(var n in this.options)this.options.hasOwnProperty(n)&&(e[n]=this.options[n]);return e}if(2===arguments.length){var r={};r[t]=arguments[1],t=r}for(var i in t)this.options[i]=t[i],this[i]&&this[i]instanceof on&&(t[i]?this[i].enable():this[i].disable());return this.onConfig(t),this},e.onConfig=function(){},e._visitInitHooks=function(t){if(!this._initHooksCalled){var e=Object.getPrototypeOf(t);e._visitInitHooks&&e._visitInitHooks.call(this,e),this._initHooksCalled=!0;var n=t._initHooks;if(n&&n!==e._initHooks)for(var r=0;r<n.length;r++)n[r].call(this)}},t.addInitHook=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i="function"==typeof t?t:function(){this[t].apply(this,n)},o=this.prototype,a=Object.getPrototypeOf(o);return o._initHooks&&o._initHooks!==a._initHooks||(o._initHooks=[]),o._initHooks.push(i),this},t.include=function(){for(var t=0;t<arguments.length;t++)h(this.prototype,t<0||arguments.length<=t?void 0:arguments[t]);return this},t.mergeOptions=function(t){var e=this.prototype,n=Object.getPrototypeOf(e);return e.options&&e.options!==n.options||(e.options=e.options?Object.create(e.options):{}),h(e.options,t),this},t}(),sn={},un=function(t){return function(t){function e(){return t.apply(this,arguments)||this}return ne(e,t),e.registerJSONType=function(t){return t?(sn[t]=this,this):this},e.getJSONClass=function(t){return t?sn[t]:null},e.prototype.getJSONType=function(){if(void 0===this._jsonType){var t=Object.getPrototypeOf(this).constructor;for(var e in sn)if(sn[e]===t){this._jsonType=e;break}}if(!this._jsonType)throw new Error("Found an unregistered geometry class!");return this._jsonType},e}(t)};function cn(t){return function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.addHandler=function(t,e){if(!e)return this;if(this._handlers||(this._handlers=[]),this[t])return this[t].enable(),this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},n.removeHandler=function(t){if(!t)return this;var e=this[t];if(e){var n=this._handlers.indexOf(e);n>=0&&this._handlers.splice(n,1),this[t].remove(),delete this[t]}return this},n._clearHandlers=function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].remove();this._handlers=[]},e}(t)}var ln={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},hn={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},fn=function(t){function e(e,n){var r;return void 0===n&&(n={}),(r=t.call(this,null)||this).dom=e,r.options=n,r}ne(e,t);var n=e.prototype;return n.enable=function(){return this.dom?(this._onMouseDown=function(t){return this.onMouseDown(t)},Ye(this.dom,"touchstart mousedown",this._onMouseDown,this),this):this},n.disable=function(){return this.dom?(this._offEvents(),Je(this.dom,"touchstart mousedown",this._onMouseDown),delete this._onMouseDown,this):this},n.onMouseDown=function(t){if((this.options.rightclick||2!==t.button)&&!(t.touches&&t.touches.length>1||this.options.cancelOn&&!0===this.options.cancelOn(t))){var e=this.dom;e.setCapture?e.setCapture():window.captureEvents&&window.captureEvents(window.Event.MOUSEMOVE|window.Event.MOUSEUP),e.ondragstart=function(){return!1},delete this.moved;var n=t.touches?t.touches[0]:t;this.startPos=new oe(n.clientX,n.clientY),Ye(document,ln[t.type],this.onMouseMove,this),Ye(document,hn[t.type],this.onMouseUp,this),this.options.ignoreMouseleave||Ye(this.dom,"mouseleave",this.onMouseUp,this),this.fire("mousedown",{domEvent:t,mousePos:new oe(n.clientX,n.clientY)})}},n.onMouseMove=function(t){if(t.touches&&t.touches.length>1)this.moved&&(this.interupted=!0,this.onMouseUp(t));else{var e=t.touches?t.touches[0]:t,n=new oe(e.clientX,e.clientY).sub(this.startPos);(n.x||n.y)&&(this.moved?this.fire("dragging",{domEvent:t,mousePos:new oe(e.clientX,e.clientY)}):(this.fire("dragstart",{domEvent:t,mousePos:this.startPos.copy()}),this.moved=!0))}},n.onMouseUp=function(t){var e=t.changedTouches?t.changedTouches[0]:t;this._offEvents();var n={domEvent:t};d(e.clientX)&&(n.mousePos=new oe(parseInt(e.clientX,0),parseInt(e.clientY,0))),this.moved&&(n.interupted=this.interupted,this.fire("dragend",n),delete this.interupted,delete this.moved),this.fire("mouseup",n)},n._offEvents=function(){var t=this.dom;if(Je(t,"mouseleave",this.onMouseUp,this),"undefined"!=typeof document&&"undefined"!=typeof window){for(var e in ln)Je(document,ln[e],this.onMouseMove,this),Je(document,hn[e],this.onMouseUp,this);t.releaseCapture?t.releaseCapture():window.captureEvents&&window.captureEvents(window.Event.MOUSEMOVE|window.Event.MOUSEUP)}},e}(on),dn=function(t){function e(){return t.apply(this,arguments)||this}return ne(e,t),e.toNumberArrays=function(t){return Array.isArray(t)?R(t,function(t){return[t.x,t.y]}):[t.x,t.y]},e.toCoordinates=function(t){if(d(t[0])&&d(t[1]))return new e(t);for(var n=[],r=0,i=t.length;r<i;r++){var o=t[r];Array.isArray(o)?d(o[0])?n.push(new e(o)):n.push(e.toCoordinates(o)):n.push(new e(o))}return n},e}(ie),pn=function(){function t(t,e){this.type=t,this.properties=e}return t.createProj4=function(e){return new t("proj4",{proj:e})},t.fromProjectionCode=function(e){return e&&t[e=e.toUpperCase().replace(":","")]||null},t}();pn.WGS84=pn.createProj4("+proj=longlat +datum=WGS84 +no_defs"),pn.EPSG4326=pn.WGS84,pn.EPSG3857=pn.createProj4("+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"),pn.IDENTITY=pn.createProj4("+proj=identity +no_defs"),pn.CGCS2000=pn.createProj4("+proj=longlat +datum=CGCS2000"),pn.EPSG4490=pn.CGCS2000,pn.BD09LL=pn.createProj4("+proj=longlat +datum=BD09"),pn.GCJ02=pn.createProj4("+proj=longlat +datum=GCJ02");var vn,gn=function(){function t(t,e,n,r){this._clazz=dn;var i=arguments.length,o=i>0?arguments[i-1]:null;o&&o.unproject&&(this.projection=arguments[i-1]),this._dirty=!0,this._initialize(t,e,n,r)}var e=t.prototype;return e._initialize=function(t,e,n,r){if(this.xmin=null,this.xmax=null,this.ymin=null,this.ymax=null,!f(t)){var i=this.projection;d(t)&&d(e)&&d(n)&&d(r)?i?(this.xmin=t,this.ymin=e,this.xmax=n,this.ymax=r):(this.xmin=Math.min(t,n),this.ymin=Math.min(e,r),this.xmax=Math.max(t,n),this.ymax=Math.max(e,r)):Array.isArray(t)?i?(this.xmin=t[0],this.ymin=t[1],this.xmax=t[2],this.ymax=t[3]):(this.xmin=Math.min(t[0],t[2]),this.ymin=Math.min(t[1],t[3]),this.xmax=Math.max(t[0],t[2]),this.ymax=Math.max(t[1],t[3])):d(t.x)&&d(e.x)&&d(t.y)&&d(e.y)?i?(this.xmin=t.x,this.ymin=t.y,this.xmax=e.x,this.ymax=e.y):(t.x>e.x?(this.xmin=e.x,this.xmax=t.x):(this.xmin=t.x,this.xmax=e.x),t.y>e.y?(this.ymin=e.y,this.ymax=t.y):(this.ymin=t.y,this.ymax=e.y)):d(t.xmin)&&d(t.xmax)&&d(t.ymin)&&d(t.ymax)&&(this.xmin=t.xmin,this.ymin=t.ymin,this.xmax=t.xmax,this.ymax=t.ymax)}},e._add=function(t){return this._dirty=!0,f(t.x)?f(t.xmin)?f(t[0])||(this.xmin+=t[0],this.ymin+=t[1],this.xmax+=t[0],this.ymax+=t[1]):(this.xmin+=t.xmin,this.ymin+=t.ymin,this.xmax+=t.xmax,this.ymax+=t.ymax):(this.xmin+=t.x,this.ymin+=t.y,this.xmax+=t.x,this.ymax+=t.y),this},e.add=function(){var t=new this.constructor(this.xmin,this.ymin,this.xmax,this.ymax,this.projection);return t._add.apply(t,arguments)},e._sub=function(t){return this._dirty=!0,f(t.x)?f(t.xmin)?f(t[0])||(this.xmin-=t[0],this.ymin-=t[1],this.xmax-=t[0],this.ymax-=t[1]):(this.xmin-=t.xmin,this.ymin-=t.ymin,this.xmax-=t.xmax,this.ymax-=t.ymax):(this.xmin-=t.x,this.ymin-=t.y,this.xmax-=t.x,this.ymax-=t.y),this},e._substract=function(){return this._sub.apply(this,arguments)},e.sub=function(){var t=new this.constructor(this.xmin,this.ymin,this.xmax,this.ymax,this.projection);return t._sub.apply(t,arguments)},e.substract=function(){return this.sub.apply(this,arguments)},e.round=function(){return new this.constructor(Math.round(this.xmin),Math.round(this.ymin),Math.round(this.xmax),Math.round(this.ymax),this.projection)},e._round=function(){return this._dirty=!0,this.xmin=Math.round(this.xmin),this.ymin=Math.round(this.ymin),this.xmax=Math.round(this.xmax),this.ymax=Math.round(this.ymax),this},e.getMin=function(){return new this._clazz(this.xmin,this.ymin)},e.getMax=function(){return new this._clazz(this.xmax,this.ymax)},e.getCenter=function(){return new this._clazz((this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)},e.isValid=function(){return d(this.xmin)&&d(this.ymin)&&d(this.xmax)&&d(this.ymax)},e.equals=function(t){return this.xmin===t.xmin&&this.xmax===t.xmax&&this.ymin===t.ymin&&this.ymax===t.ymax},e.intersects=function(t){this._project(this),this._project(t);var e=Math.max(this.pxmin,t.pxmin),n=Math.max(this.pymin,t.pymin),r=Math.min(this.pxmax,t.pxmax),i=Math.min(this.pymax,t.pymax),o=!(e>r||n>i);return o},e.within=function(t){return this._project(this),this._project(t),this.pxmin>=t.pxmin&&this.pxmax<=t.pxmax&&this.pymin>=t.pymin&&this.pymax<=t.pymax},e.contains=function(t){if(!t)return!1;this._project(this);var e=this.projection;return Array.isArray(t)&&(t=new this._clazz(t)),e&&(t=e.project(t)),t.x>=this.pxmin&&t.x<=this.pxmax&&t.y>=this.pymin&&t.y<=this.pymax},e.getWidth=function(){return Math.abs(this.xmax-this.xmin)},e.getHeight=function(){return Math.abs(this.ymax-this.ymin)},e.getSize=function(){return new ae(this.getWidth(),this.getHeight())},e.__combine=function(t){t instanceof this.constructor||(t=new this.constructor(t,t)),this._project(t),this._project(this);var e=this.pxmin;d(e)?d(t.pxmin)&&e>t.pxmin&&(e=t.pxmin):e=t.pxmin;var n=this.pxmax;d(n)?d(t.pxmax)&&n<t.pxmax&&(n=t.pxmax):n=t.pxmax;var r=this.pymin;d(r)?d(t.pymin)&&r>t.pymin&&(r=t.pymin):r=t.pymin;var i=this.pymax;d(i)?d(t.pymax)&&i<t.pymax&&(i=t.pymax):i=t.pymax;var o=this.projection;if(o){var a=o.unproject(new this._clazz(e,r)),s=o.unproject(new this._clazz(n,i));e=a.x,r=a.y,n=s.x,i=s.y}return[e,r,n,i]},e._combine=function(t){if(!t)return this;var e=this.__combine(t);return this.xmin=e[0],this.ymin=e[1],this.xmax=e[2],this.ymax=e[3],this._dirty=!0,this},e.combine=function(t){if(!t)return this;var e=this.__combine(t);return new this.constructor(e[0],e[1],e[2],e[3],this.projection)},e.intersection=function(t){if(!this.intersects(t))return null;var e=new this._clazz(Math.max(this.pxmin,t.pxmin),Math.max(this.pymin,t.pymin)),n=new this._clazz(Math.min(this.pxmax,t.pxmax),Math.min(this.pymax,t.pymax)),r=this.projection;return r&&(e=r.unproject(e),n=r.unproject(n)),new this.constructor(e,n,r)},e.expand=function(t){var e,n;return d(t)?e=n=t:(e=t.width||t.x||t[0]||0,n=t.height||t.y||t[1]||0),new this.constructor(this.xmin-e,this.ymin-n,this.xmax+e,this.ymax+n,this.projection)},e._expand=function(t){var e,n;return d(t)?e=n=t:(e=t.width||t.x||t[0]||0,n=t.height||t.y||t[1]||0),this.xmin-=e,this.ymin-=n,this.xmax+=e,this.ymax+=n,this._dirty=!0,this},e.toJSON=function(){return{xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax}},e.toArray=function(){var t=this.xmin,e=this.ymin,n=this.xmax,r=this.ymax;return[new this._clazz([t,r]),new this._clazz([n,r]),new this._clazz([n,e]),new this._clazz([t,e]),new this._clazz([t,r])]},e.toString=function(){return this.xmin+","+this.ymin+","+this.xmax+","+this.ymax},e.copy=function(){return new this.constructor(this.xmin,this.ymin,this.xmax,this.ymax,this.projection)},e.convertTo=function(t){if(!this.isValid())return null;var e=new this.constructor,n=new this._clazz(this.xmin,this.ymax);return e._combine(t(n)),n.x=this.xmax,e._combine(t(n)),n.y=this.ymin,e._combine(t(n)),n.x=this.xmin,e._combine(t(n)),e},e._project=function(t){if(t&&t.isValid()){var e=this.projection;if(e){if(t._dirty){var n=[t.getMin(),t.getMax()],r=(n=e.projectCoords(n))[0],i=n[1];t.pxmin=Math.min(r.x,i.x),t.pymin=Math.min(r.y,i.y),t.pxmax=Math.max(r.x,i.x),t.pymax=Math.max(r.y,i.y)}delete t._dirty}else t.pxmin=t.xmin,t.pxmax=t.xmax,t.pymin=t.ymin,t.pymax=t.ymax}},t}(),yn=function(t){function e(e,n,r,i){var o;return(o=t.call(this,e,n,r,i)||this)._clazz=oe,o}return ne(e,t),e}(gn),mn=function(){function t(t){this.matrix=t}var e=t.prototype;return e.transform=function(t,e){return new oe(this.matrix[0]*(t.x-this.matrix[2])/e,this.matrix[1]*(t.y-this.matrix[3])/e)},e.untransform=function(t,e){return new dn(t.x*e/this.matrix[0]+this.matrix[2],t.y*e/this.matrix[1]+this.matrix[3])},t}(),_n={project:function(){},unproject:function(){},projectCoords:function(t){var e=this;if(!t)return[];if(!Array.isArray(t))return this.project(t);if(0===t.length)return[];if(!this.isSphere())return R(t,this.project,this);if(Array.isArray(t[0]))return t.map(function(t){return e.projectCoords(t)});for(var n,r,i,o,a,s,u=this.getCircum(),c=this.getSphereExtent(),l=c.sx,h=c.sy,f=t[0],d=[this.project(f)],p=1,v=t.length;p<v;p++)o=(i=t[p]).x-f.x,a=i.y-f.y,s=this.project(i),Math.abs(o)>180&&(void 0===n&&(n=i.x<f.x),n&&(s._add(-u.x*I(o)*l,0),i._add(-360*I(o),0))),Math.abs(a)>90&&(void 0===r&&(r=i.y<f.y),r&&(s._add(0,-u.y*I(a)*h),i._add(0,-180*I(a)))),f=i,d.push(s);return d},unprojectCoords:function(t){return t?Array.isArray(t)?R(t,this.unproject,this):this.unproject(t):[]},isSphere:function(){return!!this.sphere},isOutSphere:function(t){return!!this.isSphere()&&!this.getSphereExtent().contains(t)},wrapCoord:function(t){if(!this.isSphere())return t;var e=this.getSphereExtent(),n=new dn(t);return e.contains(n)||(n.x=N(t.x,e.xmin,e.xmax),n.y=N(t.y,e.ymin,e.ymax)),n},getCircum:function(){if(!this.circum&&this.isSphere()){var t=this.getSphereExtent();this.circum={x:t.getWidth(),y:t.getHeight()}}return this.circum},getSphereExtent:function(){if(!this.extent&&this.isSphere()){var t=this.project(new dn(180,90)),e=this.project(new dn(-180,-90));this.extent=new gn(e,t,this),this.extent.sx=t.x>e.x?1:-1,this.extent.sy=t.y>e.y?1:-1}return this.extent}},bn={measureLength:function(t,e){if(!Array.isArray(t))return this.measureLenBetween(t,e);for(var n=0,r=0,i=t.length;r<i-1;r++)n+=this.measureLenBetween(t[r],t[r+1]);return n}},wn=h({measure:"IDENTITY",measureLenBetween:function(t,e){if(!t||!e)return 0;try{return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}catch(t){return 0}},measureArea:function(t){if(!Array.isArray(t))return 0;for(var e=0,n=0,r=t.length;n<r;n++){var i=t[n],o=null;o=n===r-1?t[0]:t[n+1],e+=i.x*o.y-i.y*o.x}return Math.abs(e/2)},locate:function(t,e,n){return t=new dn(t.x,t.y),this._locate(t,e,n)},_locate:function(t,e,n){return t?(e||(e=0),n||(n=0),e||n?(t.x=t.x+e,t.y=t.y+n,t):t):null},rotate:function(t,e,n){return t=new dn(t.x,t.y),this._rotate(t,e,n)},_rotate:(vn=new oe(0,0),function(t,e,n){return vn.x=t.x-e.x,vn.y=t.y-e.y,vn._rotate(n*Math.PI/180),t.x=e.x+vn.x,t.y=e.y+vn.y,t})},bn),xn=function(){function t(t){this.radius=t}var e=t.prototype;return e.measureLenBetween=function(t,e){if(!t||!e)return 0;var n=w(t.y),r=w(e.y),i=n-r,o=w(t.x)-w(e.x);return n=2*Math.asin(Math.sqrt(Math.pow(Math.sin(i/2),2)+Math.cos(n)*Math.cos(r)*Math.pow(Math.sin(o/2),2))),n*=this.radius,Math.round(1e5*n)/1e5},e.measureArea=function(t){var e,n=w(this.radius),r=0,i=t,o=i.length;if(o<3)return 0;for(e=0;e<o-1;e++){var a=i[e],s=i[e+1];r+=a.x*n*Math.cos(w(a.y))*s.y*n-s.x*n*Math.cos(w(s.y))*a.y*n}return o=i[e],i=i[0],r+=o.x*n*Math.cos(w(o.y))*i.y*n-i.x*n*Math.cos(w(i.y))*o.y*n,.5*Math.abs(r)},e.locate=function(t,e,n){return t=new dn(t.x,t.y),this._locate(t,e,n)},e._locate=function(t,e,n){if(!t)return null;if(e||(e=0),n||(n=0),!e&&!n)return t;var r,i,o=w(t.y);if(0!==n){var a=Math.abs(n);i=N(180*(o+=2*Math.sin(a/(2*this.radius))*(n>0?1:-1))/Math.PI,-90,90)}else i=t.y;if(0!==e){var s=Math.abs(e),u=w(t.x);r=N(180*(u+=2*Math.sqrt(Math.pow(Math.sin(s/(2*this.radius)),2)/Math.pow(Math.cos(o),2))*(e>0?1:-1))/Math.PI,-180,180)}else r=t.x;return t.x=r,t.y=i,t},e.rotate=function(t,e,n){return t=new dn(t),this._rotate(t,e,n)},e._rotate=function(t,e,n){var r=function(t,e,n){void 0===n&&(n={});var r;r=n.final?En(e,t):En(t,e);return r>180?-(360-r):r}(e,t)-n,i=this.measureLenBetween(e,t);return t.x=e.x,t.y=e.y,function(t,e,n,r){var i=e/r,o=t.x*Math.PI/180,a=w(t.y),s=w(n),u=i*Math.cos(s),c=a+u;Math.abs(c)>Math.PI/2&&(c=c>0?Math.PI-c:-Math.PI-c);var l=Math.log(Math.tan(c/2+Math.PI/4)/Math.tan(a/2+Math.PI/4)),h=Math.abs(l)>1e-11?u/l:Math.cos(a),f=i*Math.sin(s)/h,d=o+f;return t.x=(180*d/Math.PI+540)%360-180,t.y=180*c/Math.PI,t}(t,i,r,this.radius)},t}();function En(t,e){var n=w(t.y),r=w(e.y),i=w(e.x-t.x);i>Math.PI&&(i-=2*Math.PI),i<-Math.PI&&(i+=2*Math.PI);var o=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(n/2+Math.PI/4));return(x(Math.atan2(i,o))+360)%360}var On=h({measure:"EPSG:4326",sphere:new xn(6378137),measureLenBetween:function(){return this.sphere.measureLenBetween.apply(this.sphere,arguments)},measureArea:function(){return this.sphere.measureArea.apply(this.sphere,arguments)},_locate:function(){return this.sphere._locate.apply(this.sphere,arguments)},locate:function(){return this.sphere.locate.apply(this.sphere,arguments)},_rotate:function(){return this.sphere._rotate.apply(this.sphere,arguments)},rotate:function(){return this.sphere.rotate.apply(this.sphere,arguments)}},bn),Pn=h({measure:"BAIDU",sphere:new xn(6370996.81),measureLenBetween:function(){return this.sphere.measureLenBetween.apply(this.sphere,arguments)},measureArea:function(){return this.sphere.measureArea.apply(this.sphere,arguments)},_locate:function(){return this.sphere._locate.apply(this.sphere,arguments)},locate:function(){return this.sphere.locate.apply(this.sphere,arguments)},_rotate:function(){return this.sphere._rotate.apply(this.sphere,arguments)},rotate:function(){return this.sphere.rotate.apply(this.sphere,arguments)}},bn),Sn=On,Tn={};function Cn(t){Tn[t.measure]=t}Cn(wn),Cn(On),Cn(Pn);var An={getInstance:function(t){if(!t)return Sn;for(var e in Tn)if(_(Tn,e)){var n=Tn[e].measure;if(!n)continue;if(t.toLowerCase()===n.toLowerCase())return Tn[e]}return null}},Mn=h({},_n,{code:"EPSG:3857",rad:Math.PI/180,metersPerDegree:6378137*Math.PI/180,maxLatitude:85.0511287798,project:function(t){var e,n=this.rad,r=this.metersPerDegree,i=this.maxLatitude,o=t.x,a=Math.max(Math.min(i,t.y),-i);return e=0===a?0:Math.log(Math.tan((90+a)*n/2))/n,new dn(o*r,e*r)},unproject:function(t){var e,n=t.x,r=t.y,i=this.rad,o=this.metersPerDegree;return 0===r?e=0:(e=r/o,e=(2*Math.atan(Math.exp(e*i))-Math.PI/2)/i),new dn(N(n/o,-180,180),N(e,-this.maxLatitude,this.maxLatitude))}},On),kn=h({},_n,{code:"EPSG:4326",project:function(t){return new dn(t)},unproject:function(t){return new dn(t)}},On),jn=h({},kn,{code:"EPSG:4490"}),Rn=h({},_n,{code:"BAIDU",project:function(t){return this.convertLL2MC(t)},unproject:function(t){return this.convertMC2LL(t)}},Pn,{EARTHRADIUS:6370996.81,MCBAND:[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],LLBAND:[75,60,45,30,15,0],MC2LL:[[1.410526172116255e-8,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,17337981.2],[-7.435856389565537e-9,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,6856817.37],[-1.981981304930552e-8,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,4482777.06],[3.09191371068437e-9,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,2555164.4],[2.890871144776878e-9,8983055095805407e-21,-3.068298e-8,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],LL2MC:[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],convertMC2LL:function(t){Math.abs(t.x);for(var e,n=Math.abs(t.y),r=0,i=this.MCBAND.length;r<i;r++)if(n>=this.MCBAND[r]){e=this.MC2LL[r];break}var o=this.convertor(t,e);return new dn(o.x,o.y)},convertLL2MC:function(t){var e,n,r;t.x=this.getLoop(t.x,-180,180),t.y=this.getRange(t.y,-74,74);var i=new dn(t.x,t.y);for(n=0,r=this.LLBAND.length;n<r;n++)if(i.y>=this.LLBAND[n]){e=this.LL2MC[n];break}if(!e)for(n=this.LLBAND.length-1;n>=0;n--)if(i.y<=-this.LLBAND[n]){e=this.LL2MC[n];break}var o=this.convertor(t,e);return new dn(o.x,o.y)},convertor:function(t,e){if(!t||!e)return null;var n=e[0]+e[1]*Math.abs(t.x),r=Math.abs(t.y)/e[9],i=e[2]+e[3]*r+e[4]*r*r+e[5]*r*r*r+e[6]*r*r*r*r+e[7]*r*r*r*r*r+e[8]*r*r*r*r*r*r;return n*=t.x<0?-1:1,i*=t.y<0?-1:1,new dn(n,i)},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},getRange:function(t,e,n){return null!=e&&(t=Math.max(t,e)),null!=n&&(t=Math.min(t,n)),t},getLoop:function(t,e,n){if(t===1/0)return n;if(t===-1/0)return e;for(;t>n;)t-=n-e;for(;t<e;)t+=n-e;return t}}),Ln=h({},_n,{code:"IDENTITY",project:function(t){return t.copy()},unproject:function(t){return t.copy()}},wn),In=Mn,Dn=Object.freeze({EPSG3857:Mn,DEFAULT:In,EPSG4326:kn,EPSG4490:jn,BAIDU:Rn,IDENTITY:Ln,Common:_n}),Fn=function(t){return function(t){function e(){return t.apply(this,arguments)||this}return ne(e,t),e.registerRenderer=function(t,e){var n=this.prototype,r=Object.getPrototypeOf(n);return n._rendererClasses&&n._rendererClasses!==r._rendererClasses||(n._rendererClasses=n._rendererClasses?Object.create(n._rendererClasses):{}),n._rendererClasses[t.toLowerCase()]=e,this},e.getRendererClass=function(t){var e=this.prototype;return e._rendererClasses?e._rendererClasses[t.toLowerCase()]:null},e}(t)},Nn="undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:{};function Bn(t,e){return t(e={exports:{}},e.exports),e.exports}var Un=Bn(function(t){!function(e){function n(t){if(t){var e=this;t(function(t){e.resolve(t)},function(t){e.reject(t)})}}function r(t,e){if("function"==typeof t.y)try{var n=t.y.call(a,e);t.p.resolve(n)}catch(e){t.p.reject(e)}else t.p.resolve(e)}function i(t,e){if("function"==typeof t.n)try{var n=t.n.call(a,e);t.p.resolve(n)}catch(e){t.p.reject(e)}else t.p.reject(e)}var o,a,s="fulfilled",u="undefined",c=function(){function t(){for(;n.length-r;){try{n[r]()}catch(t){e.console&&e.console.error(t)}n[r++]=a,r==i&&(n.splice(0,i),r=0)}}var n=[],r=0,i=1024,o=function(){if(typeof MutationObserver!==u){var e=document.createElement("div");return new MutationObserver(t).observe(e,{attributes:!0}),function(){e.setAttribute("a",0)}}return typeof setImmediate!==u?function(){setImmediate(t)}:function(){setTimeout(t,0)}}();return function(t){n.push(t),n.length-r==1&&o()}}();n.prototype={resolve:function(t){if(this.state===o){if(t===this)return this.reject(new TypeError("Attempt to resolve promise with self"));var e=this;if(t&&("function"==typeof t||"object"==typeof t))try{var n=!0,i=t.then;if("function"==typeof i)return void i.call(t,function(t){n&&(n=!1,e.resolve(t))},function(t){n&&(n=!1,e.reject(t))})}catch(t){return void(n&&this.reject(t))}this.state=s,this.v=t,e.c&&c(function(){for(var n=0,i=e.c.length;i>n;n++)r(e.c[n],t)})}},reject:function(t){if(this.state===o){this.state="rejected",this.v=t;var r=this.c;r?c(function(){for(var e=0,n=r.length;n>e;e++)i(r[e],t)}):!n.suppressUncaughtRejectionError&&e.console&&e.console.log("You upset Zousan. Please catch rejections: ",t,t?t.stack:null)}},then:function(t,e){var a=new n,u={y:t,n:e,p:a};if(this.state===o)this.c?this.c.push(u):this.c=[u];else{var l=this.state,h=this.v;c(function(){l===s?r(u,h):i(u,h)})}return a},catch:function(t){return this.then(null,t)},finally:function(t){return this.then(t,t)},timeout:function(t,e){e=e||"Timeout";var r=this;return new n(function(n,i){setTimeout(function(){i(Error(e))},t),r.then(function(t){n(t)},function(t){i(t)})})}},n.resolve=function(t){var e=new n;return e.resolve(t),e},n.reject=function(t){var e=new n;return e.reject(t),e},n.all=function(t){function e(e,a){e&&"function"==typeof e.then||(e=n.resolve(e)),e.then(function(e){r[a]=e,++i==t.length&&o.resolve(r)},function(t){o.reject(t)})}for(var r=[],i=0,o=new n,a=0;a<t.length;a++)e(t[a],a);return t.length||o.resolve(r),o},t.exports&&(t.exports=n),e.define&&e.define.amd&&e.define([],function(){return n}),e.Zousan=n,n.soon=c}(Nn)}),zn="undefined"!=typeof Promise?Promise:Un,Gn=function(t){function e(e){var n;return(n=t.call(this)||this).layer=e,n._painted=!1,n._drawTime=0,n.setToRedraw(),n}ne(e,t);var n=e.prototype;return n.render=function(t){var e=this;if(this.prepareRender(),this.getMap()&&this.layer.isVisible())if(this.resources||(this.resources=new Vn),this.checkResources){var n=this.checkResources();n.length>0?(this._loadingResource=!0,this.loadResources(n).then(function(){e._loadingResource=!1,e.layer&&(e.layer.fire("resourceload"),e.setToRedraw())})):this._tryToDraw(t)}else this._tryToDraw(t)},n.testIfNeedRedraw=function(){var t=this.getMap();return!this._loadingResource&&(!!this._toRedraw||!(t.isInteracting()&&!this.drawOnInteracting)&&!!this.needToRedraw())},n.needToRedraw=function(){var t=this.getMap();return!!t.isInteracting()&&!(!t.getPitch()&&t.isMoving()&&!t.isZooming()&&!t.isRotating()&&!this.layer.options.forceRenderOnMoving)},n.onSkipDrawOnInteracting=function(){},n.isRenderComplete=function(){return!!this._renderComplete},n.mustRenderOnInteracting=function(){return!this._painted||this.checkResources&&this.checkResources().length>0},n.setToRedraw=function(){return this._toRedraw=!0,this},n.setCanvasUpdated=function(){return this._canvasUpdated=!0,this},n.isCanvasUpdated=function(){return!!this._canvasUpdated},n.remove=function(){this.onRemove(),delete this._loadingResource,delete this.southWest,delete this.canvas,delete this.context,delete this.canvasExtent2D,delete this._extent2D,delete this.resources,delete this.layer},n.onRemove=function(){},n.onAdd=function(){},n.getMap=function(){return this.layer?this.layer.getMap():null},n.getCanvasImage=function(){var t=this.getMap();if(this._canvasUpdated=!1,this._renderZoom!==t.getZoom()||!this.canvas||!this._extent2D)return null;if(this.isBlank())return null;if(this.layer.isEmpty&&this.layer.isEmpty())return null;var e=t._pointToContainerPoint(this.southWest)._add(0,-t.height);return{image:this.canvas,layer:this.layer,point:e}},n.clear=function(){this.clearCanvas()},n.isBlank=function(){return!this._painted},n.show=function(){this.setToRedraw()},n.hide=function(){this.clear(),this.setToRedraw()},n.setZIndex=function(){this.setToRedraw()},n.hitDetect=function(t){if(!this.context||this.layer.isEmpty&&this.layer.isEmpty()||this.isBlank()||this._errorThrown)return!1;var e=this.getMap(),n=ee.retina?2:1,r=e.getSize();if(t.x<0||t.x>r.width*n||t.y<0||t.y>r.height*n)return!1;try{if(this.context.getImageData(n*t.x,n*t.y,1,1).data[3]>0)return!0}catch(t){return this._errorThrown||(console&&console.warn("hit detect failed with tainted canvas, some geometries have external resources in another domain:\n",t),this._errorThrown=!0),!1}return!1},n.loadResources=function(t){this.resources||(this.resources=new Vn);var e=this.resources,n=[];if(U(t))for(var r={},i=t.length-1;i>=0;i--){var o=t[i];o&&o.length&&!r[o.join("-")]&&(r[o.join("-")]=1,e.isResourceLoaded(o,!0)||n.push(new zn(this._promiseResource(o))))}return zn.all(n)},n.prepareRender=function(){delete this._renderComplete;var t=this.getMap();this._renderZoom=t.getZoom(),this.canvasExtent2D=this._extent2D=t._get2DExtent(),this.southWest=t._containerPointToPoint(new oe(0,t.height))},n.createCanvas=function(){if(!this.canvas){var t=this.getMap(),e=t.getSize(),n=ee.retina?2:1,r=n*e.width,i=n*e.height;if(this.layer._canvas){var o=this.layer._canvas;o.width=r,o.height=i,o.style&&(o.style.width=e.width+"px",o.style.height=e.height+"px"),this.canvas=this.layer._canvas}else this.canvas=Ke.createCanvas(r,i,t.CanvasClass);this.onCanvasCreate()}},n.onCanvasCreate=function(){},n.createContext=function(){if(!(this.gl&&this.gl.canvas===this.canvas||this.context)&&(this.context=this.canvas.getContext("2d"),this.context&&(this.layer.options.globalCompositeOperation&&(this.context.globalCompositeOperation=this.layer.options.globalCompositeOperation),ee.retina))){this.context.scale(2,2)}},n.resetCanvasTransform=function(){if(this.context){var t=ee.retina?2:1;this.context.setTransform(t,0,0,t,0,0)}},n.resizeCanvas=function(t){var e=this.canvas;if(e){var n=t||this.getMap().getSize(),r=ee.retina?2:1;e.width===r*n.width&&e.height===r*n.height||(e.height=r*n.height,e.width=r*n.width,ee.retina&&this.context&&this.context.scale(r,r),this.layer._canvas&&e.style&&(e.style.width=n.width+"px",e.style.height=n.height+"px"))}},n.clearCanvas=function(){this.context&&Ke.clearRect(this.context,0,0,this.canvas.width,this.canvas.height)},n.prepareCanvas=function(){this.canvas?(this.clearCanvas(),this.resizeCanvas(),this.resetCanvasTransform()):(this.createCanvas(),this.createContext(),this.layer.fire("canvascreate",{context:this.context,gl:this.gl})),delete this._maskExtent;var t=this.layer.getMask();if(!t)return this.layer.fire("renderstart",{context:this.context,gl:this.gl}),null;var e=this._maskExtent=t._getPainter().get2DExtent();return e.intersects(this._extent2D),this.layer.fire("renderstart",{context:this.context,gl:this.gl}),e},n.clipCanvas=function(t){var e=this.layer.getMask();if(!e)return!1;var n=this.southWest,r=this.getMap();if(this.southWest=r._containerPointToPoint(new oe(0,r.height)),t.save(),ee.retina&&(t.save(),t.scale(2,2)),e.getGeometries){t.isMultiClip=!0;var i=e.getGeometries()||[];t.beginPath(),i.forEach(function(e){e._getPainter().paint(null,t)}),t.stroke(),delete t.isMultiClip}else{e._getPainter().paint(null,t)}return ee.retina&&t.restore(),t.clip(),this.southWest=n,!0},n.getViewExtent=function(){return{extent:this._extent2D,maskExtent:this._maskExtent,zoom:this._renderZoom,southWest:this.southWest}},n.completeRender=function(){this.getMap()&&(this._renderComplete=!0,this.layer.fire("renderend",{context:this.context,gl:this.gl}),this.setCanvasUpdated())},n.getEvents=function(){return{_zoomstart:this.onZoomStart,_zooming:this.onZooming,_zoomend:this.onZoomEnd,_resize:this.onResize,_movestart:this.onMoveStart,_moving:this.onMoving,_moveend:this.onMoveEnd,_dragrotatestart:this.onDragRotateStart,_dragrotating:this.onDragRotating,_dragrotateend:this.onDragRotateEnd,_spatialreferencechange:this.onSpatialReferenceChange}},n.onZoomStart=function(){},n.onZoomEnd=function(){this.setToRedraw()},n.onZooming=function(){},n.onMoveStart=function(){},n.onMoving=function(){},n.onMoveEnd=function(){this.setToRedraw()},n.onResize=function(){delete this._extent2D,this.resizeCanvas(),this.setToRedraw()},n.onDragRotateStart=function(){},n.onDragRotating=function(){},n.onDragRotateEnd=function(){this.setToRedraw()},n.onSpatialReferenceChange=function(){},n.getDrawTime=function(){return this._drawTime},n._tryToDraw=function(t){this._toRedraw=!1,!this.canvas&&this.layer.isEmpty&&this.layer.isEmpty()?this._renderComplete=!0:this._drawAndRecord(t)},n._drawAndRecord=function(t){if(this.getMap()){var e=this._painted;this._painted=!0;var n=l();this.draw(t),n=l()-n,this._drawTime=e?n:n/2,e&&this.layer.options.logDrawTime&&console.log(this.layer.getId(),"frameTimeStamp:",t,"drawTime:",this._drawTime)}},n._promiseResource=function(t){var e=this,n=this.resources,r=this.layer.options.crossOrigin;return function(i){if(n.isResourceLoaded(t,!0))i(t);else{var o=new Image;f(r)||(o.crossOrigin=r),S(t[0])&&!P&&(t[1]&&(t[1]*=2),t[2]&&(t[2]*=2)),o.onload=function(){e._cacheResource(t,o),i(t)},o.onabort=function(e){console&&console.warn("image loading aborted: "+t[0]),e&&console&&console.warn(e),i(t)},o.onerror=function(e){e&&"undefined"!=typeof console&&console.warn(e),n.markErrorResource(t),i(t)},T(o,t)}}},n._cacheResource=function(t,e){if(this.layer&&this.resources){var n=t[1],r=t[2];if(this.layer.options.cacheSvgOnCanvas&&1===S(t[0])&&(ee.edge||ee.ie)){f(n)&&(n=e.width||this.layer.options.defaultIconSize[0]),f(r)&&(r=e.height||this.layer.options.defaultIconSize[1]);var i=Ke.createCanvas(n,r);Ke.image(i.getContext("2d"),e,0,0,n,r),e=i}this.resources.addResource(t,e)}},e}(an),Vn=function(){function t(){this.resources={},this._errors={}}var e=t.prototype;return e.addResource=function(t,e){this.resources[t[0]]={image:e,width:+t[1],height:+t[2]}},e.isResourceLoaded=function(t,e){if(!t)return!1;var n=this._getImgUrl(t);if(this._errors[n])return!0;var r=this.resources[n];return!!r&&!(e&&S(t[0])&&(+t[1]>r.width||+t[2]>r.height))},e.getImage=function(t){var e=this._getImgUrl(t);return!this.isResourceLoaded(t)||this._errors[e]?null:this.resources[e].image},e.markErrorResource=function(t){this._errors[this._getImgUrl(t)]=1},e.merge=function(t){if(!t)return this;for(var e in t.resources){var n=t.resources[e];this.addResource([e,n.width,n.height],n.image)}return this},e.forEach=function(t){if(!this.resources)return this;for(var e in this.resources)_(this.resources,e)&&t(e,this.resources[e]);return this},e._getImgUrl=function(t){return Array.isArray(t)?t[0]:t},t}(),Wn=function(t){function e(e,n){var r,i;return n&&(i=n.canvas,delete n.canvas),(r=t.call(this,n)||this)._canvas=i,r.setId(e),n&&r.setZIndex(n.zIndex),r}ne(e,t);var n=e.prototype;return n.load=function(){if(!this.getMap())return this;if(this.onLoad()){this._initRenderer();var t=this.getZIndex();f(t)||(this._renderer.setZIndex(t),this.isCanvasRender()||this._renderer.render()),this.onLoadEnd()}return this},n.getId=function(){return this._id},n.setId=function(t){var e=this._id;return f(t)||(t+=""),this._id=t,this.fire("idchange",{old:e,new:t}),this},n.addTo=function(t){return t.addLayer(this),this},n.setZIndex=function(t){return this._zIndex=t,f(t)?delete this.options.zIndex:this.options.zIndex=t,this.map&&this.map._sortLayersByZIndex(),this._renderer&&this._renderer.setZIndex(t),this},n.getZIndex=function(){return this._zIndex||0},n.getMinZoom=function(){var t=this.getMap(),e=this.options.minZoom;return t?Math.max(t.getMinZoom(),e||0):e},n.getMaxZoom=function(){var t=this.getMap(),e=this.options.maxZoom;return t?Math.min(t.getMaxZoom(),f(e)?1/0:e):e},n.getOpacity=function(){return this.options.opacity},n.setOpacity=function(t){return this.config("opacity",t),this},n.isCanvasRender=function(){var t=this._getRenderer();return t&&t instanceof Gn},n.getMap=function(){return this.map?this.map:null},n.getProjection=function(){var t=this.getMap();return t?t.getProjection():null},n.bringToFront=function(){var t=this._getLayerList();if(!t.length)return this;var e=t[t.length-1];if(1===t.length||e===this)return this;var n=e.getZIndex();return this.setZIndex(n+1),this},n.bringToBack=function(){var t=this._getLayerList();if(!t.length)return this;var e=t[0];if(1===t.length||e===this)return this;var n=e.getZIndex();return this.setZIndex(n-1),this},n.show=function(){var t=this;if(!this.options.visible){this.options.visible=!0;var e=this.getRenderer();e&&e.show();var n=this.getMap();e&&n?n.once("renderend",function(){t.fire("show")}):this.fire("show")}return this},n.hide=function(){var t=this;if(this.options.visible){this.options.visible=!1;var e=this.getRenderer();e&&e.hide();var n=this.getMap();e&&n?n.once("renderend",function(){t.fire("hide")}):this.fire("hide")}return this},n.isVisible=function(){if(d(this.options.opacity)&&this.options.opacity<=0)return!1;var t=this.getMap();if(t){var e=t.getZoom();if(!f(this.options.maxZoom)&&this.options.maxZoom<e||!f(this.options.minZoom)&&this.options.minZoom>e)return!1}return f(this.options.visible)&&(this.options.visible=!0),this.options.visible},n.remove=function(){return this.map&&this.map.removeLayer(this),this},n.getMask=function(){return this._mask},n.setMask=function(t){if(!("Point"===t.type&&t._isVectorMarker()||"Polygon"===t.type||"MultiPolygon"===t.type))throw new Error("Mask for a layer must be a marker with vector marker symbol or a Polygon(MultiPolygon).");if("Point"===t.type?t.updateSymbol({markerLineColor:"rgba(0, 0, 0, 0)",markerFillOpacity:0}):t.setSymbol({lineColor:"rgba(0, 0, 0, 0)",polygonOpacity:0}),t._bindLayer(this),this._mask=t,!this.getMap()||this.getMap().isZooming())return this;var e=this._getRenderer();return e&&e.setToRedraw&&this._getRenderer().setToRedraw(),this},n.removeMask=function(){if(delete this._mask,!this.getMap()||this.getMap().isZooming())return this;var t=this._getRenderer();return t&&t.setToRedraw&&this._getRenderer().setToRedraw(),this},n.onLoad=function(){return!0},n.onLoadEnd=function(){},n.isLoaded=function(){return!!this._loaded},n.getRenderer=function(){return this._getRenderer()},n.onConfig=function(t){if(d(t.opacity)||t.cssFilter){var e=this.getRenderer();e&&e.setToRedraw()}},n.onAdd=function(){},n.onRemove=function(){},n._bindMap=function(t,e){t&&(this.map=t,f(e)||this.setZIndex(e),this._switchEvents("on",this),this.onAdd(),this.fire("add"))},n._initRenderer=function(){var t=this.options.renderer;if(this.constructor.getRendererClass){var e=this.constructor.getRendererClass(t);if(!e)throw new Error("Invalid renderer for Layer("+this.getId()+"):"+t);this._renderer=new e(this),this._renderer.layer=this,this._renderer.setZIndex(this.getZIndex()),this._switchEvents("on",this._renderer),this._renderer.onAdd&&this._renderer.onAdd(),this.fire("renderercreate",{renderer:this._renderer})}},n._doRemove=function(){this._loaded=!1,this.onRemove(),this._switchEvents("off",this),this._renderer&&(this._switchEvents("off",this._renderer),this._renderer.remove(),delete this._renderer),delete this.map},n._switchEvents=function(t,e){e&&e.getEvents&&this.getMap()[t](e.getEvents(),e)},n._getRenderer=function(){return this._renderer},n._getLayerList=function(){return this.map?this.map._layers:[]},n._getMask2DExtent=function(){if(!this._mask||!this.getMap())return null;var t=this._mask._getPainter();return t?t.get2DExtent():null},e}(un(rn(Fn(an))));Wn.mergeOptions({attribution:null,minZoom:null,maxZoom:null,visible:!0,opacity:1,globalCompositeOperation:null,renderer:"canvas",debugOutline:"#0f0",cssFilter:null,forceRenderOnMoving:!1,forceRenderOnZooming:!1,forceRenderOnRotating:!1});var Zn=Wn.prototype.fire;Wn.prototype.fire=function(t,e){return"layerload"===t&&(this._loaded=!0),this.map&&(e||(e={}),e.type=t,e.target=this,this.map._onLayerEvent(e)),Zn.apply(this,arguments)};var Hn={"EPSG:3857":{resolutions:function(){for(var t=[],e=12756274*Math.PI,n=0;n<21;n++)t[n]=e/(256*Math.pow(2,n));return t}(),fullExtent:{top:6378137*Math.PI,left:-6378137*Math.PI,bottom:-6378137*Math.PI,right:6378137*Math.PI}},"EPSG:4326":{fullExtent:{top:90,left:-180,bottom:-90,right:180},resolutions:function(){for(var t=[],e=0;e<20;e++)t[e]=180/(128*Math.pow(2,e));return t}()},BAIDU:{resolutions:function(){for(var t=Math.pow(2,18),e=[],n=0;n<20;n++)e[n]=t,t*=.5;return e[0]=null,e[1]=null,e[2]=null,e}(),fullExtent:{top:33554432,left:-33554432,bottom:-33554432,right:33554432}},IDENTITY:{resolutions:function(){for(var t=Math.pow(2,8),e=[],n=0;n<18;n++)e[n]=t,t*=.5;return e}(),fullExtent:{top:2e5,left:-2e5,bottom:-2e5,right:2e5}}};Hn["EPSG:4490"]=Hn["EPSG:4326"];var Xn=function(){function t(t){void 0===t&&(t={}),this.options=t,this._initSpatialRef()}t.getProjectionInstance=function(t){if(!t)return null;if(v(t))return t;for(var e in t=(t+"").toLowerCase(),Dn)if(_(Dn,e)){var n=Dn[e].code;if(n&&n.toLowerCase()===t)return Dn[e]}return null},t.equals=function(t,e){if(!t&&!e)return!0;if(!t||!e)return!1;if(t.projection!==e.projection)return!1;var n=t.fullExtent,r=e.fullExtent;if(n&&!r||!n&&r)return!1;if(n&&r&&(n.top!==r.top||n.bottom!==r.bottom||n.left!==r.left||n.right!==r.right))return!1;var i=t.resolutions,o=e.resolutions;if(i&&o){if(i.length!==o.length)return!1;for(var a=0;a<i.length;a++)if(i[a]!==o[a])return!1}return!0};var e=t.prototype;return e._initSpatialRef=function(){var e=this.options.projection;if(!(e=e?t.getProjectionInstance(e):In))throw new Error("must provide a valid projection in map's spatial reference.");(e=h({},_n,e)).measureLength||h(e,An.DEFAULT),this._projection=e;var n,r=this.options.resolutions;if(!r&&(e.code&&(n=Hn[e.code])&&(r=n.resolutions,this.isEPSG="IDENTITY"!==e.code),!r))throw new Error("must provide valid resolutions in map's spatial reference.");this._resolutions=r;var i=this.options.fullExtent;if(!i&&(e.code&&(n=Hn[e.code])&&(i=n.fullExtent),!i))throw new Error("must provide a valid fullExtent in map's spatial reference.");if(f(i.left)?(this._fullExtent=new gn(i),i.left=i.xmin,i.right=i.xmax,i.top=i.ymax,i.bottom=i.ymin):this._fullExtent=new gn(new dn(i.left,i.top),new dn(i.right,i.bottom)),f(i.top)||f(i.bottom)||f(i.left)||f(i.right))throw new Error("must provide valid top/bottom/left/right in fullExtent.");h(this._fullExtent,i),this._projection.fullExtent=i;var o=i.right>=i.left?1:-1,a=i.top>=i.bottom?-1:1;this._transformation=new mn([o,a,0,0])},e.getResolutions=function(){return this._resolutions||[]},e.getResolution=function(t){var e=0|t;e<0?e=0:e>this._resolutions.length-1&&(e=this._resolutions.length-1);var n=this._resolutions[e];return p(t)||e===this._resolutions.length-1?n:n+(this._resolutions[e+1]-n)*(t-e)},e.getProjection=function(){return this._projection},e.getFullExtent=function(){return this._fullExtent},e.getTransformation=function(){return this._transformation},e.getMinZoom=function(){for(var t=0;t<this._resolutions.length;t++)if(!f(this._resolutions[t]))return t;return 0},e.getMaxZoom=function(){for(var t=this._resolutions.length-1;t>=0;t--)if(!f(this._resolutions[t]))return t;return this._resolutions.length-1},e.getZoomDirection=function(){return I(this._resolutions[this.getMinZoom()]-this._resolutions[this.getMaxZoom()])},e.toJSON=function(){return this.json||(this.json={resolutions:this._resolutions,fullExtent:{top:this._fullExtent.top,left:this._fullExtent.left,bottom:this._fullExtent.bottom,right:this._fullExtent.right},projection:this._projection.code}),this.json},t}(),Yn={maxVisualPitch:60,maxPitch:80,centerCross:!1,zoomInCenter:!1,zoomAnimation:!P,zoomAnimationDuration:330,panAnimation:!P,panAnimationDuration:600,zoomable:!0,enableInfoWindow:!0,hitDetect:!ee.mobile,hitDetectLimit:5,fpsOnInteracting:25,layerCanvasLimitOnInteracting:-1,maxZoom:null,minZoom:null,maxExtent:null,fixCenterOnResize:!1,checkSize:!0,renderer:"canvas"},Jn=function(t){function e(e,n){var r;if(!n)throw new Error("Invalid options when creating map.");if(!n.center)throw new Error("Invalid center when creating map.");var i=h({},n),o=i.zoom;delete i.zoom;var a=new dn(i.center);delete i.center;var s=i.baseLayer;delete i.baseLayer;var u=i.layers;return delete i.layers,r=t.call(this,i)||this,Object.defineProperty(re(re(r)),"id",{value:A(),writable:!1}),r._loaded=!1,r._initContainer(e),r._panels={},r._baseLayer=null,r._layers=[],r._zoomLevel=o,r._center=a,r.setSpatialReference(i.spatialReference||i.view),r._mapViewPoint=new oe(0,0),r._initRenderer(),r._updateMapSize(r._getContainerDomSize()),s&&r.setBaseLayer(s),u&&r.addLayer(u),r._Load(),r}ne(e,t),e.addOnLoadHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._onLoadHooks=this.prototype._onLoadHooks||[],this.prototype._onLoadHooks.push(n),this};var n=e.prototype;return n.isLoaded=function(){return!!this._loaded},n.getContainer=function(){return this._containerDOM},n.getSpatialReference=function(){return this._spatialReference},n.setSpatialReference=function(t){var e=this.options.spatialReference;return this._loaded&&Xn.equals(e,t)?this:(this._updateSpatialReference(t,e),this)},n._updateSpatialReference=function(t,e){if(t=h({},t),this._center=this.getCenter(),this.options.spatialReference=t,this._spatialReference=new Xn(t),this.options.spatialReference&&y(this.options.spatialReference.projection)){var n=this._spatialReference.getProjection();this.options.spatialReference.projection=n.code}return this._resetMapStatus(),this._fireEvent("spatialreferencechange",{old:e,new:h({},this.options.spatialReference)}),this},n.onConfig=function(t){var e=t.spatialReference||t.view;return f(e)||this._updateSpatialReference(e,null),this},n.getProjection=function(){return this._spatialReference?this._spatialReference.getProjection():null},n.getFullExtent=function(){return this._spatialReference?this._spatialReference.getFullExtent():null},n.setCursor=function(t){return delete this._cursor,this._trySetCursor(t),this._cursor=t,this},n.resetCursor=function(){return this.setCursor(null)},n.getCenter=function(){return this._loaded&&this._prjCenter?this.getProjection().unproject(this._prjCenter):this._center},n.setCenter=function(t){if(!t)return this;if(t=new dn(t),!this._verifyExtent(t))return this;if(!this._loaded)return this._center=t,this;this.onMoveStart();var e=this.getProjection().project(t);return this._setPrjCenter(e),this.onMoveEnd(this._parseEventFromCoord(this.getCenter())),this},n.getSize=function(){return f(this.width)||f(this.height)?this._getContainerDomSize():new ae(this.width,this.height)},n.getContainerExtent=function(){var t=this.height,e=this.getPitch(),n=this.options.maxVisualPitch;return n&&e>n&&(t=this._getVisualHeight(n)),new yn(0,this.height-t,this.width,this.height)},n._getVisualHeight=function(t){var e=this.getPitch(),n=this.height/2*Math.tan(t*Math.PI/180);return this.height/2+n*Math.tan((90-e)*Math.PI/180)},n.getExtent=function(){return this._pointToExtent(this._get2DExtent())},n.getProjExtent=function(){var t=this._get2DExtent();return new gn(this._pointToPrj(t.getMin()),this._pointToPrj(t.getMax()))},n.getPrjExtent=function(){return this.getProjExtent()},n.getMaxExtent=function(){return this.options.maxExtent?new gn(this.options.maxExtent,this.getProjection()):null},n.setMaxExtent=function(t){if(t){var e=new gn(t,this.getProjection());this.options.maxExtent=e;var n=this.getCenter();this._verifyExtent(n)||this.panTo(e.getCenter())}else delete this.options.maxExtent;return this},n.getZoom=function(){return this._zoomLevel},n.getZoomForScale=function(t,e,n){var r=this.getZoom();if(f(e)&&(e=r),1===t&&e===r)return r;var i=this._getResolution(e)/t,o=this.getZoomFromRes(i);if(n)return o;return this.getSpatialReference().getZoomDirection()<0?Math.ceil(o-1e-6):Math.floor(o+1e-6)},n.getZoomFromRes=function(t){var e=this._getResolutions(),n=this._getResolution(this.getMinZoom()),r=this._getResolution(this.getMaxZoom());if(n<=r){if(t<=n)return this.getMinZoom();if(t>=r)return this.getMaxZoom()}else{if(t>=n)return this.getMinZoom();if(t<=r)return this.getMaxZoom()}for(var i=e.length,o=0;o<i-1;o++)if(e[o]){var a=e[o+1]-e[o],s=t-e[o];if(I(a)===I(s)&&Math.abs(a)>=Math.abs(s))return o+s/a}return i-1},n.setZoom=function(t,e){return void 0===e&&(e={animation:!0}),isNaN(t)||f(t)?this:(this._loaded&&this.options.zoomAnimation&&e.animation?this._zoomAnimation(t):this._zoom(t),this)},n.getMaxZoom=function(){return f(this.options.maxZoom)?this.getMaxNativeZoom():this.options.maxZoom},n.setMaxZoom=function(t){var e=this.getMaxNativeZoom();return t>e&&(t=e),null!==t&&t<this._zoomLevel&&this.setZoom(t),this.options.maxZoom=t,this},n.getMinZoom=function(){return f(this.options.minZoom)?this._spatialReference.getMinZoom():this.options.minZoom},n.setMinZoom=function(t){if(null!==t){var e=this._spatialReference.getMinZoom();t<e&&(t=e),t>this._zoomLevel&&this.setZoom(t)}return this.options.minZoom=t,this},n.getMaxNativeZoom=function(){var t=this.getSpatialReference();return t?t.getMaxZoom():null},n.getGLZoom=function(){return this.getMaxNativeZoom()/2},n.getGLScale=function(t){return f(t)&&(t=this.getZoom()),this.getScale(t)/this.getScale(this.getGLZoom())},n.zoomIn=function(){return this.setZoom(this.getZoom()+1)},n.zoomOut=function(){return this.setZoom(this.getZoom()-1)},n.isZooming=function(){return!!this._zooming},n.isInteracting=function(){return this.isZooming()||this.isMoving()||this.isRotating()},n.setCenterAndZoom=function(t,e){return f(e)||this._zoomLevel===e?this.setCenter(t):(this.setCenter(t),this.setZoom(e,{animation:!1})),this},n.getFitZoom=function(t){var e=this;if(!(t&&t instanceof gn))return this._zoomLevel;if(t.xmin===t.xmax&&t.ymin===t.ymax)return this.getMaxZoom();var n=this.getSize(),r=t.convertTo(function(t){return e.coordToContainerPoint(t)}),i=r.getWidth(),o=r.getHeight(),a=n.width/i,s=n.height/o,u=this.getSpatialReference().getZoomDirection()<0?Math.max(a,s):Math.min(a,s);return this.getZoomForScale(u)},n.getView=function(){return{center:this.getCenter().toArray(),zoom:this.getZoom(),pitch:this.getPitch(),bearing:this.getBearing()}},n.setView=function(t){return t?(t.center&&this.setCenter(t.center),null===t.zoom||isNaN(+t.zoom)||this.setZoom(+t.zoom,{animation:!1}),null===t.pitch||isNaN(+t.pitch)||this.setPitch(+t.pitch),null===t.pitch||isNaN(+t.bearing)||this.setBearing(+t.bearing),this):this},n.getResolution=function(t){return this._getResolution(t)},n.getScale=function(t){var e=f(t)?this.getZoom():t,n=this._getResolution(this.getMaxNativeZoom());return this._getResolution(e)/n},n.fitExtent=function(t,e,n,r){if(void 0===n&&(n={}),!t)return this;t=new gn(t,this.getProjection());var i=this.getFitZoom(t)+(e||0),o=t.getCenter();return void 0===n.animation||n.animation?this.animateTo({center:o,zoom:i},{duration:n.duration||this.options.zoomAnimationDuration,easing:n.easing||"out"},r):this.setCenterAndZoom(o,i)},n.getBaseLayer=function(){return this._baseLayer},n.setBaseLayer=function(t){var e=!1;if(this._baseLayer&&(e=!0,this._fireEvent("baselayerchangestart"),this._baseLayer.remove()),!t)return delete this._baseLayer,this._fireEvent("baselayerchangeend"),this._fireEvent("setbaselayer"),this;return this._baseLayer=t,t._bindMap(this,-1),this._baseLayer.on("layerload",function(){this._fireEvent("baselayerload"),e&&(e=!1,this._fireEvent("baselayerchangeend"))},this),this._loaded&&this._baseLayer.load(),this._fireEvent("setbaselayer"),this},n.removeBaseLayer=function(){return this._baseLayer&&(this._baseLayer.remove(),delete this._baseLayer,this._fireEvent("baselayerremove")),this},n.getLayers=function(t){return this._getLayers(function(e){return!(e===this._baseLayer||e.getId().indexOf("_maptalks__internal_layer_")>=0)&&(!t||t(e))})},n.getLayer=function(t){if(!t)return null;var e=this._layerCache?this._layerCache[t]:null;if(e)return e;var n=this.getBaseLayer();return n&&n.getId()===t?n:null},n.addLayer=function(t){if(!t)return this;if(!Array.isArray(t))return t=Array.prototype.slice.call(arguments,0),this.addLayer(t);this._layerCache||(this._layerCache={});for(var e=this._layers,n=0,r=t.length;n<r;n++){var i=t[n],o=i.getId();if(f(o))throw new Error("Invalid id for the layer: "+o);if(i.getMap()!==this){if(this._layerCache[o])throw new Error("Duplicate layer id in the map: "+o);this._layerCache[o]=i,i._bindMap(this),e.push(i),this._loaded&&i.load()}}return this._sortLayersByZIndex(),this._fireEvent("addlayer",{layers:t}),this},n.removeLayer=function(t){if(!t)return this;if(!Array.isArray(t))return this.removeLayer([t]);for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];if(i instanceof Wn||(i=this.getLayer(i)),i){var o=i.getMap();if(o&&o===this){e.push(i),this._removeLayer(i,this._layers),this._loaded&&i._doRemove();var a=i.getId();this._layerCache&&delete this._layerCache[a]}}}return e.length>0&&this.once("frameend",function(){e.forEach(function(t){t.fire("remove")})}),this._fireEvent("removelayer",{layers:t}),this},n.sortLayers=function(t){if(!t||!Array.isArray(t))return this;for(var e=[],n=Number.MAX_VALUE,r=0,i=t.length;r<i;r++){var o=t[r];if(g(t[r])&&(o=this.getLayer(o)),!(o instanceof Wn&&o.getMap()&&o.getMap()===this))throw new Error("It must be a layer added to this map to order.");o.getZIndex()<n&&(n=o.getZIndex()),e.push(o)}for(var a=0,s=e.length;a<s;a++)e[a].setZIndex(n+a);return this},n.toDataURL=function(t){t||(t={});var e=t.mimeType;e||(e="image/png");var n=t.save,r=this._getRenderer();if(r&&r.toDataURL){var i=t.fileName;i||(i="export");var o=r.toDataURL(e);if(n&&o){var a;if("undefined"!=typeof Blob&&"undefined"!=typeof atob){var s=Y(o.replace(/^data:image\/(png|jpeg|jpg);base64,/,""),e);a=URL.createObjectURL(s)}else a=o;var u=document.createElement("a");u.download=i,u.href=a,document.body.appendChild(u),u.click(),document.body.removeChild(u)}return o}return null},n.coordinateToPoint=function(t,e){var n=this.getProjection().project(t);return this._prjToPoint(n,e)},n.coordToPoint=function(t,e){return this.coordinateToPoint(t,e)},n.pointToCoordinate=function(t,e){var n=this._pointToPrj(t,e);return this.getProjection().unproject(n)},n.pointToCoord=function(t,e){return this.pointToCoordinate(t,e)},n.coordinateToViewPoint=function(t){return this._prjToViewPoint(this.getProjection().project(t))},n.coordToViewPoint=function(t){return this.coordinateToViewPoint(t)},n.viewPointToCoordinate=function(t){return this.getProjection().unproject(this._viewPointToPrj(t))},n.viewPointToCoord=function(t){return this.viewPointToCoordinate(t)},n.coordinateToContainerPoint=function(t,e){var n=this.getProjection().project(t);return this._prjToContainerPoint(n,e)},n.coordToContainerPoint=function(t,e){return this.coordinateToContainerPoint(t,e)},n.containerPointToCoordinate=function(t){var e=this._containerPointToPrj(t);return this.getProjection().unproject(e)},n.containerPointToCoord=function(t){return this.containerPointToCoordinate(t)},n.containerPointToViewPoint=function(t){return t.sub(this.getViewPoint())},n.viewPointToContainerPoint=function(t){return t.add(this.getViewPoint())},n.containerToExtent=function(t){var e=new yn(this._containerPointToPoint(t.getMin()),this._containerPointToPoint(t.getMax()));return this._pointToExtent(e)},n.checkSize=function(){var t=l()-this._initTime<1500&&0===this.width||0===this.height,e=this._getContainerDomSize(),n=this.height,r=this.width;if(e.width===r&&e.height===n)return this;var i=this.getCenter();if(this._updateMapSize(e),!this.options.fixCenterOnResize){var o=new oe((r-e.width)/2,(n-e.height)/2);this._offsetCenterByPixel(o),this._mapViewCoord=this._getPrjCenter()}var a=0===e.width||0===e.height||0===r||0===n;return(t||a)&&(this._noEvent=!0,this.setCenter(i),delete this._noEvent),this._fireEvent("resize"),this},n.distanceToPixel=function(t,e,n){var r=this.getProjection();if(!r)return null;var i=this.getScale()/this.getScale(n),o=this.getCenter(),a=r.locate(o,t,e),s=this.coordToContainerPoint(o),u=this.coordToContainerPoint(a);return u._sub(s)._multi(i)._abs(),new ae(u.x,u.y)},n.distanceToPoint=function(t,e,n){var r=this.getProjection();if(!r)return null;var i=this.getCenter(),o=r.locate(i,t,e),a=this.coordToPoint(i,n),s=this.coordToPoint(o,n);return s._sub(a)._abs(),s},n.pixelToDistance=function(t,e){var n=this.getProjection();if(!n)return null;var r=this.getFullExtent(),i=r.top>r.bottom?-1:1,o=new oe(this.width/2+t,this.height/2+i*e),a=this.containerPointToCoord(o);return n.measureLength(this.getCenter(),a)},n.pointToDistance=function(t,e,n){var r=this.getProjection();if(!r)return null;var i=this._prjToPoint(this._getPrjCenter(),n);i._add(t,e);var o=this.pointToCoord(i,n);return r.measureLength(this.getCenter(),o)},n.locate=function(t,e,n){return this.getProjection()._locate(new dn(t),e,n)},n.locateByPoint=function(t,e,n){var r=this.coordToContainerPoint(t);return this.containerPointToCoord(r._add(e,n))},n.getMainPanel=function(){return this._getRenderer().getMainPanel()},n.getPanels=function(){return this._panels},n.remove=function(){if(this.isRemoved())return this;this._fireEvent("removestart"),this._removeDomEvents(),this._clearHandlers(),this.removeBaseLayer();for(var t=this.getLayers(),e=0;e<t.length;e++)t[e].remove();return this._getRenderer()&&this._getRenderer().remove(),this._containerDOM.innerHTML&&(this._containerDOM.innerHTML=""),delete this._panels,delete this._containerDOM,delete this.renderer,this._fireEvent("removeend"),this._clearAllListeners(),this},n.isRemoved=function(){return!this._containerDOM},n.isMoving=function(){return!!this._moving},n.onMoveStart=function(t){this._originCenter=this.getCenter(),this._moving=!0,this._trySetCursor("move"),this._fireEvent("movestart",this._parseEvent(t?t.domEvent:null,"movestart"))},n.onMoving=function(t){this._fireEvent("moving",this._parseEvent(t?t.domEvent:null,"moving"))},n.onMoveEnd=function(t){if(this._moving=!1,this._trySetCursor("default"),this._fireEvent("moveend",t&&t.domEvent?this._parseEvent(t.domEvent,"moveend"):t),!this._verifyExtent(this.getCenter())){var e=this._originCenter;this._verifyExtent(e)||(e=this.getMaxExtent().getCenter()),this.panTo(e)}},n.onDragRotateStart=function(t){this._dragRotating=!0,this._fireEvent("dragrotatestart",this._parseEvent(t?t.domEvent:null,"dragrotatestart"))},n.onDragRotating=function(t){this._fireEvent("dragrotating",this._parseEvent(t?t.domEvent:null,"dragrotating"))},n.onDragRotateEnd=function(t){this._dragRotating=!1,this._fireEvent("dragrotateend",this._parseEvent(t?t.domEvent:null,"dragrotateend"))},n.isDragRotating=function(){return!!this._dragRotating},n.getRenderer=function(){return this._getRenderer()},n._initContainer=function(t){if(g(t)){if(this._containerDOM=document.getElementById(t),!this._containerDOM)throw new Error("Invalid container when creating map: '"+t+"'")}else this._containerDOM=t,P&&(this.CanvasClass=this._containerDOM.constructor);if(this._containerDOM.childNodes&&this._containerDOM.childNodes.length>0&&"maptalks-wrapper"===this._containerDOM.childNodes[0].className)throw new Error("Container is already loaded with another map instance, use map.remove() to clear it.")},n._trySetCursor=function(t){return this._cursor||this._priorityCursor||(t||(t="default"),this._setCursorToPanel(t)),this},n._setPriorityCursor=function(t){if(t)this._priorityCursor=t,this._setCursorToPanel(t);else{var e=!1;this._priorityCursor&&(e=!0),delete this._priorityCursor,e&&this.setCursor(this._cursor)}return this},n._setCursorToPanel=function(t){var e=this.getMainPanel();e&&e.style&&e.style.cursor!==t&&(e.style.cursor=t)},n._get2DExtent=function(t){var e=this;return this.getContainerExtent().convertTo(function(n){return e._containerPointToPoint(n,t)})},n._pointToExtent=function(t){var e=t.getMin(),n=t.getMax(),r=this.getFullExtent(),i=!r||r.left<=r.right?[e.x,n.x]:[n.x,e.x],o=i[0],a=i[1],s=!r||r.top>r.bottom?[n.y,e.y]:[e.y,n.y],u=s[1],c=new dn(o,s[0]),l=new dn(a,u);return new gn(this.pointToCoord(c),this.pointToCoord(l),this.getProjection())},n._removeLayer=function(t,e){if(t&&e){var n=e.indexOf(t);n>-1&&e.splice(n,1)}},n._sortLayersByZIndex=function(){if(this._layers){for(var t=0,e=this._layers.length;t<e;t++)this._layers[t]._order=t;this._layers.sort(function(t,e){var n=t.getZIndex()-e.getZIndex();return 0===n?t._order-e._order:n})}},n._fireEvent=function(t,e){this._noEvent||(this.fire("_"+t,e),this.fire(t,e))},n._Load=function(){this._resetMapStatus(),this.options.pitch&&(this.setPitch(this.options.pitch),delete this.options.pitch),this.options.bearing&&(this.setBearing(this.options.bearing),delete this.options.bearing),this._loadAllLayers(),this._getRenderer().onLoad(),this._loaded=!0,this._callOnLoadHooks(),this._initTime=l()},n._initRenderer=function(){var t=this.options.renderer,n=e.getRendererClass(t);this._renderer=new n(this),this._renderer.load()},n._getRenderer=function(){return this._renderer},n._loadAllLayers=function(){this._baseLayer&&this._baseLayer.load(),this._eachLayer(function(t){t&&t.load()},this.getLayers())},n._getLayers=function(t){for(var e=this._baseLayer?[this._baseLayer].concat(this._layers):this._layers,n=[],r=0;r<e.length;r++)t&&!t.call(this,e[r])||n.push(e[r]);return n},n._eachLayer=function(t){if(!(arguments.length<2)){var e=Array.prototype.slice.call(arguments,1);e&&!Array.isArray(e)&&(e=[e]);for(var n=[],r=0,i=e.length;r<i;r++)n=n.concat(e[r]);for(var o=0,a=n.length;o<a;o++)t.call(t,n[o])}},n._onLayerEvent=function(t){t&&"idchange"===t.type&&(delete this._layerCache[t.old],this._layerCache[t.new]=t.target)},n._resetMapStatus=function(){var t=this.getMaxZoom(),e=this.getMinZoom(),n=this._spatialReference.getMaxZoom(),r=this._spatialReference.getMinZoom();(f(t)||-1===t||t>n)&&this.setMaxZoom(n),(f(e)||-1===e||e<r)&&this.setMinZoom(r),(t=this.getMaxZoom())<(e=this.getMinZoom())&&this.setMaxZoom(e),(f(this._zoomLevel)||this._zoomLevel>t)&&(this._zoomLevel=t),this._zoomLevel<e&&(this._zoomLevel=e),delete this._prjCenter;var i=this.getProjection();this._prjCenter=i.project(this._center),this._calcMatrices();var o=this._getRenderer();o&&o.resetContainer()},n._getContainerDomSize=function(){if(!this._containerDOM)return null;var t,e,n=this._containerDOM;if(f(n.width)||f(n.height)){if(f(n.clientWidth)||f(n.clientHeight))throw new Error("can not get size of container");t=parseInt(n.clientWidth,0),e=parseInt(n.clientHeight,0)}else t=n.width,e=n.height,ee.retina&&n.layer&&(t/=2,e/=2);return new ae(t,e)},n._updateMapSize=function(t){return this.width=t.width,this.height=t.height,this._getRenderer().updateMapSize(t),this._calcMatrices(),this},n._getPrjCenter=function(){return this._prjCenter},n._setPrjCenter=function(t){this._prjCenter=t,this.isInteracting()&&!this.isMoving()&&(this._mapViewCoord=t),this._calcMatrices()},n._setPrjCoordAtContainerPoint=function(t,e){if(e.x===this.width/2&&e.y===this.height/2)return this;var n=this._containerPointToPoint(e)._sub(this._prjToPoint(this._getPrjCenter())),r=this._pointToPrj(this._prjToPoint(t).sub(n));return this._setPrjCenter(r),this},n._verifyExtent=function(t){if(!t)return!1;var e=this.getMaxExtent();return!e||e.contains(t)},n._offsetCenterByPixel=function(t){var e=new oe(this.width/2-t.x,this.height/2-t.y),n=this._containerPointToPrj(e);return this._setPrjCenter(n),n},n.offsetPlatform=function(t){return t?(this._getRenderer().offsetPlatform(t),this._mapViewCoord=this._getPrjCenter(),this._mapViewPoint=this._mapViewPoint.add(t),this):this._mapViewPoint},n.getViewPoint=function(){var t=this._getViewPointFrameOffset(),e=this.offsetPlatform();return t&&(e=e.add(t)),e},n._getViewPointFrameOffset=function(){if(this.isZooming())return null;var t=this._getPrjCenter();return this._mapViewCoord&&!this._mapViewCoord.equals(t)?this._prjToContainerPoint(this._mapViewCoord).sub(this._prjToContainerPoint(t)):null},n._resetMapViewPoint=function(){this._mapViewPoint=new oe(0,0),this._mapViewCoord=this._getPrjCenter()},n._getResolution=function(t){return f(t)&&(t=this.getZoom()),this._spatialReference.getResolution(t)},n._getResolutions=function(){return this._spatialReference.getResolutions()},n._prjToPoint=function(t,e){return e=f(e)?this.getZoom():e,this._spatialReference.getTransformation().transform(t,this._getResolution(e))},n._pointToPrj=function(t,e){return e=f(e)?this.getZoom():e,this._spatialReference.getTransformation().untransform(t,this._getResolution(e))},n._pointToPoint=function(t,e){return f(e)?t.copy():t.multi(this._getResolution(e)/this._getResolution())},n._pointToPointAtZoom=function(t,e){return f(e)?t.copy():t.multi(this._getResolution()/this._getResolution(e))},n._containerPointToPrj=function(t){return this._pointToPrj(this._containerPointToPoint(t))},n._viewPointToPrj=function(t){return this._containerPointToPrj(this.viewPointToContainerPoint(t))},n._prjToContainerPoint=function(t,e){return this._pointToContainerPoint(this._prjToPoint(t,e),e)},n._prjToViewPoint=function(t){var e=this._prjToContainerPoint(t);return this._containerPointToViewPoint(e)},n._containerPointToViewPoint=function(t){return t?t._sub(this.getViewPoint()):null},n._viewPointToPoint=function(t,e){return this._containerPointToPoint(this.viewPointToContainerPoint(t),e)},n._pointToViewPoint=function(t,e){return this._prjToViewPoint(this._pointToPrj(t,e))},n._callOnLoadHooks=function(){var t=e.prototype;if(t._onLoadHooks)for(var n=0,r=t._onLoadHooks.length;n<r;n++)t._onLoadHooks[n].call(this)},e}(cn(rn(Fn(an))));Jn.mergeOptions(Yn);var qn=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.addHooks=function(){this.target&&this.target.on("_dblclick",this._onDoubleClick,this)},n.removeHooks=function(){this.target&&this.target.off("_dblclick",this._onDoubleClick,this)},n._onDoubleClick=function(t){var e=this.target;if(e.options.doubleClickZoom){var n=e.getZoom(),r=t.domEvent.shiftKey?Math.ceil(n)-1:Math.floor(n)+1;e._zoomAnimation(r,t.containerPoint)}},e}(on);Jn.mergeOptions({doubleClickZoom:!0}),Jn.addOnLoadHook("addHandler","doubleClickZoom",qn);var Qn,Kn=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.addHooks=function(){var t=this.target;if(t){var e=t._panels.mapWrapper||t._containerDOM;this._dragHandler=new fn(e,{cancelOn:this._cancelOn.bind(this),rightclick:!0}),this._dragHandler.on("mousedown",this._onMouseDown,this).on("dragstart",this._onDragStart,this).on("dragging",this._onDragging,this).on("dragend",this._onDragEnd,this).enable()}},n.removeHooks=function(){this._dragHandler.off("mousedown",this._onMouseDown,this).off("dragstart",this._onDragStart,this).off("dragging",this._onDragging,this).off("dragend",this._onDragEnd,this),this._dragHandler.remove(),delete this._dragHandler},n._cancelOn=function(t){return!(!this.target.isZooming()&&!this._ignore(t))},n._ignore=function(t){return!!t&&(t.domEvent&&(t=t.domEvent),this.target._ignoreEvent(t))},n._onMouseDown=function(t){delete this.startDragTime,delete this._mode,2===t.domEvent.button||t.domEvent.ctrlKey?(this.target.options.dragRotate||this.target.options.dragPitch)&&(this._mode="rotatePitch"):this.target.options.dragPan&&(this._mode="move"),this.target._stopAnim(this.target._animPlayer),Re(t.domEvent)},n._onDragStart=function(t){this.startDragTime=l(),"move"===this._mode?this._moveStart(t):"rotatePitch"===this._mode&&this._rotateStart(t)},n._onDragging=function(t){this.target._isEventOutMap(t.domEvent)||("move"===this._mode?this._moving(t):"rotatePitch"===this._mode&&this._rotating(t))},n._onDragEnd=function(t){"move"===this._mode?this._moveEnd(t):"rotatePitch"===this._mode&&this._rotateEnd(t),delete this.startDragTime,delete this.startBearing},n._start=function(t){this.preX=t.mousePos.x,this.preY=t.mousePos.y,this.startX=this.preX,this.startY=this.preY},n._moveStart=function(t){this._start(t);var e=this.target;e.onMoveStart(t);var n=Ne(e._getActualEvent(t.domEvent),e.getContainer());this.startPrjCoord=e._containerPointToPrj(n)},n._moving=function(t){if(this.startDragTime){var e=this.target,n=Ne(e._getActualEvent(t.domEvent),e.getContainer());e._setPrjCoordAtContainerPoint(this.startPrjCoord,n),e.onMoving(t)}},n._moveEnd=function(t){if(this.startDragTime){var e=this.target,n=l()-this.startDragTime,r=t.mousePos.x,i=t.mousePos.y,o=r-this.startX,a=i-this.startY;this._clear(),e.options.panAnimation&&!t.interupted&&e._verifyExtent(e.getCenter())&&n<280&&Math.abs(a)+Math.abs(o)>5?(n=5*n*(Math.abs(o)+Math.abs(a))/500,e.panBy(new oe(o,a),{duration:n})):e.onMoveEnd(t)}},n._rotateStart=function(t){this._start(t),delete this._rotateMode,this.startBearing=this.target.getBearing(),this.target.onDragRotateStart(t),this._db=0},n._rotating=function(t){var e=this.target,n=t.mousePos.x,r=t.mousePos.y,i=e.getPitch(),o=e.getBearing(),a=Math.abs(n-this.preX),s=Math.abs(r-this.preY);if(this._rotateMode||(e.options.dragRotatePitch?this._rotateMode="rotate_pitch":this._rotateMode=a>s?"rotate":a<s?"pitch":"rotate"),!("pitch"===this._rotateMode&&0===i&&s<10)){if(this._rotateMode.indexOf("rotate")>=0&&e.options.dragRotate){var u=0;u=e.options.dragPitch||a>s?-.6*(this.preX-n):n>e.width/2?.6*(this.preY-r):-.6*(this.preY-r);var c=e.getBearing()+u;this._db=this._db||0,this._db+=u,e.setBearing(c)}this._rotateMode.indexOf("pitch")>=0&&e.options.dragPitch&&e.setPitch(e.getPitch()+.4*(this.preY-r)),this.preX=n,this.preY=r,e.getBearing()===o&&e.getPitch()===i||e.onDragRotating(t)}},n._rotateEnd=function(t){var e=this.target,n=e.getBearing();this._clear();var r=l()-this.startDragTime;if(e.onDragRotateEnd(t),Math.abs(n-this.startBearing)>20&&("rotate"===this._rotateMode||"rotate_pitch"===this._rotateMode)&&!t.interupted&&r<400){var i=e.getBearing();e.animateTo({bearing:i+this._db/2},{easing:"out",duration:800})}},n._clear=function(){delete this.startPrjCoord,delete this.preX,delete this.preY,delete this.startX,delete this.startY},e}(on);function $n(t,e,n,r){for(var i,o=[],a=0,s=0,u=t.length;s<u-1;s++)(i=tr(t[s],t[s+1],e,s,n,r))&&(o[a]=o[a]||[],o[a].push({point:i[0],index:s}),i[1]===t[s+1]&&s!==u-2||(o[a].push({point:i[1],index:s+1}),a++));return o}function tr(t,e,n,r,i,o){var a,s,u,c=r?Qn:rr(t,n),l=rr(e,n);for(Qn=l;;){if(!(c|l))return[t,e];if(c&l)return!1;if(o)return[t,e];u=rr(s=nr(t,e,a=c||l,n,i),n),a===c?(t=s,c=u):(e=s,l=u)}}function er(t,e,n){var r,i,o,a,s,u,c,l,h,f=[1,4,2,8];for(i=0,c=t.length;i<c;i++)t[i]._code=rr(t[i],e);for(a=0;a<4;a++){for(l=f[a],r=[],i=0,o=(c=t.length)-1;i<c;o=i++)s=t[i],u=t[o],s._code&l?u._code&l||((h=nr(u,s,l,e,n))._code=rr(h,e),r.push(h)):(u._code&l&&((h=nr(u,s,l,e,n))._code=rr(h,e),r.push(h)),r.push(s));t=r}return t}function nr(t,e,n,r,i){var o,a,s=e.x-t.x,u=e.y-t.y,c=r.getMin(),l=r.getMax();8&n?(o=t.x+s*(l.y-t.y)/u,a=l.y):4&n?(o=t.x+s*(c.y-t.y)/u,a=c.y):2&n?(o=l.x,a=t.y+u*(l.x-t.x)/s):1&n&&(o=c.x,a=t.y+u*(c.x-t.x)/s);var h=new oe(o,a);return i&&h._round(),h}function rr(t,e){var n=0;return t.x<e.getMin().x?n|=1:t.x>e.getMax().x&&(n|=2),t.y<e.getMin().y?n|=4:t.y>e.getMax().y&&(n|=8),n}function ir(t,e,n,r){t=new oe(t);var i,o,a,s=Math.abs(n.x-e.x),u=Math.abs(n.y-e.y),c=Math.sqrt(Math.abs(s*s-u*u));return s>=u?(i=new oe(e.x-c,e.y),o=new oe(e.x+c,e.y),a=2*s):(i=new oe(e.x,e.y-c),o=new oe(e.x,e.y+c),a=2*u),t.distanceTo(i)+t.distanceTo(o)<=a+2*r}Jn.mergeOptions({draggable:!0,dragPan:!0,dragRotatePitch:!0,dragRotate:!0,dragPitch:!0}),Jn.addOnLoadHook("addHandler","draggable",Kn);var or=function(){function t(){}var e=t.prototype;return e.getMap=function(){return this.geometry.getMap()},e.getPainter=function(){return this.painter},t.testColor=function(t){return!(!t||!g(t))&&c.indexOf(t)>=0},t}(),ar=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n._prepareContext=function(t){d(this.symbol.opacity)?t.globalAlpha!==this.symbol.opacity&&(t.globalAlpha=this.symbol.opacity):1!==t.globalAlpha&&(t.globalAlpha=1)},n.prepareCanvas=function(t,e,n){Ke.prepareCanvas(t,e,n,this.getPainter().isHitTesting())},n.remove=function(){},n.setZIndex=function(){},n.show=function(){},n.hide=function(){},n._defineStyle=function(t){return function(){var e=this,n=[],r={};return xt(t,function(){var t=e.getMap();return function(t,e,n){return t[0]=e,t[1]=n,t}(n,t.getZoom(),h({},e.geometry.getProperties(),function(t,e,n,r){return t["{bearing}"]=e,t["{pitch}"]=n,t["{zoom}"]=r,t}(r,t.getBearing(),t.getPitch(),t.getZoom())))})}.bind(this)()},e}(or);var sr=function(t){function e(e,n,r){var i;return(i=t.call(this)||this).symbol=e,i.geometry=n,i.painter=r,i}ne(e,t);var n=e.prototype;return n.get2DExtent=function(){for(var t=this.getMap(),e=t.getGLZoom(),n=new yn,r=this._getRenderPoints()[0],i=r.length-1;i>=0;i--)r[i]&&n._combine(t._pointToPoint(r[i],e));return n},n._rotateExtent=function(t,e){return t.convertTo(function(t){return t._rotate(e)})},n._getRenderPoints=function(){return this.getPainter().getRenderPoints(this.getPlacement())},n._getRenderContainerPoints=function(t){var e=this.getPainter(),n=this._getRenderPoints()[0];if(e.isSpriting())return n;var r=this.getDxDy(),i=this.painter._pointContainerPoints(n,r.x,r.y,t,!0,this.getPlacement());if(!i||!Array.isArray(i[0]))return i;for(var o=[],a=0,s=i.length;a<s;a++)for(var u=0,c=i[a].length;u<c;u++)o.push(i[a][u]);return o},n._getRotationAt=function(t){var e=this.getRotation();e||(e=0);var n=this._getRenderPoints()[1];if(!n||!n[t])return e;var r=this.getMap(),i=n[t][0],o=n[t][1];if(r.isTransforming()){var a=r.getGLZoom();i=r._pointToContainerPoint(n[t][0],a),o=r._pointToContainerPoint(n[t][1],a)}return e+J(i.x,i.y,o.x,o.y)},n._rotate=function(t,e,n){if(n){var r=this.getDxDy(),i=e.sub(r);return t.save(),t.translate(i.x,i.y),t.rotate(n),this.getDxDy()}return null},e}(ar),ur=function(t){function e(n,r,i){var o;(o=t.call(this,n,r,i)||this)._dynamic=bt(n),o.style=o._defineStyle(o.translate()),o.strokeAndFill=o._defineStyle(e.translateLineAndFill(o.style));var a=o.strokeAndFill.lineWidth;return o.padding=a%2==0?2:1.5,o}ne(e,t),e.test=function(t){return!!t&&!(!f(t.markerFile)||f(t.markerType)||"path"===t.markerType)};var n=e.prototype;return n.symbolize=function(t,e){var n=this.style;if(this.painter.isHitTesting()||0!==n.markerWidth&&0!==n.markerHeight&&(0!==n.polygonOpacity||0!==n.lineOpacity)){var r=this._getRenderContainerPoints();U(r)&&(this._prepareContext(t),this.getPainter().isSpriting()||this.geometry.getLayer().getMask()===this.geometry||this._dynamic||!1===this.geometry.getLayer().options.cacheVectorOnCanvas?this._drawMarkers(t,r,e):this._drawMarkersWithCache(t,r,e))}},n.getDxDy=function(){var t=this.style,e=t.markerDx,n=t.markerDy;return new oe(e,n)},n._drawMarkers=function(t,e,n){var r=this.strokeAndFill;At(r.lineColor)||At(r.polygonFill)||this.prepareCanvas(t,r,n);for(var i=e.length-1;i>=0;i--){var o=e[i],a=this._rotate(t,o,this._getRotationAt(i));a&&(o=a),this._drawVectorMarker(t,o,n),a&&t.restore()}},n._drawMarkersWithCache=function(t,e,n){var r=this._stampSymbol(),i=n.getImage(r);i||(i=this._createMarkerImage(t,n),n.addResource([r,i.width,i.height],i));for(var o=this._getAnchor(i.width,i.height),a=e.length-1;a>=0;a--){var s=e[a],u=this._rotate(t,s,this._getRotationAt(a));u&&(s=u),Ke.image(t,i,s.x+o.x,s.y+o.y),u&&t.restore()}},n._calMarkerSize=function(){if(!this._size){var t=this.strokeAndFill.lineWidth,e=2*(this.symbol.shadowBlur||0),n=Math.round(this.style.markerWidth+t+2*e+2*this.padding),r=Math.round(this.style.markerHeight+t+2*e+2*this.padding);this._size=[n,r]}return this._size},n._createMarkerImage=function(t,e){var n=t.canvas.constructor,r=this._calMarkerSize(),i=Ke.createCanvas(r[0],r[1],n),o=this._getCacheImageAnchor(r[0],r[1]),a=i.getContext("2d");return At(this.strokeAndFill.lineColor)||At(this.strokeAndFill.polygonFill)||this.prepareCanvas(a,this.strokeAndFill,e),this._drawVectorMarker(a,o,e),i},n._stampSymbol=function(){return this._stamp||(this._stamp=[this.style.markerType,At(this.style.markerFill)?Mt(this.style.markerFill):this.style.markerFill,this.style.markerFillOpacity,this.style.markerFillPatternFile,At(this.style.markerLineColor)?Mt(this.style.markerLineColor):this.style.markerLineColor,this.style.markerLineWidth,this.style.markerLineOpacity,this.style.markerLineDasharray?this.style.markerLineDasharray.join(","):"",this.style.markerLinePatternFile,this.style.markerWidth,this.style.markerHeight,this.style.markerHorizontalAlignment,this.style.markerVerticalAlignment].join("_")),this._stamp},n._getAnchor=function(t,e){var n=2*(this.symbol.shadowBlur||0)+this.padding,r=_e(new ae(t,e),this.style.markerHorizontalAlignment,this.style.markerVerticalAlignment);return r.x!==-t/2&&(r.x-=I(r.x+t/2)*n),r.y!==-e/2&&(r.y-=I(r.y+e/2)*n),r},n._getCacheImageAnchor=function(t,e){var n=2*(this.symbol.shadowBlur||0)+this.padding,r=this.style.markerType;return"bar"===r||"pie"===r||"pin"===r?new oe(t/2,e-n):"rectangle"===r?new oe(n,n):new oe(t/2,e/2)},n._getGraidentExtent=function(t){var e=new yn,n=this.getDxDy(),r=this.getFixedExtent();if(Array.isArray(t))for(var i=t.length-1;i>=0;i--)e._combine(t[i]);else e._combine(t);return e.xmin+=r.xmin-n.x,e.ymin+=r.ymin-n.y,e.xmax+=r.xmax-n.x,e.ymax+=r.ymax-n.y,e},n._drawVectorMarker=function(t,n,r){var i,o=this.style,a=this.strokeAndFill,s=o.markerType.toLowerCase(),u=e._getVectorPoints(s,o.markerWidth,o.markerHeight),c=a.lineOpacity,l=a.polygonOpacity;(At(a.lineColor)||At(a.polygonFill))&&(At(a.lineColor)&&(i=this._getGraidentExtent(n),a.lineGradientExtent=i.expand(a.lineWidth)),At(a.polygonFill)&&(i||(i=this._getGraidentExtent(n)),a.polygonGradientExtent=i),this.prepareCanvas(t,a,r));var h=o.markerWidth,f=o.markerHeight,d=o.markerLineWidth/2;if("ellipse"===s)Ke.ellipse(t,n,h/2,f/2,c,l);else if("cross"===s||"x"===s){for(var p=u.length-1;p>=0;p--)u[p]._add(n);Ke.path(t,u.slice(0,2),c),Ke.path(t,u.slice(2,4),c)}else if("diamond"===s||"bar"===s||"square"===s||"rectangle"===s||"triangle"===s){"bar"===s?n=n.add(0,-d):"rectangle"===s&&(n=n.add(d,d));for(var v=u.length-1;v>=0;v--)u[v]._add(n);Ke.polygon(t,u,c,l)}else if("pin"===s){n=n.add(0,-d);for(var g=u.length-1;g>=0;g--)u[g]._add(n);var y=t.lineCap;t.lineCap="round",Ke.bezierCurveAndFill(t,u,c,l),t.lineCap=y}else{if("pie"!==s)throw new Error("unsupported markerType: "+s);n=n.add(0,-d);var m=180*Math.atan(h/2/f)/Math.PI,_=t.lineCap;t.lineCap="round",Ke.sector(t,n,f,[90-m,90+m],c,l),t.lineCap=_}},n.getPlacement=function(){return this.symbol.markerPlacement},n.getRotation=function(){var t=this.style.markerRotation;return d(t)?-t*Math.PI/180:null},n.getFixedExtent=function(){var t=this.getDxDy(),e=2*this.padding,n=this._calMarkerSize().map(function(t){return t-e}),r=this._getAnchor(n[0],n[1]),i=new yn(t.add(0,0),t.add(n[0],n[1]));i._add(r);var o=this.getRotation();return o&&(i=this._rotateExtent(i,o)),i},n.translate=function(){var t,e,n=this.symbol,r={markerType:L(n.markerType,"ellipse"),markerFill:L(n.markerFill,"#00f"),markerFillOpacity:L(n.markerFillOpacity,1),markerFillPatternFile:L(n.markerFillPatternFile,null),markerLineColor:L(n.markerLineColor,"#000"),markerLineWidth:L(n.markerLineWidth,1),markerLineOpacity:L(n.markerLineOpacity,1),markerLineDasharray:L(n.markerLineDasharray,[]),markerLinePatternFile:L(n.markerLinePatternFile,null),markerDx:L(n.markerDx,0),markerDy:L(n.markerDy,0),markerWidth:L(n.markerWidth,10),markerHeight:L(n.markerHeight,10),markerRotation:L(n.markerRotation,0)},i=r.markerType;return"bar"===i||"pie"===i||"pin"===i?(t="middle",e="top"):"rectangle"===i?(t="right",e="bottom"):(t="middle",e="middle"),r.markerHorizontalAlignment=L(n.markerHorizontalAlignment,t),r.markerVerticalAlignment=L(n.markerVerticalAlignment,e),d(n.markerOpacity)&&(d(n.markerFillOpacity)&&(r.markerFillOpacity*=n.markerOpacity),d(n.markerLineOpacity)&&(r.markerLineOpacity*=n.markerOpacity)),r},e.translateLineAndFill=function(t){var e={lineColor:t.markerLineColor,linePatternFile:t.markerLinePatternFile,lineWidth:t.markerLineWidth,lineOpacity:t.markerLineOpacity,lineDasharray:t.markerLineDasharray,lineCap:"butt",lineJoin:"round",polygonFill:t.markerFill,polygonPatternFile:t.markerFillPatternFile,polygonOpacity:t.markerFillOpacity};return 0===e.lineWidth&&(e.lineOpacity=0),e},e._getVectorPoints=function(t,e,n){var r,i,o,a,s=n/2,u=e/2;if("triangle"===t)return[r=new oe(0,0-s),i=new oe(0-u,0+s),o=new oe(0+u,0+s)];if("cross"===t)return[r=new oe(0-u,0),i=new oe(0+u,0),o=new oe(0,0-s),a=new oe(0,0+s)];if("diamond"===t)return[r=new oe(0-u,0),i=new oe(0,0-s),o=new oe(0+u,0),a=new oe(0,0+s)];if("square"===t)return[r=new oe(0-u,0+s),i=new oe(0+u,0+s),o=new oe(0+u,0-s),a=new oe(0-u,0-s)];if("rectangle"===t)return i=(r=new oe(0,0)).add(e,0),o=r.add(e,n),a=r.add(0,n),[r,i,o,a];if("x"===t)return[r=new oe(0-u,0+s),i=new oe(0+u,0-s),o=new oe(0+u,0+s),a=new oe(0-u,0-s)];if("bar"===t)return[r=new oe(0-u,0-n),i=new oe(0+u,0-n),o=new oe(0+u,0),a=new oe(0-u,0)];if("pin"===t){var c=n*Math.atan(u/s);return[r=new oe(0,0),i=new oe(0-c,0-n),o=new oe(0+c,0-n),a=new oe(0,0)]}return[]},e}(sr),cr=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.getPlacement=function(){return"point"},n.getDxDy=function(){return new oe(0,0)},n.symbolize=function(t){var e=this.geometry,n=e.getLayer();if(e.options.debug||!n||n.options.debug){var r=this.getMap();if(r&&!r.isZooming()){var i=n.options.debugOutline;t.strokeStyle=i,t.fillStyle=i;var o=this.getPainter().getContainerExtent().toArray();Ke.polygon(t,[o],1,0);for(var a=this._getRenderContainerPoints(),s=this.geometry.getId(),u=ur._getVectorPoints("cross",10,10),c=0;c<a.length;c++){var l=a[c];f(s)||Ke.fillText(t,s,l.add(8,-4),i);for(var h=[],d=0;d<u.length;d++)h.push(u[d].add(l));Ke.path(t,h.slice(0,2),1),Ke.path(t,h.slice(2,4),1)}}}},e}(sr),lr=function(t){function e(e,n,r){var i;return(i=t.call(this,e,n,r)||this).style=i._defineStyle(i.translate()),i}ne(e,t),e.test=function(t){return!!t&&!f(t.markerFile)};var n=e.prototype;return n.symbolize=function(t,e){var n=this.style;if(this.painter.isHitTesting()||0!==n.markerWidth&&0!==n.markerHeight&&0!==n.markerOpacity){var r=this._getRenderContainerPoints();if(U(r)){var i=this._getImage(e);if(i){this._prepareContext(t);var o,a=n.markerWidth,s=n.markerHeight;if(!d(a)||!d(s)){a=i.width,s=i.height,n.markerWidth=a,n.markerHeight=s;var u=[n.markerFile,n.markerWidth,n.markerHeight];e.isResourceLoaded(u)||e.addResource(u,i);var c=this.getPainter();c.isSpriting()||c.removeCache()}"path"!==this.symbol.markerType&&d(n.markerOpacity)&&n.markerOpacity<1&&(o=t.globalAlpha,t.globalAlpha*=n.markerOpacity);for(var l=_e(new ae(a,s),n.markerHorizontalAlignment,n.markerVerticalAlignment),h=0,f=r.length;h<f;h++){var p=r[h],v=this._rotate(t,p,this._getRotationAt(h));v&&(p=v),Ke.image(t,i,p.x+l.x,p.y+l.y,a,s),v&&t.restore()}void 0!==o&&(t.globalAlpha=o)}else"undefined"!=typeof console&&console.warn("no img found for "+(this.style.markerFile||this._url[0]))}}},n._getImage=function(t){return t?t.getImage([this.style.markerFile,this.style.markerWidth,this.style.markerHeight]):null},n.getPlacement=function(){return this.symbol.markerPlacement},n.getRotation=function(){var t=this.style.markerRotation;return d(t)?-t*Math.PI/180:null},n.getDxDy=function(){var t=this.style,e=t.markerDx,n=t.markerDy;return new oe(e,n)},n.getFixedExtent=function(t){var e=this.style,n=e.markerFile,r=t?t.getImage(n):null,i=e.markerWidth||(r?r.width:0),o=e.markerHeight||(r?r.height:0),a=this.getDxDy(),s=_e(new ae(i,o),e.markerHorizontalAlignment,e.markerVerticalAlignment),u=new yn(a.add(0,0),a.add(i,o));u._add(s);var c=this.getRotation();return c&&(u=this._rotateExtent(u,c)),u},n.translate=function(){var t=this.symbol;return{markerFile:t.markerFile,markerOpacity:L(t.markerOpacity,1),markerWidth:L(t.markerWidth,null),markerHeight:L(t.markerHeight,null),markerRotation:L(t.markerRotation,0),markerDx:L(t.markerDx,0),markerDy:L(t.markerDy,0),markerHorizontalAlignment:L(t.markerHorizontalAlignment,"middle"),markerVerticalAlignment:L(t.markerVerticalAlignment,"top")}},e}(sr),hr=function(t){function e(e,n,r){var i;return(i=t.call(this)||this).symbol=e,i.geometry=n,i.painter=r,"Point"===n.type?re(i):(i.style=i._defineStyle(i.translate()),i)}ne(e,t),e.test=function(t,e){if(!t)return!1;if(e&&"Point"===e.type)return!1;for(var n in t){var r=n.slice(0,4);if("line"===r||"poly"===r)return!0}return!1};var n=e.prototype;return n.symbolize=function(t,e){var n=this.style;if(0!==n.polygonOpacity||0!==n.lineOpacity||this.painter.isHitTesting()){var r=this._getPaintParams();if(r){this._prepareContext(t);var i=At(n.lineColor),o="Polygon"===this.geometry.getJSONType()||"LineString"===this.geometry.type;!i||!n.lineColor.places&&o||(n.lineGradientExtent=this.getPainter().getContainerExtent()._expand(n.lineWidth)),At(n.polygonFill)&&(n.polygonGradientExtent=this.getPainter().getContainerExtent());var a=r[0];if("Polygon"===this.geometry.getJSONType()&&a.length>0&&Array.isArray(a[0][0])||"LineString"===this.geometry.type&&a.length>0&&Array.isArray(a[0]))for(var s=0;s<a.length;s++){this.prepareCanvas(t,n,e),i&&o&&!n.lineColor.places&&this._createGradient(t,a[s],n.lineColor);var u=[t,a[s]];r.length>1&&u.push.apply(u,r.slice(1)),u.push(n.lineOpacity,n.polygonOpacity,n.lineDasharray),this.geometry._paintOn.apply(this.geometry,u)}else{this.prepareCanvas(t,n,e),i&&o&&!n.lineColor.places&&this._createGradient(t,a,n.lineColor);var c=[t];c.push.apply(c,r),c.push(n.lineOpacity,n.polygonOpacity,n.lineDasharray),this.geometry._paintOn.apply(this.geometry,c)}t.setLineDash&&Array.isArray(n.lineDasharray)&&t.setLineDash([])}}},n.get2DExtent=function(){var t=this.getMap(),e=this.geometry._getPrjExtent();if(!e)return null;this._extMin&&this._extMax||(this._extMin=new dn(0,0),this._extMax=new dn(0,0)),this._extMin.x=e.xmin,this._extMin.y=e.ymin,this._extMax.x=e.xmax,this._extMax.y=e.ymax;var n=t._prjToPoint(this._extMin),r=t._prjToPoint(this._extMax);return this._pxExtent?(this._pxExtent.xmin=Math.min(n.x,r.x),this._pxExtent.xmax=Math.max(n.x,r.x),this._pxExtent.ymin=Math.min(n.y,r.y),this._pxExtent.ymax=Math.max(n.y,r.y)):this._pxExtent=new yn(n,r),this._pxExtent},n.getFixedExtent=function(){var t=this.style.lineWidth/2;return new yn(-t,-t,t,t)},n._getPaintParams=function(){return this.getPainter().getPaintParams(this.style.lineDx,this.style.lineDy)},n.translate=function(){var t=this.symbol,e={lineColor:L(t.lineColor,"#000"),lineWidth:L(t.lineWidth,2),lineOpacity:L(t.lineOpacity,1),lineDasharray:L(t.lineDasharray,[]),lineCap:L(t.lineCap,"butt"),lineJoin:L(t.lineJoin,"miter"),linePatternFile:L(t.linePatternFile,null),lineDx:L(t.lineDx,0),lineDy:L(t.lineDy,0),polygonFill:L(t.polygonFill,null),polygonOpacity:L(t.polygonOpacity,1),polygonPatternFile:L(t.polygonPatternFile,null),polygonPatternDx:L(t.polygonPatternDx,0),polygonPatternDy:L(t.polygonPatternDy,0),linePatternDx:L(t.linePatternDx,0),linePatternDy:L(t.linePatternDy,0)};return 0===e.lineWidth&&(e.lineOpacity=0),"LineString"!==this.geometry.type||e.polygonFill||(e.polygonFill=e.lineColor),e},n._createGradient=function(t,e,n){if(Array.isArray(e)){var r=e.length,i=t.createLinearGradient(e[0].x,e[0].y,e[r-1].x,e[r-1].y);n.colorStops.forEach(function(t){i.addColorStop.apply(i,t)}),t.strokeStyle=i}},e}(ar),fr="___text_symbol_cache",dr=function(t){function e(e,n,r){var i;if((i=t.call(this,e,n,r)||this)._dynamic=bt(e),i.style=i._defineStyle(i.translate()),0===i.style.textWrapWidth)return re(i);i.strokeAndFill=i._defineStyle(i.translateLineAndFill(i.style));var o=me(i.style.textName,i.geometry.getProperties());return i._dynamic||(i._cacheKey=function(t,e){var n=[t];for(var r in e)e.hasOwnProperty(r)&&r.length>4&&"text"===r.substring(0,4)&&n.push(r+"="+e[r]);return n.join("-")}(o,i.style)),i._descText(o),i}ne(e,t),e.test=function(t){return!!t&&!f(t.textName)};var n=e.prototype;return n.symbolize=function(t,e){if(this.painter.isHitTesting()||0!==this.style.textSize&&(this.style.textOpacity||this.style.textHaloRadius&&this.style.textHaloOpacity)&&0!==this.style.textWrapWidth){var n=this._getRenderContainerPoints();if(U(n)){var r=this.style,i=this.strokeAndFill,o=me(this.style.textName,this.geometry.getProperties());this._descText(o),this._prepareContext(t),this.prepareCanvas(t,i,e),Ke.prepareCanvasFont(t,r);for(var a=0,s=n.length;a<s;a++){var u=n[a],c=this._rotate(t,u,this._getRotationAt(a));c&&(u=c),Ke.text(t,o,u,r,this.textDesc),c&&t.restore()}}}},n.getPlacement=function(){return this.symbol.textPlacement},n.getRotation=function(){var t=this.style.textRotation;return d(t)?-t*Math.PI/180:null},n.getDxDy=function(){var t=this.style;return new oe(t.textDx,t.textDy)},n.getFixedExtent=function(){var t=this.getDxDy(),e=this.style,n=this.textDesc.size,r=_e(n,e.textHorizontalAlignment,e.textVerticalAlignment),i=r.x,o=r.y;if(e.textHaloRadius){var a=e.textHaloRadius;n=n.add(2*a,2*a)}var s=new yn(t.add(i,o),t.add(i+n.width,o+n.height)),u=this.getRotation();return u&&(s=this._rotateExtent(s,u)),s},n.translate=function(){var t=this.symbol,e={textName:t.textName,textFaceName:L(t.textFaceName,"monospace"),textWeight:L(t.textWeight,"normal"),textStyle:L(t.textStyle,"normal"),textSize:L(t.textSize,10),textFont:L(t.textFont,null),textFill:L(t.textFill,"#000"),textOpacity:L(t.textOpacity,1),textHaloFill:L(t.textHaloFill,"#ffffff"),textHaloRadius:L(t.textHaloRadius,0),textHaloOpacity:L(t.textHaloOpacity,1),textWrapWidth:L(t.textWrapWidth,null),textWrapCharacter:L(t.textWrapCharacter,"\n"),textLineSpacing:L(t.textLineSpacing,0),textDx:L(t.textDx,0),textDy:L(t.textDy,0),textHorizontalAlignment:L(t.textHorizontalAlignment,"middle"),textVerticalAlignment:L(t.textVerticalAlignment,"middle"),textAlign:L(t.textAlign,"center"),textRotation:L(t.textRotation,0),textMaxWidth:L(t.textMaxWidth,0),textMaxHeight:L(t.textMaxHeight,0)};return e.textMaxWidth>0&&(!e.textWrapWidth||e.textWrapWidth>e.textMaxWidth)&&(e.textWrapWidth||(e.textMaxHeight=1),e.textWrapWidth=e.textMaxWidth),e},n.translateLineAndFill=function(t){return{lineColor:t.textHaloRadius?t.textHaloFill:t.textFill,lineWidth:t.textHaloRadius,lineOpacity:t.textOpacity,lineDasharray:null,lineCap:"butt",lineJoin:"round",polygonFill:t.textFill,polygonOpacity:t.textOpacity}},n._descText=function(t){this._dynamic?this.textDesc=this._measureText(t):(this.textDesc=this._loadFromCache(),this.textDesc||(this.textDesc=this._measureText(t),this._storeToCache(this.textDesc)))},n._measureText=function(t){var e=this.style.textMaxHeight,n=xe(t,this.style);return e&&e<n.size.height&&(n.size.height=e),n},n._storeToCache=function(t){P||(this.geometry[fr]||(this.geometry[fr]={}),this.geometry[fr][this._cacheKey]={desc:t,active:!0})},n._loadFromCache=function(){if(!this.geometry[fr])return null;var t=this.geometry[fr][this._cacheKey];return t?(t.active=!0,t.desc):null},e}(sr);dr.CACHE_KEY=fr;var pr,vr=function(t){function e(e,n,r){var i;return(i=t.call(this,e,n,r)||this).style=i._defineStyle(i.translate()),f(i.style.markerWidth)&&(i.style.markerWidth=80),f(i.style.markerHeight)&&(i.style.markerHeight=80),ee.gecko?i._url=[Pt(e,i.style.markerWidth,i.style.markerHeight),i.style.markerWidth,i.style.markerHeight]:i._url=[Pt(e),e.markerWidth,e.markerHeight],i}ne(e,t),e.test=function(t){return!!t&&!(!f(t.markerFile)||"path"!==t.markerType)};var n=e.prototype;return n._prepareContext=function(){},n._getImage=function(t){if(t&&t.isResourceLoaded(this._url))return t.getImage(this._url);var e=new Image;return e.src=this._url[0],t&&t.addResource(this._url,e),e},e}(lr),gr={lineWidth:1,polygonFill:"#fff",polygonOpacity:.5},yr=function(t){function e(e,n,r){var i;return(i=t.call(this,e,n,r)||this).style=n.getLayer().options.drawAltitude,i.style&&v(i.style)||(i.style={lineWidth:2}),i.style.lineWidth||(i.style.lineWidth=0),i.dxdy=i._defineStyle({dx:e.textDx||e.markerDx,dy:e.textDy||e.markerDy}),i}ne(e,t),e.test=function(t,e){if(!e.getLayer())return!1;var n=e.getJSONType();return"Marker"===n||"LineString"===n};var n=e.prototype;return n.symbolize=function(t){var e=this.geometry.getLayer();if(e.options.drawAltitude){var n=this.geometry.getProperties();if(n&&n[e.options.altitudeProperty]){var r=this._getStyle();if(this._prepareContext(t),"LineString"===this.geometry.type){var i=this._getPaintParams(r.lineDx,r.lineDy);if(!i)return;var o=this.getPainter().getPaintParams(r.lineDx,r.lineDy,!0)[0];this._drawLineAltitude(t,i[0],o)}else{var a=this._getRenderContainerPoints(),s=this._getRenderContainerPoints(!0);if(!a||0===a.length)return;this._drawMarkerAltitude(t,a[0],s[0])}}}},n.getDxDy=function(){var t=this.dxdy;return new oe(t.dx||0,t.dy||0)},n.get2DExtent=function(){return"LineString"===this.geometry.type?hr.prototype.get2DExtent.apply(this):t.prototype.get2DExtent.call(this)},n.getPlacement=function(){return"point"},n._getPaintParams=function(t,e){return this.getPainter().getPaintParams(t||0,e||0)},n._drawMarkerAltitude=function(t,e,n){var r=this._getStyle();this.prepareCanvas(t,r),Ke.path(t,[e,n],r.lineOpacity,null,r.lineDasharray)},n._drawLineAltitude=function(t,e,n){var r=this._getStyle();if(e.length>0&&Array.isArray(e[0]))for(var i=0;i<e.length;i++)this._drawLine(t,e[i],n[i]);else this._drawLine(t,e,n);t.setLineDash&&Array.isArray(r.lineDasharray)&&t.setLineDash([])},n._drawLine=function(t,e,n){var r=this._getStyle();this.prepareCanvas(t,r);for(var i=0,o=e.length-1;i<o;i++)Ke.polygon(t,[e[i],e[i+1],n[i+1],n[i]],r.lineOpacity,r.polygonOpacity,r.lineDasharray)},n._getStyle=function(){var t=this.geometry.getLayer().options.drawAltitude;return v(t)||(t=gr),t.lineWidth||(t.lineWidth=0,t.lineOpacity=0),t},e}(sr),mr=[yr,hr,lr,vr,ur,dr],_r=function(t){function e(e){var n;return(n=t.call(this)||this).geometry=e,n.symbolizers=n._createSymbolizers(),n._altAtGLZoom=n._getGeometryAltitude(),n}ne(e,t);var n=e.prototype;return n.getMap=function(){return this.geometry.getMap()},n.getLayer=function(){return this.geometry.getLayer()},n._createSymbolizers=function(){var t=this.getSymbol(),e=[],n=mr,r=t;Array.isArray(t)||(r=[t]);for(var i=r.length-1;i>=0;i--)for(var o=r[i],a=n.length-1;a>=0;a--)if(n[a].test(o,this.geometry)){var s=new n[a](o,this.geometry,this);e.push(s),s instanceof sr&&(this._hasPoint=!0)}if(!e.length&&console){var u=this.geometry.getId();console.warn("invalid symbol for geometry("+(this.geometry?this.geometry.getType()+(u?":"+u:""):"")+") to draw : "+JSON.stringify(t))}return this._debugSymbolizer=new cr(t,this.geometry,this),e},n.hasPoint=function(){return!!this._hasPoint},n.getRenderPoints=function(t){return this._renderPoints||(this._renderPoints={}),t||(t="center"),this._renderPoints[t]||(this._renderPoints[t]=this.geometry._getRenderPoints(t)),this._renderPoints[t]},n.getPaintParams=function(t,e,n){var r=this.getMap(),i=this.geometry,o=r.getResolution(),a=0!==r.getPitch(),s=0!==r.getBearing(),u=this._cachedParams,c=i._paintAsPath&&i._paintAsPath();if(c&&this._unsimpledParams&&o<=this._unsimpledParams._res)u=this._unsimpledParams;else if(!u||u._res!==r.getResolution()||this._pitched!==a&&i._redrawWhenPitch()||this._rotated!==s&&i._redrawWhenRotate()){if(!(u=i._getPaintParams()))return null;u._res=o,!i._simplified&&c&&(this._unsimpledParams||(this._unsimpledParams=u),o>this._unsimpledParams._res&&(this._unsimpledParams._res=o)),this._cachedParams=u}if(!u)return null;this._pitched=a,this._rotated=s;var l=r.getGLScale(),h=[],f=u[0],p=r.getContainerExtent(),v=this._pointContainerPoints(f,t,e,n,this._hitPoint&&!p.contains(this._hitPoint));if(!v)return null;h.push(v);for(var g=1,y=u.length;g<y;g++)d(u[g])||u[g]instanceof ae?d(u[g])?h.push(u[g]/l):h.push(u[g].multi(1/l)):h.push(u[g]);return h},n._pointContainerPoints=function(t,e,n,r,i,o){if(!this.getContainerExtent())return null;var a,s=this.getMap(),u=s.getGLZoom(),c=this.containerOffset;function l(t,r){var i=s._pointToContainerPoint(t,u,r)._sub(c);return(e||n)&&i._add(e||0,n||0),i}var h=this.getAltitude();if(Array.isArray(t)){var f,d=this.geometry,p=(f=!i&&d.options.enableClip?this._clip(t,h):{points:t,altitude:h}).points;h=f.altitude,r&&(h=0);var v=h;a=[];for(var g=0,y=p.length;g<y;g++){var m=p[g];if(Array.isArray(m)){for(var _=[],b=0,w=m.length;b<w;b++){var x=m[b];Array.isArray(h)&&(v=h[g]?h[g][b]:0),_.push(l(x,v))}a.push(_)}else Array.isArray(h)&&(v="vertex-last"===o?h[h.length-1-g]:"line"===o?(h[g]+h[g+1])/2:h[g]),a.push(l(m,v))}}else t instanceof oe&&(r&&(h=0),a=s._pointToContainerPoint(t,u,h)._sub(c),(e||n)&&a._add(e,n));return a},n._clip=function(t,e){var n=this.getMap(),r=this.geometry,i=n.getGLZoom(),o=this.getSymbol().lineWidth;d(o)||(o=4);var a=n.getContainerExtent().expand(o).convertTo(function(t){return n._containerPointToPoint(t,i)});if(n.getPitch()>0&&e){var s=n.cameraLookAt,u=n.cameraPosition;a=a.combine(new oe(u)._add(I(s[0]-u[0]),I(s[1]-u[1])))}var c=t;if(this.get2DExtent().within(a))return{points:c,altitude:e};var l=r.options.smoothness;if(r.getShell&&this.geometry.getHoles&&!l)if(Array.isArray(t[0])){c=[];for(var h=0;h<t.length;h++){var f=er(t[h],a);f.length&&c.push(f)}}else c=er(t,a);else if("LineString"===r.getJSONType()){if(Array.isArray(t[0])){c=[];for(var p=0;p<t.length;p++)k(c,$n(t[p],a,!1,!!l))}else c=$n(t,a,!1,!!l);return this._interpolateSegAlt(c,t,e)}return{points:c,altitude:e}},n._interpolateSegAlt=function(t,e,n){if(!Array.isArray(n)){var r=function(t){return t.point};return{points:t.map(function(t){return Array.isArray(t)?t.map(r):t.point}),altitude:n}}var i=function t(e,n,r){if(!Array.isArray(r))return e;var i=[];for(var o=0,a=e.length;o<a;o++)if(Array.isArray(e[o]))i.push(t(e[o],n,r));else{var s=e[o];if(s.point.equals(n[s.index]))s.altitude=r[s.index],i.push(s);else{var u=void 0,c=void 0;0===s.index?(u=s.index,c=s.index+1):(u=s.index-1,c=s.index);var l=s.point.distanceTo(n[c]),h=l/(l+n[u].distanceTo(s.point)),f=F(r[u],r[c],1-h);s.altitude=f,i.push(s)}}return i}(t,e,n);return n=[],{points:i.map(function(t){if(Array.isArray(t)){var e=[],r=t.map(function(t){return e.push(t.altitude),t.point});return n.push(e),r}return n.push(t.altitude),t.point}),altitude:n}},n.getSymbol=function(){return this.geometry._getInternalSymbol()},n.paint=function(t,e,n){if(this.symbolizers){var r=this.getLayer()._getRenderer();if(r&&r.context&&(!t||t.intersects(this.get2DExtent(r.resources)))){var i=this.getMap(),o=this.getMinAltitude(),a=i.getFrustumAltitude();if(!(o&&a&&a<o)){this.containerOffset=n||i._pointToContainerPoint(r.southWest)._add(0,-i.height),this._beforePaint();for(var s=e||r.context,u=[s,r.resources],c=this.symbolizers.length-1;c>=0;c--)this._prepareShadow(s,this.symbolizers[c].symbol),this.symbolizers[c].symbolize.apply(this.symbolizers[c],u);this._afterPaint(),this._painted=!0,this._debugSymbolizer.symbolize.apply(this._debugSymbolizer,u)}}}},n.getSprite=function(t,e){if("Point"!==this.geometry.type)return null;if(this._spriting=!0,!this._sprite&&this.symbolizers.length>0){var n=new yn;this.symbolizers.forEach(function(e){var r=e.getFixedExtent(t);n._combine(r)});var r,i=n.getMin().multi(-1),o=e||(this.getMap()?this.getMap().CanvasClass:null),a=Ke.createCanvas(n.getWidth(),n.getHeight(),o);this._renderPoints&&(r=this._renderPoints);for(var s=a.getContext("2d"),u=[s,t],c=this.symbolizers.length-1;c>=0;c--){var l=this.symbolizers[c].getDxDy();this._renderPoints={center:[[i.add(l)]]},this._prepareShadow(s,this.symbolizers[c].symbol),this.symbolizers[c].symbolize.apply(this.symbolizers[c],u)}r&&(this._renderPoints=r),this._sprite={canvas:a,offset:n.getCenter()}}return this._spriting=!1,this._sprite},n.isSpriting=function(){return!!this._spriting},n.hitTest=function(t,e){(!e||e<.5)&&(e=.5),pr||(pr=Ke.createCanvas(1,1)),Ke.setHitTesting(!0),pr.width=pr.height=2*e;var n=pr.getContext("2d");this._hitPoint=t.sub(e,e);try{this.paint(null,n,this._hitPoint)}catch(t){throw t}finally{Ke.setHitTesting(!1)}delete this._hitPoint;for(var r=n.getImageData(0,0,pr.width,pr.height).data,i=3,o=r.length;i<o;i+=4)if(r[i]>0)return!0;return!1},n.isHitTesting=function(){return!!this._hitPoint},n._prepareShadow=function(t,e){e.shadowBlur?(t.shadowBlur=e.shadowBlur,t.shadowColor=e.shadowColor||"#000",t.shadowOffsetX=e.shadowOffsetX||0,t.shadowOffsetY=e.shadowOffsetY||0):t.shadowBlur&&(t.shadowBlur=null,t.shadowColor=null,t.shadowOffsetX=null,t.shadowOffsetY=null)},n._eachSymbolizer=function(t,e){if(this.symbolizers){e||(e=this);for(var n=this.symbolizers.length-1;n>=0;n--)t.apply(e,[this.symbolizers[n]])}},n.get2DExtent=function(t){this._verifyProjection();var e=this.getMap();t=t||this.getLayer()._getRenderer().resources;var n=e.getZoom();if((!this._extent2D||this._extent2D._zoom!==n)&&(delete this._extent2D,delete this._fixedExtent,this.symbolizers)){for(var r=this._extent2D=new yn,i=this._fixedExtent=new yn,o=this.symbolizers.length-1;o>=0;o--){var a=this.symbolizers[o];r._combine(a.get2DExtent()),a.getFixedExtent&&i._combine(a.getFixedExtent(t))}r._zoom=n}return this._extent2D.add(this._fixedExtent)},n.getContainerExtent=function(){this._verifyProjection();var t=this.getMap(),e=t.getZoom(),n=t.getGLScale();this._extent2D&&this._extent2D._zoom===e||this.get2DExtent();var r=this.getMinAltitude(),i=t.getFrustumAltitude();if(r&&i&&i<r)return null;var o=this._extent2D.convertTo(function(i){return t._pointToContainerPoint(i,e,r/n)}),a=this.getMaxAltitude();if(a!==r){var s=this._extent2D.convertTo(function(r){return t._pointToContainerPoint(r,e,a/n)});o._combine(s)}return o&&o._add(this._fixedExtent),this.geometry.options.smoothness&&o._expand(.15*o.getWidth()),o},n.getFixedExtent=function(){var t=this.getMap().getZoom();return this._extent2D&&this._extent2D._zoom===t||this.get2DExtent(),this._fixedExtent},n.setZIndex=function(t){this._eachSymbolizer(function(e){e.setZIndex(t)})},n.show=function(){this._painted?(this.removeCache(),this._eachSymbolizer(function(t){t.show()})):this.getLayer().isCanvasRender()||this.paint()},n.hide=function(){this._eachSymbolizer(function(t){t.hide()})},n.repaint=function(){this._altAtGLZoom=this._getGeometryAltitude(),this.removeCache();var t=this.getLayer();if(t){var e=t.getRenderer();e&&e.setToRedraw()&&e.setToRedraw()}},n.refreshSymbol=function(){this.removeCache(),this._removeSymbolizers(),this.symbolizers=this._createSymbolizers()},n.remove=function(){this.removeCache(),this._removeSymbolizers()},n._removeSymbolizers=function(){this._eachSymbolizer(function(t){delete t.painter,t.remove()}),delete this.symbolizers},n.removeCache=function(){delete this._renderPoints,delete this._paintParams,delete this._sprite,delete this._extent2D,delete this._fixedExtent,delete this._cachedParams,delete this._unsimpledParams,this.geometry&&delete this.geometry[dr.CACHE_KEY]},n.getAltitude=function(){return this._getAltitudeProperty()!==this._propAlt&&(this._altAtGLZoom=this._getGeometryAltitude()),this._altAtGLZoom?this._altAtGLZoom:0},n.getMinAltitude=function(){return this.minAltitude?this.minAltitude:0},n.getMaxAltitude=function(){return this.maxAltitude?this.maxAltitude:0},n._getGeometryAltitude=function(){var t=this;if(!this.getMap())return 0;var e=this._getAltitudeProperty();if(this._propAlt=e,!e)return this.minAltitude=this.maxAltitude=0,0;var n=this.geometry.getCenter();return n?Array.isArray(e)?(this.minAltitude=Number.MAX_VALUE,this.maxAltitude=Number.MIN_VALUE,e.map(function(e){var r=t._meterToPoint(n,e);return r<t.minAltitude&&(t.minAltitude=r),r>t.maxAltitude&&(t.maxAltitude=r),r})):(this.minAltitude=this.maxAltitude=this._meterToPoint(n,e),this.minAltitude):0},n._meterToPoint=function(t,e){var n=this.getMap(),r=n.getGLZoom(),i=n.locate(t,e,0),o=n.coordToPoint(t,r),a=n.coordToPoint(i,r);return Math.abs(a.x-o.x)*I(e)},n._getAltitudeProperty=function(){var t=this.geometry,e=t.getLayer().options,n=t.getProperties();return e.enableAltitude&&n?n[e.altitudeProperty]:0},n._verifyProjection=function(){var t=this.geometry._getProjection();this._projCode&&this._projCode!==t.code&&this.removeCache(),this._projCode=t.code},n._beforePaint=function(){var t=this.geometry[dr.CACHE_KEY];if(t)for(var e in t)_(t,e)&&(t[e].active=!1)},n._afterPaint=function(){var t=this.geometry[dr.CACHE_KEY];if(t)for(var e in t)_(t,e)&&(t[e].active||delete t[e])},e}(an);var br=function(t){function e(e){var n;return(n=t.call(this)||this).geometry=e,n}ne(e,t);var n=e.prototype;return n._eachPainter=function(t){for(var e,n=this.geometry.getGeometries(),r=0,i=n.length;r<i&&(!(e=n[r]._getPainter())||!e||!1!==t.call(this,e));r++);},n.paint=function(t){this.geometry&&this._eachPainter(function(e){e.paint(t)})},n.get2DExtent=function(t){var e=new yn;return this._eachPainter(function(n){e=e.combine(n.get2DExtent(t))}),e},n.getContainerExtent=function(){var t=new yn;return this._eachPainter(function(e){t=t.combine(e.getContainerExtent())}),t},n.remove=function(){var t=arguments;this._eachPainter(function(e){e.remove.apply(e,t)})},n.setZIndex=function(){var t=arguments;this._eachPainter(function(e){e.setZIndex.apply(e,t)})},n.show=function(){var t=arguments;this._eachPainter(function(e){e.show.apply(e,t)})},n.hide=function(){var t=arguments;this._eachPainter(function(e){e.hide.apply(e,t)})},n.repaint=function(){var t=arguments;this._eachPainter(function(e){e.repaint.apply(e,t)})},n.refreshSymbol=function(){var t=arguments;this._eachPainter(function(e){e.refreshSymbol.apply(e,t)})},n.hasPoint=function(){var t=!1;return this._eachPainter(function(e){return!e.hasPoint()||(t=!0,!1)}),t},n.getMinAltitude=function(){var t=!0,e=0;return this._eachPainter(function(n){var r=n.getMinAltitude();(t||r<e)&&(t=!1,e=r)}),e},n.getMaxAltitude=function(){var t=0;return this._eachPainter(function(e){var n=e.getMaxAltitude();n>t&&(t=n)}),t},e}(an),wr=function(t){function e(e){var n,r=h({},e),i=r.symbol,o=r.properties,a=r.id;return delete r.symbol,delete r.id,delete r.properties,n=t.call(this,r)||this,i&&n.setSymbol(i),o&&n.setProperties(o),f(a)||n.setId(a),n}ne(e,t);var n=e.prototype;return n.getFirstCoordinate=function(){if("GeometryCollection"===this.type){var t=this.getGeometries();return t.length?t[0].getFirstCoordinate():null}var e=this.getCoordinates();if(!Array.isArray(e))return e;do{e=e[0]}while(Array.isArray(e)&&e.length>0);return e},n.getLastCoordinate=function(){if("GeometryCollection"===this.type){var t=this.getGeometries();return t.length?t[t.length-1].getLastCoordinate():null}var e=this.getCoordinates();if(!Array.isArray(e))return e;do{e=e[e.length-1]}while(Array.isArray(e)&&e.length>0);return e},n.addTo=function(t,e){return t.addGeometry(this,e),this},n.getLayer=function(){return this._layer?this._layer:null},n.getMap=function(){return this._layer?this._layer.getMap():null},n.getId=function(){return this._id},n.setId=function(t){var e=this.getId();return this._id=t,this._fireEvent("idchange",{old:e,new:t}),this},n.getProperties=function(){return this.properties?this.properties:this._getParent()?this._getParent().getProperties():null},n.setProperties=function(t){var e=this.properties;return this.properties=v(t)?h({},t):t,this._repaint(),this._fireEvent("propertieschange",{old:e,new:t}),this},n.getType=function(){return this.type},n.getSymbol=function(){var t=this._symbol;return t?Array.isArray(t)?jt(t):h({},t):null},n.setSymbol=function(t){return this._symbol=this._prepareSymbol(t),this.onSymbolChanged(),this},n.updateSymbol=function(t){if(!t)return this;var e=this._getSymbol();return e=jt(e||this._getInternalSymbol(),t),this.setSymbol(e)},n.getCenter=function(){return this._computeCenter(this._getMeasurer())},n.getExtent=function(){var t=this._getPrjExtent();if(t){var e=this._getProjection(),n=e.unproject(new dn(t.xmin,t.ymin)),r=e.unproject(new dn(t.xmax,t.ymax));return new gn(n,r,this._getProjection())}return this._computeExtent(this._getMeasurer())},n.getContainerExtent=function(){var t=this._getPainter();return t?t.getContainerExtent():null},n.getSize=function(){var t=this.getContainerExtent();return t?t.getSize():null},n.containsPoint=function(t,e){if(!this.getMap())throw new Error('The geometry is required to be added on a map to perform "containsPoint".');return t instanceof dn&&(t=this.getMap().coordToContainerPoint(t)),this._containsPoint(t,e)},n._containsPoint=function(t,e){var n=this._getPainter();return!!n&&(f(e)&&this._hitTestTolerance&&(e=this._hitTestTolerance()),n.hitTest(t,e))},n.show=function(){if(this.options.visible=!0,this.getMap()){var t=this._getPainter();t&&t.show(),this._fireEvent("show")}return this},n.hide=function(){if(this.options.visible=!1,this.getMap()){this.onHide();var t=this._getPainter();t&&t.hide(),this._fireEvent("hide")}return this},n.isVisible=function(){if(!this.options.visible)return!1;var t=this._getInternalSymbol();if(!t)return!0;if(Array.isArray(t)){if(!t.length)return!0;for(var e=0,n=t.length;e<n;e++)if(f(t[e].opacity)||t[e].opacity>0)return!0;return!1}return f(t.opacity)||d(t.opacity)&&t.opacity>0},n.getZIndex=function(){return this.options.zIndex||0},n.setZIndex=function(t){var e=this.options.zIndex;return this.options.zIndex=t,this._fireEvent("zindexchange",{old:e,new:t}),this},n.setZIndexSilently=function(t){return this.options.zIndex=t,this},n.bringToFront=function(){var t=this.getLayer();if(!t||!t.getGeoMaxZIndex)return this;var e=t.getGeoMaxZIndex();return this.setZIndex(e+1),this},n.bringToBack=function(){var t=this.getLayer();if(!t||!t.getGeoMinZIndex)return this;var e=t.getGeoMinZIndex();return this.setZIndex(e-1),this},n.translate=function(t,e){if(f(t))return this;var n=new dn(t,e);if(0===n.x&&0===n.y)return this;var r=this.getCoordinates();if(r)if(Array.isArray(r)){var i=R(r,function(t){return t.add(n)});this.setCoordinates(i)}else this.setCoordinates(r.add(n));return this},n.flash=function(t,e,n,r){return $.call(this,t,e,n,r)},n.copy=function(){var t=this.toJSON(),n=e.fromJSON(t);return n.options.visible=!0,n},n.remove=function(){return this.getLayer()?(this._fireEvent("removestart"),this._unbind(),this._fireEvent("removeend"),this._fireEvent("remove"),this):this},n.toGeoJSONGeometry=function(){return this._exportGeoJSONGeometry()},n.toGeoJSON=function(t){t||(t={});var e={type:"Feature",geometry:null};if(f(t.geometry)||t.geometry){var n=this._exportGeoJSONGeometry();e.geometry=n}var r,i=this.getId();return f(i)||(e.id=i),(f(t.properties)||t.properties)&&(r=this._exportProperties()),e.properties=r,e},n.toJSON=function(t){t||(t={});var e=this._toJSON(t);return h(e,this._exportGraphicOptions(t)),e},n.getLength=function(){return this._computeGeodesicLength(this._getMeasurer())},n.getArea=function(){return this._computeGeodesicArea(this._getMeasurer())},n.rotate=function(t,e){if("GeometryCollection"===this.type)return this.getGeometries().forEach(function(n){return n.rotate(t,e)}),this;e=e?new dn(e):this.getCenter();var n=this._getMeasurer(),r=this.getCoordinates();if(!Array.isArray(r)){if(e.x!==r.x||e.y!==r.y){var i=n._rotate(r,e,t);this.setCoordinates(i)}return this}return R(r,function(r){return n._rotate(r,e,t)}),this.setCoordinates(r),this},n._getConnectPoints=function(){return[this.getCenter()]},n._initOptions=function(t){var e=h({},t),n=e.symbol,r=e.properties,i=e.id;delete e.symbol,delete e.id,delete e.properties,this.setOptions(e),n&&this.setSymbol(n),r&&this.setProperties(r),f(i)||this.setId(i)},n._bindLayer=function(t){if(this.getLayer())throw new Error("Geometry cannot be added to two or more layers at the same time.");this._layer=t,this._clearCache(),this._clearProjection()},n._prepareSymbol=function(t){if(Array.isArray(t)){for(var e=[],n=0;n<t.length;n++)e.push(Tt(this._checkAndCopySymbol(t[n])));return e}return t?Tt(t=this._checkAndCopySymbol(t)):null},n._checkAndCopySymbol=function(t){var e={};for(var n in t)u[n]&&g(t[n])?e[n]=+t[n]:e[n]=t[n];return e},n._getSymbol=function(){return this._symbol},n._setExternSymbol=function(t){return this._externSymbol=this._prepareSymbol(t),this.onSymbolChanged(),this},n._getInternalSymbol=function(){return this._symbol?this._symbol:this._externSymbol?this._externSymbol:this.options.symbol?this.options.symbol:null},n._getPrjExtent=function(){var t=this._getProjection();return this._verifyProjection(),!this._extent&&t&&(this._extent=this._computePrjExtent(t)),this._extent},n._unbind=function(){var t=this.getLayer();t&&(this._animPlayer&&this._animPlayer.finish(),this._clearHandlers(),this._unbindMenu(),this._unbindInfoWindow(),this.isEditing()&&this.endEdit(),this._removePainter(),this.onRemove&&this.onRemove(),t.onRemoveGeometry&&t.onRemoveGeometry(this),delete this._layer,delete this._internalId,delete this._extent)},n._getInternalId=function(){return this._internalId},n._setInternalId=function(t){this._internalId=t},n._getMeasurer=function(){return this._getProjection()?this._getProjection():Xn.getProjectionInstance(this.options.defaultProjection)},n._getProjection=function(){var t=this.getMap();return t?t.getProjection():null},n._verifyProjection=function(){var t=this._getProjection();!this._projCode||t&&this._projCode===t.code||this._clearProjection(),this._projCode=t?t.code:null},n._getExternalResources=function(){return St(this._getInternalSymbol())},n._getPainter=function(){return!this._painter&&this.getMap()&&(-1!==i.indexOf(this.type)?this._painter=new br(this):this._painter=new _r(this)),this._painter},n._removePainter=function(){this._painter&&this._painter.remove(),delete this._painter},n._paint=function(t){this._painter&&this._painter.paint(t)},n._clearCache=function(){delete this._extent},n._clearProjection=function(){delete this._extent},n._repaint=function(){this._painter&&this._painter.repaint()},n.onHide=function(){this.closeMenu(),this.closeInfoWindow()},n.onShapeChanged=function(){this._clearCache(),this._repaint(),this._fireEvent("shapechange")},n.onPositionChanged=function(){this._clearCache(),this._repaint(),this._fireEvent("positionchange")},n.onSymbolChanged=function(){this._painter&&this._painter.refreshSymbol(),this._fireEvent("symbolchange")},n.onConfig=function(t){var e;t.properties&&(e=t.properties,delete t.properties);var n=!1;for(var r in t)if(t.hasOwnProperty(r)){var i=r.slice(0,5);if("arrow"===i||"smoot"===i){n=!0;break}}e?(this.setProperties(e),this._repaint()):n&&this._repaint()},n._setParent=function(t){t&&(this._parent=t)},n._getParent=function(){return this._parent},n._fireEvent=function(t,e){this.getLayer()&&this.getLayer()._onGeometryEvent&&(e||(e={}),e.type=t,e.target=this,this.getLayer()._onGeometryEvent(e)),this.fire(t,e)},n._toJSON=function(t){return{feature:this.toGeoJSON(t)}},n._exportGraphicOptions=function(t){var e={};return(f(t.options)||t.options)&&(e.options=this.config()),(f(t.symbol)||t.symbol)&&(e.symbol=this.getSymbol()),(f(t.infoWindow)||t.infoWindow)&&this._infoWinOptions&&(e.infoWindow=this._infoWinOptions),e},n._exportGeoJSONGeometry=function(){var t=this.getCoordinates(),e=dn.toNumberArrays(t);return{type:this.getType(),coordinates:e}},n._exportProperties=function(){var t=null,e=this.getProperties();return f(e)||(t=v(e)?h({},e):e),t},e}(un(rn(cn(an))));wr.mergeOptions({id:null,visible:!0,interactive:!0,editable:!0,cursor:null,defaultProjection:"EPSG:4326"});var xr="mousedown mouseup mousemove click dblclick contextmenu touchstart touchmove touchend",Er=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.addHooks=function(){var t=this.target,e=t._panels.allLayers||t._containerDOM;Ye(e,xr,this._identifyGeometryEvents,this)},n.removeHooks=function(){var t=this.target,e=t._panels.allLayers||t._containerDOM;Je(e,xr,this._identifyGeometryEvents,this)},n._identifyGeometryEvents=function(t,e){var n=this.target;if(!n.isInteracting()&&!n._ignoreEvent(t)){var r=n._getLayers(function(t){return!(!t.identify||!t.options.geometryEvents)});if(r.length){var i=null,o=e||t.type;if("mousedown"===o||"touchstart"===o&&1===t.touches.length)this._mouseDownTime=l();else if(("click"===o||"touchend"===o)&&this._mouseDownTime){var a=this._mouseDownTime;if(delete this._mouseDownTime,l()-a>300){if("click"===o)return}else"touchend"===o&&(i="click")}var s=t.touches&&t.touches.length>0?t.touches[0]:t.changedTouches&&t.changedTouches.length>0?t.changedTouches[0]:t;if(s){var u=Ne(s,n._containerDOM),c=n.containerPointToCoordinate(u);"touchstart"===o&&Re(t);var h=null,f={includeInternals:!0,filter:function(e){if(!(e instanceof wr))return!1;var n=e._getEventTypeToFire(t);if("mousemove"===o){if(!h&&e.options.cursor&&(h=e.options.cursor),!e.listens("mousemove")&&!e.listens("mouseover")&&!e.listens("mouseenter"))return!1}else if(!e.listens(n)&&!e.listens(i))return!1;return!0},count:1,coordinate:c,onlyVisible:n.options.onlyVisibleGeometryEvents,layers:r},d=function(e){var r=!0;if("mousemove"===o){var a={};if(e.length>0)for(var s=e.length-1;s>=0;s--){var u=e[s];if(u instanceof wr){var c=u._getInternalId();a[c]=u,u._onEvent(t),this._prevOverGeos&&this._prevOverGeos.geomap[c]||u._onEvent(t,"mouseenter"),r=u._onEvent(t,"mouseover")}}n._setPriorityCursor(h);var l=this._prevOverGeos&&this._prevOverGeos.geos;if(this._prevOverGeos={geos:e,geomap:a},l&&l.length>0)for(var f=l.length-1;f>=0;f--){var d=l[f];if(d instanceof wr){var p=l[f]._getInternalId();a[p]||(r=d._onEvent(t,"mouseout"))}}}else{if(!e||!e.length)return;for(var v=e.length-1;v>=0;v--)if(e[v]instanceof wr){r=e[v]._onEvent(t),i&&e[v]._onEvent(t,i);break}}!1===r&&Le(t)}.bind(this);this._queryIdentifyTimeout&&O(this._queryIdentifyTimeout),"mousemove"===o||"touchmove"===o?this._queryIdentifyTimeout=E(function(){n.isInteracting()||n.identify(f,d)}):n.identify(f,d)}}}},e}(on);Jn.mergeOptions({geometryEvents:!0,onlyVisibleGeometryEvents:!0}),Jn.addOnLoadHook("addHandler","geometryEvents",Er);var Or=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.addHooks=function(){Me(this.target._containerDOM,"mousewheel",this._onWheelScroll,this)},n.removeHooks=function(){ke(this.target._containerDOM,"mousewheel",this._onWheelScroll)},n._onWheelScroll=function(t){var e=this,n=this.target;if(n._ignoreEvent(t)||!n.options.zoomable)return!1;if(Re(t),Le(t),this._zooming)return this._requesting++,!1;this._requesting=0;var r=n._containerDOM,i=(t.wheelDelta?t.wheelDelta:t.detail)>0?1:-1;t.detail&&(i*=-1);var o=n.getZoom(),a=o+i;if((a=n._checkZoom(i>0?Math.ceil(a):Math.floor(a)))===o)return!1;this._zooming=!0;var s=n._checkZoomOrigin(Ne(t,r));this._delta||(n.onZoomStart(null,s),this._origin=s,this._delta=i,this._startZoom=n.getZoom());return n.animateTo({zoom:a-1*this._delta/2,around:this._origin},{continueOnViewChanged:!0,easing:"linear",duration:90,wheelZoom:!0},function(r){"finished"===r.state.playState&&(e._requesting<1||Math.abs(a-e._startZoom)>2||a===n.getMaxZoom()||a===n.getMinZoom()?(n.animateTo({zoom:a,around:e._origin},{continueOnViewChanged:!0,duration:100},function(t){"finished"===t.state.playState&&setTimeout(function(){delete e._zooming,delete e._requesting},200)}),delete e._startZoom,delete e._origin,delete e._delta,e._requesting=0):f(e._requesting)||(delete e._zooming,e._onWheelScroll(t)))}),!1},e}(on);Jn.mergeOptions({scrollWheelZoom:!0}),Jn.addOnLoadHook("addHandler","scrollWheelZoom",Or);var Pr=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.addHooks=function(){Me(this.target.getContainer(),"touchstart",this._onTouchStart,this)},n.removeHooks=function(){ke(this.target.getContainer(),"touchstart",this._onTouchStart)},n._onTouchStart=function(t){var e=this.target;if(t.touches&&2===t.touches.length&&!e.isInteracting()){var n=e.getContainer(),r=Ne(t.touches[0],n),i=Ne(t.touches[1],n);this.preY=r.y,this._startP1=r,this._startP2=i,this._startDist=r.distanceTo(i),this._startVector=r.sub(i),this._startZoom=e.getZoom(),this._startBearing=e.getBearing(),Me(document,"touchmove",this._onTouchMove,this),Me(document,"touchend",this._onTouchEnd,this),Re(t),e._fireEvent("touchactstart")}},n._onTouchMove=function(t){var e=this.target;if(t.touches&&2===t.touches.length){var n=e.getContainer(),r=Ne(t.touches[0],n),i=Ne(t.touches[1],n),o=r.sub(this._startP1),a=i.sub(this._startP2),s=r.sub(i),u=r.distanceTo(i)/this._startDist,c=180*s.angleWith(this._startVector)/Math.PI,l=.4*((this.preY||r.y)-r.y);this.preY=r.y;var h={domEvent:t,mousePos:[r,i]};if(this.mode||(e.options.touchRotate&&Math.abs(c)>8?this.mode=e.options.touchZoomRotate?"rotate_zoom":"rotate":e.options.touchPitch&&o.y*a.y>0&&Math.abs(o.y)>10&&Math.abs(a.y)>10?this.mode="pitch":e.options.zoomable&&e.options.touchZoom&&Math.abs(1-u)>.15&&(this.mode=e.options.touchZoomRotate&&e.options.touchRotate?"rotate_zoom":"zoom"),this._startTouching(h)),"zoom"===this.mode||"rotate_zoom"===this.mode){this._scale=u;var f=e._getResolution(this._startZoom)/u,d=e.getZoomFromRes(f);e.onZooming(d,this._Origin)}"rotate"===this.mode||"rotate_zoom"===this.mode?(e.setBearing(this._startBearing+c),e.onDragRotating(h)):"pitch"===this.mode&&(e.setPitch(e.getPitch()+l),e.onDragRotating(h)),e._fireEvent("touchactinging")}},n._startTouching=function(t){var e=this.target;if("zoom"===this.mode||"rotate_zoom"===this.mode){var n=e.getSize();this._Origin=new oe(n.width/2,n.height/2),e.onZoomStart(null,this._Origin)}"rotate"!==this.mode&&"pitch"!==this.mode&&"rotate_zoom"!==this.mode||e.onDragRotateStart(t)},n._onTouchEnd=function(t){delete this.preY;var e=this.target;if(Je(document,"touchmove",this._onTouchMove,this),Je(document,"touchend",this._onTouchEnd,this),"zoom"===this.mode||"rotate_zoom"===this.mode){var n=this._scale,r=e._getResolution(this._startZoom)/n,i=e.getZoomFromRes(r);e.onZoomEnd(i,this._Origin)}"pitch"!==this.mode&&"rotate"!==this.mode&&"rotate_zoom"!==this.mode||e.onDragRotateEnd({domEvent:t}),delete this.mode,e._fireEvent("touchactend")},e}(on);Jn.mergeOptions({touchGesture:!0,touchZoom:!0,touchPitch:!0,touchRotate:!0,touchZoomRotate:!1}),Jn.addOnLoadHook("addHandler","touchGesture",Pr);var Sr={in:function(t){return Math.pow(t,2)},out:function(t){return 1-Sr.in(1-t)},inAndOut:function(t){return 3*t*t-2*t*t*t},linear:function(t){return t},upAndDown:function(t){return t<.5?Sr.inAndOut(2*t):1-Sr.inAndOut(2*(t-.5))}},Tr=function(t,e){this.state=t,this.styles=e},Cr=function(t,e,n){this._animation=t,this.options=e,this._onFrame=n,this.playState="idle",this.ready=!0,this.finished=!1},Ar={speed:{slow:2e3,normal:1e3,fast:500},_resolveStyles:function(t){if(!t)return null;function e(t){if(!Array.isArray(t))return Ar._resolveStyles(t);for(var e=[],n=[],r=[],i=0;i<t.length;i++){var o=Ar._resolveStyles(t[i]);o&&(e.push(o[0]),n.push(o[1]),r.push(o[2]))}return e.length?[e,n,r]:null}function n(t){var e,n=t;Array.isArray(t)||(n=d(t)?[0,t]:t instanceof oe||t instanceof dn?[new(e=t.constructor)(0,0),t]:[t,t]);var r=n[0],i=n[1];return d(r)&&d(i)?r===i?null:[r,i-r,i]:Array.isArray(r)||r instanceof dn||r instanceof oe?(Array.isArray(r)?(r=new dn(r),i=new dn(i)):(r=new(e=r.constructor)(r),i=new e(i)),r.equals(i)?null:[r,i.sub(r),i]):[r,0,i]}var r,i={},o={},a={};for(var s in t)if(t.hasOwnProperty(s)){var u=t[s];if(!u)continue;if(Array.isArray(u)&&(f(u[0])||f(u[1])))continue;var c=void 0;r=u,(c=!Array.isArray(r)&&r.constructor===Object||Array.isArray(r)&&r[0].constructor===Object?e(u):n(u))&&(o[s]=c[0],i[s]=c[1],a[s]=c[2])}return[o,i,a]},framing:function(t,e){e||(e={});var n,r,i,o=e.easing?Sr[e.easing]:Sr.linear;o||(o=Sr.linear),(t=Ar._resolveStyles(t))&&(r=t[0],n=t[1],i=t[2]);return function(t,e){var a,s;if(t<0)a={playState:"idle",delta:0},s=r;else if(t<e){var u=o(t/e);a={playState:"running",delta:u},s=function t(e,n,r){if(!n||!r)return null;var o={};for(var a in r)if(r.hasOwnProperty(a)){if(n[a]===i[a]){o[a]=n[a];continue}var s=n[a],u=r[a];if(d(u))o[a]=s+e*u;else if(Array.isArray(u)){for(var c=[],l=0;l<u.length;l++)c.push(t(e,s[l],u[l]));o[a]=c}else u.constructor===Object?o[a]=t(e,s,u):(s instanceof oe||s instanceof dn)&&(o[a]=s.add(u.multi(e)))}return o}(u,r,n)}else a={playState:"finished",delta:1},s=i;return a.startStyles=r,a.destStyles=i,a.progress=t,a.remainingMs=e-t,new Tr(a,s)}},_requestAnimFrame:function(t){this._frameQueue||(this._frameQueue=[]),this._frameQueue.push(t),this._a()},_a:function(){this._animationFrameId||(this._animationFrameId=E(Ar._frameFn))},_run:function(){if(this._frameQueue.length){var t=this._frameQueue;this._frameQueue=[];for(var e=0,n=t.length;e<n;e++)t[e]();this._frameQueue.length?this._animationFrameId=E(Ar._frameFn):delete this._animationFrameId}},animate:function(t,e,n){e||(e={});var r=Ar.framing(t,e);return new Cr(r,e,n)}};Ar._frameFn=Ar._run.bind(Ar),h(Cr.prototype,{_prepare:function(){var t=this.options,e=t.speed||t.duration;g(e)&&((e=Ar.speed[e])||(e=+e)),e||(e=Ar.speed.normal),this.duration=e,this._framer=t.framer||Ar._requestAnimFrame.bind(Ar)},play:function(){if("idle"!==this.playState&&"paused"!==this.playState)return this;"idle"===this.playState&&(this.currentTime=0,this._prepare());var t=l();if(!this.startTime){var e=this.options;this.startTime=e.startTime?e.startTime:t}return this._playStartTime=Math.max(t,this.startTime),"paused"===this.playState&&(this._playStartTime-=this.currentTime),this.playState="running",this._run(),this},pause:function(){return"paused"===this.playState?this:(this.playState="paused",this._run(),this)},cancel:function(){return"idle"===this.playState?this:(this.playState="idle",this.finished=!1,this._run(),this)},finish:function(){return"finished"===this.playState?this:(this.playState="finished",this.finished=!0,this._run(),this)},reverse:function(){},_run:function(){var t=this,e=this._onFrame,n=l(),r=n-this._playStartTime;if(this.options.repeat&&r>=this.duration&&(this._playStartTime=n,r=0),"running"===this.playState){var i=this._animation(r,this.duration);this.playState=i.state.playState,"idle"===this.playState?this.startTime>n&&setTimeout(this._run.bind(this),this.startTime-n):"running"===this.playState?this._framer(function(){"running"===t.playState&&(t.currentTime=r,e&&e(i),t._run())}):"finished"===this.playState&&(this.finished=!0,e&&e(i))}else if(e){"finished"===this.playState?r=this.duration:"idle"===this.playState&&(r=0);var o=this._animation(r,this.duration);o.state.playState=this.playState,e(o)}}});var Mr=Bn(function(t){!function(){function e(t,e,n){var r=e.x,i=e.y,o=n.x-r,a=n.y-i;if(0!==o||0!==a){var s=((t.x-r)*o+(t.y-i)*a)/(o*o+a*a);s>1?(r=n.x,i=n.y):s>0&&(r+=o*s,i+=a*s)}return(o=t.x-r)*o+(a=t.y-i)*a}function n(t,n){var r=t.length-1,i=[t[0]];return function t(n,r,i,o,a){for(var s,u=o,c=r+1;c<i;c++){var l=e(n[c],n[r],n[i]);l>u&&(s=c,u=l)}u>o&&(s-r>1&&t(n,r,s,o,a),a.push(n[s]),i-s>1&&t(n,s,i,o,a))}(t,0,r,n,i),i.push(t[r]),i}function r(t,e,r){if(t.length<=2)return t;var i=void 0!==e?e*e:1;return t=n(t=r?t:function(t,e){for(var n,r,i,o,a,s=t[0],u=[s],c=1,l=t.length;c<l;c++)n=t[c],i=s,o=void 0,a=void 0,o=(r=n).x-i.x,a=r.y-i.y,o*o+a*a>e&&(u.push(n),s=n);return s!==n&&u.push(n),u}(t,i),i)}t.exports=r,t.exports.default=r}()}),kr=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.getOutline=function(){var t=this._getPainter();if(!t)return null;var e=this.getMap(),n=t.getContainerExtent().convertTo(function(t){return e.containerPointToCoord(t)});return new jr(n.toArray(),{symbol:{lineWidth:1,lineColor:"6b707b"}})},n.animateShow=function(t,e){var n=this;void 0===t&&(t={}),this._showPlayer&&this._showPlayer.finish(),y(t)&&(e=t={});var r=this.getCoordinates();if(0===r.length)return this;this._animIdx=0,this._animLenSoFar=0,this.show();var i=!!this.getShell?this.getShell().concat(this.getShell()[0]):this.getCoordinates(),o=this._getProjection();this._aniShowCenter=o.unproject(this._getPrjExtent().getCenter());var a=t.duration||1e3,s=this.getLength(),u=t.easing||"out";this.setCoordinates([]);var c=this._showPlayer=Ar.animate({t:a},{duration:a,easing:u},function(t){if(n.getMap()){var o=n._drawAnimShowFrame(t.styles.t,a,s,i);"finished"===t.state.playState&&(delete n._showPlayer,delete n._aniShowCenter,delete n._animIdx,delete n._animLenSoFar,delete n._animTailRatio,n.setCoordinates(r)),e&&e(t,o)}else if("finished"!==c.playState&&(c.finish(),e)){var u=n.getCoordinates();e(t,u[u.length-1])}});return c.play(),c},n._drawAnimShowFrame=function(t,e,n,r){if(0===t)return r[0];var i,o,a=this.getMap(),s=t/e*n,u=0;for(i=this._animIdx,o=r.length;i<o-1&&(u=a.computeLength(r[i],r[i+1]),!(this._animLenSoFar+u>s));i++)this._animLenSoFar+=u;if(this._animIdx=i,this._animIdx>=o-1)return this.setCoordinates(r),r[r.length-1];var c=this._animIdx,l=r[c],h=r[c+1],f=(s-this._animLenSoFar)/u;this._animTailRatio=f;var d=l.x+(h.x-l.x)*f,p=l.y+(h.y-l.y)*f,v=new dn(d,p),g=!!this.getShell;if(!g&&this.options.smoothness>0){var y=r.slice(0,this._animIdx+3);this.setCoordinates(y)}else{var m=r.slice(0,this._animIdx+1);m.push(v),g?this.setCoordinates([this._aniShowCenter].concat(m)):this.setCoordinates(m)}return v},n._getCenterInExtent=function(t,e,n){var r=this.getExtent();if(!t.intersects(r))return null;var i=n(e,t);if(0===i.length)return null;var o=0,a=0,s=0;i.forEach(function(t){Array.isArray(t)?t.forEach(function(t){t.point&&(t=t.point),o+=t.x,a+=t.y,s++}):(t.point&&(t=t.point),o+=t.x,a+=t.y,s++)});var u=new dn(o,a)._multi(1/s);return u.count=s,u},n._getPath2DPoints=function(t,e,n){if(!U(t))return[];var r=this.getMap(),i=!e&&this._shouldSimplify(),o=this.options.simplifyTolerance*r._getResolution(),a=Array.isArray(t[0]);if(delete this._simplified,i&&!a){var s=t.length;t=Mr(t,o,!1),this._simplified=t.length<s}return f(n)&&(n=r.getZoom()),R(t,function(t){return r._prjToPoint(t,n)})},n._shouldSimplify=function(){var t=this.getLayer(),e=this.getProperties(),n=e&&t.options.enableAltitude&&!f(e[t.options.altitudeProperty]);return t&&t.options.enableSimplify&&!n&&this.options.enableSimplify&&!this._showPlayer},n._setPrjCoordinates=function(t){this._prjCoords=t,this.onShapeChanged()},n._getPrjCoordinates=function(){return this._getProjection()?(this._verifyProjection(),this._prjCoords||(this._prjCoords=this._projectCoords(this._coordinates)),this._prjCoords):null},n._updateCache=function(){this._clearCache(),this._getProjection()&&this._prjCoords&&(this._coordinates=this._unprojectCoords(this._getPrjCoordinates()))},n._clearProjection=function(){this._prjCoords=null,t.prototype._clearProjection.call(this)},n._projectCoords=function(t){var e=this._getProjection();return e?e.projectCoords(t):[]},n._unprojectCoords=function(t){var e=this._getProjection();return e?e.unprojectCoords(t):[]},n._computeCenter=function(){var t=this._coordinates;if(!U(t))return null;for(var e=0,n=0,r=0,i=t.length,o=0;o<i;o++)t[o]&&d(t[o].x)&&d(t[o].y)&&(e+=t[o].x,n+=t[o].y,r++);return new dn(e/r,n/r)},n._computeExtent=function(){var t=this._coordinates;if(!U(t))return null;var e=[t];return this.hasHoles&&this.hasHoles()&&e.push.apply(e,this.getHoles()),this._coords2Extent(e,this._getProjection())},n._computePrjExtent=function(){var t=[this._getPrjCoordinates()];return this.hasHoles&&this.hasHoles()&&t.push.apply(t,this._getPrjHoles()),this._coords2Extent(t)},n._get2DLength=function(){for(var t=this._getPath2DPoints(this._getPrjCoordinates(),!0),e=0,n=1,r=t.length;n<r;n++)e+=t[n].distanceTo(t[n-1]);return e},n._hitTestTolerance=function(){var t,e=this._getInternalSymbol();if(Array.isArray(e)){t=0;for(var n=0;n<e.length;n++)d(e[n].lineWidth)&&e[n].lineWidth>t&&(t=e[n].lineWidth)}else t=e.lineWidth;return d(t)?t/2:1.5},n._coords2Extent=function(t,e){for(var n=new gn(e),r=0,i=t.length;r<i;r++)for(var o=0,a=t[r].length;o<a;o++)n._combine(t[r][o]);return n},e}(wr);kr.mergeOptions({smoothness:0,enableClip:!0,enableSimplify:!0,simplifyTolerance:2,symbol:{lineColor:"#000",lineWidth:2,lineOpacity:1,polygonFill:"#fff",polygonOpacity:1,opacity:1}});var jr=function(t){function e(e,n){var r;return(r=t.call(this,n)||this).type="Polygon",e&&r.setCoordinates(e),r}ne(e,t);var n=e.prototype;return n.setCoordinates=function(t){if(!t)return this._coordinates=null,this._holes=null,this._projectRings(),this;var e=dn.toCoordinates(t),n=e.length;if(Array.isArray(e[0])){if(this._coordinates=this._trimRing(e[0]),n>1){for(var r=[],i=1;i<n;i++)e[i]&&r.push(this._trimRing(e[i]));this._holes=r}}else this._coordinates=this._trimRing(e);return this._projectRings(),this},n.getCoordinates=function(){if(!this._coordinates)return[];for(var t=this.getHoles(),e=[this._copyAndCloseRing(this._coordinates)],n=0,r=t.length;n<r;n++)e.push(this._copyAndCloseRing(t[n]));return e},n.getCenterInExtent=function(t){return this._getCenterInExtent(t,this.getShell(),er)},n.getShell=function(){return this._coordinates||[]},n.getHoles=function(){return this._holes||[]},n.hasHoles=function(){return this.getHoles().length>0},n._projectRings=function(){this.getMap()?(this._prjCoords=this._projectCoords(this._coordinates),this._prjHoles=this._projectCoords(this._holes),this.onShapeChanged()):this.onShapeChanged()},n._cleanRing=function(t){for(var e=t.length-1;e>=0;e--)t[e]||t.splice(e,1)},n._checkRing=function(t){if(this._cleanRing(t),!t||!U(t))return!1;var e=t[t.length-1],n=!0;return t[0].x===e.x&&t[0].y===e.y||(n=!1),n},n._trimRing=function(t){var e=this._checkRing(t);return U(t)&&e&&t.splice(t.length-1,1),t},n._copyAndCloseRing=function(t){t=t.slice(0);var e=this._checkRing(t);return U(t)&&!e?(t.push(t[0].copy()),t):t},n._getPrjShell=function(){return"Polygon"===this.getJSONType()?this._getPrjCoordinates():this._getProjection()?(this._verifyProjection(),this._prjShell||(this._prjShell=this._projectCoords(this.getShell())),this._prjShell):null},n._getPrjHoles=function(){return this._getProjection()?(this._verifyProjection(),this._prjHoles||(this._prjHoles=this._projectCoords(this.getHoles())),this._prjHoles):null},n._computeGeodesicLength=function(t){var e=this.getCoordinates();if(!U(e))return 0;for(var n=0,r=0,i=e.length;r<i;r++)n+=t.measureLength(e[r]);return n},n._computeGeodesicArea=function(t){var e=this.getCoordinates();if(!U(e))return 0;for(var n=t.measureArea(e[0]),r=1,i=e.length;r<i;r++)n-=t.measureArea(e[r]);return n},n._updateCache=function(){t.prototype._updateCache.call(this),this._prjHoles&&(this._holes=this._unprojectCoords(this._getPrjHoles()))},n._clearCache=function(){return delete this._prjShell,t.prototype._clearCache.call(this)},n._clearProjection=function(){this._prjHoles&&(this._prjHoles=null),this._prjShell&&(this._prjShell=null),t.prototype._clearProjection.call(this)},e}(kr);function Rr(t){return function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.getCoordinates=function(){return this._coordinates},n.setCoordinates=function(t){var e=t instanceof dn?t:new dn(t);if(e.equals(this._coordinates))return this;if(this._coordinates=e,!this.getMap())return this.onPositionChanged(),this;var n=this._getProjection();return this._setPrjCoordinates(n.project(this._coordinates)),this},n._getCenter2DPoint=function(t){var e=this.getMap();if(!e)return null;var n=f(t)?e.getZoom():e.getGLZoom(),r=this._getPrjCoordinates();return r?e._prjToPoint(r,n):null},n._getPrjCoordinates=function(){var t=this._getProjection();return t?(this._verifyProjection(),this._pcenter||this._coordinates&&(this._pcenter=t.project(this._coordinates)),this._pcenter):null},n._setPrjCoordinates=function(t){this._pcenter=t,this.onPositionChanged()},n._updateCache=function(){this._clearCache();var t=this._getProjection();this._pcenter&&t&&(this._coordinates=t.unproject(this._pcenter))},n._clearProjection=function(){this._pcenter=null,t.prototype._clearProjection.call(this)},n._computeCenter=function(){return this._coordinates?this._coordinates.copy():null},e}(t)}jr.registerJSONType("Polygon");var Lr=function(t){function e(e,n){var r;return(r=t.call(this,n)||this).type="Point",e&&r.setCoordinates(e),r}ne(e,t);var n=e.prototype;return n.getOutline=function(){var t=this._getPainter();if(!t)return null;var n=this.getCoordinates(),r=t.getContainerExtent(),i=this.getMap().coordToContainerPoint(n);return new e(n,{symbol:{markerType:"square",markerWidth:r.getWidth(),markerHeight:r.getHeight(),markerLineWidth:1,markerLineColor:"6b707b",markerFill:"rgba(0, 0, 0, 0)",markerDx:r.xmin-(i.x-r.getWidth()/2),markerDy:r.ymin-(i.y-r.getHeight()/2)}})},n._isVectorMarker=function(){var t=this._getInternalSymbol();return!Array.isArray(t)&&ur.test(t)},n._canEdit=function(){var t=this._getInternalSymbol();return!Array.isArray(t)&&(ur.test(t)||vr.test(t)||lr.test(t))},n._containsPoint=function(e,n){var r=this.getContainerExtent();return n&&(r=r.expand(n)),!!r.contains(e)&&(!this.options.hitTestForEvent||t.prototype._containsPoint.call(this,e,n))},n._computeExtent=function(){return Ir.call(this,"getCenter")},n._computePrjExtent=function(){return Ir.call(this,"_getPrjCoordinates")},n._computeGeodesicLength=function(){return 0},n._computeGeodesicArea=function(){return 0},n._getSprite=function(t,e){return this._getPainter()?this._getPainter().getSprite(t,e):new _r(this).getSprite(t,e)},e}(Rr(wr));function Ir(t){var e=this[t]();return e?new gn(e,e,this._getProjection()):null}Lr.mergeOptions({symbol:{markerType:"path",markerPath:[{path:"M8 23l0 0 0 0 0 0 0 0 0 0c-4,-5 -8,-10 -8,-14 0,-5 4,-9 8,-9l0 0 0 0c4,0 8,4 8,9 0,4 -4,9 -8,14z M3,9 a5,5 0,1,0,0,-0.9Z",fill:"#DE3333"}],markerPathWidth:16,markerPathHeight:23,markerWidth:24,markerHeight:34},hitTestForEvent:!1}),Lr.registerJSONType("Marker");var Dr=function(t){function e(e,n){var r;return(r=t.call(this,n)||this).type="LineString",e&&r.setCoordinates(e),r}ne(e,t);var n=e.prototype;return n.setCoordinates=function(t){return t?(this._coordinates=dn.toCoordinates(t),this.getMap()?this._setPrjCoordinates(this._projectCoords(this._coordinates)):this.onShapeChanged(),this):(this._coordinates=null,this._setPrjCoordinates(null),this)},n.getCoordinates=function(){return this._coordinates||[]},n.getCenterInExtent=function(t){return this._getCenterInExtent(t,this.getCoordinates(),$n)},n._computeGeodesicLength=function(t){return t.measureLength(this.getCoordinates())},n._computeGeodesicArea=function(){return 0},e}(kr);Dr.mergeOptions({arrowStyle:null,arrowPlacement:"vertex-last"}),Dr.registerJSONType("LineString");var Fr=function(t){function e(e,n){var r;return(r=t.call(this,n)||this).type="GeometryCollection",r.setGeometries(e),r}ne(e,t);var n=e.prototype;return n.setGeometries=function(t){for(var e=this._checkGeometries(t||[]),n=this._getSymbol(),r=this.config(),i=e.length-1;i>=0;i--)e[i]._initOptions(r),e[i]._setParent(this),e[i]._setEventParent(this),n&&e[i].setSymbol(n);return this._geometries=e,this.getLayer()&&(this._bindGeometriesToLayer(),this.onShapeChanged()),this},n.getGeometries=function(){return this._geometries||[]},n.forEach=function(t,e){for(var n=this.getGeometries(),r=0,i=n.length;r<i;r++)n[r]&&(e?t.call(e,n[r],r):t(n[r],r));return this},n.filter=function(t,n){if(!t)return new e;var r=[],i=y(t),o=i?t:et(t);return this.forEach(function(t){var e=i?t:lt(t);(n?o.call(n,e):o(e))&&r.push(t)},this),new e(r)},n.translate=function(t){if(!t)return this;if(this.isEmpty())return this;var e=arguments;return this.forEach(function(t){t&&t.translate&&t.translate.apply(t,e)}),this},n.isEmpty=function(){return!U(this.getGeometries())},n.remove=function(){return this.forEach(function(t){t._unbind()}),wr.prototype.remove.apply(this,arguments)},n.show=function(){return this.options.visible=!0,this.forEach(function(t){t.show()}),this},n.hide=function(){return this.options.visible=!1,this.forEach(function(t){t.hide()}),this},n.onConfig=function(t){this.forEach(function(e){e.config(t)})},n.getSymbol=function(){var e=t.prototype.getSymbol.call(this);if(!e){var n=[],r=!1;this.forEach(function(t){t.getSymbol()&&!r&&(r=!0),n.push(t.getSymbol())}),r&&(e={children:n})}return e},n.setSymbol=function(t){if(t&&t.children)this._symbol=null,this.forEach(function(e,n){e.setSymbol(t.children[n])});else{var e=this._prepareSymbol(t);this._symbol=e,this.forEach(function(t){t.setSymbol(e)})}return this.onSymbolChanged(),this},n._setExternSymbol=function(t){return t=this._prepareSymbol(t),this._externSymbol=t,this.forEach(function(e){e._setExternSymbol(t)}),this.onSymbolChanged(),this},n._bindLayer=function(){t.prototype._bindLayer.apply(this,arguments),this._bindGeometriesToLayer()},n._bindGeometriesToLayer=function(){var t=this.getLayer();this.forEach(function(e){e._bindLayer(t)})},n._checkGeometries=function(t){if(t&&!Array.isArray(t)){if(t instanceof wr)return[t];throw new Error("The geometry added to collection is invalid.")}for(var e=0,n=t.length;e<n;e++)if(!this._checkGeo(t[e]))throw new Error("The geometry added to collection is invalid. Index: "+e);return t},n._checkGeo=function(t){return t instanceof wr},n._updateCache=function(){this._clearCache(),this.isEmpty()||this.forEach(function(t){t&&t._updateCache&&t._updateCache()})},n._removePainter=function(){this._painter&&this._painter.remove(),delete this._painter,this.forEach(function(t){t._removePainter()})},n._computeCenter=function(t){if(!t||this.isEmpty())return null;for(var e=0,n=0,r=0,i=this.getGeometries(),o=0,a=i.length;o<a;o++)if(i[o]){var s=i[o]._computeCenter(t);s&&(e+=s.x,n+=s.y,r++)}return 0===r?null:new dn(e/r,n/r)},n._containsPoint=function(t,e){if(this.isEmpty())return!1;for(var n=this.getGeometries(),r=0,i=n.length;r<i;r++)if(n[r]._containsPoint(t,e))return!0;return!1},n._computeExtent=function(t){return Nr.call(this,t,"_computeExtent")},n._computePrjExtent=function(t){return Nr.call(this,t,"_computePrjExtent")},n._computeGeodesicLength=function(t){if(!t||this.isEmpty())return 0;for(var e=this.getGeometries(),n=0,r=0,i=e.length;r<i;r++)e[r]&&(n+=e[r]._computeGeodesicLength(t));return n},n._computeGeodesicArea=function(t){if(!t||this.isEmpty())return 0;for(var e=this.getGeometries(),n=0,r=0,i=e.length;r<i;r++)e[r]&&(n+=e[r]._computeGeodesicArea(t));return n},n._exportGeoJSONGeometry=function(){var t=[];if(!this.isEmpty())for(var e=this.getGeometries(),n=0,r=e.length;n<r;n++)e[n]&&t.push(e[n]._exportGeoJSONGeometry());return{type:"GeometryCollection",geometries:t}},n._clearProjection=function(){if(!this.isEmpty())for(var t=this.getGeometries(),e=0,n=t.length;e<n;e++)t[e]&&t[e]._clearProjection()},n._getConnectPoints=function(){var t=this.getExtent();return[new dn(t.xmin,t.ymax),new dn(t.xmax,t.ymin),new dn(t.xmin,t.ymin),new dn(t.xmax,t.ymax)]},n._getExternalResources=function(){if(this.isEmpty())return[];for(var t,e,n=this.getGeometries(),r=[],i={},o=0,a=n.length;o<a;o++)if(n[o])for(var s=0,u=(t=St(n[o]._getInternalSymbol())).length;s<u;s++)i[e=t[s].join()]||(r.push(t[s]),i[e]=1);return r},n.startEdit=function(t){var e=this;if(this.isEmpty())return this;t||(t={}),t.symbol&&(this._originalSymbol=this.getSymbol(),this.setSymbol(t.symbol)),this._draggbleBeforeEdit=this.options.draggable,this.config("draggable",!1);for(var n=this.getGeometries(),r=0,i=n.length;r<i;r++)n[r].startEdit(t);return this._editing=!0,this.hide(),setTimeout(function(){e.fire("editstart")},1),this},n.endEdit=function(){if(this.isEmpty())return this;for(var t=this.getGeometries(),e=0,n=t.length;e<n;e++)t[e].endEdit();return this._originalSymbol&&(this.setSymbol(this._originalSymbol),delete this._originalSymbol),this._editing=!1,this.show(),this.config("draggable",this._draggbleBeforeEdit),this.fire("editend"),this},n.isEditing=function(){return!!this._editing},e}(wr);function Nr(t,e){if(this.isEmpty())return null;for(var n=this.getGeometries(),r=null,i=0,o=n.length;i<o;i++){var a=n[i];if(a){var s=a[e](t);s&&(r=s.combine(r))}}return r}Fr.registerJSONType("GeometryCollection");var Br=function(t){function e(e,n,r,i){var o;return(o=t.call(this,null,i)||this).GeometryType=e,o.type=n,o._initData(r),o}ne(e,t);var n=e.prototype;return n.getCoordinates=function(){for(var t=[],e=this.getGeometries(),n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.getShell&&"Polygon"!==i.getJSONType()?[i.getShell()]:i.getCoordinates())}return t},n.setCoordinates=function(t){for(var e=[],n=0,r=(t=t||[]).length;n<r;n++){var i=new this.GeometryType(t[n],this.config());e.push(i)}return this.setGeometries(e),this},n._initData=function(t){(t=t||[]).length&&(t[0]instanceof this.GeometryType?this.setGeometries(t):this.setCoordinates(t))},n._checkGeo=function(t){return t instanceof this.GeometryType},n._exportGeoJSONGeometry=function(){var t=this.getCoordinates(),e=dn.toNumberArrays(t);return{type:this.getType(),coordinates:e}},e}(Fr),Ur=function(t){function e(e,n){return t.call(this,Lr,"MultiPoint",e,n)||this}return ne(e,t),e.prototype.findClosest=function(t){if(!t)return null;var e=this.getCoordinates(),n=null,r=1/0;return e.forEach(function(e){var i,o,a,s,u=(i=e,a=(o=t).x-i.x,s=o.y-i.y,Math.sqrt(a*a+s*s));u<r&&(n=e,r=u)}),n},e}(Br);Ur.registerJSONType("MultiPoint");var zr=function(t){function e(){return t.apply(this,arguments)||this}return ne(e,t),e.prototype.getCenterInExtent=function(t){var e=this.getGeometries(),n=0,r=0,i=0;return e.forEach(function(e){var o=e.getCenterInExtent(t);o&&(n+=o.x*o.count,r+=o.y*o.count,i+=o.count)}),0===i?null:new dn(n,r)._multi(1/i)},e}(Br),Gr=function(t){function e(e,n){return t.call(this,Dr,"MultiLineString",e,n)||this}return ne(e,t),e}(zr);Gr.registerJSONType("MultiLineString");var Vr=function(t){function e(e,n){return t.call(this,jr,"MultiPolygon",e,n)||this}return ne(e,t),e}(zr);Vr.registerJSONType("MultiPolygon");var Wr={Marker:Lr,LineString:Dr,Polygon:jr,MultiPoint:Ur,MultiLineString:Gr,MultiPolygon:Vr},Zr={toGeometry:function(t){if(g(t)&&(t=M(t)),Array.isArray(t)){for(var e=[],n=0,r=t.length;n<r;n++){var i=Zr._convert(t[n]);Array.isArray(i)?k(e,i):e.push(i)}return e}return Zr._convert(t)},_convert:function(t){if(!t||f(t.type))return null;var e=t.type;if("Feature"===e){var n=t.geometry,r=Zr._convert(n);return r?(r.setId(t.id),r.setProperties(t.properties),r):null}if("FeatureCollection"===e){var i=t.features;return i?Zr.toGeometry(i):null}if(["Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon"].indexOf(e)>=0)return new Wr["Point"===e?"Marker":e](t.coordinates);if("GeometryCollection"===e){var o=t.geometries;if(!U(o))return new Fr;for(var a=[],s=o.length,u=0;u<s;u++)a.push(Zr._convert(o[u]));return new Fr(a)}return null}},Hr=function(t){function e(e,n,r){var i;return i=t.call(this,null,r)||this,e&&i.setCoordinates(e),i._radius=n,i}ne(e,t),e.fromJSON=function(t){var n=t.feature,r=new e(t.coordinates,t.radius,t.options);return r.setProperties(n.properties),r};var n=e.prototype;return n.getRadius=function(){return this._radius},n.setRadius=function(t){return this._radius=t,this.onShapeChanged(),this},n.getShell=function(){for(var t,e,n,r=this._getMeasurer(),i=this.getCoordinates(),o=this.options.numberOfShellPoints,a=this.getRadius(),s=[],u=0,c=o-1;u<c;u++){t=360*u/c*Math.PI/180,e=a*Math.cos(t),n=a*Math.sin(t);var l=r.locate(i,e,n);s.push(l)}return s.push(s[0]),s},n.getHoles=function(){return[]},n.animateShow=function(){return this.show()},n._containsPoint=function(e,n){var r=this.getMap();if(r.getPitch())return t.prototype._containsPoint.call(this,e,n);var i=r._pointToContainerPoint(this._getCenter2DPoint()),o=this.getSize(),a=f(n)?this._hitTestTolerance():n,s=i.add(o.width/2,o.height/2);return ir(e,i,s,a)},n._computePrjExtent=function(t){var e=this._getMinMax(t);if(!e)return null;var n=this._getPrjCoordinates(),r=e.map(function(e){return t.project(e)}),i=Math.min(Math.abs(r[0].x-n.x),Math.abs(r[1].x-n.x)),o=Math.min(Math.abs(r[2].y-n.y),Math.abs(r[3].y-n.y));return new gn(n.sub(i,o),n.add(i,o))},n._computeExtent=function(t){var e=this._getMinMax(t);return e?new gn(e[0].x,e[2].y,e[1].x,e[3].y,this._getProjection()):null},n._getMinMax=function(t){if(!t||!this._coordinates||f(this._radius))return null;var e=this._radius;return[t.locate(this._coordinates,-e,0),t.locate(this._coordinates,e,0),t.locate(this._coordinates,0,e),t.locate(this._coordinates,0,-e)]},n._computeGeodesicLength=function(){return f(this._radius)?0:2*Math.PI*this._radius},n._computeGeodesicArea=function(){return f(this._radius)?0:Math.PI*Math.pow(this._radius,2)},n._exportGeoJSONGeometry=function(){return{type:"Polygon",coordinates:dn.toNumberArrays([this.getShell()])}},n._toJSON=function(t){var e=this.getCenter(),n=h({},t);n.geometry=!1;var r=this.toGeoJSON(n);return r.geometry={type:"Polygon"},{feature:r,subType:"Circle",coordinates:[e.x,e.y],radius:this.getRadius()}},e}(Rr(jr));Hr.mergeOptions({numberOfShellPoints:60}),Hr.registerJSONType("Circle");var Xr=function(t){function e(e,n,r,i){var o;return o=t.call(this,null,i)||this,e&&o.setCoordinates(e),o.width=n,o.height=r,o}ne(e,t),e.fromJSON=function(t){var n=t.feature,r=new e(t.coordinates,t.width,t.height,t.options);return r.setProperties(n.properties),r};var n=e.prototype;return n.getWidth=function(){return this.width},n.setWidth=function(t){return this.width=t,this.onShapeChanged(),this},n.getHeight=function(){return this.height},n.setHeight=function(t){return this.height=t,this.onShapeChanged(),this},n.getShell=function(){for(var t,e,n,r,i=this._getMeasurer(),o=this.getCoordinates(),a=this.options.numberOfShellPoints,s=this.getWidth(),u=this.getHeight(),c=[],l=Math.pow(s/2,2)*Math.pow(u/2,2),h=Math.pow(s/2,2),f=Math.pow(u/2,2),d=0;d<a;d++){e=(t=360*d/a)*Math.PI/180,n=Math.sqrt(l/(h*Math.pow(Math.tan(e),2)+f)),r=Math.sqrt(l/(f*Math.pow(1/Math.tan(e),2)+h)),t>90&&t<270&&(n*=-1),t>180&&t<360&&(r*=-1);var p=i.locate(o,n,r);c.push(p)}return c},n.getHoles=function(){return[]},n.animateShow=function(){return this.show()},n._containsPoint=function(e,n){var r=this.getMap();if(r.isTransforming())return t.prototype._containsPoint.call(this,e,n);var i=r.getProjection(),o=f(n)?this._hitTestTolerance():n,a=i.projectCoords([this._coordinates,r.locate(this._coordinates,this.getWidth()/2,this.getHeight()/2)]);return ir(e,r._prjToContainerPoint(a[0]),r._prjToContainerPoint(a[1]),o)},n._computePrjExtent=function(){return Hr.prototype._computePrjExtent.apply(this,arguments)},n._computeExtent=function(){return Hr.prototype._computeExtent.apply(this,arguments)},n._getMinMax=function(t){if(!t||!this._coordinates||f(this.width)||f(this.height))return null;var e=this.getWidth(),n=this.getHeight();return[t.locate(this._coordinates,-e/2,0),t.locate(this._coordinates,e/2,0),t.locate(this._coordinates,0,-n/2),t.locate(this._coordinates,0,n/2)]},n._computeGeodesicLength=function(){if(f(this.width)||f(this.height))return 0;var t=this.width>this.height?this.width:this.height;return 2*Math.PI*t/2-4*Math.abs(this.width-this.height)},n._computeGeodesicArea=function(){return f(this.width)||f(this.height)?0:Math.PI*this.width*this.height/4},n._exportGeoJSONGeometry=function(){return{type:"Polygon",coordinates:dn.toNumberArrays([this.getShell()])}},n._toJSON=function(t){var e=h({},t),n=this.getCenter();e.geometry=!1;var r=this.toGeoJSON(e);return r.geometry={type:"Polygon"},{feature:r,subType:"Ellipse",coordinates:[n.x,n.y],width:this.getWidth(),height:this.getHeight()}},e}(Rr(jr));Xr.mergeOptions({numberOfShellPoints:80}),Xr.registerJSONType("Ellipse");var Yr=function(t){function e(e,n,r,i){var o;return o=t.call(this,null,i)||this,e&&o.setCoordinates(e),o._width=n,o._height=r,o}ne(e,t),e.fromJSON=function(t){var n=t.feature,r=new e(t.coordinates,t.width,t.height,t.options);return r.setProperties(n.properties),r};var n=e.prototype;return n.getCoordinates=function(){return this._coordinates},n.setCoordinates=function(t){if(this._coordinates=t instanceof dn?t:new dn(t),!this._coordinates||!this.getMap())return this.onPositionChanged(),this;var e=this._getProjection();return this._setPrjCoordinates(e.project(this._coordinates)),this},n.getWidth=function(){return this._width},n.setWidth=function(t){return this._width=t,this.onShapeChanged(),this},n.getHeight=function(){return this._height},n.setHeight=function(t){return this._height=t,this.onShapeChanged(),this},n.getShell=function(){var t=this._getMeasurer(),e=this._coordinates,n=this.getMap(),r=1,i=-1;if(n){var o=n.getFullExtent();o.left>o.right&&(r=-1),o.bottom>o.top&&(i=1)}var a=[];return a.push(e),a.push(t.locate(e,r*this._width,0)),a.push(t.locate(e,r*this._width,i*this._height)),a.push(t.locate(e,0,i*this._height)),a.push(e),a},n.getHoles=function(){return[]},n.animateShow=function(){return this.show()},n._getPrjCoordinates=function(){var t=this._getProjection();return t?(this._verifyProjection(),this._pnw||this._coordinates&&(this._pnw=t.project(this._coordinates)),this._pnw):null},n._setPrjCoordinates=function(t){this._pnw=t,this.onPositionChanged()},n._getPrjShell=function(){var e=t.prototype._getPrjShell.call(this),n=this._getProjection();if(!n.isSphere())return e;for(var r=n.getSphereExtent(),i=r.sx,o=r.sy,a=this._getProjection().getCircum(),s=e[0],u=1,c=e.length;u<c;u++){var l=e[u],h=0,f=0;i*(s.x-l.x)>0&&(h=a.x*i),o*(s.y-l.y)<0&&(f=a.y*o),e[u]._add(h,f)}return e},n._updateCache=function(){this._clearCache();var t=this._getProjection();this._pnw&&t&&(this._coordinates=t.unproject(this._pnw))},n._clearProjection=function(){this._pnw=null,t.prototype._clearProjection.call(this)},n._computeCenter=function(t){return t.locate(this._coordinates,this._width/2,-this._height/2)},n._containsPoint=function(e,n){var r=this.getMap();if(r.isTransforming())return t.prototype._containsPoint.call(this,e,n);var i=f(n)?this._hitTestTolerance():n,o=r._getResolution()*i,a=this._getPrjExtent().expand(o),s=r._containerPointToPrj(e);return a.contains(s)},n._computePrjExtent=function(t){var e=this._getSouthEast(t);if(!e)return null;var n=t.projectCoords([new dn(this._coordinates.x,e.y),new dn(e.x,this._coordinates.y)]);return new gn(n[0],n[1])},n._computeExtent=function(t){var e=this._getSouthEast(t);return e?new gn(this._coordinates,e,this._getProjection()):null},n._getSouthEast=function(t){if(!t||!this._coordinates||f(this._width)||f(this._height))return null;var e=this.getWidth(),n=-this.getHeight();if(t.fullExtent){var r=t.fullExtent;e*=r.right>r.left?1:-1,n*=r.top>r.bottom?1:-1}return t.locate(this._coordinates,e,n)},n._computeGeodesicLength=function(){return f(this._width)||f(this._height)?0:2*(this._width+this._height)},n._computeGeodesicArea=function(){return f(this._width)||f(this._height)?0:this._width*this._height},n._exportGeoJSONGeometry=function(){return{type:"Polygon",coordinates:dn.toNumberArrays([this.getShell()])}},n._toJSON=function(t){var e=h({},t),n=this.getCoordinates();e.geometry=!1;var r=this.toGeoJSON(e);return r.geometry={type:"Polygon"},{feature:r,subType:"Rectangle",coordinates:[n.x,n.y],width:this.getWidth(),height:this.getHeight()}},e}(jr);Yr.registerJSONType("Rectangle");var Jr=function(t){function e(e,n,r,i,o){var a;return(a=t.call(this,e,n,o)||this).startAngle=r,a.endAngle=i,a}ne(e,t),e.fromJSON=function(t){var n=t.feature,r=new e(t.coordinates,t.radius,t.startAngle,t.endAngle,t.options);return r.setProperties(n.properties),r};var n=e.prototype;return n.getStartAngle=function(){return this.startAngle},n.setStartAngle=function(t){return this.startAngle=t,this.onShapeChanged(),this},n.getEndAngle=function(){return this.endAngle},n.setEndAngle=function(t){return this.endAngle=t,this.onShapeChanged(),this},n.getShell=function(){for(var t,e,n,r=this._getMeasurer(),i=this.getCoordinates(),o=this.options.numberOfShellPoints-2,a=this.getRadius(),s=[i.copy()],u=this.getStartAngle(),c=this.getEndAngle()-u,l=0;l<o;l++){t=(c*l/(o-1)+u)*Math.PI/180,e=a*Math.cos(t),n=a*Math.sin(t);var h=r.locate(i,e,n);s.push(h)}return s.push(i.copy()),s},n._containsPoint=function(e,n){var r=this.getMap();if(r.isTransforming())return t.prototype._containsPoint.call(this,e,n);var i=r._pointToContainerPoint(this._getCenter2DPoint()),o=f(n)?this._hitTestTolerance():n,a=this.getSize(),s=i,u=e,c=u.x-s.x,l=s.y-u.y,h=Math.atan2(l,c),d=h<0?360*(h+2*Math.PI)/(2*Math.PI):360*h/(2*Math.PI),p=this.startAngle%360,v=this.endAngle%360,g=!1;return g=p>v?!(d>v&&d<p):d>=p&&d<=v,u.distanceTo(s)<=a.width/2+o&&g},n._computeGeodesicLength=function(){return f(this._radius)?0:2*Math.PI*this._radius*Math.abs(this.startAngle-this.endAngle)/360+2*this._radius},n._computeGeodesicArea=function(){return f(this._radius)?0:Math.PI*Math.pow(this._radius,2)*Math.abs(this.startAngle-this.endAngle)/360},n._toJSON=function(t){var e=h({},t),n=this.getCenter();e.geometry=!1;var r=this.toGeoJSON(e);return r.geometry={type:"Polygon"},{feature:r,subType:"Sector",coordinates:[n.x,n.y],radius:this.getRadius(),startAngle:this.getStartAngle(),endAngle:this.getEndAngle()}},e}(Hr);Jr.mergeOptions({numberOfShellPoints:60}),Jr.registerJSONType("Sector");var qr=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n._arc=function(t,e,n){for(var r=this.options.arcDegree*Math.PI/180,i=1,o=e.length;i<o;i++){var a=Ke._arcBetween(t,e[i-1],e[i],r),s=[e[i-1].x+e[i].x-a[0],e[i-1].y+e[i].y-a[1]];e[i-1].nextCtrlPoint=s,e[i].prevCtrlPoint=s,Ke._stroke(t,n)}},n._quadraticCurve=function(t,e){if(e.length<=2)Ke._path(t,e);else{var n,r;for(n=2,r=e.length;n<r;n+=2)t.quadraticCurveTo(e[n-1].x,e[n-1].y,e[n].x,e[n].y);if((n-=1)<r)for(;n<r;n++)t.lineTo(e[n].x,e[n].y)}},n._bezierCurve=function(t,e){if(e.length<=3)Ke._path(t,e);else{var n,r;for(n=1,r=e.length;n+2<r;n+=3)t.bezierCurveTo(e[n].x,e[n].y,e[n+1].x,e[n+1].y,e[n+2].x,e[n+2].y);if(n<r)for(;n<r;n++)t.lineTo(e[n].x,e[n].y)}},n._getCurveArrowPoints=function(t,e,n,r,i,o){var a,s=e.length;for(a=o;a<s;a+=o)t.push(this._getArrowShape(e[a-1],e[a],n,r,i));if((a-=o)<s-1)for(a+=1;a<s;a++)t.push(this._getArrowShape(e[a-1],e[a],n,r,i))},e}(Dr);qr.mergeOptions({enableSimplify:!1,enableClip:!1});var Qr=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n._toJSON=function(t){return{feature:this.toGeoJSON(t),subType:"ArcCurve"}},n._paintOn=function(t,e,n){t.beginPath(),this._arc(t,e,n),Ke._stroke(t,n),this._paintArrow(t,e,n)},e.fromJSON=function(t){var n=t.feature,r=new e(n.geometry.coordinates,t.options);return r.setProperties(n.properties),r},e}(qr);Qr.registerJSONType("ArcCurve"),Qr.mergeOptions({arcDegree:90});var Kr=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t),e.fromJSON=function(t){var n=t.feature,r=new e(n.geometry.coordinates,t.options);return r.setProperties(n.properties),r};var n=e.prototype;return n._toJSON=function(t){return{feature:this.toGeoJSON(t),subType:"CubicBezierCurve"}},n._paintOn=function(t,e,n){t.beginPath(),t.moveTo(e[0].x,e[0].y),this._bezierCurve(t,e),Ke._stroke(t,n),this._paintArrow(t,e,n)},n._getArrowPoints=function(t,e,n,r,i){return this._getCurveArrowPoints(t,e,n,r,i,3)},e}(qr);Kr.registerJSONType("CubicBezierCurve");var $r=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t),e.fromJSON=function(t){var n=t.feature,r=new e(n.geometry.coordinates,t.options);return r.setProperties(n.properties),r};var n=e.prototype;return n._toJSON=function(t){return{feature:this.toGeoJSON(t),subType:"QuadBezierCurve"}},n._paintOn=function(t,e,n){t.beginPath(),t.moveTo(e[0].x,e[0].y),this._quadraticCurve(t,e,n),Ke._stroke(t,n),this._paintArrow(t,e,n)},n._getArrowPoints=function(t,e,n,r,i){return this._getCurveArrowPoints(t,e,n,r,i,2)},e}(qr);$r.registerJSONType("QuadBezierCurve");var ti={textFaceName:"monospace",textSize:12,textLineSpacing:8,textWrapCharacter:"\n",textHorizontalAlignment:"middle",textVerticalAlignment:"middle"},ei={markerType:"square",markerLineColor:"#000",markerLineWidth:2,markerLineOpacity:1,markerFill:"#fff",markerOpacity:1},ni=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.getContent=function(){return this._content},n.setContent=function(t){var e=this._content;return this._content=ce(t),this._refresh(),this._fireEvent("contentchange",{old:e,new:t}),this},n.onAdd=function(){this._refresh()},n.toJSON=function(){var e=t.prototype.toJSON.call(this);return delete e.symbol,e},n.setSymbol=function(e){if(this._refreshing||!e)return t.prototype.setSymbol.call(this,e);var n=this._parseSymbol(e);if(this.setTextStyle){var r=this.getTextStyle()||{};r.symbol=n[0],this.setTextStyle(r)}else this.setTextSymbol&&this.setTextSymbol(n[0]);if(this.setBoxStyle){var i=this.getBoxStyle()||{};i.symbol=n[1],this.setBoxStyle(i)}else this.setBoxSymbol&&this.setBoxSymbol(n[1]);return this},n._parseSymbol=function(t){var e={},n={};for(var r in t)_(t,r)&&(0===r.indexOf("text")?e[r]=t[r]:n[r]=t[r]);return[e,n]},n._getTextSize=function(t){return xe(this._content,t).size},n._getInternalSymbol=function(){return this._symbol},n._getDefaultTextSymbol=function(){return h({},ti)},n._getDefaultBoxSymbol=function(){return h({},ei)},n._getDefaultPadding=function(){return[12,8]},e}(Lr),ri=function(t){function e(e,n,r,i,o){var a;return void 0===o&&(o={}),(a=t.call(this,n,o)||this)._content=ce(e),a._width=f(r)?100:r,a._height=f(i)?40:i,o.boxSymbol&&a.setBoxSymbol(o.boxSymbol),o.textStyle&&a.setTextStyle(o.textStyle),a._refresh(),a}ne(e,t);var n=e.prototype;return n.getWidth=function(){return this._width},n.setWidth=function(t){return this._width=t,this._refresh(),this},n.getHeight=function(){return this._height},n.setHeight=function(t){return this._height=t,this._refresh(),this},n.getBoxSymbol=function(){return h({},this.options.boxSymbol)},n.setBoxSymbol=function(t){return this.options.boxSymbol=t?h({},t):t,this.getSymbol()&&this._refresh(),this},n.getTextStyle=function(){return this.options.textStyle?h({},this.options.textStyle):null},n.setTextStyle=function(t){return this.options.textStyle=t?h({},t):t,this.getSymbol()&&this._refresh(),this},e.fromJSON=function(t){var n=t.feature,r=new e(t.content,n.geometry.coordinates,t.width,t.height,t.options);return r.setProperties(n.properties),r.setId(n.id),t.symbol&&r.setSymbol(t.symbol),r},n._toJSON=function(t){return{feature:this.toGeoJSON(t),width:this.getWidth(),height:this.getHeight(),subType:"TextBox",content:this._content}},n._refresh=function(){var t=this.getTextStyle()||{},e=t.padding||[12,8],n=this._width-2*e[0],r=this._height-2*e[1],i=h({},t.symbol||this._getDefaultTextSymbol(),this.options.boxSymbol||this._getDefaultBoxSymbol(),{textName:this._content,markerWidth:this._width,markerHeight:this._height,textHorizontalAlignment:"middle",textVerticalAlignment:"middle",textMaxWidth:n,textMaxHeight:r});t.wrap&&!i.textWrapWidth&&(i.textWrapWidth=n);var o=t.horizontalAlignment;i.textDx=i.markerDx||0;var a=i.markerWidth/2-e[0];"left"===o?(i.textHorizontalAlignment="right",i.textDx=i.textDx-a):"right"===o&&(i.textHorizontalAlignment="left",i.textDx=i.textDx+a);var s=t.verticalAlignment;i.textDy=i.markerDy||0;var u=i.markerHeight/2-e[1];"top"===s?(i.textVerticalAlignment="bottom",i.textDy-=u):"bottom"===s&&(i.textVerticalAlignment="top",i.textDy+=u),this._refreshing=!0,this.updateSymbol(i),delete this._refreshing},e}(ni);ri.mergeOptions({textStyle:{wrap:!0,padding:[12,8],verticalAlignment:"middle",horizontalAlignment:"middle"},boxSymbol:null}),ri.registerJSONType("TextBox");var ii=function(t){function e(e,n,r){var i;return void 0===r&&(r={}),i=t.call(this,n,r)||this,r.textSymbol&&i.setTextSymbol(r.textSymbol),r.boxStyle&&i.setBoxStyle(r.boxStyle),i._content=ce(e),i._refresh(),i}ne(e,t);var n=e.prototype;return n.getBoxStyle=function(){return this.options.boxStyle?h({},this.options.boxStyle):null},n.setBoxStyle=function(t){return this.options.boxStyle=t?h({},t):t,this._refresh(),this},n.getTextSymbol=function(){return h({},this._getDefaultTextSymbol(),this.options.textSymbol)},n.setTextSymbol=function(t){return this.options.textSymbol=t?h({},t):t,this._refresh(),this},e.fromJSON=function(t){var n=t.feature,r=new e(t.content,n.geometry.coordinates,t.options);return r.setProperties(n.properties),r.setId(n.id),t.symbol&&r.setSymbol(t.symbol),r},n._canEdit=function(){return!1},n._toJSON=function(t){return{feature:this.toGeoJSON(t),subType:"Label",content:this._content}},n._refresh=function(){var t=h({},this.getTextSymbol(),{textName:this._content}),e=this.getBoxStyle();if(e){h(t,e.symbol);var n=this._getBoxSize(t),r=n[1],i=e.padding||this._getDefaultPadding(),o=n[0];t.markerWidth=o.width,t.markerHeight=o.height;var a=t.textDx||0,s=t.textDy||0,u=_e(r,t.textHorizontalAlignment,t.textVerticalAlignment)._add(a,s),c=e.horizontalAlignment||"middle";t.markerDx=u.x,"left"===c?t.markerDx+=t.markerWidth/2-i[0]:"right"===c?t.markerDx-=t.markerWidth/2-r.width-i[0]:t.markerDx+=r.width/2;var l=e.verticalAlignment||"middle";t.markerDy=u.y,"top"===l?t.markerDy+=t.markerHeight/2-i[1]:"bottom"===l?t.markerDy-=t.markerHeight/2-r.height-i[1]:t.markerDy+=r.height/2}this._refreshing=!0,this.updateSymbol(t),delete this._refreshing},n._getBoxSize=function(t){t.markerType||(t.markerType="square");var e,n,r=this.getBoxStyle(),i=this._getTextSize(t),o=r.padding||this._getDefaultPadding();return e=i.width+2*o[0],n=i.height+2*o[1],r.minWidth&&(!e||e<r.minWidth)&&(e=r.minWidth),r.minHeight&&(!n||n<r.minHeight)&&(n=r.minHeight),[new ae(e,n),i]},e}(ni);ii.mergeOptions({boxStyle:null,textSymbol:null}),ii.registerJSONType("Label");var oi=function(t){return function(t){function e(){return t.apply(this,arguments)||this}ne(e,t),e._hasConnectors=function(t){return!f(t.__connectors)&&t.__connectors.length>0},e._getConnectors=function(t){return t.__connectors};var n=e.prototype;return n.getConnectSource=function(){return this._connSource},n.setConnectSource=function(t){var e=this._connTarget;return this.onRemove(),this._connSource=t,this._connTarget=e,this.onAdd(),this},n.getConnectTarget=function(){return this._connTarget},n.setConnectTarget=function(t){var e=this._connSource;return this.onRemove(),this._connSource=e,this._connTarget=t,this._updateCoordinates(),this._registerEvents(),this},n._updateCoordinates=function(){var t=this.getMap();if(!t&&this._connSource&&(t=this._connSource.getMap()),!t&&this._connTarget&&(t=this._connTarget.getMap()),t&&this._connSource&&this._connTarget){for(var e,n,r=this._connSource._getConnectPoints(),i=this._connTarget._getConnectPoints(),o=0,a=this.getCoordinates(),s=0,u=r.length;s<u;s++)for(var c=r[s],l=0,h=i.length;l<h;l++){var f=i[l],d=t.computeLength(c,f);0===s&&0===l?(e=c,n=f,o=d):d<o&&(e=c,n=f)}U(a)&&a[0].equals(e)&&a[1].equals(n)||this.setCoordinates([e,n])}},n.onAdd=function(){this._registerEvents(),this._updateCoordinates()},n.onRemove=function(){if(this._connSource&&(this._connSource.__connectors&&j(this,this._connSource.__connectors),this._connSource.off("dragging positionchange",this._updateCoordinates,this).off("remove",this.onRemove,this),this._connSource.off("dragstart mousedown mouseover",this._showConnect,this),this._connSource.off("dragend mouseup mouseout",this.hide,this),this._connSource.off("show",this._showConnect,this).off("hide",this.hide,this),delete this._connSource),this._connTarget&&(j(this,this._connTarget.__connectors),this._connTarget.off("dragging positionchange",this._updateCoordinates,this).off("remove",this.onRemove,this),this._connTarget.off("show",this._showConnect,this).off("hide",this.hide,this),delete this._connTarget),!(this._connSource instanceof wr&&this._connTarget instanceof wr)){var t=this.getMap();t&&t.off("movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange",this._updateCoordinates,this)}},n._showConnect=function(){this._connSource&&this._connTarget&&this._connSource.isVisible()&&this._connTarget.isVisible()&&(this._updateCoordinates(),this.show())},n._registerEvents=function(){if(this._connSource&&this._connTarget){this._connSource.__connectors||(this._connSource.__connectors=[]),this._connTarget.__connectors||(this._connTarget.__connectors=[]),this._connSource.__connectors.push(this),this._connTarget.__connectors.push(this),this._connSource.on("dragging positionchange",this._updateCoordinates,this).on("remove",this.remove,this),this._connTarget.on("dragging positionchange",this._updateCoordinates,this).on("remove",this.remove,this),this._connSource.on("show",this._showConnect,this).on("hide",this.hide,this),this._connTarget.on("show",this._showConnect,this).on("hide",this.hide,this);var t=this.options.showOn;if(this.hide(),"moving"===t?(this._connSource.on("dragstart",this._showConnect,this).on("dragend",this.hide,this),this._connTarget.on("dragstart",this._showConnect,this).on("dragend",this.hide,this)):"click"===t?(this._connSource.on("mousedown",this._showConnect,this).on("mouseup",this.hide,this),this._connTarget.on("mousedown",this._showConnect,this).on("mouseup",this.hide,this)):"mouseover"===t?(this._connSource.on("mouseover",this._showConnect,this).on("mouseout",this.hide,this),this._connTarget.on("mouseover",this._showConnect,this).on("mouseout",this.hide,this)):this._showConnect(),!(this._connSource instanceof wr&&this._connTarget instanceof wr)){var e=this.getMap();e&&e.on("movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange",this._updateCoordinates,this)}}},e}(t)},ai={showOn:"always"},si=function(t){function e(e,n,r){var i;return i=t.call(this,null,r)||this,1===arguments.length&&(r=e,e=null,n=null),i._connSource=e,i._connTarget=n,i}return ne(e,t),e}(oi(Dr));si.mergeOptions(ai),si.registerJSONType("ConnectorLine");var ui=function(t){function e(e,n,r){var i;return i=t.call(this,null,r)||this,1===arguments.length&&(r=e,e=null,n=null),i._connSource=e,i._connTarget=n,i}return ne(e,t),e}(oi(Qr));ui.mergeOptions(ai),ui.registerJSONType("ArcConnectorLine");var ci=function(t){function e(e,n,r){var i;return n&&!(n instanceof wr)&&!Array.isArray(n)&&o.indexOf(n.type)<0&&(r=n,n=null),(i=t.call(this,e,r)||this)._maxZIndex=0,i._minZIndex=0,i._initCache(),n&&i.addGeometry(n),i}ne(e,t);var n=e.prototype;return n.getGeometryById=function(t){return f(t)||""===t?null:this._geoMap[t]?this._geoMap[t]:null},n.getGeometries=function(t,e){if(!t)return this._geoList.slice(0);for(var n,r=[],i=0,o=this._geoList.length;i<o;i++)n=this._geoList[i],(e?t.call(e,n):t(n))&&r.push(n);return r},n.getFirstGeometry=function(){return this._geoList.length?this._geoList[0]:null},n.getLastGeometry=function(){var t=this._geoList.length;return 0===t?null:this._geoList[t-1]},n.getCount=function(){return this._geoList.length},n.getExtent=function(){if(0===this.getCount())return null;var t=new gn(this.getProjection());return this.forEach(function(e){t._combine(e.getExtent())}),t},n.forEach=function(t,e){for(var n=this._geoList.slice(0),r=0,i=n.length;r<i;r++)e?t.call(e,n[r],r):t(n[r],r);return this},n.filter=function(){return Fr.prototype.filter.apply(this,arguments)},n.isEmpty=function(){return!this._geoList.length},n.addGeometry=function(t,e){if(!t)return this;if("FeatureCollection"===t.type)return this.addGeometry(Zr.toGeometry(t),e);if(!Array.isArray(t)){var n=arguments.length,r=arguments[n-1];return t=Array.prototype.slice.call(arguments,0,n-1),e=r,v(r)&&(t.push(r),e=!1),this.addGeometry(t,e)}if(0===t.length)return this;var i;this._initCache(),!0===e&&(i=new gn),this._toSort=this._maxZIndex>0;for(var o=[],a=0,s=t.length;a<s;a++){var u=t[a];if(!u)throw new Error("Invalid geometry to add to layer("+this.getId()+") at index:"+a);if(!(u instanceof wr)&&(u=wr.fromJSON(u),Array.isArray(u)))for(var c=0,l=u.length;c<l;c++)this._add(u[c],i,a),o.push(u[c]);Array.isArray(u)||(this._add(u,i,a),o.push(u))}var h=this.getMap();if(h&&(this._getRenderer().onGeometryAdd(o),!0===e&&!f(i.xmin))){var d=h.getFitZoom(i);h.setCenterAndZoom(i.getCenter(),d)}return this.fire("addgeo",{geometries:t}),this},n.getGeoMinZIndex=function(){return this._minZIndex},n.getGeoMaxZIndex=function(){return this._maxZIndex},n._add=function(t,e,n){this._toSort||(this._toSort=0!==t.getZIndex()),this._updateZIndex(t.getZIndex());var r=t.getId();if(!f(r)){if(!f(this._geoMap[r]))throw new Error("Duplicate geometry id in layer("+this.getId()+"):"+r+", at index:"+n);this._geoMap[r]=t}var i=A();t._setInternalId(i),this._geoList.push(t),this.onAddGeometry&&this.onAddGeometry(t),t._bindLayer(this),t.onAdd&&t.onAdd(),e&&e._combine(t.getExtent()),t._fireEvent("add",{layer:this})},n.removeGeometry=function(t){if(!Array.isArray(t))return this.removeGeometry([t]);for(var e=t.length-1;e>=0;e--)t[e]instanceof wr||(t[e]=this.getGeometryById(t[e])),t[e]&&this===t[e].getLayer()&&t[e].remove();return this.fire("removegeo",{geometries:t}),this},n.clear=function(){this._clearing=!0,this.forEach(function(t){t.remove()}),this._geoMap={};var t=this._geoList;return this._geoList=[],this._getRenderer()&&this._getRenderer().onGeometryRemove(t),this._clearing=!1,this.fire("clear"),this},n.onRemoveGeometry=function(t){if(t&&!this._clearing&&(this===t.getLayer()&&!f(t._getInternalId()))){var e=t.getId();f(e)||delete this._geoMap[e];var n=this._findInList(t);n>=0&&this._geoList.splice(n,1),this._getRenderer()&&this._getRenderer().onGeometryRemove([t])}},n.hide=function(){for(var t=0,e=this._geoList.length;t<e;t++)this._geoList[t].onHide();return Wn.prototype.hide.call(this)},n.identify=function(t,e){return void 0===e&&(e={}),this._hitGeos(this._geoList,t,e)},n._hitGeos=function(t,e,n){void 0===n&&(n={});for(var r=n.filter,i=n.tolerance,o=[],a=this.getMap(),s=a.coordToPoint(e),u=a._pointToContainerPoint(s),c=t.length-1;c>=0;c--){var l=t[c];if(l&&l.isVisible()&&l._getPainter()&&l.options.interactive){if(!(l instanceof Dr&&(l._getArrowStyle()||l instanceof qr))){var h=l.getContainerExtent();if(i&&(h=h.expand(i)),!h||!h.contains(u))continue}if(l._containsPoint(u,i)&&(!r||r(l))&&(o.push(l),n.count&&o.length>=n.count))break}}return o},n._initCache=function(){this._geoList||(this._geoList=[],this._geoMap={})},n._updateZIndex=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._maxZIndex=Math.max(this._maxZIndex,Math.max.apply(Math,e)),this._minZIndex=Math.min(this._minZIndex,Math.min.apply(Math,e))},n._sortGeometries=function(){var t=this;this._toSort&&(this._maxZIndex=0,this._minZIndex=0,this._geoList.sort(function(e,n){return t._updateZIndex(e.getZIndex(),n.getZIndex()),t._compare(e,n)}),this._toSort=!1)},n._compare=function(t,e){return t.getZIndex()===e.getZIndex()?t._getInternalId()-e._getInternalId():t.getZIndex()-e.getZIndex()},n._findInList=function(t){var e=this._geoList.length;if(0===e)return-1;for(var n,r=0,i=e-1;r<=i;){if(n=Math.floor((r+i)/2),this._geoList[n]===t)return n;this._compare(this._geoList[n],t)>0?i=n-1:r=n+1}return-1},n._onGeometryEvent=function(t){if(t&&t.target){var e=t.type;"idchange"===e?this._onGeometryIdChange(t):"zindexchange"===e?this._onGeometryZIndexChange(t):"positionchange"===e?this._onGeometryPositionChange(t):"shapechange"===e?this._onGeometryShapeChange(t):"symbolchange"===e?this._onGeometrySymbolChange(t):"show"===e?this._onGeometryShow(t):"hide"===e?this._onGeometryHide(t):"propertieschange"===e&&this._onGeometryPropertiesChange(t)}},n._onGeometryIdChange=function(t){if(t.new!==t.old||!this._geoMap[t.old]||this._geoMap[t.old]!==t.target){if(!f(t.new)){if(this._geoMap[t.new])throw new Error("Duplicate geometry id in layer("+this.getId()+"):"+t.new);this._geoMap[t.new]=t.target}f(t.old)||t.new===t.old||delete this._geoMap[t.old]}},n._onGeometryZIndexChange=function(t){t.old!==t.new&&(this._updateZIndex(t.new),this._toSort=!0,this._getRenderer()&&this._getRenderer().onGeometryZIndexChange(t))},n._onGeometryPositionChange=function(t){this._getRenderer()&&this._getRenderer().onGeometryPositionChange(t)},n._onGeometryShapeChange=function(t){this._getRenderer()&&this._getRenderer().onGeometryShapeChange(t)},n._onGeometrySymbolChange=function(t){this._getRenderer()&&this._getRenderer().onGeometrySymbolChange(t)},n._onGeometryShow=function(t){this._getRenderer()&&this._getRenderer().onGeometryShow(t)},n._onGeometryHide=function(t){this._getRenderer()&&this._getRenderer().onGeometryHide(t)},n._onGeometryPropertiesChange=function(t){this._getRenderer()&&this._getRenderer().onGeometryPropertiesChange(t)},e}(Wn);ci.mergeOptions({drawImmediate:!1});var li={debug:!1,enableSimplify:!0,geometryEvents:!0,defaultIconSize:[20,20],cacheVectorOnCanvas:!0,cacheSvgOnCanvas:ee.gecko,enableAltitude:!1,altitudeProperty:"altitude",drawAltitude:!1},hi=function(t){function e(e,n,r){var i,o=(i=t.call(this,e,n,r)||this).options.style;return delete i.options.style,o&&i.setStyle(o),i}ne(e,t);var n=e.prototype;return n.getStyle=function(){return this._style?this._style:null},n.setStyle=function(t){return this._style=t,this._cookedStyles=ht(t),this.forEach(function(t){this._styleGeometry(t)},this),this.fire("setstyle",{style:t}),this},n.removeStyle=function(){return this._style?(delete this._style,delete this._cookedStyles,this.forEach(function(t){t._setExternSymbol(null)},this),this.fire("removestyle"),this):this},n.onAddGeometry=function(t){this.getStyle()&&this._styleGeometry(t)},n.onConfig=function(e){if(t.prototype.onConfig.call(this,e),e.enableAltitude||e.drawAltitude||e.altitudeProperty){var n=this.getRenderer();n&&n.setToRedraw&&n.setToRedraw()}},n._styleGeometry=function(t){if(!this._cookedStyles)return!1;for(var e=lt(t),n=0,r=this._cookedStyles.length;n<r;n++)if(!0===this._cookedStyles[n].filter(e))return t._setExternSymbol(this._cookedStyles[n].symbol),!0;return!1},n.identify=function(e,n){void 0===n&&(n={});var r=this.getRenderer();return n.onlyVisible&&r&&r.identify?r.identify(e,n):t.prototype.identify.call(this,e,n)},n.toJSON=function(t){t||(t={});var e={type:this.getJSONType(),id:this.getId(),options:this.config()};if((f(t.style)||t.style)&&this.getStyle()&&(e.style=this.getStyle()),f(t.geometries)||t.geometries){var n;if(t.clipExtent){var r=this.getMap(),i=r?r.getProjection():null;n=new gn(t.clipExtent,i)}for(var o=[],a=this.getGeometries(),s=0,u=a.length;s<u;s++){var c=a[s],l=c.getExtent();if(l&&(!n||n.intersects(l))){var h=c.toJSON(t.geometries);o.push(h)}}e.geometries=o}return e},e.fromJSON=function(t){if(!t||"VectorLayer"!==t.type)return null;for(var n=new e(t.id,t.options),r=t.geometries,i=[],o=0;o<r.length;o++){var a=wr.fromJSON(r[o]);a&&i.push(a)}return n.addGeometry(i),t.style&&n.setStyle(t.style),n},e}(ci);hi.mergeOptions(li),hi.registerJSONType("VectorLayer");var fi="_map_tool",di=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.addTo=function(t){return t?(this._map=t,t[fi]&&t[fi].disable(),this.onAdd&&this.onAdd(),this.enable(),t[fi]=this,this._fireEvent("add"),this):this},n.getMap=function(){return this._map},n.enable=function(){return!this._map||this._enabled?this:(this._enabled=!0,this._switchEvents("off"),this._registerEvents(),this.onEnable&&this.onEnable(),this._fireEvent("enable"),this)},n.disable=function(){return this._enabled&&this._map?(this._enabled=!1,this._switchEvents("off"),this.onDisable&&this.onDisable(),this._fireEvent("disable"),this):this},n.isEnabled=function(){return!!this._enabled},n.remove=function(){return this._map?(this.disable(),this._map&&(delete this._map[fi],delete this._map),this._fireEvent("remove"),this):this},n._registerEvents=function(){this._switchEvents("on")},n._switchEvents=function(t){var e=this.getEvents();e&&this._map[t](e,this)},n._fireEvent=function(t,e){e||(e={}),this.fire(t,e)},e}(rn(an)),pi={},vi=function(t){function e(e){var n;return(n=t.call(this,e)||this)._checkMode(),n._events={click:n._firstClickHandler,mousemove:n._mouseMoveHandler,dblclick:n._doubleClickHandler,mousedown:n._mouseDownHandler,mouseup:n._mouseUpHandler},n}ne(e,t),e.registerMode=function(t,e){pi[t.toLowerCase()]=e},e.getRegisterMode=function(t){return pi[t.toLowerCase()]};var n=e.prototype;return n.getMode=function(){return this.options.mode?this.options.mode.toLowerCase():null},n.setMode=function(t){return this._geometry&&(this._geometry.remove(),delete this._geometry),this._clearStage(),this._switchEvents("off"),this.options.mode=t,this._checkMode(),this.isEnabled()&&(this._switchEvents("on"),this._restoreMapCfg(),this._saveMapCfg()),this},n.getSymbol=function(){var t=this.options.symbol;return jt(t||this.options.symbol)},n.setSymbol=function(t){return t?(this.options.symbol=t,this._geometry&&this._geometry.setSymbol(t),this):this},n.getCurrentGeometry=function(){return this._geometry},n.onAdd=function(){this._checkMode()},n.onEnable=function(){return this._saveMapCfg(),this._drawToolLayer=this._getDrawLayer(),this._clearStage(),this._loadResources(),this},n.onDisable=function(){var t=this.getMap();return this._restoreMapCfg(),this.endDraw(),this._map&&t.removeLayer(this._getDrawLayer()),this},n.undo=function(){var t=this._getRegisterMode(),e=t.action;if(!this._shouldRecordHistory(e)||!this._historyPointer)return this;var n=this._clickCoords.slice(0,--this._historyPointer);return t.update(n,this._geometry),this},n.redo=function(){var t=this._getRegisterMode(),e=t.action;if(!this._shouldRecordHistory(e)||f(this._historyPointer)||this._historyPointer===this._clickCoords.length)return this;var n=this._clickCoords.slice(0,++this._historyPointer);return t.update(n,this._geometry),this},n._shouldRecordHistory=function(t){return Array.isArray(t)&&"click"===t[0]&&"mousemove"===t[1]&&"dblclick"===t[2]},n._checkMode=function(){this._getRegisterMode()},n._saveMapCfg=function(){var t=this.getMap();if(this._mapDoubleClickZoom=t.options.doubleClickZoom,t.config({doubleClickZoom:this.options.doubleClickZoom}),this._getRegisterMode().action.indexOf("mousedown")>-1){var e=this.getMap();this._mapDraggable=e.options.draggable,e.config({draggable:!1})}},n._restoreMapCfg=function(){var t=this.getMap();t.config({doubleClickZoom:this._mapDoubleClickZoom}),f(this._mapDraggable)||t.config("draggable",this._mapDraggable),delete this._mapDraggable,delete this._mapDoubleClickZoom},n._loadResources=function(){var t=St(this.getSymbol());t.length>0&&this._drawToolLayer._getRenderer().loadResources(t)},n._getProjection=function(){return this._map.getProjection()},n._getRegisterMode=function(){var t=this.getMode(),n=e.getRegisterMode(t);if(!n)throw new Error(t+" is not a valid mode of DrawTool.");return n},n.getEvents=function(){var t=this._getRegisterMode().action,e={};if(Array.isArray(t)){for(var n=0;n<t.length;n++)e[t[n]]=this._events[t[n]];return e}return null},n._mouseDownHandler=function(t){this._createGeometry(t)},n._mouseUpHandler=function(t){this.endDraw(t)},n._firstClickHandler=function(t){var e=this._getRegisterMode(),n=t.coordinate;this._geometry?(f(this._historyPointer)||(this._clickCoords=this._clickCoords.slice(0,this._historyPointer)),this._clickCoords.push(n),this._historyPointer=this._clickCoords.length,e.clickLimit&&e.clickLimit===this._historyPointer?(e.update([n],this._geometry,t),this.endDraw(t)):e.update(this._clickCoords,this._geometry,t),this._fireEvent("drawvertex",t)):this._createGeometry(t)},n._createGeometry=function(t){var e=this.getMode(),n=this._getRegisterMode(),r=t.coordinate,i=this.getSymbol();this._geometry||(this._clickCoords=[r],this._geometry=n.create(this._clickCoords,t),i&&"point"!==e?this._geometry.setSymbol(i):this.options.hasOwnProperty("symbol")&&this._geometry.setSymbol(this.options.symbol),this._addGeometryToStage(this._geometry),this._fireEvent("drawstart",t)),"point"===e&&this.endDraw(t)},n._mouseMoveHandler=function(t){var e=this.getMap(),n=t.coordinate;if(this._geometry&&e&&!e.isInteracting()){var r=this._getMouseContainerPoint(t);if(this._isValidContainerPoint(r)){var i=this._getRegisterMode();if(this._shouldRecordHistory(i.action)){var o=this._clickCoords.slice(0,this._historyPointer);if(o&&o.length>0&&n.equals(o[o.length-1]))return;i.update(o.concat([n]),this._geometry,t)}else i.update([n],this._geometry,t);this._fireEvent("mousemove",t)}}},n._doubleClickHandler=function(t){if(this._geometry){var e=this._getMouseContainerPoint(t);if(this._isValidContainerPoint(e)){var n=this._getRegisterMode(),r=this._clickCoords;if(!(r.length<2)){for(var i=[r[0]],o=1,a=r.length;o<a;o++)r[o].x===r[o-1].x&&r[o].y===r[o-1].y||i.push(r[o]);i.length<2||this._geometry&&this._geometry instanceof jr&&i.length<3||(n.update(i,this._geometry,t),this.endDraw(t))}}}},n._addGeometryToStage=function(t){this._getDrawLayer().addGeometry(t)},n.endDraw=function(t){if(!this._geometry||this._ending)return this;this._ending=!0;var e=this._geometry;return this._clearStage(),t=t||{},this._geometry=e,this._fireEvent("drawend",t),delete this._geometry,this.options.once&&this.disable(),delete this._ending,this},n._clearStage=function(){this._getDrawLayer().clear(),delete this._geometry,delete this._clickCoords},n._getMouseContainerPoint=function(t){return"mousedown"===this._getRegisterMode().action&&Le(t.domEvent),t.containerPoint},n._isValidContainerPoint=function(t){var e=this._map.getSize(),n=e.width,r=e.height;return!(t.x<0||t.y<0)&&!(t.x>n||t.y>r)},n._getDrawLayer=function(){var t="_maptalks__internal_layer_drawtool",e=this._map.getLayer(t);return e||(e=new hi(t,{enableSimplify:!1}),this._map.addLayer(e)),e},n._fireEvent=function(t,e){e||(e={}),this._geometry&&(e.geometry=this._getRegisterMode().generate(this._geometry).copy()),di.prototype._fireEvent.call(this,t,e)},e}(di);vi.mergeOptions({symbol:{lineColor:"#000",lineWidth:2,lineOpacity:1,polygonFill:"#fff",polygonOpacity:.3},doubleClickZoom:!1,mode:null,once:!1,ignoreMouseleave:!0});var gi=function(t){function e(e){var n;return(n=t.call(this,e)||this).drawTool=new vi({mode:"boxZoom",ignoreMouseleave:!1}),n}ne(e,t);var n=e.prototype;return n.addHooks=function(){this.target.on("_mousedown",this._onMouseDown,this)},n.removeHooks=function(){this.target.off("_mousedown",this._onMouseDown,this),this.drawTool.isEnabled()&&this.drawTool.remove()},n._onMouseDown=function(t){this.target.options.boxZoom&&t.domEvent.shiftKey&&this.drawTool.setSymbol(this.target.options.boxZoomSymbol).on("drawend",this._boxZoom,this).addTo(this.target)},n._boxZoom=function(t){var e=this.target;this.drawTool.remove();var n=t.geometry,r=n.getCenter(),i=n.getSymbol(),o=i.markerWidth,a=i.markerHeight,s=new gn(r,e.locateByPoint(r,o,a),e.getProjection()),u=e.getFitZoom(s);e.animateTo({center:s.getCenter(),zoom:u})},e}(on);Jn.mergeOptions({boxZoom:!0,boxZoomSymbol:{markerType:"rectangle",markerLineWidth:3,markerLineColor:"#1bbc9b",markerLineDasharray:[10,5],markerFillOpacity:.1,markerFill:"#1bbc9b",markerWidth:1,markerHeight:1}}),Jn.addOnLoadHook("addHandler","boxZoom",gi),Jn.include({animateTo:function(t,e,n){var r=this;void 0===e&&(e={}),this._stopAnim(this._animPlayer),y(e)&&(n=e,e={});var i=this.getProjection(),o=this.getView(),a={},s=!0;for(var u in t)if(_(t,u)&&!f(o[u]))if(s=!1,"center"===u){var c=new dn(o[u]).toFixed(7),l=new dn(t[u]).toFixed(7);c.equals(l)||(a.center=[c,l])}else o[u]!==t[u]&&"around"!==u&&(a[u]=[o[u],t[u]]);if(s)return null;var h=t.around||new oe(this.width/2,this.height/2),d=this.getView(),p=this._getRenderer(),v=this._animPlayer=Ar.animate(a,{easing:e.easing||"out",duration:e.duration||this.options.zoomAnimationDuration,framer:function(t){p.callInNextFrame(t)}},function(t){if(r.isRemoved())v.finish();else{if("running"===v.playState){var o=r.getView();if(!e.continueOnViewChanged&&!function(t,e){for(var n in t)if(_(t,n))if("center"===n){if(t[n][0]!==e[n][0]||t[n][1]!==e[n][1])return!1}else if(t[n]!==e[n])return!1;return!0}(o,d))return void r._stopAnim(v);if(t.styles.center){var s=t.styles.center;r._setPrjCenter(i.project(s)),r.onMoving(r._parseEventFromCoord(r.getCenter()))}f(t.styles.zoom)||r.onZooming(t.styles.zoom,h),f(t.styles.pitch)||r.setPitch(t.styles.pitch),f(t.styles.bearing)||r.setBearing(t.styles.bearing),d=r.getView(),r._fireEvent("animating")}else"finished"===v.playState&&(v._interupted||(a.center&&r._setPrjCenter(i.project(a.center[1])),f(a.pitch)||r.setPitch(a.pitch[1]),f(a.bearing)||r.setBearing(a.bearing[1])),r._endAnim(v,a,h,e),d=r.getView());n&&n(t)}});return this._startAnim(a,h),v},isAnimating:function(){return!!this._animPlayer},isRotating:function(){return this.isDragRotating()||!!this._animRotating},_endAnim:function(t,e,n,r){delete this._animRotating;var i,o=t._interupted?"animateinterrupted":"animateend";(t===this._animPlayer&&delete this._animPlayer,e.center)&&(i=t._interupted?this.getCenter():e.center[1],this.onMoveEnd(this._parseEventFromCoord(i)));f(e.zoom)||(t._interupted?this.onZoomEnd(this.getZoom(),n):r.wheelZoom?this.onZooming(e.zoom[1],n):this.onZoomEnd(e.zoom[1],n)),o&&this._fireEvent(o),f(e.pitch)||this.getPitch()||this.getRenderer().setToRedraw()},_startAnim:function(t,e){this._animPlayer&&(t.center&&this.onMoveStart(),t.zoom&&!this.isZooming()&&this.onZoomStart(t.zoom[1],e),(t.pitch||t.bearing)&&(this._animRotating=!0),this._fireEvent("animatestart"),this._animPlayer.play())},_stopAnim:function(t){t&&"finished"!==t.playState&&(t._interupted=!0,t.finish())}});var yi="mousedown mouseup mouseover mouseout mouseenter mouseleave mousemove click dblclick contextmenu keypress touchstart touchmove touchend ";function mi(t,e,n){var r,i,o,a,s,u,c,l,h,f,d,p,v=n[0],g=n[1],y=n[2];return e===t?(t[12]=e[0]*v+e[4]*g+e[8]*y+e[12],t[13]=e[1]*v+e[5]*g+e[9]*y+e[13],t[14]=e[2]*v+e[6]*g+e[10]*y+e[14],t[15]=e[3]*v+e[7]*g+e[11]*y+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=f,t[10]=d,t[11]=p,t[12]=r*v+s*g+h*y+e[12],t[13]=i*v+u*g+f*y+e[13],t[14]=o*v+c*g+d*y+e[14],t[15]=a*v+l*g+p*y+e[15]),t}function _i(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function bi(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],v=e[12],g=e[13],y=e[14],m=e[15],_=n[0],b=n[1],w=n[2],x=n[3];return t[0]=_*r+b*s+w*h+x*v,t[1]=_*i+b*u+w*f+x*g,t[2]=_*o+b*c+w*d+x*y,t[3]=_*a+b*l+w*p+x*m,_=n[4],b=n[5],w=n[6],x=n[7],t[4]=_*r+b*s+w*h+x*v,t[5]=_*i+b*u+w*f+x*g,t[6]=_*o+b*c+w*d+x*y,t[7]=_*a+b*l+w*p+x*m,_=n[8],b=n[9],w=n[10],x=n[11],t[8]=_*r+b*s+w*h+x*v,t[9]=_*i+b*u+w*f+x*g,t[10]=_*o+b*c+w*d+x*y,t[11]=_*a+b*l+w*p+x*m,_=n[12],b=n[13],w=n[14],x=n[15],t[12]=_*r+b*s+w*h+x*v,t[13]=_*i+b*u+w*f+x*g,t[14]=_*o+b*c+w*d+x*y,t[15]=_*a+b*l+w*p+x*m,t}function wi(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],p=e[12],v=e[13],g=e[14],y=e[15],m=n*s-r*a,_=n*u-i*a,b=n*c-o*a,w=r*u-i*s,x=r*c-o*s,E=i*c-o*u,O=l*v-h*p,P=l*g-f*p,S=l*y-d*p,T=h*g-f*v,C=h*y-d*v,A=f*y-d*g,M=m*A-_*C+b*T+w*S-x*P+E*O;return M?(M=1/M,t[0]=(s*A-u*C+c*T)*M,t[1]=(i*C-r*A-o*T)*M,t[2]=(v*E-g*x+y*w)*M,t[3]=(f*x-h*E-d*w)*M,t[4]=(u*S-a*A-c*P)*M,t[5]=(n*A-i*S+o*P)*M,t[6]=(g*b-p*E-y*_)*M,t[7]=(l*E-f*b+d*_)*M,t[8]=(a*C-s*S+c*O)*M,t[9]=(r*S-n*C-o*O)*M,t[10]=(p*x-v*b+y*m)*M,t[11]=(h*b-l*x-d*m)*M,t[12]=(s*P-a*T-u*O)*M,t[13]=(n*T-r*P+i*O)*M,t[14]=(v*_-p*w-g*m)*M,t[15]=(l*w-h*_+f*m)*M,t):null}function xi(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ei(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Oi(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Pi(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function Si(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t}function Ti(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t}function Ci(t,e,n){var r=e[0],i=e[1],o=e[2],a=1/(n[3]*r+n[7]*i+n[11]*o+n[15]);return t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])*a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])*a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])*a,t}Jn.include({_registerDomEvents:function(){Me(this._panels.mapWrapper||this._containerDOM,yi,this._handleDOMEvent,this)},_removeDomEvents:function(){ke(this._panels.mapWrapper||this._containerDOM,yi,this._handleDOMEvent)},_handleDOMEvent:function(t){var e=t.type;if("contextmenu"===e&&Re(t),!this._ignoreEvent(t)){var n=!1;if("mousedown"===e||"touchstart"===e&&1===t.touches.length)this._mouseDownTime=l();else if("click"===e||"touchend"===e||"contextmenu"===e){if(!this._mouseDownTime)return;var r=this._mouseDownTime;if(delete this._mouseDownTime,l()-r>300){if("click"===e||"contextmenu"===e)return}else"touchend"===e&&(n=!0)}this._fireDOMEvent(this,t,e),n&&(this._clickTime&&l()-this._clickTime<=300?(delete this._clickTime,this._fireDOMEvent(this,t,"dblclick")):(this._clickTime=l(),this._fireDOMEvent(this,t,"click")))}},_ignoreEvent:function(t){if(!t||!this._panels.control)return!1;if(this._isEventOutMap(t))return!0;var e,n=t.srcElement||t.target;if(n)for(;n&&n!==this._containerDOM;){if(n.className&&n.className.indexOf&&(n.className.indexOf("maptalks-control")>=0||n.className.indexOf("maptalks-ui")>=0&&!e.eventsPropagation))return!0;e=n,n=n.parentNode}return!1},_isEventOutMap:function(t){if(this.getPitch()>this.options.maxVisualPitch){var e=Ne(this._getActualEvent(t),this._containerDOM);if(!this.getContainerExtent().contains(e))return!0}return!1},_parseEvent:function(t,e){if(!t)return null;var n={domEvent:t};if("keypress"!==e){var r=this._getActualEvent(t);if(r){var i=Ne(r,this._containerDOM);n=h(n,{coordinate:this.containerPointToCoord(i),containerPoint:i,viewPoint:this.containerPointToViewPoint(i),point2d:this._containerPointToPoint(i)})}}return n},_parseEventFromCoord:function(t){var e=this.coordToContainerPoint(t);return{coordinate:t,containerPoint:e,viewPoint:this.containerPointToViewPoint(e),point2d:this.coordToPoint(t)}},_getActualEvent:function(t){return t.touches&&t.touches.length>0?t.touches[0]:t.changedTouches&&t.changedTouches.length>0?t.changedTouches[0]:t},_fireDOMEvent:function(t,e,n){if(!this.isRemoved()){var r=this._parseEvent(e,n);this._fireEvent(n,r)}}}),Jn.addOnLoadHook("_registerDomEvents"),Jn.include({isFullScreen:function(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)},requestFullScreen:function(t){return this._fireEvent("fullscreenstart"),this._requestFullScreen(t||this._containerDOM),this._fireEvent("fullscreenend"),this},cancelFullScreen:function(){return this._cancelFullScreen(),this._fireEvent("cancelfullscreen"),this},_requestFullScreen:function(t){if(t.requestFullScreen)t.requestFullScreen();else if(t.mozRequestFullScreen)t.mozRequestFullScreen();else if(t.webkitRequestFullScreen)t.webkitRequestFullScreen();else if(t.msRequestFullScreen)t.msRequestFullScreen();else{var e="fullscreen=1,status=no,resizable=yes,top=0,left=0,scrollbars=no,titlebar=no,menubar=no,location=no,toolbar=no,z-look=yes,width="+(screen.availWidth-8)+",height="+(screen.availHeight-45);null!==window.open(location.href,"_blank",e)&&(window.opener=null,window.close())}},_cancelFullScreen:function(){if(document.cancelFullScreen)document.cancelFullScreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.webkitCancelFullScreen)document.webkitCancelFullScreen();else{null!==window.open(location.href,"_blank","fullscreen=no,status=yes,resizable=yes,scrollbars=no,titlebar=no,menubar=yes,location=yes,toolbar=yes,z-look=yes")&&(window.opener=null,window.close())}}}),Jn.include({panTo:function(t,e,n){return void 0===e&&(e={}),t?(y(e)&&(n=e,e={}),t=new dn(t),void 0===e.animation||e.animation?this._panAnimation(t,e.duration,n):(this.setCenter(t),this)):this},panBy:function(t,e,n){if(void 0===e&&(e={}),!t)return this;if(y(e)&&(n=e,e={}),t=new oe(t).multi(-1),this.onMoveStart(),void 0===e.animation||e.animation){var r=this.locateByPoint(this.getCenter(),t.x,t.y);this._panAnimation(r,e.duration,n)}else this._offsetCenterByPixel(t),this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));return this},_panAnimation:function(t,e,n){return this.animateTo({center:t},{duration:e||this.options.panAnimationDuration},n)}}),wr.fromJSON=function(t){if(Array.isArray(t)){for(var e=[],n=0,r=t.length;n<r;n++){var i=wr.fromJSON(t[n]);Array.isArray(t)?e=e.concat(i):e.push(i)}return e}return t&&!t.feature?Zr.toGeometry(t):(t.subType?(o=wr.getJSONClass(t.subType).fromJSON(t),f(t.feature.id)||o.setId(t.feature.id)):(o=Zr.toGeometry(t.feature),t.options&&o.config(t.options)),t.symbol&&o.setSymbol(t.symbol),t.infoWindow&&o.setInfoWindow(t.infoWindow),o);var o},Wn.fromJSON=function(t){if(!t)return null;var e=t.type,n=Wn.getJSONClass(e);if(!n||!n.fromJSON)throw new Error("unsupported layer type:"+e);return n.fromJSON(t)},Jn.include({JSON_VERSION:"1.0",toJSON:function(t){t||(t={});var e={version:this.JSON_VERSION,extent:this.getExtent().toJSON()};e.options=this.config(),e.options.center=this.getCenter(),e.options.zoom=this.getZoom();var n=this.getBaseLayer();(f(t.baseLayer)||t.baseLayer)&&n&&(e.baseLayer=n.toJSON(t.baseLayer));var r={};t.clipExtent&&(!0===t.clipExtent?r.clipExtent=this.getExtent():r.clipExtent=t.clipExtent);var i=[];if(f(t.layers)||t.layers&&!Array.isArray(t.layers)){for(var o=this.getLayers(),a=0,s=o.length;a<s;a++)if(o[a].toJSON){var u=h({},v(t.layers)?t.layers:{},r);i.push(o[a].toJSON(u))}e.layers=i}else if(U(t.layers)){for(var c=t.layers,l=0;l<c.length;l++){var d=c[l],p=this.getLayer(d.id);if(p.toJSON){var g=h({},d.options,r);i.push(p.toJSON(g))}}e.layers=i}else e.layers=[];return e}}),Jn.fromJSON=function(t,e,n){if(!t||!e)return null;n||(n={});var r=new Jn(t,e.options);if(f(n.baseLayer)||n.baseLayer){var i=Wn.fromJSON(e.baseLayer);i&&r.setBaseLayer(i)}if(f(n.layers)||n.layers){for(var o=[],a=e.layers,s=0;s<a.length;s++){var u=Wn.fromJSON(a[s]);o.push(u)}r.addLayer(o)}return r},Jn.include({computeLength:function(t,e){if(!this.getProjection())return null;var n=new dn(t),r=new dn(e);return n.equals(r)?0:this.getProjection().measureLength(n,r)},computeGeometryLength:function(t){return t._computeGeodesicLength(this.getProjection())},computeGeometryArea:function(t){return t._computeGeodesicArea(this.getProjection())},identify:function(t,e){if(!t)return this;var n=t.layers;if(!U(n))return this;for(var r=[],i=0,o=n.length;i<o;i++)g(n[i])?r.push(this.getLayer(n[i])):r.push(n[i]);for(var a=new dn(t.coordinate),s=h({},t),u=[],c=r.length-1;c>=0&&!(t.count&&u.length>=t.count);c--){var l=r[c];if(l&&l.getMap()&&(t.includeInvisible||l.isVisible())&&(t.includeInternals||!(l.getId().indexOf("_maptalks__internal_layer_")>=0))){var f=l.identify(a,s);f&&(Array.isArray(f)?k(u,f):u.push(f))}}return e.call(this,u),this}}),Jn.include({_zoom:function(t,e){this.options.zoomable&&!this.isZooming()&&(e=this._checkZoomOrigin(e),t=this._checkZoom(t),this.onZoomStart(t,e),this._frameZoom=this.getZoom(),this.onZoomEnd(t,e))},_zoomAnimation:function(t,e,n){this.options.zoomable&&!this.isZooming()&&(t=this._checkZoom(t),this.getZoom()!==t&&(e=this._checkZoomOrigin(e),this._startZoomAnim(t,e,n)))},_checkZoomOrigin:function(t){return t&&!this.options.zoomInCenter||(t=new oe(this.width/2,this.height/2)),t},_startZoomAnim:function(t,e,n){f(n)&&(n=1);var r=this._getResolution(this._startZoomVal)/this._getResolution(t),i=this.options.zoomAnimationDuration*Math.abs(r-n)/Math.abs(r-1);this._frameZoom=this._startZoomVal,this.animateTo({zoom:t,around:e},{continueOnViewChanged:!0,duration:i})},onZoomStart:function(t,e){this.options.zoomable&&!this.isZooming()&&(this._zooming=!0,this._startZoomVal=this.getZoom(),this._startZoomCoord=this._containerPointToPrj(e),this._fireEvent("zoomstart",{from:this._startZoomVal,to:t}))},onZooming:function(t,e,n){if(this.options.zoomable&&this._frameZoom!==t){f(n)&&(n=1),this._zoomTo(t,e);var r=this.getResolution(t),i=this.getResolution(this._startZoomVal)/r/n,o=this._prjToContainerPoint(this._startZoomCoord,this._startZoomVal),a=this.getViewPoint();if(!this.isRotating()&&!o.equals(e)&&1!==i){var s=this.getPitch(),u=o._sub(e)._multi(1/(1-i));s&&(u.y/=Math.cos(s*Math.PI/180)),e=e.add(u)}var c={view:[i,0,0,i,(e.x-a.x)*(1-i),(e.y-a.y)*(1-i)]};ee.retina&&(e=e.multi(2)),c.container=[i,0,0,i,e.x*(1-i),e.y*(1-i)],this._fireEvent("zooming",{from:this._startZoomVal,to:t,origin:e,matrix:c}),this._frameZoom=t}},onZoomEnd:function(t,e){if(this.options.zoomable){var n=this._startZoomVal;this._zoomTo(t,e),this._zooming=!1,this._getRenderer().onZoomEnd(),this._fireEvent("zoomend",{from:n,to:t}),this._verifyExtent(this.getCenter())||this.panTo(this.getMaxExtent().getCenter())}},_zoomTo:function(t,e){this._zoomLevel=t,this._calcMatrices(),e&&this._setPrjCoordAtContainerPoint(this._startZoomCoord,e)},_checkZoom:function(t){var e=this.getMaxZoom(),n=this.getMinZoom();return t<n&&(t=n),t>e&&(t=e),t}});var Ai,Mi,ki,ji,Ri,Li,Ii,Di,Fi,Ni,Bi,Ui,zi=Math.PI/180;function Gi(){return xi(new Array(16))}Jn.include({getFov:function(){return this._fov||(this._fov=.6435011087932844),this._fov/zi},setFov:function(t){if(this.isZooming())return this;if(t=Math.max(.01,Math.min(60,t)),this._fov===t)return this;var e=this.getFov();return this._fov=t*zi,this._calcMatrices(),this._renderLayers(),this._fireEvent("fovchange",{from:e,to:this.getFov()}),this},getBearing:function(){return this._angle?-this._angle/zi:0},setBearing:function(t){if(ee.ie9)throw new Error("map can't rotate in IE9.");var e=-N(t,-180,180)*zi;if(this._angle===e)return this;var n=this.getBearing();return this._fireEvent("rotatestart",{from:n,to:e}),this._angle=e,this._calcMatrices(),this._renderLayers(),this._fireEvent("rotate",{from:n,to:e}),this._fireEvent("rotateend",{from:n,to:e}),this},getPitch:function(){return this._pitch?this._pitch/Math.PI*180:0},setPitch:function(t){if(ee.ie9)throw new Error("map can't tilt in IE9.");var e=B(t,0,this.options.maxPitch)*zi;if(this._pitch===e)return this;var n=this.getPitch();return this._fireEvent("pitchstart",{from:n,to:e}),this._pitch=e,this._calcMatrices(),this._renderLayers(),this._fireEvent("pitch",{from:n,to:e}),this._fireEvent("pitchend",{from:n,to:e}),this},isTransforming:function(){return!(!this._pitch&&!this._angle)},getFrustumAltitude:function(){var t=90-this.getPitch(),e=this.getFov()/2,n=this.cameraPosition?this.cameraPosition[2]:0;if(e<=t)return n;e=Math.PI*e/180;var r=new oe(this.cameraPosition).distanceTo(new oe(this.cameraLookAt)),i=n*Math.tan(2*e);return n+Math.tan(e)*(r+i)},_pointToContainerPoint:(Ui=[0,0,0],function(t,e,n){if(void 0===n&&(n=0),t=this._pointToPoint(t,e),this.isTransforming()||n){n*=this.getResolution(e)/this.getResolution();var r=this._glScale;Ei(Ui,t.x*r,t.y*r,n*r);var i=this._projIfBehindCamera(Ui,this.cameraPosition,this.cameraForward);Ci(i,i,this.projViewMatrix);var o=this.width/2,a=this.height/2;return i[0]=i[0]*o+o,i[1]=-i[1]*a+a,new oe(i[0],i[1])}var s=this._prjToPoint(this._getPrjCenter());return t._sub(s)._add(this.width/2,this.height/2)}),_projIfBehindCamera:(Fi=new Array(3),Ni=new Array(3),Bi=new Array(3),function(t,e,n){Oi(Fi,t,e);var r,i,o=(i=Fi,(r=n)[0]*i[0]+r[1]*i[1]+r[2]*i[2]);return o<=0&&(function(t,e,n){t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n}(Ni,n,1.01*o),function(t,e,n){t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2]}(t,e,Oi(Bi,Fi,Ni))),t}),_containerPointToPoint:(Li=[0,0,0],Ii=[0,0,0,1],Di=[0,0,0,1],function(t,e){if(this.isTransforming()){var n=this.width/2||1,r=this.height/2||1;Ei(Li,(t.x-n)/n,(r-t.y)/r,0),Ei(Ii,Li[0],Li[1],0),Ei(Di,Li[0],Li[1],1),Ii[3]=Di[3]=1,Ci(Ii,Ii,this.projViewMatrixInverse),Ci(Di,Di,this.projViewMatrixInverse);var i=Ii[0],o=Di[0],a=Ii[1],s=Di[1],u=Ii[2],c=Di[2],l=u===c?0:(0-u)/(c-u),h=new oe(F(i,o,l),F(a,s,l))._multi(1/this._glScale);return void 0===e||this.getZoom()===e?h:this._pointToPointAtZoom(h,e)}var f=this._prjToPoint(this._getPrjCenter(),e),d=void 0!==e?this._getResolution()/this._getResolution(e):1,p=d*(t.x-this.width/2),v=d*(t.y-this.height/2);return f._add(p,v)}),_calcMatrices:(ji=ee.ie9?null:Gi(),Ri=ee.ie9?null:Gi(),function(){if(!ee.ie9){var t=this.getSize(),e=t.width||1,n=t.height||1;this._glScale=this.getGLScale();var r,i,o,a,s,u,c,l=this.getFov()*Math.PI/180,h=this.getScale(this.getMinZoom())/this.getScale(this.getMaxNativeZoom())*n/2/this._getFovRatio()*1.4,f=this.projMatrix||Gi();r=f,i=l,o=e/n,a=.1,s=h,u=1/Math.tan(i/2),c=1/(a-s),r[0]=u/o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=u,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=(s+a)*c,r[11]=-1,r[12]=0,r[13]=0,r[14]=2*s*a*c,r[15]=0,this.projMatrix=f;var d=this._getCameraWorldMatrix();this.viewMatrix=wi(ji,d),this.projViewMatrix=bi(this.projViewMatrix||Gi(),f,this.viewMatrix),this.projViewMatrixInverse=bi(this.projViewMatrixInverse||Gi(),d,wi(Ri,f)),this.domCssMatrix=this._calcDomMatrix()}}),_calcDomMatrix:(Ai=ee.ie9?null:Gi(),Mi=[1,-1,1],ki=[0,0,0],function(){var t,e,n,r,i,o,a,s,u,c,l,h,f,d=.5/Math.tan(this._fov/2)*this.height;_i(Ai,this.projMatrix,Mi),mi(Ai,Ai,Ei(ki,0,0,-d)),this._pitch&&(t=Ai,e=Ai,n=this._pitch,r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],h=e[10],f=e[11],e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+h*r,t[7]=u*i+f*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=h*i-s*r,t[11]=f*i-u*r),this._angle&&function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],h=e[6],f=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+h*r,t[3]=u*i+f*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=h*i-s*r,t[7]=f*i-u*r}(Ai,Ai,this._angle);var p=Gi();return _i(p,p,Ei(ki,this.width/2,-this.height/2,1)),bi(this.domCssMatrix||Gi(),p,Ai)}),_getCameraWorldMatrix:function(){var t={},e=[1,-1,1];return function(){var n=this.getGLZoom(),r=this.getSize(),i=this.getGLScale(),o=this._prjToPoint(this._prjCenter,n);this.cameraLookAt=Ei(this.cameraLookAt||[0,0,0],o.x,o.y,0);var a=this.getPitch()*zi,s=-this.getBearing()*zi,u=this._getFovRatio(),c=i*(r.height||1)/2/u,l=c*Math.cos(a),h=Math.sin(a)*c,f=o.x+h*Math.sin(s),d=o.y+h*Math.cos(s);this.cameraPosition=Ei(this.cameraPosition||[0,0,0],f,d,l);var p=h||1,v=this.cameraUp=Ei(this.cameraUp||[0,0,0],Math.sin(s)*p,Math.cos(s)*p,0),g=this.cameraWorldMatrix=this.cameraWorldMatrix||Gi();!function(t,e,n,r){var i=[0,0,0],o=[0,0,0],a=[0,0,0];Oi(a,e,n),0===Pi(a)&&(a[2]=1),Si(a,a),Ti(i,r,a),0===Pi(a)&&(1===Math.abs(r[2])?a[0]+=1e-4:a[2]+=1e-4,Si(a,a),Ti(i,r,a)),Si(i,i),Ti(o,a,i),t[0]=i[0],t[4]=o[0],t[8]=a[0],t[1]=i[1],t[5]=o[1],t[9]=a[1],t[2]=i[2],t[6]=o[2],t[10]=a[2]}(g,this.cameraPosition,this.cameraLookAt,v);var y,m,_,b=this.cameraForward||[0,0,0];return Oi(b,this.cameraLookAt,this.cameraPosition),this.cameraForward=Si(b,b),function(t,e){var n,r=e[0],i=e[4],o=e[8],a=e[1],s=e[5],u=e[9],c=e[2],l=e[6],h=e[10],f=r+s+h;f>0?(n=.5/Math.sqrt(f+1),t.w=.25/n,t.x=(l-u)*n,t.y=(o-c)*n,t.z=(a-i)*n):r>s&&r>h?(n=2*Math.sqrt(1+r-s-h),t.w=(l-u)/n,t.x=.25*n,t.y=(i+a)/n,t.z=(o+c)/n):s>h?(n=2*Math.sqrt(1+s-r-h),t.w=(o-c)/n,t.x=(i+a)/n,t.y=.25*n,t.z=(u+l)/n):(n=2*Math.sqrt(1+h-r-s),t.w=(a-i)/n,t.x=(o+c)/n,t.y=(u+l)/n,t.z=.25*n)}(t,g),function(t,e){var n=t,r=e.x,i=e.y,o=e.z,a=e.w,s=r+r,u=i+i,c=o+o,l=r*s,h=r*u,f=r*c,d=i*u,p=i*c,v=o*c,g=a*s,y=a*u,m=a*c;n[0]=1-(d+v),n[4]=h-m,n[8]=f+y,n[1]=h+m,n[5]=1-(l+v),n[9]=p-g,n[2]=f-y,n[6]=p+g,n[10]=1-(l+d),n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(g,t),y=g,m=this.cameraPosition,(_=y)[12]=m[0],_[13]=m[1],_[14]=m[2],_i(g,g,e),g}}(),_getFovRatio:function(){var t=this.getFov();return Math.tan(t/2*zi)},_renderLayers:function(){this.isInteracting()||this._getLayers().forEach(function(t){if(t){var e=t._getRenderer();e&&e.setToRedraw&&e.setToRedraw()}})}}),Jn.include({_onViewChange:function(t){this._viewHistory||(this._viewHistory=[],this._viewHistoryPointer=0);for(var e=this._getCurrentView(),n=this._viewHistory.length-1;n>=0;n--)if(Q(t,this._viewHistory[n]))return this._viewHistoryPointer=n,void this._fireViewChange(e,t);this._viewHistoryPointer<this._viewHistory.length-1&&this._viewHistory.splice(this._viewHistoryPointer+1),this._viewHistory.push(t);var r=this.options.viewHistoryCount;r>0&&this._viewHistory.length>r&&this._viewHistory.splice(0,this._viewHistory.length-r),this._viewHistoryPointer=this._viewHistory.length-1,this._fireViewChange(e,t)},zoomToPreviousView:function(t){if(void 0===t&&(t={}),!this.hasPreviousView())return null;var e=this._viewHistory[--this._viewHistoryPointer];return this._zoomToView(e,t),e},hasPreviousView:function(){return!(!this._viewHistory||0===this._viewHistoryPointer)},zoomToNextView:function(t){if(void 0===t&&(t={}),!this.hasNextView())return null;var e=this._viewHistory[++this._viewHistoryPointer];return this._zoomToView(e,t),e},hasNextView:function(){return!(!this._viewHistory||this._viewHistoryPointer===this._viewHistory.length-1)},_zoomToView:function(t,e){var n=this,r=this.getView();e.animation?this.animateTo(t,{duration:e.duration},function(e){"finished"===e.state.playState&&n._fireViewChange(r,t)}):(this.setView(t),this._fireViewChange(r,t))},getViewHistory:function(){return this._viewHistory},_fireViewChange:function(t,e){this._fireEvent("viewchange",{old:t,new:e})},_getCurrentView:function(){return this._viewHistory?this._viewHistory[this._viewHistoryPointer]:null}}),Jn.mergeOptions({viewHistory:!0,viewHistoryCount:10});var Vi=function(t){function e(e){var n;return(n=t.call(this,e)||this).on("enable",n._afterEnable,re(re(n))).on("disable",n._afterDisable,re(re(n))),n._measureLayers=[],n}ne(e,t);var n=e.prototype;return n.clear=function(){if(U(this._measureLayers))for(var t=0;t<this._measureLayers.length;t++)this._measureLayers[t].remove();return delete this._lastMeasure,delete this._lastVertex,this._measureLayers=[],this},n.getMeasureLayers=function(){return this._measureLayers},n.getLastMeasure=function(){return this._lastMeasure?this._lastMeasure:0},n._measure=function(t){var e,n,r=this.getMap();t instanceof wr?e=r.computeGeometryLength(t):Array.isArray(t)&&(e=r.getProjection().measureLength(t)),this._lastMeasure=e,n="zh-CN"===this.options.language?[" "," "," "," "]:[" m"," km"," feet"," mile"];var i="";return this.options.metric&&(i+=e<1e3?e.toFixed(0)+n[0]:(e/1e3).toFixed(2)+n[1]),this.options.imperial&&(e*=3.2808399,i.length>0&&(i+="\n"),i+=e<5280?e.toFixed(0)+n[2]:(e/5280).toFixed(2)+n[3]),i},n._registerMeasureEvents=function(){this.on("drawstart",this._msOnDrawStart,this).on("drawvertex",this._msOnDrawVertex,this).on("mousemove",this._msOnMouseMove,this).on("drawend",this._msOnDrawEnd,this)},n._afterEnable=function(){this._registerMeasureEvents()},n._afterDisable=function(){this.off("drawstart",this._msOnDrawStart,this).off("drawvertex",this._msOnDrawVertex,this).off("mousemove",this._msOnMouseMove,this).off("drawend",this._msOnDrawEnd,this)},n._msOnDrawStart=function(t){var e=this.getMap(),n=A(),r="distancetool_"+n,i="distancetool_markers_"+n;e.getLayer(r)?(this._measureLineLayer=e.getLayer(r),this._measureMarkerLayer=e.getLayer(i)):(this._measureLineLayer=new hi(r).addTo(e),this._measureMarkerLayer=new hi(i).addTo(e)),this._measureLayers.push(this._measureLineLayer),this._measureLayers.push(this._measureMarkerLayer),new Lr(t.coordinate,{symbol:this.options.vertexSymbol}).addTo(this._measureMarkerLayer);var o="zh-CN"===this.options.language?"":"start",a=new ii(o,t.coordinate,this.options.labelOptions);this._measureMarkerLayer.addGeometry(a)},n._msOnMouseMove=function(t){var e=this._measure(this._msGetCoordsToMeasure(t));if(!this._tailMarker){var n=jt(this.options.vertexSymbol);n.markerWidth/=2,n.markerHeight/=2,this._tailMarker=new Lr(t.coordinate,{symbol:n}).addTo(this._measureMarkerLayer),this._tailLabel=new ii(e,t.coordinate,this.options.labelOptions).addTo(this._measureMarkerLayer)}this._tailMarker.setCoordinates(t.coordinate),this._tailLabel.setContent(e),this._tailLabel.setCoordinates(t.coordinate)},n._msGetCoordsToMeasure=function(t){return t.geometry.getCoordinates().concat([t.coordinate])},n._msOnDrawVertex=function(t){var e=t.geometry;new Lr(t.coordinate,{symbol:this.options.vertexSymbol}).addTo(this._measureMarkerLayer);var n=this._measure(e),r=new ii(n,t.coordinate,this.options.labelOptions);this._measureMarkerLayer.addGeometry(r),this._lastVertex=r},n._msOnDrawEnd=function(t){this._clearTailMarker();var e=this._lastVertex.getSize();e||(e=new ae(10,10)),this._addClearMarker(this._lastVertex.getCoordinates(),e.width);var n=t.geometry.copy();n.addTo(this._measureLineLayer),this._lastMeasure=n.getLength()},n._addClearMarker=function(t,e){var n=this.options.clearButtonSymbol,r={markerDx:(n.markerDx||0)+e,textDx:(n.textDx||0)+e};Array.isArray(n)&&(r=n.map(function(t){return t?{markerDx:(t.markerDx||0)+e,textDx:(t.textDx||0)+e}:null})),n=jt(n,r);var i=new Lr(t,{symbol:n}),o=this._measureLineLayer,a=this._measureMarkerLayer;i.on("click",function(){return o.remove(),a.remove(),!1},this),i.addTo(this._measureMarkerLayer)},n._clearTailMarker=function(){this._tailMarker&&(this._tailMarker.remove(),delete this._tailMarker),this._tailLabel&&(this._tailLabel.remove(),delete this._tailLabel)},e}(vi);Vi.mergeOptions({mode:"LineString",language:"zh-CN",metric:!0,imperial:!1,symbol:{lineColor:"#000",lineWidth:3,lineOpacity:1},vertexSymbol:{markerType:"ellipse",markerFill:"#fff",markerLineColor:"#000",markerLineWidth:3,markerWidth:11,markerHeight:11},labelOptions:{textSymbol:{textFaceName:"monospace",textLineSpacing:1,textHorizontalAlignment:"right",textDx:15},boxStyle:{padding:[6,2],symbol:{markerType:"square",markerFill:"#fff",markerFillOpacity:.9,markerLineColor:"#b4b3b3"}}},clearButtonSymbol:[{markerType:"square",markerFill:"#fff",markerLineColor:"#b4b3b3",markerLineWidth:2,markerWidth:15,markerHeight:15,markerDx:20},{markerType:"x",markerWidth:10,markerHeight:10,markerDx:20}]});function Wi(t){for(var e=t.tileInfo,n=[e.cols,e.rows],r=[],i=e.lods,o=0,a=i.length;o<a;o++)r.push(i[o].resolution);var s=t.fullExtent,u=e.origin,c=[1,-1,u.x,u.y];return delete s.spatialReference,{spatialReference:{resolutions:r,fullExtent:s},tileSystem:c,tileSize:n}}(function(t){function e(e){var n;return(n=t.call(this,e)||this).on("enable",n._afterEnable,re(re(n))).on("disable",n._afterDisable,re(re(n))),n._measureLayers=[],n}ne(e,t);var n=e.prototype;return n._measure=function(t){var e,n,r=this.getMap();t instanceof wr?e=r.computeGeometryArea(t):Array.isArray(t)&&(e=r.getProjection().measureArea(t)),this._lastMeasure=e,n="zh-CN"===this.options.language?[" "," "," "," "]:[" sq.m"," sq.km"," sq.ft"," sq.mi"];var i="";if(this.options.metric&&(i+=e<1e6?e.toFixed(0)+n[0]:(e/1e6).toFixed(2)+n[1]),this.options.imperial){e*=3.2808399,i.length>0&&(i+="\n");i+=e<27878400?e.toFixed(0)+n[2]:(e/27878400).toFixed(2)+n[3]}return i},n._msGetCoordsToMeasure=function(t){return t.geometry.getShell().concat([t.coordinate])},n._msOnDrawVertex=function(t){var e=new Lr(t.coordinate,{symbol:this.options.vertexSymbol}).addTo(this._measureMarkerLayer);this._measure(t.geometry),this._lastVertex=e},n._msOnDrawEnd=function(t){this._clearTailMarker();var e=this._measure(t.geometry),n=new ii(e,t.coordinate,this.options.labelOptions).addTo(this._measureMarkerLayer).getSize();n||(n=new ae(10,10)),this._addClearMarker(t.coordinate,n.width);var r=t.geometry.copy();r.addTo(this._measureLineLayer),this._lastMeasure=r.getArea()},e})(Vi).mergeOptions({mode:"Polygon",symbol:{lineColor:"#000000",lineWidth:2,lineOpacity:1,lineDasharray:"",polygonFill:"#ffffff",polygonOpacity:.5}}),vi.registerMode("circle",{clickLimit:2,action:["click","mousemove","click"],create:function(t){return new Hr(t[0],0)},update:function(t,e){var n=e.getMap().computeLength(e.getCenter(),t[t.length-1]);e.setRadius(n)},generate:function(t){return t}}),vi.registerMode("freeHandCircle",{action:["mousedown","mousemove","mouseup"],create:function(t){return new Hr(t[0],0)},update:function(t,e){var n=e.getMap().computeLength(e.getCenter(),t[t.length-1]);e.setRadius(n)},generate:function(t){return t}}),vi.registerMode("ellipse",{clickLimit:2,action:["click","mousemove","click"],create:function(t){return new Xr(t[0],0,0)},update:function(t,e){var n=e.getMap(),r=e.getCenter(),i=n.computeLength(r,new dn({x:t[t.length-1].x,y:r.y})),o=n.computeLength(r,new dn({x:r.x,y:t[t.length-1].y}));e.setWidth(2*i),e.setHeight(2*o)},generate:function(t){return t}}),vi.registerMode("freeHandEllipse",{action:["mousedown","mousemove","mouseup"],create:function(t){return new Xr(t[0],0,0)},update:function(t,e){var n=e.getMap(),r=e.getCenter(),i=n.computeLength(r,new dn({x:t[t.length-1].x,y:r.y})),o=n.computeLength(r,new dn({x:r.x,y:t[t.length-1].y}));e.setWidth(2*i),e.setHeight(2*o)},generate:function(t){return t}}),vi.registerMode("rectangle",{clickLimit:2,action:["click","mousemove","click"],create:function(t){var e=new jr([]);return e._firstClick=t[0],e},update:function(t,e,n){var r=e.getMap(),i=n.containerPoint,o=r.coordToContainerPoint(e._firstClick),a=[[o.x,o.y],[i.x,o.y],[i.x,i.y],[o.x,i.y]];e.setCoordinates(a.map(function(t){return r.containerPointToCoord(new oe(t))}))},generate:function(t){return t}}),vi.registerMode("freeHandRectangle",{action:["mousedown","mousemove","mouseup"],create:function(t){var e=new jr([]);return e._firstClick=t[0],e},update:function(t,e){var n=e._firstClick,r=[[n.x,n.y],[t[0].x,n.y],[t[0].x,t[0].y],[n.x,t[0].y]];e.setCoordinates(r)},generate:function(t){return t}}),vi.registerMode("point",{clickLimit:1,action:["click"],create:function(t){return new Lr(t[0])},generate:function(t){return t}}),vi.registerMode("polygon",{action:["click","mousemove","dblclick"],create:function(t){return new Dr(t)},update:function(t,e){var n=e.getSymbol();e.setCoordinates(t);var r=e.getLayer();if(r){var i=r.getGeometryById("polygon");if(!i&&t.length>=3){if(i=new jr([t],{id:"polygon"}),n){var o=jt(n,{lineOpacity:0});i.setSymbol(o)}i.addTo(r)}i&&i.setCoordinates(t)}},generate:function(t){return new jr(t.getCoordinates(),{symbol:t.getSymbol()})}}),vi.registerMode("freeHandPolygon",{action:["mousedown","mousemove","mouseup"],create:function(t){return new Dr(t)},update:function(t,e){var n=e.getCoordinates(),r=e.getSymbol();e.setCoordinates(n.concat(t));var i=e.getLayer();if(i){var o=i.getGeometryById("polygon");if(!o&&t.length>=3){if(o=new jr([t],{id:"polygon"}),r){var a=jt(r,{lineOpacity:0});o.setSymbol(a)}o.addTo(i)}o&&o.setCoordinates(t)}},generate:function(t){return new jr(t.getCoordinates(),{symbol:t.getSymbol()})}}),vi.registerMode("linestring",{action:["click","mousemove","dblclick"],create:function(t){return new Dr(t)},update:function(t,e){e.setCoordinates(t)},generate:function(t){return t}}),vi.registerMode("freeHandLinestring",{action:["mousedown","mousemove","mouseup"],create:function(t){return new Dr(t)},update:function(t,e){var n=e.getCoordinates();e.setCoordinates(n.concat(t))},generate:function(t){return t}}),vi.registerMode("arccurve",{action:["click","mousemove","dblclick"],create:function(t){return new Qr(t)},update:function(t,e){e.setCoordinates(t)},generate:function(t){return t}}),vi.registerMode("quadbeziercurve",{action:["click","mousemove","dblclick"],create:function(t){return new $r(t)},update:function(t,e){e.setCoordinates(t)},generate:function(t){return t}}),vi.registerMode("cubicbeziercurve",{action:["click","mousemove","dblclick"],create:function(t){return new Kr(t)},update:function(t,e){e.setCoordinates(t)},generate:function(t){return t}}),vi.registerMode("boxZoom",{action:["mousedown","mousemove","mouseup"],create:function(t){var e=new Lr(t[0]);return e._firstClick=t[0],e},update:function(t,e,n){var r=e.getMap(),i=r.coordToContainerPoint(e._firstClick),o=n.containerPoint,a=r.containerPointToCoordinate(new dn(Math.min(i.x,o.x),Math.min(i.y,o.y)));e.setCoordinates(a).updateSymbol({markerWidth:Math.abs(i.x-o.x),markerHeight:Math.abs(i.y-o.y)})},generate:function(t){return t}}),Xn.loadArcgis=function(t,e,n){if(void 0===n&&(n={jsonp:!0}),g(t)&&"{"!==t.substring(0,1))qe.getJSON(t,function(t,n){if(t)e(t);else{var r=Wi(n);e(null,r)}},n);else{g(t)&&(t=M(t));var r=Wi(t);e(null,r)}return this};var Zi=function(t){function e(e){return t.call(this,e)||this}ne(e,t);var n=e.prototype;return n.addTo=function(t){return this._owner=t,this._switchEvents("on"),this.onAdd&&this.onAdd(),this.fire("add"),this},n.getMap=function(){return this._owner?this._owner.getBaseLayer?this._owner:this._owner.getMap():null},n.show=function(t){var e=this.getMap();if(!e)return this;this._mapEventsOn||this._switchMapEvents("on"),t=t||this._coordinate||this._owner.getCenter();var n=this.isVisible();this.fire("showstart");var r=this._getUIContainer();this._coordinate=t,this._removePrevDOM();var i=this.__uiDOM=this.buildOn(e);if(i.eventsPropagation=this.options.eventsPropagation,!i)return this.fire("showend"),this;this._measureSize(i),this._singleton()&&(e[this._uiDomKey()]=i),this._setPosition(),i.style[Se]=null,r.appendChild(i);var o=this._getAnimation();if(n&&(o.ok=!1),o.ok&&(o.fade&&(i.style.opacity=0),o.scale)){if(this.getTransformOrigin){var a=this.getTransformOrigin();i.style[Pe]=a}i.style[Oe]=this._toCSSTranslate(this._pos)+" scale(0)"}i.style.display="",this.options.eventsToStop&&Ye(i,this.options.eventsToStop,Le),this.options.autoPan&&this._autoPan();var s=o.transition;return o.ok&&s&&(i.offsetHeight,s&&(i.style[Se]=s),o.fade&&(i.style.opacity=1),o.scale&&(i.style[Oe]=this._toCSSTranslate(this._pos)+" scale(1)")),this.fire("showend"),this},n.hide=function(){var t=this;if(!this.getDOM()||!this.getMap())return this;var e=this._getAnimation(),n=this.getDOM();return this.options.animationOnHide||(e.ok=!1),e.ok?(n.offsetHeight,n.style[Se]=e.transition,setTimeout(function(){n.style.display="none",t.fire("hide")},this.options.animationDuration)):(n.style.display="none",this.fire("hide")),e.fade&&(n.style.opacity=0),e.scale&&(n.style[Oe]=this._toCSSTranslate(this._pos)+" scale(0)"),this},n.isVisible=function(){var t=this.getDOM();return this.getMap()&&t&&t.parentNode&&"none"!==t.style.display},n.remove=function(){return delete this._mapEventsOn,this._owner?(this.hide(),this._switchEvents("off"),this.onRemove&&this.onRemove(),!this._singleton()&&this.__uiDOM&&this._removePrevDOM(),delete this._owner,this.fire("remove"),this):this},n.getSize=function(){return this._size?this._size.copy():null},n.getOwner=function(){return this._owner},n.getDOM=function(){return this.__uiDOM},n.getPosition=function(){if(!this.getMap())return null;var t=this._getViewPoint()._round();if(this.getOffset){var e=this.getOffset()._round();e&&t._add(e)}return t},n._getAnimation=function(){for(var t={fade:!1,scale:!1},e=this.options.animation?this.options.animation.split(","):[],n=0;n<e.length;n++){var r=se(e[n]);"fade"===r?t.fade=!0:"scale"===r&&(t.scale=!0)}var i=null;return t.fade&&(i="opacity "+this.options.animationDuration+"ms"),t.scale&&(i=i?i+",":"",i+=Oe+" "+this.options.animationDuration+"ms"),t.transition=i,t.ok=null!==i,t},n._getViewPoint=function(){return this.getMap().coordToViewPoint(this._coordinate)._add(this.options.dx,this.options.dy)},n._autoPan=function(){var t=this.getMap(),e=this.getDOM();if(!t.isMoving()){var n=this._pos,r=t.getSize(),i=r.width,o=r.height,a=t.viewPointToContainerPoint(n),s=parseInt(e.clientWidth),u=parseInt(e.clientHeight),c=0,l=0;a.x<0?c=-(a.x-s/2):a.x+s-35>i&&(c=i-(a.x+3*s/2)),a.y-u<0?l=50-(a.y-u):a.y>o&&(l=o-a.y-u-30),0===l&&0===c||t.panBy(new oe(c,l),{duration:this.options.autoPanDuration})}},n._measureSize=function(t){var e=this._getUIContainer();t.style.position="absolute",t.style.left="-99999px";var n=t.style.bottom?"bottom":"top";return t.style[n]="-99999px",t.style.display="",e.appendChild(t),this._size=new ae(t.clientWidth,t.clientHeight),t.style.display="none",t.style.left="0px",t.style[n]="0px",this._size},n._removePrevDOM=function(){this.onDomRemove&&this.onDomRemove();var t=this.options.eventsToStop;if(this._singleton()){var e=this.getMap(),n=this._uiDomKey();e[n]&&(t&&Je(e[n],t,Le),Ae(e[n]),delete e[n]),delete this.__uiDOM}else this.__uiDOM&&(t&&Je(this.__uiDOM,t,Le),Ae(this.__uiDOM),delete this.__uiDOM)},n._uiDomKey=function(){return"__ui_"+this._getClassName()},n._singleton=function(){return this.options.single},n._getUIContainer=function(){return this.getMap()._panels.ui},n._getClassName=function(){return"UIComponent"},n._switchMapEvents=function(t){var e=this.getMap();if(e){this._mapEventsOn="on"===t;var n=this._getDefaultEvents();if(this.getEvents&&h(n,this.getEvents()),n)for(var r in n)n.hasOwnProperty(r)&&e[t](r,n[r],this)}},n._switchEvents=function(t){this._switchMapEvents(t);var e=this._getOwnerEvents();if(this._owner)for(var n in e)e.hasOwnProperty(n)&&this._owner[t](n,e[n],this)},n._getDefaultEvents=function(){return{"zooming rotate pitch":this.onEvent,zoomend:this.onZoomEnd,moving:this.onMoving}},n._getOwnerEvents=function(){var t={};return this._owner&&this._owner instanceof wr&&(t.positionchange=this.onGeometryPositionChange),this.getOwnerEvents&&h(t,this.getOwnerEvents()),t},n.onGeometryPositionChange=function(t){this._owner&&this.isVisible()&&this.show(t.target.getCenter())},n.onMoving=function(){this.isVisible()&&this.getMap().isTransforming()&&this._updatePosition()},n.onEvent=function(){this.isVisible()&&this._updatePosition()},n.onZoomEnd=function(){this.isVisible()&&this._setPosition()},n._updatePosition=function(){this.getMap()._getRenderer().callInNextFrame(this._setPosition.bind(this))},n._setPosition=function(){var t=this.getDOM();if(t){var e=this.getPosition();this._pos=e,t.style[Oe]=this._toCSSTranslate(e)+" scale(1)"}},n._toCSSTranslate=function(t){if(!t)return"";if(ee.any3d){var e=this.getMap(),n=e?e.getBearing():0,r=e?e.getPitch():0,i="";return this.options.pitchWithMap&&r&&(i+=" rotateX("+Math.round(r)+"deg)"),this.options.rotateWithMap&&n&&(i+=" rotateZ("+Math.round(-n)+"deg)"),"translate3d("+t.x+"px,"+t.y+"px, 0px)"+i}return"translate("+t.x+"px,"+t.y+"px)"},e}(rn(an));Zi.mergeOptions({eventsPropagation:!1,eventsToStop:null,dx:0,dy:0,autoPan:!1,autoPanDuration:600,single:!0,animation:"scale",animationOnHide:!0,animationDuration:500,pitchWithMap:!1,rotateWithMap:!1});var Hi="mousedown mouseup mouseenter mouseover mouseout mousemove click dblclick contextmenu keypress touchstart touchmove touchend",Xi=function(t){function e(e,n){var r;return(r=t.call(this,n)||this)._markerCoord=new dn(e),r}ne(e,t);var n=e.prototype;return n._getClassName=function(){return"UIMarker"},n.setCoordinates=function(t){return this._markerCoord=t,this.fire("positionchange"),this.isVisible()&&(this._coordinate=this._markerCoord,this._setPosition()),this},n.getCoordinates=function(){return this._markerCoord},n.setContent=function(t){var e=this.options.content;return this.options.content=t,this.fire("contentchange",{old:e,new:t}),this.isVisible()&&this.show(),this},n.getContent=function(){return this.options.content},n.onAdd=function(){this.show()},n.show=function(){return t.prototype.show.call(this,this._markerCoord)},n.flash=function(t,e,n,r){return $.call(this,t,e,n,r)},n.buildOn=function(){var t;return g(this.options.content)?(t=Te("div")).innerHTML=this.options.content:t=this.options.content,this._registerDOMEvents(t),t},n.getOffset=function(){var t=this.getSize();return new oe(-t.width/2,-t.height/2)},n.getTransformOrigin=function(){return"center center"},n.onDomRemove=function(){var t=this.getDOM();this._removeDOMEvents(t)},n.isDragging=function(){return!!this.draggable&&this.draggable.isDragging()},n._registerDOMEvents=function(t){Ye(t,Hi,this._onDomEvents,this)},n._onDomEvents=function(t){var e=this.getMap()._parseEvent(t,t.type);this.fire(t.type,e)},n._removeDOMEvents=function(t){Je(t,Hi,this._onDomEvents,this)},n._getConnectPoints=function(){var t=this.getMap(),e=t.coordToContainerPoint(this.getCoordinates()),n=this.getSize(),r=n.width,i=n.height;return[t.containerPointToCoordinate(e.add(-r/2,0)),t.containerPointToCoordinate(e.add(r/2,0)),t.containerPointToCoordinate(e.add(0,i/2)),t.containerPointToCoordinate(e.add(0,-i/2))]},e}(cn(Zi));Xi.mergeOptions({eventsPropagation:!0,draggable:!1,single:!1,content:null});var Yi=ee.touch?"touchstart mousedown":"mousedown",Ji=function(t){function e(e){return t.call(this,e)||this}ne(e,t);var n=e.prototype;return n.addHooks=function(){this.target.on(Yi,this._startDrag,this)},n.removeHooks=function(){this.target.off(Yi,this._startDrag,this)},n._startDrag=function(t){var e=t.domEvent;e.touches&&e.touches.length>1||2===e.button||this.isDragging()||(this.target.on("click",this._endDrag,this),this._lastCoord=t.coordinate,this._lastPoint=t.containerPoint,this._prepareDragHandler(),this._dragHandler.onMouseDown(t.domEvent),this.target.fire("dragstart",t))},n._prepareDragHandler=function(){this._dragHandler=new fn(this.target.getDOM(),{cancelOn:this._cancelOn.bind(this),ignoreMouseleave:!0}),this._dragHandler.on("mousedown",this._onMouseDown,this),this._dragHandler.on("dragging",this._dragging,this),this._dragHandler.on("mouseup",this._endDrag,this),this._dragHandler.enable()},n._cancelOn=function(t){var e=(t.srcElement||t.target).tagName.toLowerCase();return"button"===e||"input"===e||"select"===e||"option"===e||"textarea"===e},n._onMouseDown=function(t){Le(t.domEvent)},n._dragging=function(t){var e=this.target,n=e.getMap()._parseEvent(t.domEvent),r=n.domEvent;if(!(r.touches&&r.touches.length>1))if(this._isDragging){var i=n.coordinate,o=n.containerPoint;this._lastCoord||(this._lastCoord=i),this._lastPoint||(this._lastPoint=o);var a=i.sub(this._lastCoord),s=o.sub(this._lastPoint);this._lastCoord=i,this._lastPoint=o,this.target.setCoordinates(this.target.getCoordinates().add(a)),n.coordOffset=a,n.pointOffset=s,e.fire("dragging",n)}else this._isDragging=!0},n._endDrag=function(t){var e=this.target,n=e.getMap();if(this._dragHandler&&(e.off("click",this._endDrag,this),this._dragHandler.disable(),delete this._dragHandler),delete this._lastCoord,delete this._lastPoint,this._isDragging=!1,n){var r=n._parseEvent(t.domEvent);e.fire("dragend",r)}},n.isDragging=function(){return!!this._isDragging},e}(on);Xi.addInitHook("addHandler","draggable",Ji);var qi=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n._getClassName=function(){return"InfoWindow"},n.addTo=function(e){return e instanceof wr&&(e.getInfoWindow()&&e.getInfoWindow()!==this&&e.removeInfoWindow(),e._infoWindow=this),t.prototype.addTo.call(this,e)},n.setContent=function(t){var e=this.options.content;return this.options.content=t,this.fire("contentchange",{old:e,new:t}),this.isVisible()&&this.show(this._coordinate),this},n.getContent=function(){return this.options.content},n.setTitle=function(t){var e=t;return this.options.title=t,this.fire("contentchange",{old:e,new:t}),this.isVisible()&&this.show(this._coordinate),this},n.getTitle=function(){return this.options.title},n.buildOn=function(){if(this.options.custom){if(g(this.options.content)){var t=Te("div");return t.innerHTML=this.options.content,t}return this.options.content}var e=Te("div");e.className="maptalks-msgBox",e.style.width=this._getWindowWidth()+"px",e.style.bottom="0px";var n='<em class="maptalks-ico"></em>';this.options.title&&(n+="<h2>"+this.options.title+"</h2>"),n+='<a href="javascript:void(0);" class="maptalks-close"></a><div class="maptalks-msgContent"></div>',e.innerHTML=n;var r=e.querySelector(".maptalks-msgContent");return g(this.options.content)?r.innerHTML=this.options.content:r.appendChild(this.options.content),this._onCloseBtnClick=this.hide.bind(this),Me(e.querySelector(".maptalks-close"),"click touchend",this._onCloseBtnClick),e},n.getTransformOrigin=function(){return this.getSize().width/2+"px bottom"},n.getOffset=function(){var t=this.getSize(),e=new oe(-t.width/2,0);this.options.custom||e._sub(4,12);var n=this.getOwner();if(n instanceof Lr||n instanceof Ur){var r,i;if(n instanceof Lr)r=n._getPainter(),i=n.getSize();else{var o=n.getGeometries();if(!o||!o.length)return e;r=o[0]._getPainter(),i=o[0].getSize()}if(r){var a=r.getFixedExtent();e._add(a.xmax-i.width/2,a.ymin)}}return e},n.show=function(e){return this.getMap()&&this.getMap().options.enableInfoWindow?t.prototype.show.call(this,e):this},n.getEvents=function(){if(!this.options.autoCloseOn)return null;var t={};return t[this.options.autoCloseOn]=this.hide,t},n.getOwnerEvents=function(){var t=this.getOwner();if(!this.options.autoOpenOn||!t)return null;var e={};return e[this.options.autoOpenOn]=this._onAutoOpen,e},n.onRemove=function(){this.onDomRemove()},n.onDomRemove=function(){this._onCloseBtnClick&&(ke(this.getDOM().childNodes[2],"click touchend",this._onCloseBtnClick),delete this._onCloseBtnClick)},n._onAutoOpen=function(t){var e=this,n=this.getOwner();setTimeout(function(){n instanceof Lr?e.show(n.getCoordinates()):n instanceof Ur?e.show(n.findClosest(t.coordinate)):e.show(t.coordinate)},1)},n._getWindowWidth=function(){var t=this.options.width;return t||(t=300),t},e}(Zi);qi.mergeOptions({autoPan:!0,autoCloseOn:null,autoOpenOn:"click",width:300,minHeight:120,custom:!1,title:null,content:null});var Qi={width:0,height:0,animation:"fade",cssName:"maptalks-tooltip",showTimeout:400},Ki=function(t){ne(n,t);var e=n.prototype;function n(e,n){var r;return void 0===n&&(n={}),(r=t.call(this,n)||this)._content=e,r}return e._getClassName=function(){return"ToolTip"},e.addTo=function(e){if(e instanceof wr||e instanceof Xi)return e.on("mousemove",this.onMouseMove,this),e.on("mouseout",this.onMouseOut,this),t.prototype.addTo.call(this,e);throw new Error("Invalid geometry or UIMarker the tooltip is added to.")},e.setStyle=function(t){return this.options.cssName=t,this},e.getStyle=function(){return this.options.cssName},e.getContent=function(){return this._content},e.buildOn=function(){var t=Te("div");Qi.height&&(t.style.height=Qi.height+"px"),Qi.width&&(t.style.width=Qi.width+"px");var e=this.options.cssName;return!e&&Qi.height&&(t.style.lineHeight=Qi.height+"px"),t.innerHTML='<div class="'+e+'">'+this._content+"</div>",t},e.onMouseOut=function(){clearTimeout(this._timeout),this.isVisible()&&this._removePrevDOM()},e.onMouseMove=function(t){var e=this;clearTimeout(this._timeout);var n=this.getMap();if(n){var r=n.locateByPoint(t.coordinate,-5,25);0===this.options.showTimeout?this.show(r):this._timeout=setTimeout(function(){n&&e.show(r)},this.options.showTimeout)}},e.onRemove=function(){clearTimeout(this._timeout),this._owner&&(this._owner.off("mouseover",this.onMouseOver,this),this._owner.off("mouseout",this.onMouseOut,this))},n}(Zi);Ki.mergeOptions(Qi);var $i=function(t){function e(e){return t.call(this,e)||this}ne(e,t);var n=e.prototype;return n._getClassName=function(){return"Menu"},n.addTo=function(t){return t._menu&&t._menu!==this&&t.removeMenu(),t._menu=this,Zi.prototype.addTo.apply(this,arguments)},n.setItems=function(t){return this.options.items=t,this},n.getItems=function(){return this.options.items||[]},n.buildOn=function(){if(this.options.custom){if(g(this.options.items)){var t=Te("div");return t.innerHTML=this.options.items,t}return this.options.items}var e=Te("div");ze(e,"maptalks-menu"),e.style.width=this._getMenuWidth()+"px";var n=this._createMenuItemDom();return e.appendChild(n),Ye(e,"contextmenu",Re),e},n.getOffset=function(){if(!this.getMap())return null;var t=this.getMap().getSize(),e=this.getMap().viewPointToContainerPoint(this._getViewPoint()),n=this.getSize(),r=0,i=0;return e.x+n.width>t.width&&(r=-n.width),e.y+n.height>t.height&&(i=-n.height),new oe(r,i)},n.getTransformOrigin=function(){var t=this.getOffset()._multi(-1);return t.x+"px "+t.y+"px"},n.getEvents=function(){return{"_zoomstart _zoomend _movestart _dblclick _click":this._removePrevDOM}},n._createMenuItemDom=function(){var t=this,e=this.getMap(),n=Te("ul");ze(n,"maptalks-menu-items");var r,i,o=this.getItems();function a(n){return function(r){var i=e._parseEvent(r,"click");i.target=t,i.owner=t._owner,i.index=n,!1!==this._callback(i)&&t.hide()}}for(var s=0,u=o.length;s<u;s++){if("-"===(r=o[s])||"_"===r)ze(i=Te("li"),"maptalks-menu-splitter");else{i=Te("li");var c=r.item;y(c)&&(c=c({owner:this._owner,index:s})),i.innerHTML=c,i._callback=r.click,Ye(i,"click",a(s))}n.appendChild(i)}var l=this.options.maxHeight||0;return l>0&&Be(n,"max-height: "+l+"px; overflow-y: auto;"),n},n._getMenuWidth=function(){return this.options.width||160},e}(Zi);$i.mergeOptions({animation:null,animationDelay:10,animationOnHide:!1,autoPan:!1,width:160,maxHeight:0,custom:!1,items:[]});var to={setMenu:function(t){return this._menuOptions=t,this._menu?this._menu.setOptions(t):this.on("contextmenu",this._defaultOpenMenu,this),this},openMenu:function(t){var e=this instanceof Jn?this:this.getMap();return t||(t=this.getCenter()),this._menu?this._menu.show(t):this._menuOptions&&e&&(this._bindMenu(this._menuOptions),this._menu.show(t)),this},setMenuItems:function(t){return this._menuOptions||(this._menuOptions={}),Array.isArray(t)&&(this._menuOptions.custom=!1),this._menuOptions.items=t,this.setMenu(this._menuOptions),this},getMenuItems:function(){return this._menu?this._menu.getItems():this._menuOptions&&this._menuOptions.items||[]},closeMenu:function(){return this._menu&&this._menu.hide(),this},removeMenu:function(){return this.off("contextmenu",this._defaultOpenMenu,this),this._unbindMenu(),delete this._menuOptions,this},_bindMenu:function(t){return this._menu=new $i(t),this._menu.addTo(this),this},_unbindMenu:function(){return this._menu&&(this.closeMenu(),this._menu.remove(),delete this._menu),this},_defaultOpenMenu:function(t){return this.listens("contextmenu")>1||(this.openMenu(t.coordinate),!1)}};Jn.include(to),wr.include(to);var eo=function(t){function e(e){return e&&e.position&&!g(e.position)&&(e.position=h({},e.position)),t.call(this,e)||this}ne(e,t);var n=e.prototype;return n.addTo=function(t){if(this.remove(),!t.options.control)return this;this._map=t;var e=t._panels.control;return this.__ctrlContainer=Te("div"),Be(this.__ctrlContainer,"position:absolute;overflow:visible;"),this.update(),e.appendChild(this.__ctrlContainer),this.onAdd&&this.onAdd(),this.fire("add",{dom:e}),this},n.update=function(){return this.__ctrlContainer.innerHTML="",this._controlDom=this.buildOn(this.getMap()),this._controlDom&&(this._updatePosition(),this.__ctrlContainer.appendChild(this._controlDom)),this},n.getMap=function(){return this._map},n.getPosition=function(){return h({},this._parse(this.options.position))},n.setPosition=function(t){return g(t)?this.options.position=t:this.options.position=h({},t),this._updatePosition(),this},n.getContainerPoint=function(){var t,e,n=this.getPosition(),r=this.getMap().getSize();return f(n.left)?f(n.right)||(t=r.width-parseInt(n.right)):t=parseInt(n.left),f(n.top)?f(n.bottom)||(e=r.height-parseInt(n.bottom)):e=parseInt(n.top),new oe(t,e)},n.getContainer=function(){return this.__ctrlContainer},n.getDOM=function(){return this._controlDom},n.show=function(){return this.__ctrlContainer.style.display="",this},n.hide=function(){return this.__ctrlContainer.style.display="none",this},n.isVisible=function(){return this.__ctrlContainer&&""===this.__ctrlContainer.style.display},n.remove=function(){return this._map?(Ae(this.__ctrlContainer),this.onRemove&&this.onRemove(),delete this._map,delete this.__ctrlContainer,delete this._controlDom,this.fire("remove"),this):this},n._parse=function(t){var n=t;return g(t)&&(n=e.positions[n]),n},n._updatePosition=function(){var t=this.getPosition();for(var e in t||(t={top:20,left:20}),t)t.hasOwnProperty(e)&&(t[e]=parseInt(t[e]),this.__ctrlContainer.style[e]=t[e]+"px");this.fire("positionchange",{position:h({},t)})},e}(rn(an));eo.positions={"top-left":{top:20,left:20},"top-right":{top:20,right:20},"bottom-left":{bottom:20,left:20},"bottom-right":{bottom:20,right:20}},Jn.mergeOptions({control:!0}),Jn.include({addControl:function(t){return this._containerDOM.getContext?this:(t.addTo(this),this)},removeControl:function(t){return t&&t.getMap()===this?(t.remove(),this):this}});var no="addlayer removelayer setbaselayer baselayerremove",ro=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.buildOn=function(){return this._attributionContainer=Te("div"),this._attributionContainer.className="maptalks-attribution",this._update(),this._attributionContainer},n.onAdd=function(){this.getMap().on(no,this._update,this)},n.onRemove=function(){this.getMap().off(no,this._update,this)},n._update=function(){var t=this.getMap();if(t){var e=t._getLayers(function(t){return t.options.attribution}).reverse().map(function(t){return t.options.attribution}),n=this.options.content+(e.length>0?" - "+e.join(", "):"");this._attributionContainer.innerHTML='<span style="padding:0px 4px">'+n+"</span>"}},e}(eo);ro.mergeOptions({position:{bottom:0,left:0},content:'<a href="http://maptalks.org" target="_blank">maptalks</a>'}),Jn.mergeOptions({attribution:!0}),Jn.addOnLoadHook(function(){var t=this.options.attribution||this.options.attributionControl;t&&(this.attributionControl=new ro(t),this.addControl(this.attributionControl))});var io=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.buildOn=function(){var t=this.container=Te("div",this.options.containerClass),e=this.panel=Te("div","panel"),n=this.button=Te("button");return t.appendChild(n),t.appendChild(e),t},n.onAdd=function(){Ye(this.button,"mouseover",this._show,this),Ye(this.panel,"mouseleave",this._hide,this),Ye(this.getMap(),"click",this._hide,this)},n.onRemove=function(){this.panel&&(Je(this.button,"mouseover",this._show,this),Je(this.panel,"mouseleave",this._hide,this),Je(this.getMap(),"click",this._hide,this),Ae(this.panel),Ae(this.button),delete this.panel,delete this.button,delete this.container)},n._show=function(){Ue(this.container,"shown")||(ze(this.container,"shown"),this._createPanel())},n._hide=function(t){this.panel.contains(t.toElement||t.relatedTarget)||Ge(this.container,this.options.containerClass)},n._createPanel=function(){this.panel.innerHTML="";var t=Te("ul");this.panel.appendChild(t),this._renderLayers(this.getMap(),t)},n._renderLayers=function(t,e){var n=t.getBaseLayer(),r=t.getLayers(),i=r.length;if(n){var o=n.layers||[n],a=Te("li","group"),s=Te("ul"),u=Te("label");u.innerHTML=this.options.baseTitle,a.appendChild(u);for(var c=0,l=o.length;c<l;c++){var h=o[c];this._isExcluded(h)&&(s.appendChild(this._renderLayer(o[c],!0)),a.appendChild(s),e.appendChild(a))}}if(i){var f=Te("li","group"),d=Te("ul"),p=Te("label");p.innerHTML=this.options.overlayTitle,f.appendChild(p);for(var v=0;v<i;v++){var g=r[v];this._isExcluded(g)&&d.appendChild(this._renderLayer(g))}f.appendChild(d),e.appendChild(f)}},n._isExcluded=function(t){var e=t.getId(),n=this.options.excludeLayers;return!(n.length&&n.indexOf(e)>=0)},n._renderLayer=function(t,e){var n=this,r=Te("li","layer"),i=Te("label"),o=Te("input"),a=this.getMap(),s=t.options.visible;t.options.visible=!0;var u=t.isVisible();return t.options.visible=s,r.className="layer",e?(o.type="radio",o.name="base"):o.type="checkbox",o.checked=s&&u,u||o.setAttribute("disabled","disabled"),o.onchange=function(e){if("radio"===e.target.type){var r=a.getBaseLayer(),i=r.layers;if(i)for(var o=0,s=i.length;o<s;o++){var u=i[o];u[u===t?"show":"hide"]()}else r.isVisible()||r.show();a._fireEvent("setbaselayer")}else t[e.target.checked?"show":"hide"]();n.fire("layerchange",{target:t})},r.appendChild(o),i.innerHTML=t.getId(),r.appendChild(i),r},e}(eo);io.mergeOptions({position:"top-right",baseTitle:"Base Layers",overlayTitle:"Layers",excludeLayers:[],containerClass:"maptalks-layer-switcher"}),Jn.mergeOptions({layerSwitcherControl:!1}),Jn.addOnLoadHook(function(){this.options.layerSwitcherControl&&(this.layerSwitcherControl=new io(this.options.layerSwitcherControl),this.addControl(this.layerSwitcherControl))});var oo=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.buildOn=function(){var t=this.options.size;this.options.maximize||(t=[0,0]);var e=Te("div"),n=this.mapContainer=Te("div");n.style.width=t[0]+"px",n.style.height=t[1]+"px",n.className=this.options.containerClass;var r=this.button=Te("div");return r.className=this.options.buttonClass,e.appendChild(n),e.appendChild(r),e},n.onAdd=function(){this.options.maximize&&this._createOverview(),this.getMap().on("resize moving zooming rotate dragrotating viewchange",this._update,this).on("setbaselayer",this._updateBaseLayer,this).on("spatialreferencechange",this._updateSpatialReference,this),Ye(this.button,"click",this._onButtonClick,this),this._updateButtonText()},n.onRemove=function(){this.getMap().off("resize moving zooming rotate dragrotating viewchange",this._update,this).off("setbaselayer",this._updateBaseLayer,this).off("spatialreferencechange",this._updateSpatialReference,this),this._overview&&(this._overview.remove(),delete this._overview,delete this._perspective),Je(this.button,"click",this._onButtonClick,this)},n.maxmize=function(){var t=this.options.size,e=this.mapContainer;return e.style.width=t[0]+"px",e.style.height=t[1]+"px",this._createOverview(),this},n.minimize=function(){this._overview&&this._overview.remove(),delete this._overview,delete this._perspective;var t=this.mapContainer;return t.style.width="0px",t.style.height="0px",this},n.getOverviewMap=function(){return this._overview},n._onButtonClick=function(){this._overview?this.minimize():this.maxmize(),this._updateButtonText()},n._updateButtonText=function(){this._overview?this.button.innerHTML="-":this.button.innerHTML="+"},n._createOverview=function(){var t=this.getMap(),e=this.mapContainer,n=t.config();h(n,{center:t.getCenter(),zoom:this._getOverviewZoom(),zoomAnimationDuration:150,pitch:0,bearing:0,scrollWheelZoom:!1,checkSize:!1,doubleClickZoom:!1,touchZoom:!1,control:!1,draggable:!1,maxExtent:null}),this._overview=new Jn(e,n),this._updateBaseLayer(),this._perspective=new jr(this._getPerspectiveCoords(),{draggable:!0,cursor:"move",symbol:this.options.symbol}).on("dragend",this._onDragEnd,this),new hi("perspective_layer",this._perspective).addTo(this._overview),this.fire("load")},n._getOverviewZoom=function(){var t=this.getMap(),e=t.getZoom(),n=t.getMinZoom(),r=this.options.level;if(r>0){for(var i=r;i>0;i--)if(e-i>=n)return e-i}else for(var o=r;o<0;o++)if(e-o>=n)return e-o;return e},n._onDragEnd=function(){var t=this._perspective.getCenter();this._overview.setCenter(t),this.getMap().panTo(t)},n._getPerspectiveCoords=function(){var t=this.getMap();return t.getContainerExtent().toArray().map(function(e){return t.containerPointToCoordinate(e)})},n._update=function(){if(this._overview){Fe(this._overview._containerDOM);var t=this._getPerspectiveCoords();this._perspective.setCoordinates(t),this._overview.setCenterAndZoom(this.getMap().getCenter(),this._getOverviewZoom())}},n._updateSpatialReference=function(){if(this._overview){var t=this.getMap().options.spatialReference;this._overview.setSpatialReference(t)}},n._updateBaseLayer=function(){if(this._overview){var t=this.getMap().getBaseLayer();if(t){var e=t.layers,n=0;if(e)for(var r=0,i=e.length;r<i;r++){if(e[r].isVisible()){n=r;break}}var o=t.toJSON(),a=null;e?(a=o.layers[n].options).visible=!0:a=o.options,this._overview.setMinZoom(a.minZoom||null).setMaxZoom(a.maxZoom||null),delete a.minZoom,delete a.maxZoom,delete o.options.canvas,o.options.visible=!0,o.options.renderer="canvas";var s=Wn.fromJSON(o);for(var u in t)y(t[u])&&t.hasOwnProperty(u)&&t[u]!==t.constructor.prototype[u]&&(s[u]=t[u]);this._overview.setBaseLayer(s)}else this._overview.setBaseLayer(null)}},e}(eo);oo.mergeOptions({level:4,position:{right:1,bottom:1},size:[300,200],maximize:!0,symbol:{lineWidth:3,lineColor:"#1bbc9b",polygonFill:"#1bbc9b",polygonOpacity:.4},containerClass:"maptalks-overview",buttonClass:"maptalks-overview-button"}),Jn.mergeOptions({overviewControl:!1}),Jn.addOnLoadHook(function(){this.options.overviewControl&&(this.overviewControl=new oo(this.options.overviewControl),this.addControl(this.overviewControl))});var ao=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.buildOn=function(){var t;if(this.options.custom)g(this.options.content)?(t=Te("div")).innerHTML=this.options.content:t=this.options.content;else{if(t=Te("div","maptalks-panel"),this.options.closeButton){var e=Te("a","maptalks-close");e.href="javascript:;",e.onclick=function(){t.style.display="none"},t.appendChild(e)}var n=Te("div","maptalks-panel-content");n.innerHTML=this.options.content,t.appendChild(n)}return this.draggable=new fn(t,{cancelOn:this._cancelOn.bind(this),ignoreMouseleave:!0}),this.draggable.on("dragstart",this._onDragStart,this).on("dragging",this._onDragging,this).on("dragend",this._onDragEnd,this),this.options.draggable&&this.draggable.enable(),t},n.update=function(){return this.draggable&&(this.draggable.disable(),delete this.draggable),eo.prototype.update.call(this)},n.setContent=function(t){var e=this.options.content;return this.options.content=t,this.fire("contentchange",{old:e,new:t}),this.isVisible()&&this.update(),this},n.getContent=function(){return this.options.content},n._cancelOn=function(t){var e=(t.srcElement||t.target).tagName.toLowerCase();return"button"===e||"input"===e||"select"===e||"option"===e||"textarea"===e},n._onDragStart=function(t){this._startPos=t.mousePos,this._startPosition=h({},this.getPosition()),this.fire("dragstart",t)},n._onDragging=function(t){var e=t.mousePos.sub(this._startPos),n=this._startPosition,r=this.getPosition();f(r.top)||(r.top=parseInt(n.top)+e.y),f(r.bottom)||(r.bottom=parseInt(n.bottom)-e.y),f(r.left)||(r.left=parseInt(n.left)+e.x),f(r.right)||(r.right=parseInt(n.right)-e.x),this.setPosition(r),this.fire("dragging",t)},n._onDragEnd=function(t){delete this._startPos,delete this._startPosition,this.fire("dragend",t)},n._getConnectPoints=function(){var t=this.getMap(),e=this.getContainerPoint(),n=this.getDOM(),r=parseInt(n.clientWidth),i=parseInt(n.clientHeight);return[t.containerPointToCoordinate(e.add(r/2,0)),t.containerPointToCoordinate(e.add(r,i/2)),t.containerPointToCoordinate(e.add(r/2,i)),t.containerPointToCoordinate(e.add(0,i/2))]},e}(eo);ao.mergeOptions({position:"top-right",draggable:!0,custom:!1,content:"",closeButton:!0});var so=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.buildOn=function(t){return this._map=t,this._scaleContainer=Te("div",this.options.containerClass),this._addScales(),t.on("zoomend",this._update,this),this._map._loaded&&this._update(),this._scaleContainer},n.onRemove=function(){this.getMap().off("zoomend",this._update,this)},n._addScales=function(){var t="border: 2px solid #000000;border-top: none;line-height: 1.1;padding: 2px 5px 1px;color: #000000;font-size: 11px;text-align:center;white-space: nowrap;overflow: hidden;-moz-box-sizing: content-box;box-sizing: content-box;background: #fff; background: rgba(255, 255, 255, 0);";this.options.metric&&(this._mScale=Ce("div",this.options.containerClass?null:t,this._scaleContainer)),this.options.imperial&&(this._iScale=Ce("div",this.options.containerClass?null:t,this._scaleContainer))},n._update=function(){var t=this._map.pixelToDistance(this.options.maxWidth,0);this._updateScales(t)},n._updateScales=function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},n._updateMetric=function(t){var e=this._getRoundNum(t),n=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,n,e/t)},n._updateImperial=function(t){var e,n,r,i=3.2808399*t;i>5280?(e=i/5280,n=this._getRoundNum(e),this._updateScale(this._iScale,n+" mile",n/e)):(r=this._getRoundNum(i),this._updateScale(this._iScale,r+" feet",r/i))},n._updateScale=function(t,e,n){t.style.width=Math.round(this.options.maxWidth*n)+"px",t.innerHTML=e},n._getRoundNum=function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return e*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)},e}(eo);so.mergeOptions({position:"bottom-left",maxWidth:100,metric:!0,imperial:!1,containerClass:null}),Jn.mergeOptions({scaleControl:!1}),Jn.addOnLoadHook(function(){this.options.scaleControl&&(this.scaleControl=new so(this.options.scaleControl),this.addControl(this.scaleControl))});var uo=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.buildOn=function(t){this._map=t;var e=Te("div"),n=Te("ul","maptalks-toolbar-hx");e.appendChild(n),this.options.vertical?ze(e,"maptalks-toolbar-vertical"):ze(e,"maptalks-toolbar-horizonal");var r=this;function i(t,e,n,i){var o=r._getItems()[e];return function(r){return Le(r),t({target:o,index:e,childIndex:n,dom:i})}}var o=this.options.items;if(U(o))for(var a=0,s=o.length;a<s;a++){var u=o[a],c=Te("li");if(28!==this.options.height&&(c.style.lineHeight=this.options.height+"px"),c.style.height=this.options.height+"px",c.style.cursor="pointer",Ze(u.item)){c.style.textAlign="center";var l=He("div",u.item);c.innerHTML='<div style="margin-top:'+(this.options.height-l.height)/2+'px;">'+u.item+"</div>"}else c.innerHTML=u.item;if(u.click&&Ye(c,"click",i(u.click,a,null,c)),U(u.children)){var h=this._createDropMenu(a);c.appendChild(h),c._menu=h,Ye(c,"mouseover",function(){this._menu.style.display=""}),Ye(c,"mouseout",function(){this._menu.style.display="none"})}n.appendChild(c)}return e},n._createDropMenu=function(t){var e=this;function n(t,n,r){var i=e._getItems()[n].children[r];return function(e){return Le(e),t({target:i,index:n,childIndex:r})}}var r=Te("div","maptalks-dropMenu"),i=this._getItems(),o=i.length,a=Te("ul"),s=i[t].children;t===o-1&&s&&(r.style.cssText="right: 0px;",a.style.cssText="right: 0px;position: absolute;",this.options.reverseMenu&&(a.style.bottom=0)),r.appendChild(Te("em","maptalks-ico"));for(var u=0,c=0,l=s.length;c<l;c++){var h=pe(s[c].item,"12px");h.width>u&&(u=h.width)}for(var f=0,d=s.length;f<d;f++){var p=s[f],v=Te("li");v.innerHTML='<a href="javascript:;">'+p.item+"</a>",v.style.cursor="pointer",v.style.width=u+24+"px",Ye(v.childNodes[0],"click",n(p.click,t,f)),a.appendChild(v)}if(this.options.vertical){var g=u<95?95:u;this.options.reverseMenu?r.style.right=-(g+20)+"px":r.style.left=-(g+20)+"px"}else this.options.reverseMenu?r.style.bottom="28px":r.style.top="28px";return r.appendChild(a),r.style.display="none",r},n._getItems=function(){return this.options.items||[]},e}(eo);uo.mergeOptions({height:28,vertical:!1,position:"top-right",reverseMenu:!1,items:{}});var co=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.buildOn=function(t){var e=this.options,n=Te("div","maptalks-zoom");if(e.zoomLevel){var r=Te("span","maptalks-zoom-zoomlevel");n.appendChild(r),this._levelDOM=r}var i=Te("div","maptalks-zoom-slider"),o=Te("a","maptalks-zoom-zoomin");if(o.href="javascript:;",o.innerHTML="+",i.appendChild(o),this._zoomInButton=o,e.slider){var a=Te("div","maptalks-zoom-slider-box"),s=Te("div","maptalks-zoom-slider-ruler"),u=Te("span","maptalks-zoom-slider-reading"),c=Te("span","maptalks-zoom-slider-dot");s.appendChild(u),a.appendChild(s),a.appendChild(c),i.appendChild(a),this._sliderBox=a,this._sliderRuler=s,this._sliderReading=u,this._sliderDot=c}var l=Te("a","maptalks-zoom-zoomout");return l.href="javascript:;",l.innerHTML="-",i.appendChild(l),this._zoomOutButton=l,n.appendChild(i),t.on("_zoomend _zoomstart _spatialreferencechange",this._update,this),this._update(),this._registerDomEvents(),n},n.onRemove=function(){this.getMap().off("_zoomend _zoomstart _spatialreferencechange",this._update,this),this._zoomInButton&&Je(this._zoomInButton,"click",this._onZoomInClick,this),this._zoomOutButton&&Je(this._zoomOutButton,"click",this._onZoomOutClick,this),this._sliderRuler&&(Je(this._sliderRuler,"click",this._onClickRuler,this),this.dotDragger.disable(),delete this.dotDragger)},n._update=function(){var t=this.getMap();if(this._sliderBox){var e=10*(t.getMaxZoom()-t.getMinZoom());this._sliderBox.style.height=e+16+"px",this._sliderRuler.style.height=e+8+"px",this._sliderRuler.style.cursor="pointer";var n=10*(t.getMaxZoom()-t.getZoom());this._sliderReading.style.height=10*(t.getZoom()-t.getMinZoom()+1)+"px",this._sliderDot.style.top=n+"px"}this._updateText()},n._updateText=function(){if(this._levelDOM){var t=this.getMap().getZoom();p(t)||(t=t.toFixed(1)),this._levelDOM.innerHTML=t}},n._registerDomEvents=function(){this._zoomInButton&&Ye(this._zoomInButton,"click",this._onZoomInClick,this),this._zoomOutButton&&Ye(this._zoomOutButton,"click",this._onZoomOutClick,this),this._sliderRuler&&(Ye(this._sliderRuler,"click",this._onClickRuler,this),this.dotDragger=new fn(this._sliderDot,{ignoreMouseleave:!0}),this.dotDragger.on("dragstart",this._onDotDragstart,this).on("dragging dragend",this._onDotDrag,this).enable())},n._onZoomInClick=function(t){Re(t),this.getMap().zoomIn()},n._onZoomOutClick=function(t){Re(t),this.getMap().zoomOut()},n._onClickRuler=function(t){Re(t);var e=this.getMap(),n=Ne(t,this._sliderRuler).y,r=e.getMaxZoom(),i=Math.floor(r-n/10);e.setZoom(i)},n._onDotDragstart=function(t){Re(t.domEvent);var e=this.getMap(),n=e.getSize().toPoint()._multi(.5);e.onZoomStart(e.getZoom(),n)},n._onDotDrag=function(t){Re(t.domEvent);var e=this.getMap(),n=e.getSize().toPoint()._multi(.5),r=Ne(t.domEvent,this._sliderRuler),i=e.getMaxZoom(),o=e.getMinZoom(),a=r.y,s=i-a/10;i<s?(s=i,a=0):o>s&&(s=o,a=10*(i-o)),"dragging"===t.type?e.onZooming(s,n,1):"dragend"===t.type&&(this.options.seamless?e.onZoomEnd(s,n):e.onZoomEnd(Math.round(s),n)),this._sliderDot.style.top=a+"px",this._sliderReading.style.height=10*(e.getZoom()-o+1)+"px",this._updateText()},e}(eo);co.mergeOptions({position:"top-left",slider:!0,zoomLevel:!0,seamless:!1}),Jn.mergeOptions({zoomControl:!1}),Jn.addOnLoadHook(function(){this.options.zoomControl&&(this.zoomControl=new co(this.options.zoomControl),this.addControl(this.zoomControl))});var lo=function(){function t(t,e,n,r){Array.isArray(t)?(this.scale={x:t[0],y:t[1]},this.origin={x:t[2],y:t[3]}):(this.scale={x:t,y:e},this.origin={x:n,y:r})}return t.getDefault=function(t){return"baidu"===t.code.toLowerCase()?"baidu":t.code.toLowerCase()==="EPSG:4326".toLowerCase()?"tms-global-geodetic":"identity"===t.code.toLowerCase()?[1,-1,0,0]:"web-mercator"},t}(),ho=6378137*Math.PI;h(lo,{"web-mercator":new lo([1,-1,-ho,ho]),"tms-global-mercator":new lo([1,1,-ho,-ho]),"tms-global-geodetic":new lo([1,1,-180,-90]),baidu:new lo([1,1,0,0])});var fo=function(){function t(t,e,n){this.tileSize=n,this.fullExtent=e,this.prepareTileInfo(t,e)}var e=t.prototype;return e.prepareTileInfo=function(t,e){if(g(t)?t=lo[t.toLowerCase()]:Array.isArray(t)&&(t=new lo(t)),!t)throw new Error("Invalid TileSystem");this.tileSystem=t;var n=e.right>e.left?1:-1,r=e.top>e.bottom?-1:1,i=t.origin.x,o=t.origin.y;this.transformation=new mn([n,r,i,o])},e._getTileNum=function(t,e){var n=this.tileSystem,r=this.tileSize,i=Math.floor(1e-7+t.x/(r.width*e)),o=-Math.floor(1e-7+t.y/(r.height*e));return{x:n.scale.x*i,y:n.scale.y*o}},e.getTileIndex=function(t,e){var n=this.tileSystem,r=this.transformation.transform(t,1),i=this._getTileNum(r,e);return n.scale.x<0&&(i.x-=1),n.scale.y>0&&(i.y-=1),this.getNeighorTileIndex(i.x,i.y,0,0,e)},e.getNeighorTileIndex=function(t,e,n,r,i,o){var a=this.tileSystem,s=t+a.scale.x*n,u=e-a.scale.y*r,c=!1,l=s,h=u,f=this._getTileFullIndex(i);return o?(f.xmax===f.xmin?s=f.xmin:s<f.xmin?(s=f.xmax-(f.xmin-s)%(f.xmax-f.xmin))===f.xmax&&(s=f.xmin):s>=f.xmax&&(s=f.xmin+(s-f.xmin)%(f.xmax-f.xmin)),f.ymax===f.ymin?u=f.ymin:u>=f.ymax?u=f.ymin+(u-f.ymin)%(f.ymax-f.ymin):u<f.ymin&&(u=f.ymax-(f.ymin-u)%(f.ymax-f.ymin))===f.ymax&&(u=f.ymin)):(s<f.xmin||s>f.xmax||u>f.ymax||u<f.ymin)&&(c=!0),{x:s,y:u,idx:l,idy:h,out:c}},e._getTileFullIndex=function(t){var e=this.fullExtent,n=this.transformation,r=this._getTileNum(n.transform(new dn(e.left,e.top),1),t),i=this._getTileNum(n.transform(new dn(e.right,e.bottom),1),t);return new gn(r,i)},e.getTilePrjNW=function(t,e,n){var r=this.tileSystem,i=this.tileSize,o=r.origin.y+r.scale.y*(e+(1===r.scale.y?1:0))*(n*i.height),a=r.scale.x*(t+(1===r.scale.x?0:1))*n*i.width+r.origin.x;return new dn(a,o)},e.getTilePrjSE=function(t,e,n){var r=this.tileSystem,i=this.tileSize,o=r.origin.y+r.scale.y*(e+(1===r.scale.y?0:1))*(n*i.height),a=r.scale.x*(t+(1===r.scale.x?1:0))*n*i.width+r.origin.x;return new dn(a,o)},e.getTilePrjExtent=function(t,e,n){var r=this.getTilePrjNW(t,e,n),i=this.getTilePrjSE(t,e,n);return new gn(r,i)},t}(),po={urlTemplate:null,subdomains:null,repeatWorld:!0,background:!0,backgroundZoomDiff:6,loadingLimitOnInteracting:3,placeholder:!1,crossOrigin:null,tileSize:[256,256],offset:[0,0],tileSystem:null,fadeAnimation:!P,debug:!1,spatialReference:null,maxCacheSize:256,renderer:ee.webgl?"gl":"canvas",clipByPitch:!0,maxAvailableZoom:null,cascadeTiles:!0,minPitchToCascade:35,zoomOffset:0},vo=/\{ *([\w_]+) *\}/g,go=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t),e.fromJSON=function(t){return t&&"TileLayer"===t.type?new e(t.id,t.options):null};var n=e.prototype;return n.getTileSize=function(){var t=this.options.tileSize;return d(t)&&(t=[t,t]),new ae(t)},n.getTiles=function(t){var e=this.getMap(),n=e.getContainerExtent(),r=[],i=0,o=this.getMinZoom(),a=this.options.minPitchToCascade,s=f(t)?this._getTileZoom(e.getZoom()):t;if(!f(t)||!this.options.cascadeTiles||e.getPitch()<=a||!f(o)&&s<=o){var u=this._getTiles(s,n);return u&&(i+=u.tiles.length,r.push(u)),{tileGrids:r,count:i}}var c=Math.floor(e._getVisualHeight(a)),l=new yn(0,e.height-c,e.width,e.height),h=this._getTiles(s,l,0);i+=h?h.tiles.length:0;var d=new yn(0,n.ymin,e.width,l.ymin),p=e.getSpatialReference().getZoomDirection(),v=this._getTiles(s-p,d,1);return i+=v?v.tiles.length:0,r.push(h,v),{tileGrids:r,count:i}},n.getTileUrl=function(t,e,n){var r=this.options.urlTemplate,i="";if(this.options.subdomains){var o=this.options.subdomains;if(U(o)){var a=(t+e)%o.length;a<0&&(a=0),i=o[a]}}if(y(r))return r(t,e,n,i);var s={x:t,y:e,z:n,s:i};return r.replace(vo,function(t,e){var n=s[e];if(void 0===n)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(s)),n})},n.clear=function(){return this._renderer&&this._renderer.clear(),this.fire("clear"),this},n.toJSON=function(){return{type:this.getJSONType(),id:this.getId(),options:this.config()}},n.getSpatialReference=function(){var t=this.getMap();return!t||this.options.spatialReference&&!Xn.equals(this.options.spatialReference,t.options.spatialReference)?(this._sr=this._sr||new Xn(this.options.spatialReference),this._sr):t.getSpatialReference()},n._getTileZoom=function(t){var e=this.getMap();p(t)||(t=e.isZooming()?t>e._frameZoom?Math.floor(t):Math.ceil(t):Math.round(t));var n=this.options.maxAvailableZoom;return!f(n)&&t>n&&(t=n),t},n._getTiles=function(t,e,n){var r=this.getMap(),i=t+this.options.zoomOffset,o=this._getTileOffset(i),a=o[0]||o[1],s={zoom:t,extent:null,offset:o,tiles:[]};if(i<0)return s;var u=this.getMinZoom(),c=this.getMaxZoom();if(!(r&&this.isVisible()&&r.width&&r.height))return s;if(!f(u)&&t<u||!f(c)&&t>c)return s;var l=this._getTileConfig();if(!l)return s;var h=this.getSpatialReference(),d=r.getSpatialReference(),p=h.getResolution(i),v=e.convertTo(function(t){return r._containerPointToPoint(t)}),g=this._getInnerExtent(t,e,v)._add(o);v._add(o);var y=this._getMask2DExtent();if(y){var m=y.intersection(v);if(!m)return s;e=m.convertTo(function(t){return r._pointToContainerPoint(t)})}var _,b=r._containerPointToPrj(e.getCenter());_=a?this._project(r._pointToPrj(r._prjToPoint(b)._add(o))):this._project(b);for(var w=this._project(r._pointToPrj(v.getMin())),x=this._project(r._pointToPrj(v.getMax())),E=l.getTileIndex(_,p),O=l.getTileIndex(w,p),P=l.getTileIndex(x,p),S=Math.ceil(Math.abs(E.y-O.y)),T=Math.ceil(Math.abs(E.x-O.x)),C=Math.ceil(Math.abs(E.y-P.y)),A=Math.ceil(Math.abs(E.x-P.x)),M=this.getId(),k=this.getRenderer(),j=this.getTileSize(),R=this._getTileConfig().tileSystem.scale,L=[],I=new yn,D=-T;D<=A;D++)for(var F=-S;F<=C;F++){var N=l.getNeighorTileIndex(E.x,E.y,D,F,p,this.options.repeatWorld);if(!N.out){var B=l.getTilePrjNW(N.x,N.y,p),U=r._prjToPoint(this._unproject(B),t),z=void 0,G=void 0;if(h===d)z=j.width,G=j.height;else{var V=l.getTilePrjSE(N.x,N.y,p),W=r._prjToPoint(this._unproject(V),t);z=Math.abs(Math.round(W.x-U.x)),G=Math.abs(Math.round(W.y-U.y))}var Z=R.x*(N.idx-N.x)*z,H=-R.y*(N.idy-N.y)*G;(Z||H)&&U._add(Z,H),h!==d&&(z++,G++),a&&U._sub(o);var X=new yn(U,U.add(z,G)),Y={point:U,z:t,x:N.x,y:N.y,extent2d:X,mask:n};(g.intersects(X)||!g.equals(v.sub(o))&&this._isTileInExtent(Y,e))&&(a&&(Y.point._add(o),Y.extent2d._add(o)),Y.size=[z,G],Y.dupKey=U.round().toArray().join()+","+z+","+G+","+M,Y.id=this._getTileId(N,i),Y.layer=M,k&&k.isTileCachedOrLoading(Y.id)||(Y.url=this.getTileUrl(N.x,N.y,i)),L.push(Y),I._combine(X))}}var J=r._containerPointToPoint(e.getCenter(),t)._add(o);return L.sort(function(t,e){return t.point.distanceTo(J)-e.point.distanceTo(J)}),{offset:o,zoom:t,extent:I,tiles:L}},n._getInnerExtent=function(t,e,n){var r=this.getMap(),i=r.getResolution(t),o=r.getResolution()/i,a=n.getCenter()._multi(o),s=r.getBearing()*Math.PI/180,u=e.getHeight()/2*o,c=e.getWidth()/2*o,l=Math.abs(Math.cos(s)*u)||u,h=Math.abs(Math.sin(s)*u)||c;return new yn(a.sub(h,l),a.add(h,l))},n._getTileOffset=function(t){var e=this.getMap(),n=e._getResolution()/e._getResolution(t),r=this.options.offset;return y(r)&&(r=r(this)),r[0]*=n,r[1]*=n,r},n._getTileId=function(t,e,n){return[n||this.getId(),t.idy,t.idx,e].join("__")},n._project=function(t){var e=this.getMap(),n=this.getSpatialReference();return n!==e.getSpatialReference()?n.getProjection().project(e.getProjection().unproject(t)):t},n._unproject=function(t){var e=this.getMap(),n=this.getSpatialReference();return n!==e.getSpatialReference()?e.getProjection().project(n.getProjection().unproject(t)):t},n._initTileConfig=function(){var t=this.getMap(),e=this.getTileSize(),n=this.getSpatialReference(),r=n.getProjection(),i=n.getFullExtent();if(this._defaultTileConfig=new fo(lo.getDefault(r),i,e),this.options.tileSystem&&(this._tileConfig=new fo(this.options.tileSystem,i,e)),t&&!this._tileConfig&&t.getSpatialReference()===n&&t.getBaseLayer()&&t.getBaseLayer()!==this&&t.getBaseLayer()._getTileConfig){var o=t.getBaseLayer()._getTileConfig();this._tileConfig=new fo(o.tileSystem,o.fullExtent,e)}},n._getTileConfig=function(){return this._defaultTileConfig||this._initTileConfig(),this._tileConfig||this._defaultTileConfig},n._bindMap=function(e){var n=e.getBaseLayer();return n===this&&(n.options.hasOwnProperty("forceRenderOnMoving")||this.config({forceRenderOnMoving:!0})),t.prototype._bindMap.apply(this,arguments)},n._isTileInExtent=function(t,e){var n=this.getMap();if(!n)return!1;var r=t.z,i=t.extent2d.convertTo(function(t){return n._pointToContainerPoint(t,r)});return!(i.getWidth()<5||i.getHeight()<5)&&e.intersects(i)},n.getEvents=function(){return{spatialreferencechange:this._onSpatialReferenceChange}},n._onSpatialReferenceChange=function(){delete this._tileConfig,delete this._defaultTileConfig,delete this._sr},e}(Wn);go.registerJSONType("TileLayer"),go.mergeOptions(po),function(t){function e(e,n,r){var i;return(i=t.call(this,e,r)||this).layers=n||[],i._checkChildren(),i.layerMap={},i._groupChildren=[],i}ne(e,t),e.fromJSON=function(t){if(!t||"GroupTileLayer"!==t.type)return null;var n=t.layers.map(function(t){return Wn.fromJSON(t)});return new e(t.id,n,t.options)};var n=e.prototype;return n.getLayers=function(){return this.layers},n.toJSON=function(){return{type:this.getJSONType(),id:this.getId(),layers:this.layers.map(function(t){return t.toJSON()}),options:this.config()}},n.getTiles=function(t){for(var e=this.layers,n=[],r=0,i=0,o=e.length;i<o;i++){var a=e[i];if(a.options.visible){var s=a.getTiles(t);s&&0!==s.count&&(r+=s.count,k(n,s.tileGrids))}}return{count:r,tileGrids:n}},n.onAdd=function(){var e=this,n=this.getMap();this.layers.forEach(function(t){e.layerMap[t.getId()]=t,t.getChildLayer&&e._groupChildren.push(t),t._bindMap(n),t.on("show hide",e._onLayerShowHide,e)}),t.prototype.onAdd.call(this)},n.onRemove=function(){var e=this;this.layers.forEach(function(t){t._doRemove(),t.off("show hide",e._onLayerShowHide,e)}),this.layerMap={},this._groupChildren=[],t.prototype.onRemove.call(this)},n.getChildLayer=function(t){var e=this.layerMap[t];if(e)return e;for(var n=0;n<this._groupChildren.length;n++){var r=this._groupChildren[n].getChildLayer(t);if(r)return r}return null},n._onLayerShowHide=function(){var t=this.getRenderer();t&&t.setToRedraw()},n.isVisible=function(){if(!t.prototype.isVisible.call(this))return!1;for(var e=this.layers,n=0,r=e.length;n<r;n++)if(e[n].isVisible())return!0;return!1},n._checkChildren=function(){var t=this,e={};this.layers.forEach(function(n){var r=n.getId();if(e[r])throw new Error("Duplicate child layer id ("+r+") in the GroupTileLayer ("+t.getId()+")");e[r]=1})},e}(go).registerJSONType("GroupTileLayer");var yo={service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},mo=function(t){function e(e,n){var r;r=t.call(this,e)||this;var i=h({},yo);for(var o in n)o in r.options||(i[o]=n[o]);r.setOptions(n),r.setZIndex(n.zIndex);var a=n.detectRetina&&ee.retina?2:1,s=r.getTileSize();return i.width=s.width*a,i.height=s.height*a,r.wmsParams=i,r._wmsVersion=parseFloat(i.version),r}ne(e,t);var n=e.prototype;return n.onAdd=function(){var e=this.options.crs||this.getMap().getProjection().code,n=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[n]=e,t.prototype.onAdd.call(this)},n.getTileUrl=function(e,n,r){var i=this.getSpatialReference().getResolution(r),o=this._getTileConfig().getTilePrjExtent(e,n,i),a=o.getMax(),s=o.getMin(),u=(this._wmsVersion>=1.3&&"EPSG:4326"===this.wmsParams.crs?[s.y,s.x,a.y,a.x]:[s.x,s.y,a.x,a.y]).join(","),c=t.prototype.getTileUrl.call(this,e,n,r);return c+function(t,e,n){var r=[];for(var i in t)r.push(encodeURIComponent(n?i.toUpperCase():i)+"="+encodeURIComponent(t[i]));return(e&&-1!==e.indexOf("?")?"&":"?")+r.join("&")}(this.wmsParams,c,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+u},n.toJSON=function(){return{type:"WMSTileLayer",id:this.getId(),options:this.config()}},e.fromJSON=function(t){return t&&"WMSTileLayer"===t.type?new e(t.id,t.options):null},e}(go);mo.registerJSONType("WMSTileLayer"),mo.mergeOptions({crs:null,uppercase:!1,detectRetina:!1});var _o=function(t){function e(e,n){var r;return(r=t.call(this,e,n)||this).options.hasOwnProperty("forceRenderOnMoving")||(r.options.forceRenderOnMoving=!1),r}ne(e,t);var n=e.prototype;return n.drawTile=function(){},n.toJSON=function(){return{type:"CanvasTileLayer",id:this.getId(),options:this.config()}},e.fromJSON=function(t){return t&&"CanvasTileLayer"===t.type?new e(t.id,t.options):null},e}(go);function bo(t,e,n){var r=t.createShader(e);if(t.shaderSource(r,n),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){var i=t.getShaderInfoLog(r);throw t.deleteShader(r),new Error("Failed to compile shader: "+i)}return r}_o.registerJSONType("CanvasTileLayer");var wo="\n        attribute vec3 a_position;\n\n        attribute vec2 a_texCoord;\n\n        uniform mat4 u_matrix;\n\n        varying vec2 v_texCoord;\n\n        void main() {\n            gl_Position = u_matrix * vec4(a_position, 1.0);\n\n            v_texCoord = a_texCoord;\n        }\n    ",xo="\n        precision mediump float;\n\n        uniform sampler2D u_image;\n\n        uniform float u_opacity;\n\n        varying vec2 v_texCoord;\n\n        void main() {\n\n            gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\n\n        }\n    ",Eo=[0,0],Oo=[0,0,0],Po=new Array(16),So=function(t){var e,n=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.drawGLImage=function(t,e,n,r,i,o){var a=this.gl;this.loadTexture(t),Oo[0]=e||0,Oo[1]=n||0;var s=xi(Po);mi(s,s,Oo),bi(s,this.getMap().projViewMatrix,s),a.uniformMatrix4fv(this.program.u_matrix,!1,s),a.uniform1f(this.program.u_opacity,o),t.glBuffer?a.bindBuffer(a.ARRAY_BUFFER,t.glBuffer):t.glBuffer=this.bufferTileData(0,0,r,i),Eo[0]="a_position",Eo[1]=3,this.enableVertexAttrib(Eo),a.drawArrays(a.TRIANGLE_STRIP,0,4)},n.bufferTileData=function(t,e,n,r,i){var o=t,a=t+n,s=e,u=e+r;return this.loadImageBuffer(this.set12(o,s,0,o,u,0,a,s,0,a,u,0),i)},n.drawTinImage=function(t,e,n,r,i){var o=this.gl;this.loadTexture(t),o.uniformMatrix4fv(this.program.u_matrix,!1,this.getMap().projViewMatrix),o.uniform1f(this.program.u_opacity,i),o.bindBuffer(o.ARRAY_BUFFER,this.posBuffer),this.enableVertexAttrib(["a_position",3]),o.bufferData(o.ARRAY_BUFFER,new Float32Array(e),o.DYNAMIC_DRAW),o.bindBuffer(o.ARRAY_BUFFER,this.texBuffer),this.enableVertexAttrib(["a_texCoord",2]),o.bufferData(o.ARRAY_BUFFER,new Float32Array(n),o.DYNAMIC_DRAW),o.bufferData(o.ELEMENT_ARRAY_BUFFER,new Uint16Array(r),o.DYNAMIC_DRAW),o.drawElements(o.TRIANGLES,r.length,o.UNSIGNED_SHORT,0)},n.createCanvas2=function(){this.canvas2=Ke.createCanvas(this.canvas.width,this.canvas.height)},n.createGLContext=function(){this.canvas.gl&&this.canvas.gl.wrap?this.gl=this.canvas.gl.wrap():this.gl=function(t,e){for(var n={alpha:!0,stencil:!0,preserveDrawingBuffer:!0,antialias:!1},r=["webgl","experimental-webgl"],i=null,o=0;o<r.length;++o){try{i=t.getContext(r[o],e||n)}catch(t){}if(i)break}return i}(this.canvas2||this.canvas,this.layer.options.glOptions);var t=this.gl;t.clearColor(0,0,0,0),t.disable(t.DEPTH_TEST),t.enable(t.STENCIL_TEST),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),this.program=this.createProgram(wo,this.layer.options.fragmentShader||xo,["u_matrix","u_image","u_opacity"]),this.useProgram(this.program),this.texBuffer=this.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.texBuffer),this.enableVertexAttrib(["a_texCoord",2]),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),t.STATIC_DRAW),this.enableSampler("u_image"),t.activeTexture(t.TEXTURE0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this.posBuffer=this.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.posBuffer),this.enableVertexAttrib(["a_position",3]),this.indicesBuffer=this.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)},n.resizeGLCanvas=function(){this.gl&&this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.canvas2&&(this.canvas2.width===this.canvas.width&&this.canvas2.height===this.canvas.height||(this.canvas2.width=this.canvas.width,this.canvas2.height=this.canvas.height))},n.clearGLCanvas=function(){this.gl&&this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT)},n.disposeImage=function(t){t&&(t.texture&&this.saveTexture(t.texture),t.glBuffer&&this.saveImageBuffer(t.glBuffer),delete t.texture,delete t.glBuffer)},n._createTexture=function(t){var e=this.gl,n=this.getTexture()||e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),p(D(t.width))&&p(D(t.width))&&e.generateMipmap(e.TEXTURE_2D),n},n.getTexture=function(){this._textures||(this._textures=[]);var t=this._textures;return t&&t.length>0?t.pop():null},n.saveTexture=function(t){this._textures.push(t)},n.loadTexture=function(t){var e=this.gl,n=t.texture;return n||(n=this._createTexture(t),t.texture=n),e.bindTexture(e.TEXTURE_2D,n),n},n.getImageBuffer=function(){this._imageBuffers||(this._imageBuffers=[]);var t=this._imageBuffers;return t&&t.length>0?t.pop():null},n.saveImageBuffer=function(t){this._imageBuffers.push(t)},n.loadImageBuffer=function(t,e){var n=this.gl,r=e||this.createImageBuffer();return n.bindBuffer(n.ARRAY_BUFFER,r),n.bufferData(n.ARRAY_BUFFER,t,n.STATIC_DRAW),r},n.createImageBuffer=function(){return this.getImageBuffer()||this.createBuffer()},n.removeGLCanvas=function(){var t=this.gl;if(t){this._buffers&&(this._buffers.forEach(function(e){t.deleteBuffer(e)}),delete this._buffers),this._textures&&(this._textures.forEach(function(e){return t.deleteTexture(e)}),delete this._textures),delete this.posBuffer;var e=t.program;t.deleteShader(e.fragmentShader),t.deleteShader(e.vertexShader),t.deleteProgram(e),delete this.gl,delete this.canvas2}},n.createBuffer=function(){var t=this.gl.createBuffer();if(!t)throw new Error("Failed to create the buffer object");return this._buffers||(this._buffers=[]),this._buffers.push(t),t},n.enableVertexAttrib=function(t){!function(t,e,n){if(Array.isArray(n[0])){for(var r=Float32Array.BYTES_PER_ELEMENT,i=0,o=0;o<n.length;o++)i+=n[o][1]||0;for(var a=0,s=0;s<n.length;s++){var u=t.getAttribLocation(e,n[s][0]);if(u<0)throw new Error("Failed to get the storage location of "+n[s][0]);t.vertexAttribPointer(u,n[s][1],t[n[s][2]||"FLOAT"],!1,r*i,r*a),a+=n[s][1]||0,t.enableVertexAttribArray(u)}}else{var c=t.getAttribLocation(e,n[0]);t.vertexAttribPointer(c,n[1],t[n[2]||"FLOAT"],!1,0,0),t.enableVertexAttribArray(c)}}(this.gl,this.gl.program,t)},n.createProgram=function(t,e,n){var r=function(t,e,n){var r=bo(t,t.VERTEX_SHADER,e),i=bo(t,t.FRAGMENT_SHADER,n);if(!r||!i)return null;var o=t.createProgram();return o?(t.attachShader(o,r),t.attachShader(o,i),t.linkProgram(o),{program:o,vertexShader:r,fragmentShader:i}):null}(this.gl,t,e),i=r.program,o=r.vertexShader,a=r.fragmentShader;return i.vertexShader=o,i.fragmentShader=a,this._initUniforms(i,n),i},n.useProgram=function(t){var e=this.gl;return e.useProgram(t),e.program=t,this},n.enableSampler=function(t,e){var n=this.gl,r=this._getUniform(n.program,t);return e||(e=0),n.uniform1i(r,e),r},n._initUniforms=function(t,e){for(var n=0;n<e.length;n++){var r=e[n],i=e[n],o=r.indexOf("[");o>=0&&(r=r.substring(0,o),P||(i=i.substring(0,o))),t[r]=this._getUniform(t,i)}},n._getUniform=function(t,e){var n=this.gl.getUniformLocation(t,e);if(!n)throw new Error("Failed to get the storage location of "+e);return n},e}(t);return h(n.prototype,{set12:(e=ee.ie9?null:new Float32Array(12),function(t,n,r,i,o,a,s,u,c,l,h,f){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e[8]=c,e[9]=l,e[10]=h,e[11]=f,e})}),n},To={renderer:ee.webgl?"gl":"canvas",crossOrigin:null},Co=function(t){function e(e,n,r){var i;return Array.isArray(n)||n.url||(r=n,n=null),(i=t.call(this,e,r)||this)._prepareImages(n),i}ne(e,t);var n=e.prototype;return n.setImages=function(t){return this._images=t,this._prepareImages(t),this},n.getImages=function(){return this._images},n._prepareImages=function(t){t=t||[],Array.isArray(t)||(t=[t]),this._imageData=t.map(function(t){return h({},t,{extent:new gn(t.extent)})}),this._images=t;var e=this.getRenderer();e&&e.refreshImages()},e}(Wn);Co.mergeOptions(To);var Ao=[],Mo=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.isDrawable=function(){return!this.getMap().getPitch()||(console&&console.warn("ImageLayer with canvas renderer can't be pitched, use gl renderer ('renderer' : 'gl') instead."),!1)},n.checkResources=function(){var t=this;if(this._imageLoaded)return Ao;var e=this.layer._imageData.map(function(t){return[t.url,null,null]});if(this.resources){var n=[],r=new Vn;e.forEach(function(e){if(t.resources.isResourceLoaded(e)){var i=t.resources.getImage(e);r.addResource(e,i)}else n.push(e)}),this.resources.forEach(function(e,n){r.isResourceLoaded(e)||t.retireImage(n.image)}),this.resources=r,e=n}return this._imageLoaded=!0,e},n.retireImage=function(){},n.refreshImages=function(){this._imageLoaded=!1,this.setToRedraw()},n.needToRedraw=function(){var e=this.getMap();return!(e.isZooming()&&!e.getPitch())&&t.prototype.needToRedraw.call(this)},n.draw=function(){this.isDrawable()&&(this.prepareCanvas(),this._painted=!1,this._drawImages(),this.completeRender())},n._drawImages=function(){var t=this.layer._imageData,e=this.getMap().getExtent();if(t&&t.length)for(var n=0;n<t.length;n++){var r=t[n].extent,i=this.resources&&this.resources.getImage(t[n].url);i&&e.intersects(r)&&(this._painted=!0,this._drawImage(i,r,t[n].opacity||1))}},n._drawImage=function(t,e,n){var r=0,i=this.context;n<1&&(r=i.globalAlpha,i.globalAlpha=n);var o=this.getMap(),a=o.coordToPoint(e.getMin()),s=o.coordToPoint(e.getMax()),u=o._pointToContainerPoint(a),c=u.x,l=u.y,h=o.getBearing();h&&(i.save(),i.translate(c,l),h&&i.rotate(-h*Math.PI/180),c=l=0),i.drawImage(t,c,l,s.x-a.x,s.y-a.y),h&&i.restore(),r&&(i.globalAlpha=r)},n.drawOnInteracting=function(){this.draw()},e}(Gn),ko=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.isDrawable=function(){return!0},n._drawImage=function(t,e,n){var r=this.getMap(),i=e.__imagelayerposition;i||(i=e.__imagelayerposition=e.convertTo(function(t){return r.coordToPoint(t,r.getGLZoom())})),this.drawGLImage(t,i.xmin,i.ymin,i.getWidth(),i.getHeight(),n)},n.createContext=function(){this.createGLContext()},n.resizeCanvas=function(e){this.canvas&&(t.prototype.resizeCanvas.call(this,e),this.resizeGLCanvas())},n.clearCanvas=function(){this.canvas&&(t.prototype.clearCanvas.call(this),this.clearGLCanvas())},n.retireImage=function(t){this.disposeImage(t)},n.onRemove=function(){this.removeGLCanvas(),t.prototype.onRemove.call(this)},e}(So(Mo));Co.registerRenderer("canvas",Mo),Co.registerRenderer("gl",ko);var jo=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.getPrepareParams=function(){return[]},n.getDrawParams=function(){return[]},n.onCanvasCreate=function(){this.canvas&&this.layer.options.doubleBuffer&&(this.buffer=Ke.createCanvas(this.canvas.width,this.canvas.height,this.getMap().CanvasClass))},n.needToRedraw=function(){return!!this.layer.options.animation||!(this.getMap().isInteracting()&&!this.layer.drawOnInteracting)&&t.prototype.needToRedraw.call(this)},n.draw=function(){this.prepareCanvas(),this.prepareDrawContext(),this._drawLayer()},n.drawOnInteracting=function(){this._drawLayerOnInteracting()},n.getCanvasImage=function(){var e=t.prototype.getCanvasImage.call(this);if(e&&e.image&&this.layer.options.doubleBuffer){var n=e.image;this.buffer.width===n.width&&this.buffer.height===n.height||(this.buffer.width=n.width,this.buffer.height=n.height);var r=this.buffer.getContext("2d"),i=this.layer.doubleBuffer(r,this.context);(void 0===i||i)&&(Ke.image(r,n,0,0),e.image=this.buffer)}return e},n.remove=function(){return delete this._drawContext,t.prototype.remove.call(this)},n.onZoomStart=function(e){this.layer.onZoomStart(e),t.prototype.onZoomStart.call(this,e)},n.onZooming=function(e){this.layer.onZooming(e),t.prototype.onZooming.call(this,e)},n.onZoomEnd=function(e){this.layer.onZoomEnd(e),t.prototype.onZoomEnd.call(this,e)},n.onMoveStart=function(e){this.layer.onMoveStart(e),t.prototype.onMoveStart.call(this,e)},n.onMoving=function(e){this.layer.onMoving(e),t.prototype.onMoving.call(this,e)},n.onMoveEnd=function(e){this.layer.onMoveEnd(e),t.prototype.onMoveEnd.call(this,e)},n.onResize=function(e){this.layer.onResize(e),t.prototype.onResize.call(this,e)},n.prepareDrawContext=function(){if(!this._predrawed){var t=Ro(this.getPrepareParams());this._drawContext=this.layer.prepareToDraw.apply(this.layer,[this.context].concat(t)),this._drawContext||(this._drawContext=[]),Array.isArray(this._drawContext)||(this._drawContext=[this._drawContext]),this._predrawed=!0}},n._prepareDrawParams=function(){if(!this.getMap())return null;var t=this.getViewExtent();if(t.maskExtent&&!t.extent.intersects(t.maskExtent))return this.completeRender(),null;var e=[this.context,t],n=Ro(this.getDrawParams());return e.push.apply(e,n),e.push.apply(e,this._drawContext),e},n._drawLayer=function(){var t=this._prepareDrawParams();t&&(this.layer.draw.apply(this.layer,t),this.completeRender())},n._drawLayerOnInteracting=function(){if(this.layer.drawOnInteracting){var t=this._prepareDrawParams();t&&(this.layer.drawOnInteracting.apply(this.layer,t),this.completeRender())}},e}(Gn);function Ro(t){return t||(t=[]),Array.isArray(t)||(t=[t]),t}var Lo=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.isCanvasRender=function(){return!0},n.prepareToDraw=function(){},n.draw=function(){},n.redraw=function(){return this._getRenderer()&&this._getRenderer().setToRedraw(),this},n.play=function(){return this.config("animation",!0),this},n.pause=function(){return this.config("animation",!1),this},n.isPlaying=function(){return this.options.animation},n.clearCanvas=function(){return this._getRenderer()&&this._getRenderer().clearCanvas(),this},n.requestMapToRender=function(){return this._getRenderer()&&this._getRenderer().requestMapToRender(),this},n.completeRender=function(){return this._getRenderer()&&this._getRenderer().completeRender(),this},n.onCanvasCreate=function(){return this},n.onZoomStart=function(){},n.onZooming=function(){},n.onZoomEnd=function(){},n.onMoveStart=function(){},n.onMoving=function(){},n.onMoveEnd=function(){},n.onResize=function(){},n.doubleBuffer=function(t){return t.clearRect(0,0,t.canvas.width,t.canvas.height),this},e}(Wn);Lo.mergeOptions({doubleBuffer:!1,animation:!1}),Lo.registerRenderer("canvas",jo);var Io=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.getParticles=function(){},n.draw=function(t,e){var n=this.getParticles(l());if(n&&0!==n.length){var r=this.getMap(),i=e.extent;e.maskExtent&&(i=e.extent.intersection(e.maskExtent)),i=i.convertTo(function(t){return r._pointToContainerPoint(t)});for(var o=2*Math.PI,a=0,s=n.length;a<s;a++){var u=n[a].point;if(i.contains(u)){var c=n[a].color||this.options.lineColor||"#fff",h=n[a].r;t.fillStyle!==c&&(t.fillStyle=c),h<=2?t.fillRect(u.x-h/2,u.y-h/2,h,h):(t.beginPath(),t.arc(u.x,u.y,h/2,0,o),t.fill())}}this._fillCanvas(t)}else{this._getRenderer()&&(this._getRenderer()._shouldClear=!0)}},n._fillCanvas=function(t){var e=t.globalCompositeOperation;t.globalCompositeOperation="destination-out";var n=this.options.trail||30;t.fillStyle="rgba(0, 0, 0, "+1/n+")",t.fillRect(0,0,t.canvas.width,t.canvas.height),t.globalCompositeOperation=e},e}(Lo);Io.mergeOptions({animation:!0}),Io.registerRenderer("canvas",function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.draw=function(){this.canvas&&this.layer.options.animation&&!this._shouldClear||(this.prepareCanvas(),this._shouldClear=!1),this.prepareDrawContext(),this._drawLayer()},n.drawOnInteracting=function(){this.draw(),this._shouldClear=!1},n.onSkipDrawOnInteracting=function(){this._shouldClear=!0},e}(jo));function Do(t,e){return{markerType:t,markerFill:"#fff",markerLineColor:"#000",markerLineWidth:2,markerWidth:10,markerHeight:10,opacity:e}}var Fo={fixAspectRatio:!1,symbol:null,removeVertexOn:"contextmenu",centerHandleSymbol:Do("ellipse",1),vertexHandleSymbol:Do("square",1),newVertexHandleSymbol:Do("square",.4)},No=function(t){function e(e,n){var r;return(r=t.call(this,n)||this)._geometry=e,r._geometry?r:re(r)}ne(e,t);var n=e.prototype;return n.getMap=function(){return this._geometry.getMap()},n.prepare=function(){this.getMap()&&(this.options.symbol&&(this._originalSymbol=this._geometry.getSymbol(),this._geometry.setSymbol(this.options.symbol)),this._prepareEditStageLayer())},n._prepareEditStageLayer=function(){var t=this.getMap(),e=A(),n="_maptalks__internal_layer__edit_stage_"+e,r="_maptalks__internal_layer__edit_stage_"+e+"_shadow";this._editStageLayer=t.getLayer(n),this._shadowLayer=t.getLayer(r),this._editStageLayer||(this._editStageLayer=new hi(n),t.addLayer(this._editStageLayer)),this._shadowLayer||(this._shadowLayer=new hi(r),t.addLayer(this._shadowLayer))},n.start=function(){var t=this;if(this._geometry&&this._geometry.getMap()&&!this._geometry.editing){var e=this.getMap();this.editing=!0;var n=this._geometry;this._geometryDraggble=n.options.draggable,n.config("draggable",!1),this.prepare();var r=n.copy();r.setSymbol(n._getInternalSymbol()),r.copyEventListeners(n),n._getParent()&&r.copyEventListeners(n._getParent()),r.setId(null).config({draggable:!1}),this._shadow=r,this._switchGeometryEvents("on"),n.hide(),(n instanceof Lr||n instanceof Hr||n instanceof Yr||n instanceof Xr)&&this._createOrRefreshOutline(),this._shadowLayer.bringToFront().addGeometry(r),this._editStageLayer.bringToFront(),this._addListener([e,"zoomstart",function(){t._editStageLayer.hide()}]),this._addListener([e,"zoomend",function(){t._editStageLayer.show()}]),n instanceof Lr?(r.config("draggable",!0),r.on("dragend",this._onMarkerDragEnd,this)):this._createCenterHandle(),n instanceof Lr?this.createMarkerEditor():n instanceof Hr?this.createCircleEditor():n instanceof Yr?this.createEllipseOrRectEditor():n instanceof Xr?this.createEllipseOrRectEditor():n instanceof Jr||(n instanceof jr||n instanceof Dr)&&this.createPolygonEditor()}},n.stop=function(){delete this._history,delete this._historyPointer,delete this._editOutline,this._switchGeometryEvents("off"),this.getMap()&&(delete this._shadow,this._geometry.config("draggable",this._geometryDraggble),delete this._geometryDraggble,this._geometry.show(),this._editStageLayer.remove(),this._shadowLayer.remove(),this._clearAllListeners(),this._refreshHooks=[],this.options.symbol&&(this._geometry.setSymbol(this._originalSymbol),delete this._originalSymbol),this.editing=!1)},n.isEditing=function(){return!f(this.editing)&&this.editing},n._getGeometryEvents=function(){return{symbolchange:this._onGeoSymbolChange,"positionchange shapechange":this._exeAndReset}},n._switchGeometryEvents=function(t){if(this._geometry){var e=this._getGeometryEvents();for(var n in e)this._geometry[t](n,e[n],this)}},n._onGeoSymbolChange=function(t){this._shadow&&this._shadow.setSymbol(t.target._getInternalSymbol())},n._onMarkerDragEnd=function(){this._update("setCoordinates",this._shadow.getCoordinates().toArray()),this._refresh()},n._createOrRefreshOutline=function(){var t=this._geometry,e=this._editOutline;return e?(e.remove(),this._editOutline=e=t.getOutline(),this._editStageLayer.addGeometry(e)):(e=t.getOutline(),this._editStageLayer.addGeometry(e),this._editOutline=e,this._addRefreshHook(this._createOrRefreshOutline)),e},n._createCenterHandle=function(){var t,e=this,n=this._shadow.getCenter(),r=this.options.centerHandleSymbol,i=this.createHandle(n,{symbol:r,cursor:"move",onDown:function(){var n=kt((t=e._shadow.copy())._getInternalSymbol(),.5);t.setSymbol(n).addTo(e._editStageLayer)},onMove:function(e,n){var r=n.coordOffset;t.translate(r)},onUp:function(){e._update("setCoordinates",dn.toNumberArrays(t.getCoordinates())),t.remove(),e._refresh()}});this._addRefreshHook(function(){var t=e._shadow.getCenter();i.setCoordinates(t)})},n._createHandleInstance=function(t,e){var n=e.symbol;return new Lr(t,{draggable:!0,dragShadow:!1,dragOnAxis:e.axis,cursor:e.cursor,symbol:n})},n.createHandle=function(t,e){e||(e={});var n=this.getMap(),r=this._createHandleInstance(t,e),i=this;function o(t){return e.onDown&&(this._geometry.fire("handledragstart"),e.onDown.call(i,t.viewPoint,t)),!1}function a(t){i._hideContext();var o=n._prjToViewPoint(r._getPrjCoordinates());return e.onMove&&(this._geometry.fire("handledragging"),e.onMove.call(i,o,t)),!1}function s(t){return e.onUp&&(this._geometry.fire("handledragend"),e.onUp.call(i,t)),!1}return r.on("dragstart",o,this),r.on("dragging",a,this),r.on("dragend",s,this),r.on("removestart",function t(){r.config("draggable",!1),r.off("dragstart",o,i),r.off("dragging",a,i),r.off("dragend",s,i),r.off("removestart",t,i),delete r["maptalks--editor-refresh-fn"]},this),e.onRefresh&&(r["maptalks--editor-refresh-fn"]=e.onRefresh),this._editStageLayer.addGeometry(r),r},n._createResizeHandles=function(t,e,n){var r=this,i=["nw-resize","n-resize","ne-resize","w-resize","e-resize","sw-resize","s-resize","se-resize"],o=[null,"y",null,"x","x",null,"y",null],a=this._geometry;t||(t=[]);var s=this,u=[],c={},l=this.getMap(),h=this.options.vertexHandleSymbol,f=function(){for(var f,d=a._getPainter().get2DExtent(),p=[(f=d).getMin(),new oe((f.xmax+f.xmin)/2,f.ymin),new oe(f.xmax,f.ymin),new oe(f.xmin,(f.ymax+f.ymin)/2),new oe(f.xmax,(f.ymax+f.ymin)/2),new oe(f.xmin,f.ymax),new oe((f.xmax+f.xmin)/2,f.ymax),f.getMax()],v=function(f){if(Array.isArray(t)&&t.some(function(t){return t===f}))return"continue";var d,v=p[f],g=l.pointToCoordinate(v);if(u.length<p.length-t.length){var y=r.createHandle(g,{symbol:h,cursor:i[f],axis:o[f],onMove:(d=f,function(t){s._updating=!0,e(t,d),a.fire("resizing")}),onUp:function(){s._updating=!1,n(),r._refresh()}});y.setId(f),c[f]=u.length,u.push(y)}else u[c[f]].setCoordinates(g)},g=0;g<p.length;g++)v(g)};return f(),this._addRefreshHook(f),u},n.createMarkerEditor=function(){var t=this,e=this._geometry,n=this._shadow,r=this.getMap();if(n._canEdit()){this._history||this._recordHistory(h());var i=n._getInternalSymbol(),o=new oe(0,0);d(i.markerDx)&&(o.x=i.markerDx),d(i.markerDy)&&(o.y=i.markerDy);var a=null;ur.test(i)?"pin"!==i.markerType&&"pie"!==i.markerType&&"bar"!==i.markerType||(a=[5,6,7]):(lr.test(i)||vr.test(i))&&(a=[5,6,7]);var s,u=[2,1,2,0,0,2,1,2];if(this.options.fixAspectRatio){var c=n.getSize();s=c.width/c.height}var l=this._createResizeHandles(null,function(i,c){if(a&&a.indexOf(c)>=0){var h=r.viewPointToCoordinate(i.sub(o)),f=n.getCoordinates();h.x=f.x,n.setCoordinates(h),t._updateCoordFromShadow(!0);var d=l[l.length-1-c];i=r.coordToViewPoint(d.getCoordinates())}var p=r._pointToViewPoint(n._getCenter2DPoint()).add(o),v=n._getInternalSymbol(),g=i.sub(p);a&&i.y>p.y&&(g.y=0);var y=a?1:2,m=2*Math.abs(g.x),_=Math.abs(g.y)*y;s&&(_=(m=Math.max(m,_*s))/s);var b=u[c];n instanceof ri?((s||0===b||2===b)&&(n.setWidth(m),e.setWidth(m)),(s||1===b||2===b)&&(n.setHeight(_),e.setHeight(_))):((s||0===b||2===b)&&(v.markerWidth=m),(s||1===b||2===b)&&(v.markerHeight=_),n.setSymbol(v),e.setSymbol(v))},function(){t._update(h())});this._addListener([r,"zoomend",function(){this._refresh()}])}else console&&console.warn("A marker can't be resized with symbol:",n.getSymbol());function h(){var t=[["setCoordinates",n.getCoordinates().toArray()]];return n instanceof ri?(t.push(["setWidth",n.getWidth()]),t.push(["setHeight",n.getHeight()])):t.push(["setSymbol",n.getSymbol()]),t}},n.createCircleEditor=function(){var t=this,e=this._geometry,n=this._shadow,r=this.getMap();this._history||this._recordHistory([["setCoordinates",n.getCoordinates().toArray()],["setRadius",n.getRadius()]]),this._createResizeHandles(null,function(t){var i,o=r._pointToViewPoint(n._getCenter2DPoint()),a=t.sub(o),s=Math.abs(a.x),u=Math.abs(a.y);i=s>u?r.pixelToDistance(s,0):r.pixelToDistance(0,u),n.setRadius(i),e.setRadius(i)},function(){t._update("setRadius",n.getRadius())})},n.createEllipseOrRectEditor=function(){var t=this,e=[2,1,2,0,0,2,1,2],n=this._geometry,r=this._shadow;this._history||this._recordHistory(u());var i,o=this.getMap(),a=this._geometry instanceof Yr;this.options.fixAspectRatio&&(i=n.getWidth()/n.getHeight());var s=this._createResizeHandles(null,function(u,c){var l,h,f,d=a?1:2,p=u,v=e[c];if(a){var g=s[7-c],y=o.coordToViewPoint(g.getCoordinates()),m=(l=p.sub(y)).abs();h=o.pixelToDistance(m.x,0),f=o.pixelToDistance(0,m.y);var _=n.getSize();0===v?(i&&(m.y=m.x/i,_.height=Math.abs(m.y),f=h/i),p.y=y.y-_.height/2):1===v?(i&&(m.x=m.y*i,_.width=Math.abs(m.x),h=f*i),p.x=y.x-_.width/2):i&&(h>f*i?(f=h/i,p.y=y.y+m.x*I(l.y)/i):(h=f*i,p.x=y.x+m.y*I(l.x)*i));var b=o.viewPointToCoordinate(new oe(Math.min(p.x,y.x),Math.min(p.y,y.y)));r.setCoordinates(b),t._updateCoordFromShadow(!0)}else{l=o.coordToViewPoint(n.getCenter()).sub(p)._abs(),h=o.pixelToDistance(l.x,0),f=o.pixelToDistance(0,l.y),i&&(f=(h=Math.max(h,f*i))/i)}(i||0===v||2===v)&&(r.setWidth(h*d),n.setWidth(h*d)),(i||1===v||2===v)&&(r.setHeight(f*d),n.setHeight(f*d))},function(){t._update(u())});function u(){return[["setCoordinates",r.getCoordinates().toArray()],["setWidth",r.getWidth()],["setHeight",r.getHeight()]]}},n.createPolygonEditor=function(){var t=this.getMap(),e=this._shadow,n=this,r=t.getProjection();this._history||this._recordHistory("setCoordinates",dn.toNumberArrays(e.getCoordinates()));var i=e instanceof jr?3:2,o="maptalks--editor-refresh-fn",a="maptalks--editor-vertex-index",s=[],u=[];function c(){if(e instanceof jr){var t=e.getCoordinates()[0];return t.slice(0,t.length-1)}return e.getCoordinates()}function l(){return e._getPrjCoordinates()}function h(){for(var t=s.length-1;t>=0;t--)s[t][a]=t;for(var e=u.length-1;e>=0;e--)u[e][a]=e;n._updateCoordFromShadow()}function f(t){var r,o=t.target[a],c=l();c.length<=i||(c.splice(o,1),e._setPrjCoordinates(c),e._updateCache(),s.splice(o,1)[0].remove(),o<u.length&&u.splice(o,1)[0].remove(),r=0===o?u.length-1:o-1,u.splice(r,1)[0].remove(),u.splice(r,0,v.call(n,r)),h(),n._refresh())}function d(r,i){var a,s=l(),c=t._viewPointToPrj(r),h=s[i];h.x=c.x,h.y=c.y,e._updateCache(),e.onShapeChanged(),n._updateCoordFromShadow(!0),a=0===i?u.length-1:i-1,u[i]&&u[i][o](),u[a]&&u[a][o]()}function p(t){var e=c()[t],r=n.createHandle(e,{symbol:n.options.vertexHandleSymbol,cursor:"pointer",axis:null,onMove:function(t){d(t,r[a])},onRefresh:function(){e=c()[r[a]],r.setCoordinates(e)},onUp:function(){n._refresh(),n._updateCoordFromShadow()},onDown:function(t,e){!e||!e.domEvent||e.domEvent.button}});return r[a]=t,r.on(n.options.removeVertexOn,f),r}function v(t){var i,o=c();i=t+1>=o.length?o[0]:o[t+1];var f=o[t].add(i).multi(.5),g=n.createHandle(f,{symbol:n.options.newVertexHandleSymbol,cursor:"pointer",axis:null,onDown:function(t,i){if(!i||!i.domEvent||2!==i.domEvent.button){var o=l(),s=g[a],c=r.project(g.getCoordinates());o.splice(s+1,0,c),e._setPrjCoordinates(o),e._updateCache();var h=g.getSymbol();delete h.opacity,g.setSymbol(h),u.splice(s,0,v.call(n,s),v.call(n,s+1))}},onMove:function(t){d(t,g[a]+1)},onUp:function(t){if(!t||!t.domEvent||2!==t.domEvent.button){var e=g[a];j(g,u),g.remove(),s.splice(e+1,0,p.call(n,e+1)),h(),n._updateCoordFromShadow(),n._refresh()}},onRefresh:function(){o=c();var t,e=g[a];t=e===o.length-1?0:e+1;var n=o[e].add(o[t]).multi(.5);g.setCoordinates(n)}});return g[a]=t,g}for(var g=c(),y=0,m=g.length;y<m;y++)s.push(p.call(this,y)),y<m-1&&u.push(v.call(this,y));e instanceof jr&&u.push(v.call(this,g.length-1)),this._addRefreshHook(function(){for(var t=u.length-1;t>=0;t--)u[t][o]();for(var e=s.length-1;e>=0;e--)s[e][o]()})},n._refresh=function(){if(this._refreshHooks)for(var t=this._refreshHooks.length-1;t>=0;t--)this._refreshHooks[t].call(this)},n._hideContext=function(){this._geometry&&(this._geometry.closeMenu(),this._geometry.closeInfoWindow())},n._addListener=function(t){this._eventListeners||(this._eventListeners=[]),this._eventListeners.push(t),t[0].on(t[1],t[2],this)},n._clearAllListeners=function(){if(this._eventListeners&&this._eventListeners.length>0){for(var t=this._eventListeners.length-1;t>=0;t--){var e=this._eventListeners[t];e[0].off(e[1],e[2],this)}this._eventListeners=[]}},n._addRefreshHook=function(t){t&&(this._refreshHooks||(this._refreshHooks=[]),this._refreshHooks.push(t))},n._update=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];this._exeHistory([t,n]),this._recordHistory.apply(this,[t].concat(n))},n._updateCoordFromShadow=function(t){if(this._shadow){var e=this._shadow.getCoordinates(),n=this._geometry,r=this._updating;this._updating=!0,n.setCoordinates(e),t||this._recordHistory("setCoordinates",dn.toNumberArrays(n.getCoordinates())),this._updating=r}},n._recordHistory=function(t){this._history||(this._history=[],this._historyPointer=0),this._historyPointer<this._history.length-1&&this._history.splice(this._historyPointer+1);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];this._history.push([t,n]),this._historyPointer=this._history.length-1,this._geometry.fire("editrecord")},n.undo=function(){if(!this._history||0===this._historyPointer)return this;var t=this._history[--this._historyPointer];return this._exeAndReset(t),this},n.redo=function(){if(!this._history||this._historyPointer===this._history.length-1)return null;var t=this._history[++this._historyPointer];return this._exeAndReset(t),this},n._exeAndReset=function(t){if(!this._updating){this._exeHistory(t);var e=this._history,n=this._historyPointer;this.stop(),this._history=e,this._historyPointer=n,this.start()}},n._exeHistory=function(t){var e=this;if(Array.isArray(t)){var n=this._updating;this._updating=!0;var r=this._geometry;Array.isArray(t[0])?t[0].forEach(function(t){var n=t[0],i=t.slice(1);e._shadow[n].apply(e._shadow,i),r[n].apply(r,i)}):(this._shadow[t[0]].apply(this._shadow,t[1]),r[t[0]].apply(r,t[1])),this._updating=n}},e}(rn(an));No.mergeOptions(Fo);var Bo={startEditText:function(){return this.getMap()?(this.hide(),this.endEditText(),this._prepareEditor(),this._fireEvent("edittextstart"),this):this},endEditText:function(){if(this._textEditor){var t=this._textEditor.innerHTML;t=t.replace(/<p>/gi,"").replace(/<\/p>/gi,"<br/>"),this._textEditor.innerHTML=t;var e=this._textEditor.innerText.replace(/[\r\n]+$/gi,"");this.setContent(e),Je(this._textEditor,"mousedown dblclick",Le),this.getMap().off("mousedown",this.endEditText,this),this._editUIMarker.remove(),delete this._editUIMarker,this._textEditor.onkeyup=null,delete this._textEditor,this.show(),this._fireEvent("edittextend")}return this},isEditingText:function(){return!!this._textEditor},getTextEditor:function(){return this._editUIMarker},_prepareEditor:function(){var t=this.getMap(),e=this._createEditor();this._textEditor=e,t.on("mousedown",this.endEditText,this);var n=this._getEditorOffset();this._editUIMarker=new Xi(this.getCoordinates(),{animation:null,content:e,dx:n.dx,dy:n.dy}).addTo(t),this._setCursorToLast(this._textEditor)},_getEditorOffset:function(){var t=this._getInternalSymbol()||{},e=0,n=0,r=t.textHorizontalAlignment;return"middle"===r||f(r)?(e=(t.textDx||0)-2,n=(t.textDy||0)-2):(e=(t.markerDx||0)-2,n=(t.markerDy||0)-2),{dx:e,dy:n}},_createEditor:function(){var t=this.getContent(),e=this.getSize(),n=this._getInternalSymbol()||{},r=e.width,i=n.textFill||"#000000",o=n.textSize||12,a=e.height,s=n.markerLineColor||"#000",u=n.markerFill||"#3398CC",c=n.textLineSpacing||0,l=Te("div");return l.contentEditable=!0,l.style.cssText="background:"+u+"; border:1px solid "+s+";\n            color:"+i+";font-size:"+o+"px;width:"+(r-2)+"px;height:"+(a-2)+"px;margin: auto;\n            line-height:"+(o+c)+"px;outline: 0; padding:0; margin:0;word-wrap: break-word;\n            overflow: hidden;-webkit-user-modify: read-write-plaintext-only;",l.innerText=t,Ye(l,"mousedown dblclick",Le),l.onkeyup=function(t){var e=l.style.height||0;13===t.keyCode&&(l.style.height=parseInt(e)+o/2+"px")},l},_setCursorToLast:function(t){var e;window.getSelection?(t.focus(),(e=window.getSelection()).selectAllChildren(t),e.collapseToEnd()):document.selection&&((e=document.selection.createRange()).moveToElementText(t),e.collapse(!1),e.select())}};ni.include(Bo),wr.include({animate:function(t,e,n){var r=this;this._animPlayer&&this._animPlayer.finish(),y(e)&&(n=e),e||(e={});var i,o=this.getMap(),a=this._getProjection(),s=this.getSymbol()||{},u=this._prepareAnimationStyles(t),c=e.focus;if(delete this._animationStarted,o){var l=o._getRenderer();e.framer=function(t){l.callInNextFrame(t)}}var h=Ar.animate(u,e,function(t){if(o&&o.isRemoved())h.finish();else{o&&!r._animationStarted&&c&&o.onMoveStart();var e=t.styles;for(var u in e)if("symbol"!==u&&"translate"!==u&&e.hasOwnProperty(u)){var l="set"+u[0].toUpperCase()+u.slice(1);r[l](e[u])}var f=e.translate;if(f){var d=f;i&&(d=f.sub(i)),i=f,r.translate(d)}var p=e.symbol;if(p&&r.setSymbol(jt(s,p)),o&&c){var v=a.project(r.getCenter());o._setPrjCenter(v);var g=o._parseEventFromCoord(a.unproject(v));"running"!==h.playState?o.onMoveEnd(g):o.onMoving(g)}r._fireAnimateEvent(h.playState),n&&n(t)}});return this._animPlayer=h,this._animPlayer.play()},_prepareAnimationStyles:function(t){var e=this._getInternalSymbol(),n={};for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];if("translate"!==r&&"symbol"!==r){var o=this["get"+r[0].toUpperCase()+r.substring(1)]();n[r]=[o,i]}else if("symbol"===r){var a=void 0;if(Array.isArray(t.symbol)){if(!Array.isArray(e))throw new Error("geometry'symbol isn't a composite symbol, while the symbol in styles is.");a=[];for(var s=t.symbol,u=0;u<s.length;u++)if(s[u]){var c={};for(var l in s[u])s[u].hasOwnProperty(l)&&(c[l]=[e[u][l],s[u][l]]);a.push(c)}else a.push(null)}else{if(Array.isArray(e))throw new Error("geometry'symbol is a composite symbol, while the symbol in styles isn't.");for(var h in a={},i)i.hasOwnProperty(h)&&(a[h]=[e[h],i[h]])}n.symbol=a}else"translate"===r&&(n.translate=new dn(i))}return n},_fireAnimateEvent:function(t){"finished"===t?(delete this._animationStarted,this._fireEvent("animateend")):"running"===t&&(this._animationStarted?this._fireEvent("animating"):(this._fireEvent("animatestart"),this._animationStarted=!0))}});var Uo=ee.touch?"touchstart mousedown":"mousedown",zo=function(t){function e(e){return t.call(this,e)||this}ne(e,t);var n=e.prototype;return n.addHooks=function(){this.target.on(Uo,this._startDrag,this)},n.removeHooks=function(){this._endDrag(),this.target.off(Uo,this._startDrag,this),delete this.container},n._prepareDragHandler=function(){this._dragHandler=new fn(this.container),this._dragHandler.on("dragging",this._dragging,this).on("mouseup",this._endDrag,this).enable()},n._prepareShadow=function(){var t=this.target;this._prepareDragStageLayer(),this._shadow&&this._shadow.remove();var e=this._shadow=t.copy();if(this._shadow.setSymbol(t._getInternalSymbol()),t.options.dragShadow){var n=kt(e._getInternalSymbol(),.5);e.setSymbol(n)}e.setId(null),this._prepareShadowConnectors()},n._prepareShadowConnectors=function(){var t=this.target,e=this._shadow,n=this._dragStageLayer._getRenderer().resources,r=[];if(si._hasConnectors(t))for(var i=si._getConnectors(t),o=0,a=i.length;o<a;o++){var s=i[o],u=s.config(),c=s._getInternalSymbol();u.symbol=kt(c,.5);var l=void 0;l=s.getConnectSource()===t?new s.constructor(e,s.getConnectTarget(),u):new s.constructor(s.getConnectSource(),e,u),r.push(l),s.getLayer()&&s.getLayer()._getRenderer()&&n.merge(s.getLayer()._getRenderer().resources)}this._shadowConnectors=r,r.push(e),this._dragStageLayer.bringToFront().addGeometry(r)},n._onTargetUpdated=function(){this._shadow&&this._shadow.setSymbol(this.target._getSymbol())},n._prepareDragStageLayer=function(){var t=this.target.getMap(),e=this.target.getLayer();this._dragStageLayer=t.getLayer("_maptalks__internal_layer__drag_stage"),this._dragStageLayer||(this._dragStageLayer=new hi("_maptalks__internal_layer__drag_stage",{enableAltitude:e.options.enableAltitude,altitudeProperty:e.options.altitudeProperty}),t.addLayer(this._dragStageLayer));var n=new Vn;n.merge(e._getRenderer().resources),this._dragStageLayer._getRenderer().resources=n},n._startDrag=function(t){var e=this.target.getMap();if(e&&(!this.target._getParent()&&!this.isDragging())){var n=t.domEvent;n.touches&&n.touches.length>1||2===n.button||(this.container=e._panels.mapWrapper||e._containerDOM,this.target.on("click",this._endDrag,this),this._lastCoord=this._correctCoord(t.coordinate),this._lastPoint=t.containerPoint,this._prepareDragHandler(),this._dragHandler.onMouseDown(t.domEvent),Ye(this.container,"mouseleave",this._endDrag,this),this._startParam=t,this._moved=!1)}},n._dragging=function(t){var e=this.target,n=e.getMap()._parseEvent(t.domEvent),r=n.domEvent;if(!(r.touches&&r.touches.length>1)){if(!this._moved)return this._moved=!0,e.on("symbolchange",this._onTargetUpdated,this),this._isDragging=!0,this._prepareShadow(),e.options.dragShadow||e.hide(),this._shadow._fireEvent("dragstart",n),this.target._fireEvent("dragstart",this._startParam||n),void delete this._startParam;if(this._shadow){var i=this._shadow.options.dragOnAxis,o=this._correctCoord(n.coordinate),a=n.containerPoint;this._lastPoint=this._lastPoint||a,this._lastCoord=this._lastCoord||o;var s=a.sub(this._lastPoint),u=o.sub(this._lastCoord);"x"===i?s.y=u.y=0:"y"===i&&(s.x=u.x=0),this._lastPoint=a,this._lastCoord=o,this._shadow.translate(u),e.options.dragShadow||e.translate(u),n.coordOffset=u,n.pointOffset=s,this._shadow._fireEvent("dragging",n),e._fireEvent("dragging",n)}}},n._endDrag=function(t){if(this._dragHandler&&(this._dragHandler.disable(),delete this._dragHandler),this.container&&Je(this.container,"mouseleave",this._endDrag,this),this.target){var e=this.target;e.off("click",this._endDrag,this),e.off("symbolchange",this._onTargetUpdated,this),delete this._lastCoord,delete this._lastPoint,this._isDragging=!1;var n=e.getMap();if(this.enabled()&&n){var r=n._parseEvent(t?t.domEvent:null);this._updateTargetAndRemoveShadow(r),this._moved&&e._fireEvent("dragend",r)}}},n.isDragging=function(){return!!this._isDragging},n._updateTargetAndRemoveShadow=function(t){var e=this.target,n=e.getMap();e.options.dragShadow||e.show();var r=this._shadow;r&&(e.options.dragShadow&&e.setCoordinates(r.getCoordinates()),r._fireEvent("dragend",t),r.remove(),delete this._shadow),this._shadowConnectors&&(n.getLayer("_maptalks__internal_layer__drag_stage").removeGeometry(this._shadowConnectors),delete this._shadowConnectors),this._dragStageLayer&&this._dragStageLayer.remove()},n._correctCoord=function(t){var e=this.target.getMap();if(!e.getPitch())return t;var n=this.target._getPainter();if(!n.getMinAltitude())return t;var r=(n.getMinAltitude()+n.getMaxAltitude())/2;return e.locateByPoint(t,0,-r)},e}(on);wr.mergeOptions({draggable:!1,dragShadow:!0,dragOnAxis:null}),wr.addInitHook("addHandler","draggable",zo),wr.include({isDragging:function(){return this._getParent()?this._getParent().isDragging():!!this.draggable&&this.draggable.isDragging()}}),wr.include({startEdit:function(t){return this.getMap()&&this.options.editable?(this.endEdit(),this._editor=new No(this,t),this._editor.start(),this.fire("editstart"),this):this},endEdit:function(){return this._editor&&(this._editor.stop(),delete this._editor,this.fire("editend")),this},redoEdit:function(){return this.isEditing()?(this._editor.redo(),this.fire("redoedit"),this):this},undoEdit:function(){return this.isEditing()?(this._editor.undo(),this.fire("undoedit"),this):this},isEditing:function(){return!!this._editor&&this._editor.isEditing()}}),wr.include({_onEvent:function(t,e){if(this.getMap()){var n=e||this._getEventTypeToFire(t);"contextmenu"===n&&this.listens("contextmenu")&&(Le(t),Re(t));var r=this._getEventParams(t);this._fireEvent(n,r)}},_getEventTypeToFire:function(t){return t.type},_getEventParams:function(t){var e=this.getMap(),n={domEvent:t},r=t.touches&&t.touches.length>0?t.touches[0]:t.changedTouches&&t.changedTouches.length>0?t.changedTouches[0]:t;if(r){var i=Ne(r,e._containerDOM);n.coordinate=e.containerPointToCoordinate(i),n.containerPoint=i,n.viewPoint=e.containerPointToViewPoint(i),n.pont2d=e._containerPointToPoint(i)}return n}}),wr.include({setInfoWindow:function(t){return this.removeInfoWindow(),t instanceof qi?(this._infoWindow=t,this._infoWinOptions=h({},this._infoWindow.options),this._infoWindow.addTo(this),this):(this._infoWinOptions=h({},t),this._infoWindow?this._infoWindow.setOptions(t):this.getMap()&&this._bindInfoWindow(this._infoWinOptions),this)},getInfoWindow:function(){return this._infoWindow?this._infoWindow:null},openInfoWindow:function(t){return this.getMap()?(t||(t=this.getCenter()),this._infoWindow?this._infoWindow.show(t):this._infoWinOptions&&this.getMap()&&(this._bindInfoWindow(this._infoWinOptions),this._infoWindow.show(t)),this):this},closeInfoWindow:function(){return this._infoWindow&&this._infoWindow.hide(),this},removeInfoWindow:function(){return this._unbindInfoWindow(),delete this._infoWinOptions,delete this._infoWindow,this},_bindInfoWindow:function(t){return this._infoWindow=new qi(t),this._infoWindow.addTo(this),this},_unbindInfoWindow:function(){return this._infoWindow&&(this.closeInfoWindow(),this._infoWindow.remove(),delete this._infoWindow),this}});var Go=function(){function t(t,e){this.max=t,this.onRemove=e,this.reset()}var e=t.prototype;return e.reset=function(){for(var t in this.data)this.onRemove(this.data[t]);return this.data={},this.order=[],this},e.clear=function(){this.reset(),delete this.onRemove},e.add=function(t,e){if(this.has(t))this.order.splice(this.order.indexOf(t),1),this.data[t]=e,this.order.push(t);else if(this.data[t]=e,this.order.push(t),this.order.length>this.max){var n=this.getAndRemove(this.order[0]);n&&this.onRemove(n)}return this},e.has=function(t){return t in this.data},e.keys=function(){return this.order},e.getAndRemove=function(t){if(!this.has(t))return null;var e=this.data[t];return delete this.data[t],this.order.splice(this.order.indexOf(t),1),e},e.get=function(t){return this.has(t)?this.data[t]:null},e.remove=function(t){if(!this.has(t))return this;var e=this.data[t];return delete this.data[t],this.onRemove(e),this.order.splice(this.order.indexOf(t),1),this},e.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this.getAndRemove(this.order[0]);e&&this.onRemove(e)}return this},t}(),Vo=function(t){function e(e){var n;return(n=t.call(this,e)||this).tilesInView={},n.tilesLoading={},n._parentTiles=[],n._childTiles=[],n.tileCache=new Go(e.options.maxCacheSize,n.deleteTile.bind(re(re(n)))),n}ne(e,t);var n=e.prototype;return n.draw=function(){var t=this.getMap();if(this.isDrawable()){var e=this.prepareCanvas();if(!e||e.intersects(this.canvasExtent2D)){var n=this.layer.getTiles().tileGrids;if(n&&n.length){var r=0,i=!1,o={},a=[],s=[],u={},c=[],l={},h=[],f={},d={},p=this._markTiles(),v=this._getLoadLimit(),g=n.length;this._tileZoom=n[0].zoom,this._tileOffset=n[0].offset;for(var y=0;y<g;y++)for(var m=n[y],_=m.tiles,b=this._generatePlaceHolder(m.zoom),w=0,x=_.length;w<x;w++){var E=_[w],O=E.id,P=this._getCachedTile(O),S=!1;if(this._isLoadingTile(O))S=i=!0,this.tilesLoading[O].current=!0;else if(P)this.getTileOpacity(P.image)<1&&(S=i=!0),a.push(P);else{S=i=!0,v&&r+p[0]>v||t.isInteracting()&&!t.isMoving()&&!t.isRotating()||(r++,d[O+"@"+E.point.toArray().join()]=E)}if(S&&!o[E.dupKey]){o[E.dupKey]=1,b&&!f[E.dupKey]&&(E.cache=!1,h.push({image:b,info:E}),f[E.dupKey]=1);var T=this._findParentTile(E);if(T){var C=T.info.dupKey;void 0===u[C]&&(u[C]=s.length,s.push(T))}else{var A=this._findChildTiles(E);A.length&&A.forEach(function(t){l[t.info.dupKey]||(c.push(t),l[t.info.dupKey]=1)})}}}this._drawTiles(a,s,c,h),r?this.loadTileQueue(d):i||(t.isAnimating()||!this._parentTiles.length&&!this._childTiles.length||(this._parentTiles=[],this._childTiles=[],this.setToRedraw()),this.completeRender()),this._retireTiles()}else this.completeRender()}else this.completeRender()}},n.isTileCachedOrLoading=function(t){return this.tilesLoading[t]||this.tilesInView[t]||this.tileCache.has(t)},n._drawTiles=function(t,e,n,r){var i=this;e.length&&(e.sort(function(t,e){return Math.abs(e.info.z-i._tileZoom)-Math.abs(t.info.z-i._tileZoom)}),this._parentTiles=e),n.length&&(this._childTiles=n);var o={tiles:t,parentTiles:e,childTiles:n};this.onDrawTileStart(o),this._parentTiles.forEach(function(t){return i._drawTileAndCache(t)}),this._childTiles.forEach(function(t){return i._drawTileOffset(t.info,t.image)}),r.forEach(function(t){return i._drawTileOffset(t.info,t.image)});var a=this.layer,s=this.getMap();if(!a.options.cascadeTiles||s.getPitch()<=a.options.minPitchToCascade)t.forEach(function(t){return i._drawTileAndCache(t)});else{this.writeZoomStencil();for(var u=!1,c=0,l=t.length;c<l;c++)t[c].info.z!==this._tileZoom?u?this.resumeZoomStencilTest():(this.startZoomStencilTest(),u=!0):u&&this.pauseZoomStencilTest(),this._drawTileAndCache(t[c]);this.endZoomStencilTest()}this.onDrawTileEnd(o)},n.writeZoomStencil=function(){},n.startZoomStencilTest=function(){},n.endZoomStencilTest=function(){},n.pauseZoomStencilTest=function(){},n.resumeZoomStencilTest=function(){},n.onDrawTileStart=function(){},n.onDrawTileEnd=function(){},n._drawTileOffset=function(t,e){var n=this._tileOffset;if(n[0]||n[1]){var r=this.getMap(),i=r._getResolution(this._tileZoom)/r._getResolution(t.z);n[0]*=i,n[1]*=i,t.point._sub(n),t.extent2d._sub(n),this.drawTile(t,e),t.point._add(n),t.extent2d._add(n),n[0]/=i,n[1]/=i}else this.drawTile(t,e)},n._drawTileAndCache=function(t){t.current=!0,this.tilesInView[t.info.id]=t,this._drawTileOffset(t.info,t.image),this.tileCache.add(t.info.id,t)},n.drawOnInteracting=function(){this.draw()},n.needToRedraw=function(){var e=this.getMap();return e.getPitch()?t.prototype.needToRedraw.call(this):!(!e.isRotating()&&!e.isZooming())||(e.isMoving()?!!this.layer.options.forceRenderOnMoving:t.prototype.needToRedraw.call(this))},n.hitDetect=function(){return!1},n._getLoadLimit=function(){return this.getMap().isInteracting()?this.layer.options.loadingLimitOnInteracting:0},n.isDrawable=function(){return!this.getMap().getPitch()||(console&&console.warn("TileLayer with canvas renderer can't be pitched, use gl renderer ('renderer' : 'gl') instead."),this.clear(),!1)},n.clear=function(){this._retireTiles(!0),this.tileCache.reset(),this.tilesInView={},this.tilesLoading={},this._parentTiles=[],this._childTiles=[],t.prototype.clear.call(this)},n._isLoadingTile=function(t){return!!this.tilesLoading[t]},n.clipCanvas=function(e){return this.layer.getMask()?t.prototype.clipCanvas.call(this,e):this._clipByPitch(e)},n._clipByPitch=function(t){var e=this.getMap();if(e.getPitch()<=e.options.maxVisualPitch)return!1;if(!this.layer.options.clipByPitch)return!1;var n=e.getContainerExtent(),r=ee.retina?2:1;return t.save(),t.strokeStyle="rgba(0, 0, 0, 0)",t.beginPath(),t.rect(0,Math.ceil(n.ymin)*r,Math.ceil(n.getWidth())*r,Math.ceil(n.getHeight())*r),t.stroke(),t.clip(),!0},n.loadTileQueue=function(t){for(var e in t)if(t.hasOwnProperty(e)){var n=t[e],r=this.loadTile(n);void 0===r.loadTime&&(this.tilesLoading[n.id]={image:r,current:!0,info:n})}},n.loadTile=function(t){var e=this.layer.getTileSize(),n=new Image;return n.width=e.width,n.height=e.height,n.onload=this.onTileLoad.bind(this,n,t),n.onerror=this.onTileError.bind(this,n,t),this.loadTileImage(n,t.url),n},n.loadTileImage=function(t,e){var n=this.layer.options.crossOrigin;return f(n)||(t.crossOrigin=n),T(t,[e])},n.abortTileLoading=function(t){t&&(t.onload=Wo,t.onerror=Wo,t.src=q)},n.onTileLoad=function(t,e){if(this.layer){var n=e.id;this.tilesInView&&(t.loadTime=l(),delete this.tilesLoading[n],this._addTileToCache(e,t),this.setToRedraw(),this.layer.fire("tileload",{tile:e,tileImage:t}))}},n.onTileError=function(t,e){this.layer&&(t instanceof Image&&this.abortTileLoading(t),t.loadTime=0,delete this.tilesLoading[e.id],this._addTileToCache(e,t),this.setToRedraw(),this.layer.fire("tileerror",{tile:e}))},n.drawTile=function(t,e){if(e&&this.getMap()){var n=t.point,r=t.z,i=t.id,o=this.getMap(),a=t.size,s=o.getZoom(),u=this.context,c=o._pointToContainerPoint(n,r),l=o.getBearing(),h=l||s!==r,f=this.getTileOpacity(e),d=u.globalAlpha;f<1&&(u.globalAlpha=f,this.setToRedraw()),h||c._round();var p=c.x,v=c.y,g=a[0],y=a[1];if(h){if(g++,y++,u.save(),u.translate(p,v),l&&u.rotate(-l*Math.PI/180),s!==r){var m=o._getResolution(r)/o._getResolution();u.scale(m,m)}p=v=0}if(Ke.image(u,e,p,v,g,y),this.layer.options.debug){var _=new oe(p,v),b=this.layer.options.debugOutline,w=i.split("__");u.save(),u.strokeStyle=b,u.fillStyle=b,u.strokeWidth=10,u.font="15px monospace",Ke.rectangle(u,_,a,1,0),Ke.fillText(u,"x:"+w[2]+", y:"+w[1]+", z:"+w[3],_.add(10,20),b),Ke.drawCross(u,_.add(g/2,y/2),2,b),u.restore()}h&&u.restore(),u.globalAlpha!==d&&(u.globalAlpha=d),this.setCanvasUpdated()}},n._findChildTiles=function(t){var e=this._getLayerOfTile(t.layer);if(!e.options.background)return[];for(var n=this.getMap(),r=[],i=t.extent2d.getMin(),o=t.extent2d.getMax(),a=e._project(n._pointToPrj(i,t.z)),s=e._project(n._pointToPrj(o,t.z)),u=1;u<3;u++)this._findChildTilesAt(r,a,s,e,t.z+u);return r},n._findChildTilesAt=function(t,e,n,r,i){var o=r.options.zoomOffset,a=r.getId(),s=r.getSpatialReference().getResolution(i+o);if(s)for(var u,c,l=r._getTileConfig().getTileIndex(e,s),h=r._getTileConfig().getTileIndex(n,s),f=Math.min(l.idx,h.idx),d=Math.max(l.idx,h.idx),p=Math.min(l.idy,h.idy),v=Math.max(l.idy,h.idy),g=f;g<d;g++)for(var y=p;y<v;y++)u=r._getTileId({idx:g,idy:y},i+o,a),this.tileCache.has(u)&&(c=this.tileCache.getAndRemove(u),t.push(c),this.tileCache.add(u,c))},n._findParentTile=function(t){var e=this.getMap(),n=this._getLayerOfTile(t.layer);if(!n.options.background)return null;for(var r=n.getSpatialReference(),i=r.getZoomDirection(),o=n.options.zoomOffset,a=n.options.backgroundZoomDiff,s=t.extent2d.getCenter(),u=n._project(e._pointToPrj(s,t.z)),c=1;c<=a;c++){var l=t.z-i*c,h=r.getResolution(l+o);if(h){var f=n._getTileConfig().getTileIndex(u,h),d=n._getTileId(f,l+o,t.layer);if(this.tileCache.has(d)){var p=this.tileCache.getAndRemove(d);return this.tileCache.add(d,p),p}}}return null},n._getLayerOfTile=function(t){return this.layer.getChildLayer?this.layer.getChildLayer(t):this.layer},n._getCachedTile=function(t){var e=this.tilesInView,n=this.tileCache.getAndRemove(t);if(n){e[t]=n;var r=this.tilesLoading;r&&r[t]&&(r[t].current=!1,this.abortTileLoading(r[t]),delete r[t])}else n=e[t];return n},n._addTileToCache=function(t,e){this.tilesInView[t.id]={image:e,current:!0,info:t}},n.getTileOpacity=function(t){return this.layer.options.fadeAnimation&&t.loadTime?Math.min(1,(l()-t.loadTime)/(1e3/60*10)):1},n.onRemove=function(){this.clear(),delete this.tileCache,delete this._tilePlaceHolder,t.prototype.onRemove.call(this)},n._markTiles=function(){var t=0,e=0;if(this.tilesLoading)for(var n in this.tilesLoading)this.tilesLoading[n].current=!1,t++;if(this.tilesInView)for(var r in this.tilesInView)this.tilesInView[r].current=!1,e++;return[t,e]},n._retireTiles=function(t){for(var e in this.tilesLoading){var n=this.tilesLoading[e];!t&&n.current||(n.image&&this.abortTileLoading(n.image),this.deleteTile(n),delete this.tilesLoading[e])}for(var r in this.tilesInView){var i=this.tilesInView[r];i.current||(delete this.tilesInView[r],this.tileCache.has(r)||this.deleteTile(i))}},n.deleteTile=function(t){t&&t.image&&(t.image.onload=null,t.image.onerror=null)},n._generatePlaceHolder=function(t){var e=this.getMap(),n=this.layer.options.placeholder;if(!n||e.getPitch())return null;var r=this.layer.getTileSize(),i=e._getResolution(t)/e._getResolution(),o=this._tilePlaceHolder=this._tilePlaceHolder||Ke.createCanvas(1,1);return o.width=r.width*i,o.height=r.height*i,y(n)?n(o):function(t){var e=t.getContext("2d"),n=t.width,r=t.height,i=n/16,o=r/16;e.beginPath();for(var a=0;a<16;a++)e.moveTo(0,a*o),e.lineTo(n,a*o),e.moveTo(a*i,0),e.lineTo(a*i,r);e.strokeStyle="rgba(180, 180, 180, 0.1)",e.lineWidth=1,e.stroke(),e.beginPath();for(var s=[[0,0],[n,0],[0,r],[n,r],[0,0],[0,r],[n,0],[n,r],[0,r/2],[n,r/2],[n/2,0],[n/2,r]],u=1;u<s.length;u+=2)e.moveTo(s[u-1][0],s[u-1][1]),e.lineTo(s[u][0],s[u][1]);e.lineWidth=4,e.stroke()}(o),o},e}(Gn);function Wo(){return!1}go.registerRenderer("canvas",Vo);var Zo=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.isDrawable=function(){return!0},n.needToRedraw=function(){var e=this.getMap();return!(!this._gl()||e.getPitch()||!e.isZooming()||e.isMoving()||e.isRotating())||t.prototype.needToRedraw.call(this)},n.drawTile=function(e,n){var r=this.getMap();if(e&&r&&n.src!==q){var i=r.getGLScale(e.z),o=e.size[0]*i,a=e.size[1]*i;if(!1!==e.cache&&this._bindGLBuffer(n,o,a),this._gl()){var s=e.point,u=s.x*i,c=s.y*i,l=this.getTileOpacity(n);this.drawGLImage(n,u,c,o,a,l),l<1?this.setToRedraw():this.setCanvasUpdated()}else t.prototype.drawTile.call(this,e,n)}},n.writeZoomStencil=function(){var t=this.gl;t.stencilFunc(t.ALWAYS,1,255),t.stencilOp(t.KEEP,t.KEEP,t.REPLACE)},n.startZoomStencilTest=function(){var t=this.gl;t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.stencilFunc(t.EQUAL,0,255)},n.endZoomStencilTest=function(){this.pauseZoomStencilTest()},n.pauseZoomStencilTest=function(){var t=this.gl;t.stencilFunc(t.ALWAYS,1,255)},n.resumeZoomStencilTest=function(){var t=this.gl;t.stencilFunc(t.EQUAL,0,255)},n._bindGLBuffer=function(t,e,n){t.glBuffer||(t.glBuffer=this.bufferTileData(0,0,e,n))},n.loadTileImage=function(t,e){var n=this.layer.options.crossOrigin;t.crossOrigin=null!==n?n:"",t.src=e},n.onCanvasCreate=function(){this.canvas.gl&&this.canvas.gl.wrap||this.createCanvas2()},n.createContext=function(){t.prototype.createContext.call(this),this.createGLContext()},n.resizeCanvas=function(e){this.canvas&&(t.prototype.resizeCanvas.call(this,e),this.resizeGLCanvas())},n.clearCanvas=function(){this.canvas&&(t.prototype.clearCanvas.call(this),this.clearGLCanvas())},n.getCanvasImage=function(){if(!this._gl()||!this.canvas2)return t.prototype.getCanvasImage.call(this);var e=t.prototype.getCanvasImage.call(this);return e&&(e.image=this.canvas2),e},n._gl=function(){return!(!this.canvas.gl||!this.canvas.gl.wrap)||(this.getMap()&&!!this.getMap().getPitch()||this.layer&&!!this.layer.options.fragmentShader)},n.deleteTile=function(e){t.prototype.deleteTile.call(this,e),e&&e.image&&this.disposeImage(e.image)},n.onRemove=function(){this.removeGLCanvas()},e}(So(Vo));function Ho(t){var e=this.layer.getTileSize(),n=this.canvas.constructor,r=this.getMap(),i=ee.retina?2:1,o=Ke.createCanvas(e.width*i,e.height*i,n);o.layer=this.layer;var a=this,s=new gn(r.pointToCoordinate(t.point),r.pointToCoordinate(t.point.add(e.toPoint())),r.getProjection());return this.layer.drawTile(o,{url:t.url,point:t.point,center:r.pointToCoordinate(t.point.add(e.width/2,e.height/2)),extent:s,z:t.z,x:t.x,y:t.y},function(e){e?a.onTileError(o,t):a.onTileLoad(o,t)}),o}go.registerRenderer("gl",Zo);var Xo=function(t){function e(){return t.apply(this,arguments)||this}return ne(e,t),e.prototype.loadTile=function(){return Ho.apply(this,arguments)},e}(Vo),Yo=function(t){function e(){return t.apply(this,arguments)||this}return ne(e,t),e.prototype.loadTile=function(){return Ho.apply(this,arguments)},e}(Zo);_o.registerRenderer("canvas",Xo),_o.registerRenderer("gl",Yo);var Jo=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.checkResources=function(){var t=this._geosToCheck;if(this._resourceChecked||t||(t=this.layer._geoList),!U(t))return[];for(var e=[],n={},r=t.length-1;r>=0;r--){var i=t[r]._getExternalResources();if(i.length)if(this.resources)for(var o=0;o<i.length;o++){var a=i[o][0];this.resources.isResourceLoaded(i[o])||n[a]||(e.push(i[o]),n[a]=1)}else e.push.apply(e,i)}return this._resourceChecked=!0,delete this._geosToCheck,e},n.render=function(){return this.layer._sortGeometries(),t.prototype.render.apply(this,arguments)},n._addGeoToCheckRes=function(t){t&&(Array.isArray(t)||(t=[t]),this._geosToCheck||(this._geosToCheck=[]),k(this._geosToCheck,t))},n.onGeometryAdd=function(t){this._addGeoToCheckRes(t),qo(this)},n.onGeometryRemove=function(){qo(this)},n.onGeometrySymbolChange=function(t){this._addGeoToCheckRes(t.target),qo(this)},n.onGeometryShapeChange=function(){qo(this)},n.onGeometryPositionChange=function(){qo(this)},n.onGeometryZIndexChange=function(){qo(this)},n.onGeometryShow=function(){qo(this)},n.onGeometryHide=function(){qo(this)},n.onGeometryPropertiesChange=function(){qo(this)},e}(Gn);function qo(t){t.layer.options.drawImmediate&&t.render(),t.setToRedraw()}var Qo=function(t){function e(){return t.apply(this,arguments)||this}ne(e,t);var n=e.prototype;return n.checkResources=function(){var e=this,n=t.prototype.checkResources.apply(this,arguments),r=this.layer.getStyle();return r&&(Array.isArray(r)||(r=[r]),r.forEach(function(t){for(var r=St(t.symbol,!0),i=0,o=r.length;i<o;i++)e.resources.isResourceLoaded(r[i])||n.push(r[i])})),n},n.needToRedraw=function(){var e=this.getMap();return!(!e.isInteracting()||!this.layer.options.enableAltitude)||!(e.isZooming()&&!e.isRotating()&&!e.getPitch()&&!this._hasPoint&&this.layer.constructor===hi)&&t.prototype.needToRedraw.call(this)},n.draw=function(){if(this.getMap()){if(!this.layer.isVisible()||this.layer.isEmpty())return this.clearCanvas(),void this.completeRender();this.prepareCanvas(),this.drawGeos(),this.completeRender()}},n.isBlank=function(){return!!this.context&&!this.context.canvas._drawn},n.drawOnInteracting=function(){if(this._geosToDraw){this._updateDisplayExtent();for(var t=0,e=this._geosToDraw.length;t<e;t++)this._geosToDraw[t].isVisible()&&this._geosToDraw[t]._paint(this._displayExtent)}},n.show=function(){this.layer.forEach(function(t){t._repaint()}),t.prototype.show.apply(this,arguments)},n.forEachGeo=function(t,e){this.layer.forEach(t,e)},n.drawGeos=function(){this._updateDisplayExtent(),this.prepareToDraw(),this.forEachGeo(this.checkGeo,this);for(var t=0,e=this._geosToDraw.length;t<e;t++)this._geosToDraw[t]._paint()},n.prepareToDraw=function(){this._hasPoint=!1,this._geosToDraw=[]},n.checkGeo=function(t){if(t&&t.isVisible()&&t.getMap()&&t.getLayer()&&t.getLayer().isCanvasRender()){var e=t._getPainter(),n=e.get2DExtent(this.resources);n&&n.intersects(this._displayExtent)&&(e.hasPoint()&&(this._hasPoint=!0),this._geosToDraw.push(t))}},n.onZoomEnd=function(){delete this.canvasExtent2D,t.prototype.onZoomEnd.apply(this,arguments)},n.onRemove=function(){this.forEachGeo(function(t){t.onHide()}),delete this._geosToDraw},n.onGeometryPropertiesChange=function(e){e&&this.layer._styleGeometry(e.target),t.prototype.onGeometryPropertiesChange.call(this,e)},n._updateDisplayExtent=function(){var t=this.canvasExtent2D;if(this._maskExtent){if(!this._maskExtent.intersects(t))return void this.completeRender();t=t.intersection(this._maskExtent)}this._displayExtent=t},n.identify=function(t,e){void 0===e&&(e={});var n=this._geosToDraw;return n?this.layer._hitGeos(n,t,e):[]},e}(Jo);hi.registerRenderer("canvas",Qo);var Ko=function(t){function e(e){var n;return(n=t.call(this)||this).map=e,n._handlerQueue={},n}ne(e,t);var n=e.prototype;return n.callInNextFrame=function(t){this._handlerQueue.push(t)},n.executeFrameCallbacks=function(){var t=this._handlerQueue;this._handlerQueue=[];for(var e=0,n=t.length;e<n;e++)t[e]()},n.offsetPlatform=function(t){if(!this.map._panels.front)return this;if(0===t.x&&0===t.y)return this;var e=this.map.offsetPlatform().add(t)._round(),n=this.map._panels;return De(n.back,e),De(n.front,e),this},n.resetContainer=function(){if(this.map&&(this.map._resetMapViewPoint(),this.map._panels.front)){var t=new oe(0,0);De(this.map._panels.back,t),De(this.map._panels.front,t)}},n.onZoomEnd=function(){this.resetContainer()},n.onLoad=function(){this._frameLoop()},e}(an),$o=function(t){function e(e){var n;return(n=t.call(this,e)||this)._containerIsCanvas=!!e._containerDOM.getContext,n._registerEvents(),n._loopTime=0,n}ne(e,t);var n=e.prototype;return n.load=function(){this.initContainer()},n.renderFrame=function(t){if(!this.map)return!1;var e=this.map;e._fireEvent("framestart"),this.updateMapDOM();var n=this._getAllLayerToRender();return this.drawLayers(n,t),this.drawLayerCanvas(n),e._fireEvent("frameend"),this._recordView(),this._mapview=this._getMapView(),delete this._spatialRefChanged,this._fireLayerLoadEvents(),this.executeFrameCallbacks(),this._canvasUpdated=!1,!0},n.updateMapDOM=function(){var t=this.map;if(!t.isZooming()){var e=t._getViewPointFrameOffset();e&&t.offsetPlatform(e)}},n.drawLayers=function(t,e){for(var n=this.map,r=n.isInteracting(),i=[],o=[],a=n.options.fpsOnInteracting||0,s=0===a?0:1e3/a,u=this.map.options.layerCanvasLimitOnInteracting,c=t.length,l=n.getBaseLayer(),h=0,f=0;f<c;f++){var d=t[f];if(d.isVisible()){var p=d.isCanvasRender();p&&i.push(d.getId());var v=d._getRenderer();if(v){var g=this._checkLayerRedraw(d);if(p&&v.isCanvasUpdated()&&(g||o.push(d.getId()),this.setLayerCanvasUpdated()),delete v.__shouldZoomTransform,g){if(r&&p){if(u>0&&c-1-f>u&&d!==l){d._getRenderer().clearCanvas();continue}h+=this._drawCanvasLayerOnInteracting(d,h,s,e)}else r&&v.drawOnInteracting?(v.prepareRender&&v.prepareRender(),v.drawOnInteracting(this._eventParam,e)):v.render(e);p&&(o.push(d.getId()),this.setLayerCanvasUpdated())}else p&&r&&(n.isZooming()&&!n.getPitch()?(v.prepareRender(),v.__shouldZoomTransform=!0):(n.getPitch()||n.isRotating())&&v.clearCanvas())}}}var y=this._canvasIds||[],m=this._updatedIds||[];if(this._canvasIds=i,this._updatedIds=o,!this.isLayerCanvasUpdated()){y.join("---")===i.join("---")&&m.join("---")===o.join("---")||this.setLayerCanvasUpdated()}},n._checkLayerRedraw=function(t){if(this.isSpatialReferenceChanged())return!0;var e=this.map,n=t._getRenderer();return t.isCanvasRender()?n.testIfNeedRedraw():!(!n.needToRedraw||!n.needToRedraw())||(e.isInteracting()||this.isViewChanged())},n._drawCanvasLayerOnInteracting=function(t,e,n,r){var i=this.map,o=t._getRenderer(),a=o.getDrawTime(),s=0===n||n>0&&e+a<=n;if(o.mustRenderOnInteracting&&o.mustRenderOnInteracting())o.render(r);else{if(o.drawOnInteracting&&(t===i.getBaseLayer()||s||i.isZooming()&&t.options.forceRenderOnZooming||i.isMoving()&&t.options.forceRenderOnMoving||i.isRotating()&&t.options.forceRenderOnRotating))return o.prepareRender(),o.prepareCanvas(),o.drawOnInteracting(this._eventParam,r),a;!i.isZooming()||i.getPitch()||i.isRotating()?(i.getPitch()||i.isRotating())&&o.clearCanvas():(o.prepareRender(),o.__shouldZoomTransform=!0)}return o.drawOnInteracting&&!s&&o.onSkipDrawOnInteracting(this._eventParam,r),0},n._fireLayerLoadEvents=function(){if(this._updatedIds&&this._updatedIds.length>0){var t=this.map;this._updatedIds.reverse().forEach(function(e){var n=t.getLayer(e);if(n){var r=n._getRenderer();r&&r.isRenderComplete()&&n.fire("layerload")}})}},n.isLayerCanvasUpdated=function(){return this._canvasUpdated},n.setLayerCanvasUpdated=function(){this._canvasUpdated=!0},n.drawLayerCanvas=function(t){var e=this.map;if(e&&(this.isLayerCanvasUpdated()||this.isViewChanged())){this.canvas||this.createCanvas(),e._fireEvent("renderstart",{context:this.context}),this._updateCanvasSize()||this.clearCanvas();for(var n,r=e.isInteracting(),i=e.options.layerCanvasLimitOnInteracting,o=t.length,a=[],s=0;s<o;s++){if(t[s].isVisible()&&t[s].isCanvasRender())if(t[s]._getRenderer()){var u=this._getLayerImage(t[s]);u&&u.image&&(t[s]===e.getBaseLayer()?n=[t[s],u]:a.push([t[s],u]))}}n&&(this._drawLayerCanvasImage(n[0],n[1]),this._drawFog()),o=a.length;for(var c=r&&i>=0&&o>i?o-i:0;c<o;c++)this._drawLayerCanvasImage(a[c][0],a[c][1]);this._drawCenterCross(),e._fireEvent("renderend",{context:this.context})}},n.setToRedraw=function(){for(var t=this._getAllLayerToRender(),e=0,n=t.length;e<n;e++){var r=t[e].getRenderer();r&&r.canvas&&r.setToRedraw&&r.setToRedraw()}},n.updateMapSize=function(t){if(t&&!this._containerIsCanvas){var e=t.width+"px",n=t.height+"px",r=this.map._panels;r.mapWrapper.style.width=e,r.mapWrapper.style.height=n,this._updateCanvasSize()}},n.getMainPanel=function(){return this.map?this._containerIsCanvas?this.map._containerDOM:this.map._panels?this.map._panels.mapWrapper:null:null},n.toDataURL=function(t){return this.canvas?this.canvas.toDataURL(t):null},n.remove=function(){ee.webgl&&"undefined"!=typeof document&&ke(document,"visibilitychange",this._onVisibilitychange),this._resizeInterval&&clearInterval(this._resizeInterval),delete this.context,delete this.canvas,delete this.map,delete this._spatialRefChanged,this._cancelFrameLoop()},n.hitDetect=function(t){var e=this.map;if(e&&e.options.hitDetect&&!e.isInteracting()){for(var n=e._getLayers(),r="default",i=e.options.hitDetectLimit||0,o=0,a=n.length-1;a>=0;a--){var s=n[a];if(!s.isEmpty||!s.isEmpty()){var u=s._getRenderer();if(u&&u.hitDetect&&(!u.isBlank||!u.isBlank())){if("default"!==s.options.cursor&&u.hitDetect(t)){r=s.options.cursor||"pointer";break}if(o++,i>0&&o>i)break}}}e._trySetCursor(r)}},n._getLayerImage=function(t){var e=t._getRenderer();return e.getCanvasImage?e.getCanvasImage():null},n.initContainer=function(){var t=this.map._panels;function e(e,n,r,i){var o=Te("div",n);return r&&(o.style.cssText=r),t[e]=o,i||Ie(o),o}var n=this.map._containerDOM;if(!this._containerIsCanvas){n.innerHTML="";var r="position:absolute;top:0px;left:0px;",i=e("mapWrapper","maptalks-wrapper","position:absolute;overflow:hidden;",!0),o=e("allLayers","maptalks-all-layers",r+"padding:0px;margin:0px;z-index:0;overflow:visible;",!0),a=e("backStatic","maptalks-back-static",r+"z-index:0;",!0),s=e("back","maptalks-back",r+"z-index:1;"),u=e("backLayer","maptalks-back-layer",r),c=e("canvasContainer","maptalks-canvas-layer",r+"border:none;z-index:2;"),l=e("frontStatic","maptalks-front-static",r+"z-index:3;",!0),h=e("front","maptalks-front",r+"z-index:4;",!0),f=e("frontLayer","maptalks-front-layer",r+"z-index:0;"),d=e("ui","maptalks-ui",r+"border:none;z-index:1;",!0),p=e("control","maptalks-control","z-index:1",!0);n.appendChild(i),o.appendChild(a),s.appendChild(u),o.appendChild(s),o.appendChild(c),h.appendChild(f),o.appendChild(l),o.appendChild(h),h.appendChild(d),i.appendChild(o),i.appendChild(p),this.createCanvas(),this.resetContainer();var v=this.map._getContainerDomSize();this.updateMapSize(v)}},n.isViewChanged=function(){var t=this._mapview,e=this._getMapView();return!t||!Q(t,e)},n._recordView=function(){var t=this.map;!t._onViewChange||t.isInteracting()||t.isAnimating()||Q(t.getView(),t._getCurrentView())||t._onViewChange(t.getView())},n.isSpatialReferenceChanged=function(){return this._spatialRefChanged},n._getMapView=function(){var t=this.map,e=t._getPrjCenter();return{x:e.x,y:e.y,zoom:t.getZoom(),pitch:t.getPitch(),bearing:t.getBearing(),width:t.width,height:t.height}},n._frameLoop=function(t){var e=this;this.map?(this.renderFrame(t),this._animationFrame=E(function(t){e._frameLoop(t)})):this._cancelFrameLoop()},n._cancelFrameLoop=function(){this._animationFrame&&O(this._animationFrame)},n._drawLayerCanvasImage=function(t,e){var n=this.context,r=e.point.round();ee.retina&&r._multi(2);var i=e.image,o=i.width,a=i.height;if(!(r.x+o<=0||r.y+a<=0)){var s=t.options.opacity;if(d(s)||(s=1),!(s<=0)){var u=e.opacity;if(d(u)||(u=1),!(u<=0)){var c=n.globalAlpha;s<1&&(n.globalAlpha*=s),u<1&&(n.globalAlpha*=u),t.options.cssFilter&&(n.filter=t.options.cssFilter);var l=this._zoomMatrix,h=!!t._getRenderer().__shouldZoomTransform,f=t.getRenderer().clipCanvas(this.context);l&&h&&(n.save(),n.setTransform.apply(n,l)),n.drawImage(i,0,0,o,a,r.x,r.y,o,a),l&&h&&n.restore(),f&&n.restore(),"none"!==n.filter&&(n.filter="none"),n.globalAlpha=c}}}},n._drawCenterCross=function(){var t=this.map.options.centerCross;if(t){var e=this.context,n=new oe(this.canvas.width/2,this.canvas.height/2);y(t)?t(e,n):Ke.drawCross(this.context,n,2,"#f00")}},n._drawFog=function(){var t=this.map;if(!(t.getPitch()<=t.options.maxVisualPitch)&&t.options.fog){var e=ee.retina?2:1,n=this.context,r=t.getContainerExtent(),i=(t.height-t._getVisualHeight(75))*e;i<0&&(i=0);var o=r.ymin*e,a=Math.ceil(o-i),s=t.options.fogColor.join(),u=n.createLinearGradient(0,i,0,o+30),c=1-30/(a+30);u.addColorStop(0,"rgba("+s+", 0)"),u.addColorStop(.3,"rgba("+s+", 0.3)"),u.addColorStop(c,"rgba("+s+", 1)"),u.addColorStop(1,"rgba("+s+", 0)"),n.beginPath(),n.fillStyle=u,n.fillRect(0,i,Math.ceil(r.getWidth())*e,Math.ceil(a+30))}},n._getAllLayerToRender=function(){return this.map._getLayers()},n.clearCanvas=function(){this.canvas&&Ke.clearRect(this.context,0,0,this.canvas.width,this.canvas.height)},n._updateCanvasSize=function(){if(!this.canvas||this._containerIsCanvas)return!1;var t=this.map.getSize(),e=this.canvas,n=ee.retina?2:1;return(t.width*n!==e.width||t.height*n!==e.height)&&(e.height=n*t.height,e.width=n*t.width,e.style&&(e.style.width=t.width+"px",e.style.height=t.height+"px"),!0)},n.createCanvas=function(){this._containerIsCanvas?this.canvas=this.map._containerDOM:(this.canvas=Te("canvas"),this._updateCanvasSize(),this.map._panels.canvasContainer.appendChild(this.canvas)),this.context=this.canvas.getContext("2d")},n._checkSize=function(){this.map&&!this.map.isInteracting()&&(Fe(this.map._containerDOM),this.map.checkSize())},n._setCheckSizeInterval=function(t){var e=this;clearInterval(this._resizeInterval),this._checkSizeInterval=t,this._resizeInterval=setInterval(function(){!e.map||e.map.isRemoved()?clearInterval(e._resizeInterval):e._checkSize()},this._checkSizeInterval)},n._registerEvents=function(){var t=this,e=this.map;e.options.checkSize&&!P&&"undefined"!=typeof window&&this._setCheckSizeInterval(1e3),ee.mobile||e.on("_mousemove",this._onMapMouseMove,this),e.on("_dragrotatestart _dragrotating _dragrotateend _movestart _moving _moveend _zoomstart",function(e){t._eventParam=e}),e.on("_zooming",function(n){e.getPitch()||(t._zoomMatrix=n.matrix.container),t._eventParam=n}),e.on("_zoomend",function(e){t._eventParam=e,delete t._zoomMatrix}),e.on("_spatialreferencechange",function(){t._spatialRefChanged=!0}),ee.webgl&&"undefined"!=typeof document&&Me(document,"visibilitychange",this._onVisibilitychange,this)},n._onMapMouseMove=function(t){var e=this,n=this.map;!n.isInteracting()&&n.options.hitDetect&&(this._hitDetectFrame&&O(this._hitDetectFrame),this._hitDetectFrame=E(function(){e.hitDetect(t.containerPoint)}))},n._getCanvasLayers=function(){return this.map._getLayers(function(t){return t.isCanvasRender()})},n._onVisibilitychange=function(){"visible"===document.visibilityState&&this.setToRedraw()},e}(Ko);Jn.registerRenderer("canvas",$o),Jn.mergeOptions({fog:!0,fogColor:[233,233,233]});var ta=Object.freeze({ResourceCache:Vn,CanvasRenderer:Gn,ImageGLRenderable:So,MapRenderer:Ko,MapCanvasRenderer:$o,Renderable:Fn,ImageLayerCanvasRenderer:Mo,ImageLayerGLRenderer:ko,TileLayerCanvasRenderer:Vo,TileLayerGLRenderer:Zo,CanvasTileLayerCanvasRenderer:Xo,CanvasTileLayerGLRenderer:Yo,OverlayLayerCanvasRenderer:Jo,VectorLayerCanvasRenderer:Qo,CanvasLayerRenderer:jo}),ea={_getRenderPoints:function(){return[[this._getCenter2DPoint(this.getMap().getGLZoom())],null]}};Lr.include(ea),Xr.include(ea),Hr.include(ea),Jr.include(ea),Yr.include({_getRenderPoints:function(t){var e=this.getMap();if("vertex"===t){for(var n=this._trimRing(this.getShell()),r=[],i=0,o=n.length;i<o;i++)r.push(e.coordToPoint(n[i],e.getGLZoom()));return[r,null]}return[[e.coordToPoint(this.getCenter(),e.getGLZoom())],null]}});var na={_getRenderPoints:function(t){var e,n=this.getMap(),r=n.getGLZoom(),i=null;if("point"===t)(e=this._getPath2DPoints(this._getPrjCoordinates(),!1,r))&&e.length>0&&Array.isArray(e[0])&&(e=e[0].concat(e[1]));else if("vertex"===t)if(i=[],(e=this._getPath2DPoints(this._getPrjCoordinates(),!1,r))&&e.length>0&&Array.isArray(e[0])){for(var o=0,a=e.length;o<a;o++)for(var s=0,u=e[o].length;s<u;s++)0===s?i.push([e[o][s],e[o][s+1]]):i.push([e[o][s-1],e[o][s]]);e=e[0].concat(e[1])}else for(var c=0,l=e.length;c<l;c++)0===c?i.push([e[c],e[c+1]]):i.push([e[c-1],e[c]]);else if("line"===t){e=[],i=[];var h=this._getPath2DPoints(this._getPrjCoordinates(),!1,r);if(h.length>0&&Array.isArray(h[0]))for(var f,d=1,p=h.length;d<p;d++){f=h[d],this instanceof jr&&f.length>0&&!f[0].equals(f[f.length-1])&&f.push(f[0]);for(var v=1,g=f.length;v<g;v++)e.push(f[v].add(f[v-1])._multi(.5)),i.push([f[v-1],f[v]])}else{this instanceof jr&&h.length>0&&!h[0].equals(h[h.length-1])&&h.push(h[0]);for(var y=1,m=h.length;y<m;y++)e.push(h[y].add(h[y-1])._multi(.5)),i.push([h[y-1],h[y]])}}else if("vertex-first"===t){var _=this._getPrjCoordinates();e=[n._prjToPoint(_[0],r)],i=[[n._prjToPoint(_[0],r),n._prjToPoint(_[1],r)]]}else if("vertex-last"===t){var b=this._getPrjCoordinates(),w=b.length;e=[n._prjToPoint(b[w-1],r)],i=[[n._prjToPoint(b[w-2],r),n._prjToPoint(b[w-1],r)]]}else{var x=this._getProjection().project(this.getCenter());e=[n._prjToPoint(x,r)]}return[e,i]}};Dr.include(na),jr.include(na),wr.include({_redrawWhenPitch:function(){return!1},_redrawWhenRotate:function(){return!1}});var ra={_redrawWhenPitch:function(){return!0},_redrawWhenRotate:function(){return this instanceof Xr||this instanceof Jr},_paintAsPath:function(){var t=this.getMap();return this._getPainter().getAltitude()>0||t.getPitch()||this instanceof Xr&&t.getBearing()},_getPaintParams:function(){var t=this.getMap();if(this._paintAsPath())return jr.prototype._getPaintParams.call(this,!0);var e=this._getPrjCoordinates(),n=t._prjToPoint(e,t.getGLZoom()),r=this._getRenderSize();return[n,r.width,r.height]},_paintOn:function(){return this._paintAsPath()?Ke.polygon.apply(Ke,arguments):Ke.ellipse.apply(Ke,arguments)},_getRenderSize:function(){var t=this.getMap(),e=t.getGLZoom(),n=this._getPrjExtent(),r=t._prjToPoint(n.getMin(),e),i=t._prjToPoint(n.getMax(),e);return new ae(Math.abs(i.x-r.x)/2,Math.abs(i.y-r.y)/2)}};Xr.include(ra),Hr.include(ra),Yr.include({_getPaintParams:function(){var t=this.getMap().getGLZoom(),e=this._getPrjShell();return[this._getPath2DPoints(e,!1,t)]},_paintOn:Ke.polygon}),Jr.include(ra,{_redrawWhenPitch:function(){return!0},_getPaintParams:function(){if(this._paintAsPath())return jr.prototype._getPaintParams.call(this,!0);var t=this.getMap();return[t._prjToPoint(this._getPrjCoordinates(),t.getGLZoom()),this._getRenderSize().width,[this.getStartAngle(),this.getEndAngle()]]},_paintOn:function(){if(this._paintAsPath())return Ke.polygon.apply(Ke,arguments);var t=this.getMap().getBearing(),e=arguments;return t&&(e[3]=e[3].slice(0),e[3][0]+=t,e[3][1]+=t),Ke.sector.apply(Ke,e)}}),kr.include({_paintAsPath:function(){return!0}}),Dr.include({arrowStyles:{classic:[3,4]},_getArrowShape:function(t,e,n,r,i){i||(i=0);var o,a=n*r[0],s=n*r[1]+i,u=a/2+i;(o=e.nextCtrlPoint||e.prevCtrlPoint?e.prevCtrlPoint?e.sub(new oe(e.prevCtrlPoint)):e.sub(new oe(e.nextCtrlPoint)):e.sub(t))._unit();var c=e.sub(o.multi(s));o._perp();var l=c.add(o.multi(u));return o._multi(-1),[l,e,c.add(o.multi(u)),l]},_getPaintParams:function(){var t=this._getPrjCoordinates();return[this._getPath2DPoints(t,!1,this.getMap().getGLZoom())]},_paintOn:function(t,e,n,r,i){this.options.smoothness?Ke.paintSmoothLine(t,e,n,this.options.smoothness,!1,this._animIdx,this._animTailRatio):Ke.path(t,e,n,null,i),this._paintArrow(t,e,n)},_getArrowPlacement:function(){return this.options.arrowPlacement},_getArrowStyle:function(){var t=this.options.arrowStyle;return t?Array.isArray(t)?t:this.arrowStyles[t]:null},_getArrows:function(t,e,n){var r=this._getArrowStyle();if(!r||t.length<2)return[];for(var i=t.length>0&&Array.isArray(t[0])?t:[t],o=this._getArrowPlacement(),a=[],s=this.getMap(),u=s.coordToContainerPoint(this.getFirstCoordinate()),c=s.coordToContainerPoint(this.getLastCoordinate()),l=i.length-1;l>=0;l--)("vertex-first"===o||"vertex-firstlast"===o&&i[l][0].closeTo(u,.01))&&a.push(this._getArrowShape(i[l][1],i[l][0],e,r,n)),"vertex-last"===o||"vertex-firstlast"===o&&i[l][i[l].length-1].closeTo(c,.01)?a.push(this._getArrowShape(i[l][i[l].length-2],i[l][i[l].length-1],e,r,n)):"point"===o&&this._getArrowPoints(a,i[l],e,r,n);return a},_getArrowPoints:function(t,e,n,r,i){for(var o=0,a=e.length-1;o<a;o++)t.push(this._getArrowShape(e[o],e[o+1],n,r,i))},_paintArrow:function(t,e,n){var r=this._getInternalSymbol().lineWidth;(!d(r)||r<3)&&(r=3);var i=this._getArrows(e,r);if(i.length){t.setLineDash&&t.setLineDash([]);for(var o=i.length-1;o>=0;o--)t.fillStyle=t.strokeStyle,Ke.polygon(t,i[o],n,n)}}}),jr.include({_getPaintParams:function(t){var e=this.getMap().getGLZoom(),n=this._getPrjShell(),r=this._getPath2DPoints(n,t,e),i=r.length>0&&Array.isArray(r[0]);i&&(r=[[r[0]],[r[1]]]);var o=this._getPrjHoles(),a=[];if(o&&o.length>0)for(var s=0;s<o.length;s++){var u=this._getPath2DPoints(o[s],t,e);Array.isArray(u)&&i?Array.isArray(u[0])?(r[0].push(u[0]),r[1].push(u[1])):r[0].push(u):a.push(u)}return i||k(r=[r],a),[r]},_paintOn:function(t,e,n,r,i){Ke.polygon(t,e,n,r,i,this.options.smoothness)}})}).call(this,n("8oxB"),n("yLpj"))},"7S6R":function(t,e){t.exports=function(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}},"7pNt":function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"c",function(){return o}),n.d(e,"a",function(){return a}),n.d(e,"d",function(){return s});var r="Failed to deduce GL constant from typed array";function i(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(r)}}function o(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).clamped,n=void 0===e||e;switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return n?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function a(t){var e=t.data,n=t.width,r=t.height,i=t.bytesPerPixel,o=void 0===i?4:i,a=t.temp,s=n*o;a=a||new Uint8Array(s);for(var u=0;u<r/2;++u){var c=u*s,l=(r-u-1)*s;a.set(e.subarray(c,c+s)),e.copyWithin(c,l,l+s),e.set(a,l)}}function s(t){for(var e=t.data,n=t.width,r=t.height,i=Math.round(n/2),o=Math.round(r/2),a=new Uint8Array(i*o*4),s=0;s<o;s++)for(var u=0;u<i;u++)for(var c=0;c<4;c++)a[4*(s*i+u)+c]=e[4*(2*s*n+2*u)+c];return{data:a,width:i,height:o}}},"8oxB":function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,c=[],l=!1,h=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):h=-1,c.length&&d())}function d(){if(!l){var t=s(f);l=!0;for(var e=c.length;e;){for(u=c,c=[];++h<e;)u&&u[h].run();h=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||l||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},"9lTW":function(t,e,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function r(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0}function i(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var o=n("MCLT"),a=Object.prototype.hasOwnProperty,s=Array.prototype.slice,u="foo"===function(){}.name;function c(t){return Object.prototype.toString.call(t)}function l(t){return!i(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var h=t.exports=y,f=/\s*function\s+([^\(\s]*)\s*/;function d(t){if(o.isFunction(t)){if(u)return t.name;var e=t.toString().match(f);return e&&e[1]}}function p(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function v(t){if(u||!o.isFunction(t))return o.inspect(t);var e=d(t);return"[Function"+(e?": "+e:"")+"]"}function g(t,e,n,r,i){throw new h.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function y(t,e){t||g(t,!0,e,"==",h.ok)}function m(t,e,n,a){if(t===e)return!0;if(i(t)&&i(e))return 0===r(t,e);if(o.isDate(t)&&o.isDate(e))return t.getTime()===e.getTime();if(o.isRegExp(t)&&o.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(l(t)&&l(e)&&c(t)===c(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===r(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(i(t)!==i(e))return!1;var u=(a=a||{actual:[],expected:[]}).actual.indexOf(t);return-1!==u&&u===a.expected.indexOf(e)||(a.actual.push(t),a.expected.push(e),function(t,e,n,r){if(null==t||null==e)return!1;if(o.isPrimitive(t)||o.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=_(t),a=_(e);if(i&&!a||!i&&a)return!1;if(i)return t=s.call(t),e=s.call(e),m(t,e,n);var u,c,l=x(t),h=x(e);if(l.length!==h.length)return!1;for(l.sort(),h.sort(),c=l.length-1;c>=0;c--)if(l[c]!==h[c])return!1;for(c=l.length-1;c>=0;c--)if(u=l[c],!m(t[u],e[u],n,r))return!1;return!0}(t,e,n,a))}return n?t===e:t==e}function _(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function b(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function w(t,e,n,r){var i;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=function(t){var e;try{t()}catch(t){e=t}return e}(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!i&&g(i,n,"Missing expected exception"+r);var a="string"==typeof r,s=!t&&i&&!n;if((!t&&o.isError(i)&&a&&b(i,n)||s)&&g(i,n,"Got unwanted exception"+r),t&&i&&n&&!b(i,n)||!t&&i)throw i}h.AssertionError=function(t){var e;this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=p(v((e=this).actual),128)+" "+e.operator+" "+p(v(e.expected),128),this.generatedMessage=!0);var n=t.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,n);else{var r=new Error;if(r.stack){var i=r.stack,o=d(n),a=i.indexOf("\n"+o);if(a>=0){var s=i.indexOf("\n",a+1);i=i.substring(s+1)}this.stack=i}}},o.inherits(h.AssertionError,Error),h.fail=g,h.ok=y,h.equal=function(t,e,n){t!=e&&g(t,e,n,"==",h.equal)},h.notEqual=function(t,e,n){t==e&&g(t,e,n,"!=",h.notEqual)},h.deepEqual=function(t,e,n){m(t,e,!1)||g(t,e,n,"deepEqual",h.deepEqual)},h.deepStrictEqual=function(t,e,n){m(t,e,!0)||g(t,e,n,"deepStrictEqual",h.deepStrictEqual)},h.notDeepEqual=function(t,e,n){m(t,e,!1)&&g(t,e,n,"notDeepEqual",h.notDeepEqual)},h.notDeepStrictEqual=function t(e,n,r){m(e,n,!0)&&g(e,n,r,"notDeepStrictEqual",t)},h.strictEqual=function(t,e,n){t!==e&&g(t,e,n,"===",h.strictEqual)},h.notStrictEqual=function(t,e,n){t===e&&g(t,e,n,"!==",h.notStrictEqual)},h.throws=function(t,e,n){w(!0,t,e,n)},h.doesNotThrow=function(t,e,n){w(!1,t,e,n)},h.ifError=function(t){if(t)throw t};var x=Object.keys||function(t){var e=[];for(var n in t)a.call(t,n)&&e.push(n);return e}}).call(this,n("yLpj"))},"9w8u":function(t,e,n){},A2OQ:function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n("1OyB"),i=n("vuIU"),o=n("md7G"),a=n("foSv"),s=n("Ji7U"),u=n("JX7q"),c=n("6Sts"),l=n("lvHR"),h=[34069,34070,34071,34072,34073,34074],f=function(t){function e(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.a)(this,e),(n=Object(o.a)(this,Object(a.a)(e).call(this,t,Object.assign({},i,{target:34067})))).initialize(i),Object.seal(Object(u.a)(Object(u.a)(n))),n}return Object(s.a)(e,t),Object(i.a)(e,[{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.format,n=void 0===e?6408:e,r=t.mipmaps,i=void 0===r||r,o=t.width,a=void 0===o?1:o,s=t.height,u=void 0===s?1:s,c=t.type,h=void 0===c?5121:c,f=t.dataFormat,d=this._deduceParameters({format:n,type:h,dataFormat:f});h=d.type,f=d.dataFormat;var p=this._deduceImageSize({data:t[34069],width:a,height:u});a=p.width,u=p.height,Object(l.a)(a===u),this.setCubeMapImageData(t),i&&this.generateMipmap(t),this.opts=t}},{key:"subImage",value:function(t){var e=t.face,n=t.data,r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o,s=t.mipmapLevel,u=void 0===s?0:s;return this._subImage({target:e,data:n,x:i,y:a,mipmapLevel:u})}},{key:"setCubeMapImageData",value:function(t){var e=t.width,n=t.height,r=t.pixels,i=t.data,o=t.border,a=void 0===o?0:o,s=t.format,u=void 0===s?6408:s,c=t.type,l=void 0===c?5121:c,f=(t.generateMipmap,this.gl);if(r=r||i,this.bind(),this.width||this.height)for(var d=0;d<h.length;d++){var p=h[d];f.texImage2D(p,0,u,e,n,a,u,l,r[p])}else for(var v=0;v<h.length;v++){var g=h[v];f.texImage2D(g,0,u,u,l,r[g])}}},{key:"bind",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).index;return void 0!==t&&this.gl.activeTexture(33984+t),this.gl.bindTexture(34067,this.handle),t}},{key:"unbind",value:function(){return this.gl.bindTexture(34067,null),this}}]),e}(c.a);f.FACES=h},AEOw:function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}},AqCL:function(t,e){t.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},AyRc:function(t,e,n){"use strict";(function(t){var r=n("U8pU");e.a="undefined"!=typeof window&&"object"===Object(r.a)(window.process)&&"renderer"===window.process.type||!(void 0===t||"object"!==Object(r.a)(t.versions)||!Boolean(t.versions.electron))||"object"===("undefined"==typeof navigator?"undefined":Object(r.a)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0}).call(this,n("8oxB"))},AzzA:function(t,e){t.exports=function(t,e){return t[0]=-e[0],t[1]=-e[1],t}},B7nP:function(t,e,n){"use strict";var r=n("ODXe"),i=n("dcnC"),o=n("ahXh"),a=n("IyWr"),s=n.n(a),u=n("J6RW"),c=n.n(u),l=n("Qizj"),h=n.n(l),f=n("T2Xe"),d=n.n(f),p=n("tz+0"),v=n.n(p);function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){if(n=t,!(null!=(r=e)&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?r[Symbol.hasInstance](n):n instanceof r))throw new TypeError("Cannot call a class as a function");var n,r}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _(t,e){return!e||"object"!==g(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}var b=[0,0,0],w=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return y(this,e),t=_(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,r,i),t}var n,r,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i["a"]),n=e,(r=[{key:"angle",value:function(t){return s()(this,t)}},{key:"cross",value:function(t){return c()(this,this,t),this.check()}},{key:"rotateX",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?b:n;return h()(this,this,r,e),this.check()}},{key:"rotateY",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?b:n;return d()(this,this,r,e),this.check()}},{key:"rotateZ",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?b:n;return v()(this,this,r,e),this.check()}},{key:"operation",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.apply(void 0,[this,this].concat(n)),this.check()}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(t){return this[2]=Object(o.a)(t)}}])&&m(n.prototype,r),a&&m(n,a),e}(),x=n("VKpO"),E=n("etCb"),O=n.n(E),P=n("nKJB"),S=n.n(P),T=n("b1F2"),C=n.n(T),A=n("6eGt"),M=n.n(A),k=n("/BFQ"),j=n.n(k),R=n("xDUe"),L=n.n(R),I=n("54ZI");n.d(e,"l",function(){return V}),n.d(e,"i",function(){return W}),n.d(e,"g",function(){return Z}),n.d(e,"j",function(){return H}),n.d(e,"c",function(){return X}),n.d(e,"b",function(){return Y}),n.d(e,"a",function(){return J}),n.d(e,"f",function(){return q}),n.d(e,"e",function(){return Q}),n.d(e,"d",function(){return K}),n.d(e,"k",function(){return $}),n.d(e,"h",function(){return tt});var D=Math.PI,F=D/4,N=D/180,B=180/D,U=512,z=4003e4,G=1.5;function V(t){return Math.pow(2,t)}function W(t){return Math.log2(t)}function Z(t,e){var n=Object(r.a)(t,2),i=n[0],o=n[1]*N;return[(e*=U)*(i*N+D)/(2*D),e*(D-Math.log(Math.tan(F+.5*o)))/(2*D)]}function H(t,e){var n=Object(r.a)(t,2),i=n[0],o=n[1],a=i/(e*=U)*(2*D)-D,s=2*(Math.atan(Math.exp(D-o/e*(2*D)))-F);return[a*B,s*B]}function X(t){var e=t.latitude;Object(I.a)(Number.isFinite(e));var n=Math.cos(e*N);return W(z*n)-9}function Y(t){var e=t.latitude,n=t.longitude,r=t.zoom,i=t.scale,o=t.highPrecision,a=void 0!==o&&o;i=void 0!==i?i:V(r),Object(I.a)(Number.isFinite(e)&&Number.isFinite(n)&&Number.isFinite(i));var s={},u=U*i,c=Math.cos(e*N),l=u/360,h=l/c,f=u/z/c;if(s.pixelsPerMeter=[f,-f,f],s.metersPerPixel=[1/f,-1/f,1/f],s.pixelsPerDegree=[l,-h,f],s.degreesPerPixel=[1/l,-1/h,1/f],a){var d=N*Math.tan(e*N)/c,p=l*d/2,v=u/z*d,g=v/h*f;s.pixelsPerDegree2=[0,-p,v],s.pixelsPerMeter2=[g,0,g]}return s}function J(t,e){var n=Object(r.a)(t,3),i=n[0],o=n[1],a=n[2],s=Object(r.a)(e,3),u=s[0],c=s[1],l=s[2],h=Y({longitude:i,latitude:o,scale:1,highPrecision:!0}),f=h.pixelsPerMeter,d=h.pixelsPerMeter2,p=Z(t,1);p[0]+=u*(f[0]+d[0]*c),p[1]+=c*(f[1]+d[1]*c);var v=H(p,1),g=(a||0)+(l||0);return Number.isFinite(a)||Number.isFinite(l)?[v[0],v[1],g]:v}function q(t){var e=t.height,n=t.pitch,r=t.bearing,i=t.altitude,o=t.center,a=void 0===o?null:o,s=t.flipY,u=void 0!==s&&s,c=Object(x.a)();return C()(c,c,[0,0,-i]),S()(c,c,[1,1,1/e]),M()(c,c,-n*N),j()(c,c,r*N),u&&S()(c,c,[1,-1,1]),a&&C()(c,c,new w(a).negate()),c}function Q(t){var e=t.width,n=t.height,r=t.altitude,i=void 0===r?G:r,o=t.pitch,a=void 0===o?0:o,s=t.nearZMultiplier,u=void 0===s?1:s,c=t.farZMultiplier,l=void 0===c?1:c,h=a*N,f=Math.atan(.5/i),d=Math.sin(f)*i/Math.sin(Math.PI/2-h-f),p=Math.cos(Math.PI/2-h)*d+i;return{fov:2*Math.atan(n/2/i),aspect:e/n,focalDistance:i,near:u,far:p*l}}function K(t){var e=t.width,n=t.height,r=t.pitch,i=Q({width:e,height:n,altitude:t.altitude,pitch:r,nearZMultiplier:t.nearZMultiplier,farZMultiplier:t.farZMultiplier}),o=i.fov,a=i.aspect,s=i.near,u=i.far;return O()([],o,a,s,u)}function $(t,e){var n=Object(r.a)(t,3),i=n[0],o=n[1],a=n[2],s=void 0===a?0:a;return Object(I.a)(Number.isFinite(i)&&Number.isFinite(o)&&Number.isFinite(s)),Object(x.d)(e,[i,o,s,1])}function tt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Object(r.a)(t,3),o=i[0],a=i[1],s=i[2];if(Object(I.a)(Number.isFinite(o)&&Number.isFinite(a)),Number.isFinite(s))return Object(x.d)(e,[o,a,s,1]);var u=Object(x.d)(e,[o,a,0,1]),c=Object(x.d)(e,[o,a,1,1]),l=u[2],h=c[2],f=l===h?0:((n||0)-l)/(h-l);return L()([],u,c,f)}},B93f:function(t,e,n){"use strict";var r=n("DiGy");function i(t,e,n){if(3===t){var i=new r(n,n.readVarint()+n.pos);i.length&&(e[i.name]=i)}}t.exports=function(t,e){this.layers=t.readFields(i,{},e)}},DRYM:function(t,e,n){"use strict";n.r(e);var r=n("bwSX"),i={value:function(){}};function o(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new a(r)}function a(t){this._=t}function s(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function u(t,e,n){for(var r=0,o=t.length;r<o;++r)if(t[r].name===e){t[r]=i,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}a.prototype=o.prototype={constructor:a,on:function(t,e){var n,r,i=this._,o=(r=i,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),a=-1,c=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<c;)if(n=(t=o[a]).type)i[n]=u(i[n],t.name,e);else if(null==e)for(n in i)i[n]=u(i[n],t.name,null);return this}for(;++a<c;)if((n=(t=o[a]).type)&&(n=s(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new a(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var c=o,l=function(t,e){var n,i,o,a,s=c("beforesend","progress","load","error"),u=Object(r.a)(),l=new XMLHttpRequest,h=null,f=null,d=0;function p(t){var e,r=l.status;if(!r&&function(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}(l)||r>=200&&r<300||304===r){if(o)try{e=o.call(n,l)}catch(t){return void s.call("error",n,t)}else e=l;s.call("load",n,e)}else s.call("error",n,t)}if("undefined"==typeof XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(t)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=l.ontimeout=p:l.onreadystatechange=function(t){l.readyState>3&&p(t)},l.onprogress=function(t){s.call("progress",n,t)},n={header:function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?u.get(t):(null==e?u.remove(t):u.set(t,e+""),n)},mimeType:function(t){return arguments.length?(i=null==t?null:t+"",n):i},responseType:function(t){return arguments.length?(a=t,n):a},timeout:function(t){return arguments.length?(d=+t,n):d},user:function(t){return arguments.length<1?h:(h=null==t?null:t+"",n)},password:function(t){return arguments.length<1?f:(f=null==t?null:t+"",n)},response:function(t){return o=t,n},get:function(t,e){return n.send("GET",t,e)},post:function(t,e){return n.send("POST",t,e)},send:function(e,r,o){return l.open(e,t,!0,h,f),null==i||u.has("accept")||u.set("accept",i+",*/*"),l.setRequestHeader&&u.each(function(t,e){l.setRequestHeader(e,t)}),null!=i&&l.overrideMimeType&&l.overrideMimeType(i),null!=a&&(l.responseType=a),d>0&&(l.timeout=d),null==o&&"function"==typeof r&&(o=r,r=null),null!=o&&1===o.length&&(o=function(t){return function(e,n){t(null==e?n:null)}}(o)),null!=o&&n.on("error",o).on("load",function(t){o(null,t)}),s.call("beforesend",n,l),l.send(null==r?null:r),n},abort:function(){return l.abort(),n},on:function(){var t=s.on.apply(s,arguments);return t===s?n:t}},null!=e){if("function"!=typeof e)throw new Error("invalid callback: "+e);return n.get(e)}return n};var h=function(t,e){return function(n,r){var i=l(n).mimeType(t).response(e);if(null!=r){if("function"!=typeof r)throw new Error("invalid callback: "+r);return i.get(r)}return i}},f=h("text/html",function(t){return document.createRange().createContextualFragment(t.responseText)}),d=h("application/json",function(t){return JSON.parse(t.responseText)}),p=h("text/plain",function(t){return t.responseText}),v=h("application/xml",function(t){var e=t.responseXML;if(!e)throw new Error("parse error");return e}),g={},y={},m=34,_=10,b=13;function w(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}")}var x=function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,s=0,u=o<=0,c=!1;function l(){if(u)return y;if(c)return c=!1,g;var e,r,i=a;if(t.charCodeAt(i)===m){for(;a++<o&&t.charCodeAt(a)!==m||t.charCodeAt(++a)===m;);return(e=a)>=o?u=!0:(r=t.charCodeAt(a++))===_?c=!0:r===b&&(c=!0,t.charCodeAt(a)===_&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}for(;a<o;){if((r=t.charCodeAt(e=a++))===_)c=!0;else if(r===b)c=!0,t.charCodeAt(a)===_&&++a;else if(r!==n)continue;return t.slice(i,e)}return u=!0,t.slice(i,o)}for(t.charCodeAt(o-1)===_&&--o,t.charCodeAt(o-1)===b&&--o;(r=l())!==y;){for(var h=[];r!==g&&r!==y;)h.push(r),r=l();e&&null==(h=e(h,s++))||i.push(h)}return i}function i(e){return e.map(o).join(t)}function o(t){return null==t?"":e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,o=r(t,function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=w(t);return function(r,i){return e(n(r),i,t)}}(t,e):w(t)});return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=function(t){var e=Object.create(null),n=[];return t.forEach(function(t){for(var r in t)r in e||n.push(e[r]=r)}),n}(e)),[n.map(o).join(t)].concat(e.map(function(e){return n.map(function(t){return o(e[t])}).join(t)})).join("\n")},formatRows:function(t){return t.map(i).join("\n")}}},E=x(","),O=E.parse,P=(E.parseRows,E.format,E.formatRows,x("\t")),S=P.parse,T=(P.parseRows,P.format,P.formatRows,function(t,e){return function(n,r,i){arguments.length<3&&(i=r,r=null);var o=l(n).mimeType(t);return o.row=function(t){return arguments.length?o.response(function(t,e){return function(n){return t(n.responseText,e)}}(e,r=t)):r},o.row(r),i?o.get(i):o}});var C=T("text/csv",O),A=T("text/tab-separated-values",S);n.d(e,"request",function(){return l}),n.d(e,"html",function(){return f}),n.d(e,"json",function(){return d}),n.d(e,"text",function(){return p}),n.d(e,"xml",function(){return v}),n.d(e,"csv",function(){return C}),n.d(e,"tsv",function(){return A})},DiGy:function(t,e,n){"use strict";var r=n("HfwV");function i(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(o,this,e),this.length=this._features.length}function o(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){var e=null,n=t.readVarint()+t.pos;for(;t.pos<n;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(n))}t.exports=i,i.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new r(this._pbf,e,this.extent,this._keys,this._values)}},FBcx:function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],v=e[12],g=e[13],y=e[14],m=e[15],_=n[0],b=n[1],w=n[2],x=n[3];return t[0]=_*r+b*s+w*h+x*v,t[1]=_*i+b*u+w*f+x*g,t[2]=_*o+b*c+w*d+x*y,t[3]=_*a+b*l+w*p+x*m,_=n[4],b=n[5],w=n[6],x=n[7],t[4]=_*r+b*s+w*h+x*v,t[5]=_*i+b*u+w*f+x*g,t[6]=_*o+b*c+w*d+x*y,t[7]=_*a+b*l+w*p+x*m,_=n[8],b=n[9],w=n[10],x=n[11],t[8]=_*r+b*s+w*h+x*v,t[9]=_*i+b*u+w*f+x*g,t[10]=_*o+b*c+w*d+x*y,t[11]=_*a+b*l+w*p+x*m,_=n[12],b=n[13],w=n[14],x=n[15],t[12]=_*r+b*s+w*h+x*v,t[13]=_*i+b*u+w*f+x*g,t[14]=_*o+b*c+w*d+x*y,t[15]=_*a+b*l+w*p+x*m,t}},FVJL:function(t,e,n){"use strict";var r=n("s4An");function i(t,e,n){return(i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&Object(r.a)(o,n.prototype),o}).apply(null,arguments)}var o=n("1OyB"),a=n("vuIU"),s=n("7pNt"),u=n("0vGO"),c=n("lvHR");n.d(e,"a",function(){return h});var l={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},h=function(){function t(){var e=this;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(t){return e._assign(t)}),Object.freeze(this)}return Object(a.a)(t,null,[{key:"getBytesPerElement",value:function(t){return Object(s.c)(t.type||5126).BYTES_PER_ELEMENT}},{key:"getBytesPerVertex",value:function(t){return Object(c.a)(t.size),Object(s.c)(t.type||5126).BYTES_PER_ELEMENT*t.size}},{key:"resolve",value:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return i(t,[l].concat(n))}}]),Object(a.a)(t,[{key:"toString",value:function(){return JSON.stringify(this)}},{key:"_assign",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0!==t.type&&(this.type!==t.type&&u.a.warn("accessor type mismatch"),this.type=t.type,5124!==t.type&&5125!==t.type||(this.integer=!0)),void 0!==t.size&&(this.size!==t.size&&u.a.warn("accessor size mismatch"),this.size=t.size),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.instanced&&(u.a.deprecated("Accessor.instanced","Accessor.divisor"),this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(u.a.deprecated("Accessor.isInstanced","Accessor.divisor"),this.divisor=t.isInstanced?1:0),void 0!==t.index&&(this.index=t.index?1:0),this}},{key:"BYTES_PER_ELEMENT",get:function(){return t.getBytesPerElement(this)}},{key:"BYTES_PER_VERTEX",get:function(){return t.getBytesPerVertex(this)}}]),t}()},Gujg:function(t,e,n){"use strict";n.d(e,"a",function(){return v});var r=n("1OyB"),i=n("vuIU"),o=n("md7G"),a=n("foSv"),s=n("Ji7U"),u=n("JX7q"),c=n("NaB/"),l=n("FVJL"),h=n("xo4u"),f=n("7pNt"),d=n("ket5"),p=n("lvHR"),v=function(t){function e(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.a)(this,e),(n=Object(o.a)(this,Object(a.a)(e).call(this,t,i))).stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),n.target=i.target||(n.gl.webgl2?36662:34962),n._initialize(i),Object.seal(Object(u.a)(Object(u.a)(n))),n}return Object(s.a)(e,t),Object(i.a)(e,[{key:"getElementCount",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/l.a.getBytesPerElement(t))}},{key:"getVertexCount",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/l.a.getBytesPerVertex(t))}},{key:"initialize",value:function(t){return this._initialize(t)}},{key:"setProps",value:function(t){return"data"in t&&this.setData(t),this}},{key:"setAccessor",value:function(t){return this.accessor=t,this}},{key:"reallocate",value:function(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}},{key:"setData",value:function(t){return this.initialize(t)}},{key:"subData",value:function(t){ArrayBuffer.isView(t)&&(t={data:t});var e=t,n=e.data,r=e.offset,i=void 0===r?0:r,o=e.srcOffset,a=void 0===o?0:o,s=t.byteLength||t.length;Object(p.a)(n);var u=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(u,this.handle),0!==a||void 0!==s?(Object(h.d)(this.gl),this.gl.bufferSubData(this.target,i,n,a,s)):this.gl.bufferSubData(u,i,n),this.gl.bindBuffer(u,null),this.debugData=null,this.accessor.type||this.setAccessor(new l.a(this.accessor,{type:Object(f.b)(n)})),this}},{key:"copyData",value:function(t){var e=t.sourceBuffer,n=t.readOffset,r=void 0===n?0:n,i=t.writeOffset,o=void 0===i?0:i,a=t.size,s=this.gl;return Object(h.d)(s),s.bindBuffer(36662,e.handle),s.bindBuffer(36663,this.handle),s.copyBufferSubData(36662,36663,r,o,a),s.bindBuffer(36662,null),s.bindBuffer(36663,null),this.debugData=null,this}},{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.dstData,n=void 0===e?null:e,r=t.srcByteOffset,i=void 0===r?0:r,o=t.dstOffset,a=void 0===o?0:o,s=t.length,u=void 0===s?0:s;Object(h.d)(this.gl);var c,l,d=Object(f.c)(this.accessor.type||5126,{clamped:!1}),v=this._getAvailableElementCount(i),g=a;n?c=(l=n.length)-g:l=g+(c=Math.min(v,u||v));var y=Math.min(v,c);return u=u||y,Object(p.a)(u<=y),n=n||new d(l),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,i,n,a,u),this.gl.bindBuffer(36662,null),n}},{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target,n=void 0===e?this.target:e,r=t.index,i=void 0===r?this.accessor&&this.accessor.index:r,o=t.offset,a=void 0===o?0:o,s=t.size;return 35345===n||35982===n?void 0!==s?this.gl.bindBufferRange(n,i,this.handle,a,s):(Object(p.a)(0===a),this.gl.bindBufferBase(n,i,this.handle)):this.gl.bindBuffer(n,this.handle),this}},{key:"unbind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target,n=void 0===e?this.target:e,r=t.index,i=void 0===r?this.accessor&&this.accessor.index:r;return 35345===n||35982===n?this.gl.bindBufferBase(n,i,null):this.gl.bindBuffer(n,null),this}},{key:"getDebugData",value:function(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:10}),{data:this.debugData,changed:!0})}},{key:"invalidateDebugData",value:function(){this.debugData=null}},{key:"_initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t.bytes&&d.g.deprecated("bytes","byteLength");var e=t.byteLength||t.bytes||0;return this.usage=t.usage||35044,this.setAccessor(new l.a(t,t.accessor)),t.data?this._setData(t.data):this._setByteLength(e)}},{key:"_setData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;Object(p.a)(ArrayBuffer.isView(t));var n=this._getTarget();this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,t,e),this.gl.bindBuffer(n,null),this.usage=e,this.debugData=t.slice(0,10),this.byteLength=t.byteLength,this.bytesUsed=t.byteLength;var r=Object(f.b)(t);return Object(p.a)(r),this.setAccessor(new l.a(this.accessor,{type:r})),this}},{key:"_setByteLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;Object(p.a)(t>=0);var n=t;0===t&&(n=new Float32Array(0));var r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,e),this.gl.bindBuffer(r,null),this.usage=e,this.debugData=null,this.byteLength=t,this.bytesUsed=t,this}},{key:"_getTarget",value:function(){return this.gl.webgl2?36663:this.target}},{key:"_getAvailableElementCount",value:function(t){var e=t/Object(f.c)(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-e}},{key:"_createHandle",value:function(){return this.gl.createBuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteBuffer(this.handle)}},{key:"_getParameter",value:function(t){this.gl.bindBuffer(this.target,this.handle);var e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}},{key:"updateAccessor",value:function(t){return d.g.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)"),this.accessor=new l.a(this.accessor,t),this}},{key:"setByteLength",value:function(t){return d.g.deprecated("setByteLength","reallocate"),this.reallocate(t)}},{key:"data",get:function(){d.g.removed("Buffer.data","N/A","v6.0")}},{key:"bytes",get:function(){return d.g.deprecated("Buffer.bytes","Buffer.byteLength","v6.1"),this.byteLength}}]),e}(c.a)},HfwV:function(t,e,n){"use strict";var r=n("xnQO");function i(t,e,n,r,i){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=i,t.readFields(o,this,e)}function o(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){var n=t.readVarint()+t.pos;for(;t.pos<n;){var r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function a(t){for(var e,n,r=0,i=0,o=t.length,a=o-1;i<o;a=i++)e=t[i],r+=((n=t[a]).x-e.x)*(e.y+n.y);return r}t.exports=i,i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,i=1,o=0,a=0,s=0,u=[];t.pos<n;){if(o<=0){var c=t.readVarint();i=7&c,o=c>>3}if(o--,1===i||2===i)a+=t.readSVarint(),s+=t.readSVarint(),1===i&&(e&&u.push(e),e=[]),e.push(new r(a,s));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&u.push(e),u},i.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,r=0,i=0,o=0,a=1/0,s=-1/0,u=1/0,c=-1/0;t.pos<e;){if(r<=0){var l=t.readVarint();n=7&l,r=l>>3}if(r--,1===n||2===n)(i+=t.readSVarint())<a&&(a=i),i>s&&(s=i),(o+=t.readSVarint())<u&&(u=o),o>c&&(c=o);else if(7!==n)throw new Error("unknown command "+n)}return[a,u,s,c]},i.prototype.toGeoJSON=function(t,e,n){var r,o,s=this.extent*Math.pow(2,n),u=this.extent*t,c=this.extent*e,l=this.loadGeometry(),h=i.types[this.type];function f(t){for(var e=0;e<t.length;e++){var n=t[e],r=180-360*(n.y+c)/s;t[e]=[360*(n.x+u)/s-180,360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90]}}switch(this.type){case 1:var d=[];for(r=0;r<l.length;r++)d[r]=l[r][0];f(l=d);break;case 2:for(r=0;r<l.length;r++)f(l[r]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var n,r,i=[],o=0;o<e;o++){var s=a(t[o]);0!==s&&(void 0===r&&(r=s<0),r===s<0?(n&&i.push(n),n=[t[o]]):n.push(t[o]))}n&&i.push(n);return i}(l),r=0;r<l.length;r++)for(o=0;o<l[r].length;o++)f(l[r][o])}1===l.length?l=l[0]:h="Multi"+h;var p={type:"Feature",geometry:{type:h,coordinates:l},properties:this.properties};return"id"in this&&(p.id=this.id),p}},I0ug:function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return i});var r=n("U8pU");function i(e){if("undefined"!=typeof window&&"object"===Object(r.a)(window.process)&&"renderer"===window.process.type)return!0;if(void 0!==t&&"object"===Object(r.a)(t.versions)&&Boolean(t.versions.electron))return!0;var n="object"===("undefined"==typeof navigator?"undefined":Object(r.a)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,i=e||n;return!!(i&&i.indexOf("Electron")>=0)}}).call(this,n("8oxB"))},IyWr:function(t,e,n){t.exports=function(t,e){var n=r(t[0],t[1],t[2]),a=r(e[0],e[1],e[2]);i(n,n),i(a,a);var s=o(n,a);return s>1?0:Math.acos(s)};var r=n("lXO8"),i=n("kTsV"),o=n("5Eg2")},J6RW:function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t}},JD4l:function(t,e,n){"use strict";n.d(e,"d",function(){return s}),n.d(e,"c",function(){return h}),n.d(e,"b",function(){return d}),n.d(e,"a",function(){return p});var r=n("1OyB"),i=n("oWct"),o=n("r9/M"),a=null,s=function(){throw new Error("luma.gl: loaded under Node.js without headless gl installed, meaning that WebGL contexts can not be created. This may not be an error. For example, this is a typical configuration for isorender applications running on the server.")};if(!o.a)try{s=n(1),a=n(2)}catch(t){}var u=function t(){Object(r.a)(this,t)},c=a||i.a,l=c.WebGLRenderingContext,h=void 0===l?u:l,f=(c.WebGLProgram,c.WebGLShader,c.WebGLBuffer),d=void 0===f?u:f;c.WebGLFramebuffer,c.WebGLRenderbuffer,c.WebGLTexture,c.WebGLUniformLocation,c.WebGLActiveInfo,c.WebGLShaderPrecisionFormat;var p=i.a.WebGL2RenderingContext||function t(){Object(r.a)(this,t)};i.a.Image},JX7q:function(t,e,n){"use strict";function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.d(e,"a",function(){return r})},"Jh/b":function(t,e,n){"use strict";var r=n("d3wX");e.a=new r.a({id:"deck"}).enable()},Ji7U:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n("s4An");function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Object(r.a)(t,e)}},K9nA:function(t,e,n){"use strict";(function(t,r){n.d(e,"b",function(){return a}),n.d(e,"a",function(){return s});var i=n("U8pU"),o={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==t&&t,document:"undefined"!=typeof document&&document,process:"object"===(void 0===r?"undefined":Object(i.a)(r))&&r},a=o.window||o.self||o.global,s=o.process||{};console}).call(this,n("yLpj"),n("8oxB"))},KQm4:function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.d(e,"a",function(){return r})},"L/7I":function(t,e,n){"use strict";var r=n("WsjP"),i=n("ggbK"),o=n("xo4u"),a=n("JD4l"),s="Failed to create WebGL context in Node.js, headless gl not available",u="Failed to create WebGL context in Node.js, headless gl returned null";var c,l=n("ket5"),h=l.c&&"undefined"!=typeof document,f=h&&"complete"===document.readyState;function d(){return c||(c=h?new Promise(function(t,e){if(h&&"complete"===document.readyState)return f=!0,void t(document);window.onload=function(){f=!0,t(document)}}):Promise.resolve({})),c}function p(t){var e,n=t.canvas,r=t.width,i=t.height,o=t.onError,a=void 0===o?function(){}:o;return"string"==typeof n?(f||a("createGLContext called on canvas '".concat(n,"' before page was loaded")),e=document.getElementById(n)):e=n||function(t){var e=t.width,n=void 0===e?800:e,r=t.height,i=void 0===r?600:r,o=t.id,a=void 0===o?"gl-canvas":o,s=t.insert,u=void 0===s||s,c=document.createElement("canvas");if(c.id=a,c.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",c.style.height=Number.isFinite(i)?"".concat(i,"px"):"100%",u){var l=document.body;l.insertBefore(c,l.firstChild)}return c}({id:"lumagl-canvas",width:r,height:i,onError:a}),e}var v=n("r+5q"),g=n("1OyB"),y=n("oWct");function m(t){return t.luma=t.luma||{},t.luma}function _(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).debug;return null===t?null:void 0===e||e?function(t){if(null===t)return null;if(!y.a.WebGLDebug)return l.g.warn('WebGL debug mode not activated. import "luma.gl/debug" to enable.')(),t;var e=m(t);if(e.realContext)return t;if(e.debugContext)return e.debugContext;var n=y.a.WebGLDebug.makeDebugContext(t,w,x);return Object.assign(function t(){Object(g.a)(this,t)}.prototype,n),e.debugContext=n,n.debug=!0,n.gl=t,l.g.info("debug context actived."),n}(t):function(t){if(null===t)return null;var e=m(t);return e.realContext?e.realContext:t}(t)}function b(t,e){var n=y.a.WebGLDebug.glFunctionArgsToString(t,e);return n="".concat(n.slice(0,100)).concat(n.length>100?"...":""),"gl.".concat(t,"(").concat(n,")")}function w(t,e,n){var r=y.a.WebGLDebug.glEnumToString(t),i=y.a.WebGLDebug.glFunctionArgsToString(e,n),o="".concat(r," in gl.").concat(e,"(").concat(i,")");if(l.g.throw)throw new Error(o);l.g.error(o)()}function x(t,e){var n;if(l.g.priority>=4&&(n=b(t,e),l.g.log(4,n)()),l.g.break){n=n||b(t,e);l.g.break&&l.g.break.every(function(t){return-1!==n.indexOf(t)})}var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){if(void 0===a.value){if(n=n||b(t,e),l.g.throw)throw new Error("Undefined argument: ".concat(n));l.g.error("Undefined argument: ".concat(n))}}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}var E,O=n("rePB");E={},Object(O.a)(E,33902,{gl1:new Float32Array([1,1])}),Object(O.a)(E,33901,{gl1:new Float32Array([1,1])}),Object(O.a)(E,3379,{gl1:64,gl2:2048}),Object(O.a)(E,34076,{gl1:16}),Object(O.a)(E,34930,{gl1:8}),Object(O.a)(E,35661,{gl1:8}),Object(O.a)(E,35660,{gl1:0}),Object(O.a)(E,34024,{gl1:1}),Object(O.a)(E,36348,{gl1:8}),Object(O.a)(E,34921,{gl1:8}),Object(O.a)(E,36347,{gl1:128}),Object(O.a)(E,36349,{gl1:16}),Object(O.a)(E,3386,{gl1:new Int32Array([0,0])}),Object(O.a)(E,32883,{gl1:0,gl2:256}),Object(O.a)(E,35071,{gl1:0,gl2:256}),Object(O.a)(E,37447,{gl1:0,gl2:0}),Object(O.a)(E,36063,{gl1:0,gl2:4}),Object(O.a)(E,35379,{gl1:0,gl2:0}),Object(O.a)(E,35374,{gl1:0,gl2:0}),Object(O.a)(E,35377,{gl1:0,gl2:0}),Object(O.a)(E,34852,{gl1:0,gl2:4}),Object(O.a)(E,36203,{gl1:0,gl2:0}),Object(O.a)(E,33001,{gl1:0,gl2:0}),Object(O.a)(E,33e3,{gl1:0,gl2:0}),Object(O.a)(E,37157,{gl1:0,gl2:0}),Object(O.a)(E,35373,{gl1:0,gl2:0}),Object(O.a)(E,35657,{gl1:0,gl2:0}),Object(O.a)(E,36183,{gl1:0,gl2:0}),Object(O.a)(E,37137,{gl1:0,gl2:0}),Object(O.a)(E,34045,{gl1:0,gl2:0}),Object(O.a)(E,35978,{gl1:0,gl2:0}),Object(O.a)(E,35979,{gl1:0,gl2:0}),Object(O.a)(E,35968,{gl1:0,gl2:0}),Object(O.a)(E,35376,{gl1:0,gl2:0}),Object(O.a)(E,35375,{gl1:0,gl2:0}),Object(O.a)(E,35659,{gl1:0,gl2:0}),Object(O.a)(E,37154,{gl1:0,gl2:0}),Object(O.a)(E,35371,{gl1:0,gl2:0}),Object(O.a)(E,35658,{gl1:0,gl2:0}),Object(O.a)(E,35076,{gl1:0,gl2:-8,negative:!0}),Object(O.a)(E,35077,{gl1:0,gl2:7}),Object(O.a)(E,35380,{gl1:0,gl2:0});var P=n("vuIU"),S=function(t){return t},T=new(function(){function t(){Object(g.a)(this,t),this.pendingQueries=new Set,this.invalidQueryType=null,this.invalidErrorMessage="",this.checkInvalid=function(){return!1}}return Object(P.a)(t,[{key:"poll",value:function(t){this.cancelInvalidQueries(t);var e=!0,n=!1,r=void 0;try{for(var i,o=this.pendingQueries.values()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;if(a.isResultAvailable()){var s=a.getResult();this.resolveQuery(a,s)}}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"setInvalidator",value:function(t){var e=t.queryType,n=t.errorMessage,r=t.checkInvalid;this.invalidQueryType=e,this.invalidErrorMessage=n,this.checkInvalid=r}},{key:"beginQuery",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S;this.cancelInvalidQueries(t.gl),this.cancelQuery(t);var r={};return t.promise=new Promise(function(t,e){r.resolve=t,r.reject=e}),Object.assign(t.promise,r),this.pendingQueries.add(t),t.promise.then(e).catch(n)}},{key:"resolveQuery",value:function(t,e){this.pendingQueries.delete(t),t.promise.resolve(e)}},{key:"rejectQuery",value:function(t,e){this.pendingQueries.delete(t),t.promise&&t.promise.reject(new Error(e))}},{key:"deleteQuery",value:function(t){return this.rejectQuery(t,"Query was deleted before result was available")}},{key:"cancelQuery",value:function(t){return this.rejectQuery(t,"Query was canceled before result was available")}},{key:"invalidateQuery",value:function(t){t instanceof this.invalidQueryType&&this.rejectQuery(t,this.invalidErrorMessage)}},{key:"cancelInvalidQueries",value:function(t){if(this.checkInvalid(t)){var e=!0,n=!1,r=void 0;try{for(var i,o=this.pendingQueries.values()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this.invalidateQuery(a)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}}}]),t}()),C=n("lvHR"),A=32874;function M(t){return Boolean(t&&(t instanceof o.a||t.TEXTURE_BINDING_3D===A))}var k={webgl2:!0,webgl1:!0,throwOnFailure:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function j(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e=Object.assign({},k,e),r=n.canvas,i=n.width,o=n.height,c=n.throwOnError,h=n.manageState,f=n.debug;function d(t){if(c)throw new Error(t);return null}l.c?t=function(t){var e=t.canvas,n=t.opts,r=void 0===n?{}:n,i=t.onError,o=void 0===i?function(t){return null}:i;function a(t){o("WebGL context: ".concat(t.statusMessage||"Unknown error"))}e.addEventListener("webglcontextcreationerror",a,!1);var s=r.webgl1,u=void 0===s||s,c=r.webgl2,l=void 0===c||c,h=null;return l&&(h=(h=h||e.getContext("webgl2",r))||e.getContext("experimental-webgl2",r)),u&&(h=(h=h||e.getContext("webgl",r))||e.getContext("experimental-webgl",r)),e.removeEventListener("webglcontextcreationerror",a,!1),h||o("Failed to create ".concat(l&&!u?"WebGL2":"WebGL"," context"))}({canvas:p({canvas:r,width:i,height:o,onError:d}),opts:e}):t=function(t){var e=t.width,n=t.height,r=t.opts,i=t.onError,o=r.webgl1;if(r.webgl2&&!o)return i("headless-gl does not support WebGL2");if(!a.d)return i(s);var c=Object(a.d)(e,n,r);return c||i(u)}({width:i,height:o,opts:e,onError:d});return t?(h&&Object(v.a)(t,{copyState:!1,log:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return l.g.log.apply(l.g,[1].concat(e))()}}),l.c&&f&&(t=_(t,{debug:f}),l.g.priority=Math.max(l.g.priority,1)),function(t){var e=M(t)?"WebGL2":"WebGL1",n=function(t){return function(t){var e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info");return{vendor:r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937)||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t)}(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";l.g.once(0,"".concat(e).concat(i," context ").concat(r))()}(t),t):null}var R=n("Sr2d"),L={VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],TIMER_QUERY:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],ELEMENT_INDEX_UINT32:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:["WEBGL_color_buffer_float","EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:[!1,"EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},I={};Object.keys(L).forEach(function(t){I[t]=t});function D(t,e){var n=L[e];Object(C.a)(n,e);var r=Object(o.n)(t)&&n[1]||n[0],i="string"==typeof r?Boolean(t.getExtension(r)):r;return Object(C.a)(!1===i||!0===i),i}function F(t,e){return N(t,e)}function N(t,e){return(e=Array.isArray(e)?e:[e]).every(function(e){return D(t,e)})}var B=n("Gujg"),U=n("md7G"),z=n("foSv"),G=n("Ji7U"),V=n("NaB/"),W="Shader: GLSL source code must be a JavaScript string",Z=35632,H=35633,X=function(t){function e(t,n){var r;Object(g.a)(this,e),Object(o.e)(t),Object(C.a)("string"==typeof n.source,W);var i=Object(o.k)(n.source,null)||n.id||Object(l.i)("unnamed ".concat(e.getTypeName(n.shaderType)));return(r=Object(U.a)(this,Object(z.a)(e).call(this,t,{id:i}))).shaderType=n.shaderType,r.source=n.source,r.initialize(n),r}return Object(G.a)(e,t),Object(P.a)(e,null,[{key:"getTypeName",value:function(t){switch(t){case H:return"vertex-shader";case Z:return"fragment-shader";default:return Object(C.a)(!1),"unknown"}}}]),Object(P.a)(e,[{key:"initialize",value:function(t){var e=t.source,n=Object(o.k)(e,null);n&&(this.id=Object(l.i)(n)),this._compile(e)}},{key:"getParameter",value:function(t){return this.gl.getShaderParameter(this.handle,t)}},{key:"toString",value:function(){return"".concat(this.getTypeName(this.shaderType),":").concat(this.id)}},{key:"getName",value:function(){return Object(o.k)(this.source)||"unnamed-shader"}},{key:"getSource",value:function(){return this.gl.getShaderSource(this.handle)}},{key:"getTranslatedSource",value:function(){var t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}},{key:"_compile",value:function(){if(this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){var t=this.gl.getShaderInfoLog(this.handle),e=Object(o.o)(t,this.source,this.shaderType,this.id),n=e.shaderName,r=e.errors,i=e.warnings;throw l.g.error("GLSL compilation errors in ".concat(n,"\n").concat(r))(),l.g.warn("GLSL compilation warnings in ".concat(n,"\n").concat(i))(),new Error("GLSL compilation errors in ".concat(n))}}},{key:"_deleteHandle",value:function(){this.gl.deleteShader(this.handle)}},{key:"_getOptsFromHandle",value:function(){return{type:this.getParameter(35663),source:this.getSource()}}}]),e}(V.a),Y=function(t){function e(t,n){return Object(g.a)(this,e),"string"==typeof n&&(l.g.deprecated("new FragmentShader(gl, source)","new FragmentShader(gl, {source})","6.1"),n={source:n}),Object(U.a)(this,Object(z.a)(e).call(this,t,Object.assign({},n,{shaderType:H})))}return Object(G.a)(e,t),Object(P.a)(e,[{key:"_createHandle",value:function(){return this.gl.createShader(H)}}]),e}(X),J=function(t){function e(t,n){return Object(g.a)(this,e),"string"==typeof n&&(l.g.deprecated("new FragmentShader(gl, source)","new FragmentShader(gl, {source})","6.1"),n={source:n}),Object(U.a)(this,Object(z.a)(e).call(this,t,Object.assign({},n,{shaderType:Z})))}return Object(G.a)(e,t),Object(P.a)(e,[{key:"_createHandle",value:function(){return this.gl.createShader(Z)}}]),e}(X);function q(t,e,n){return(q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Object(z.a)(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}var Q,K=n("JX7q"),$=n("6Sts"),tt=n("ODXe"),et=n("SR+o"),nt="EXT_color_buffer_float",rt=(Q={},Object(O.a)(Q,33189,{}),Object(O.a)(Q,33190,{gl2:!0}),Object(O.a)(Q,36012,{gl2:!0}),Object(O.a)(Q,36168,{}),Object(O.a)(Q,34041,{}),Object(O.a)(Q,35056,{gl2:!0}),Object(O.a)(Q,36013,{gl2:!0}),Object(O.a)(Q,32854,{}),Object(O.a)(Q,36194,{}),Object(O.a)(Q,32855,{}),Object(O.a)(Q,33321,{gl2:!0}),Object(O.a)(Q,33330,{gl2:!0}),Object(O.a)(Q,33329,{gl2:!0}),Object(O.a)(Q,33332,{gl2:!0}),Object(O.a)(Q,33331,{gl2:!0}),Object(O.a)(Q,33334,{gl2:!0}),Object(O.a)(Q,33333,{gl2:!0}),Object(O.a)(Q,33323,{gl2:!0}),Object(O.a)(Q,33336,{gl2:!0}),Object(O.a)(Q,33335,{gl2:!0}),Object(O.a)(Q,33338,{gl2:!0}),Object(O.a)(Q,33337,{gl2:!0}),Object(O.a)(Q,33340,{gl2:!0}),Object(O.a)(Q,33339,{gl2:!0}),Object(O.a)(Q,32849,{gl2:!0}),Object(O.a)(Q,32856,{gl2:!0}),Object(O.a)(Q,32857,{gl2:!0}),Object(O.a)(Q,36220,{gl2:!0}),Object(O.a)(Q,36238,{gl2:!0}),Object(O.a)(Q,36975,{gl2:!0}),Object(O.a)(Q,36214,{gl2:!0}),Object(O.a)(Q,36232,{gl2:!0}),Object(O.a)(Q,36226,{gl2:!0}),Object(O.a)(Q,36208,{gl2:!0}),Object(O.a)(Q,33325,{gl2:nt}),Object(O.a)(Q,33327,{gl2:nt}),Object(O.a)(Q,34842,{gl2:nt}),Object(O.a)(Q,33326,{gl2:nt}),Object(O.a)(Q,33328,{gl2:nt}),Object(O.a)(Q,34836,{gl2:nt}),Object(O.a)(Q,35898,{gl2:nt}),Q);var it=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(g.a)(this,e),(n=Object(U.a)(this,Object(z.a)(e).call(this,t,r))).initialize(r),Object.seal(Object(K.a)(Object(K.a)(n))),n}return Object(G.a)(e,t),Object(P.a)(e,null,[{key:"isSupported",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).format;return!e||function(t,e,n){var r=n[e];if(!r)return!1;var i=Object(o.n)(t)&&r.gl2||r.gl1;return"string"==typeof i?t.getExtension(i):i}(t,e,rt)}},{key:"getSamplesForFormat",value:function(t,e){var n=e.format;return t.getInternalformatParameter(36161,n,32937)}}]),Object(P.a)(e,[{key:"initialize",value:function(t){var e=t.format,n=t.width,r=void 0===n?1:n,i=t.height,a=void 0===i?1:i,s=t.samples,u=void 0===s?0:s;return Object(C.a)(e,"Needs format"),this.gl.bindRenderbuffer(36161,this.handle),0!==u&&Object(o.n)(this.gl)?this.gl.renderbufferStorageMultisample(36161,u,e,r,a):this.gl.renderbufferStorage(36161,e,r,a),this.format=e,this.width=r,this.height=a,this.samples=u,this}},{key:"resize",value:function(t){var e=t.width,n=t.height;return e!==this.width||n!==this.height?this.initialize({width:e,height:n,format:this.format,samples:this.samples}):this}},{key:"_createHandle",value:function(){return this.gl.createRenderbuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteRenderbuffer(this.handle)}},{key:"_bindHandle",value:function(t){this.gl.bindRenderbuffer(36161,t)}},{key:"_syncHandle",value:function(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}},{key:"_getParameter",value:function(t){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,t)}}]),e}(V.a),ot=256,at=1024,st=16384,ut=6144,ct=6145,lt=6146,ht=34041,ft="clear: bad arguments";function dt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.framebuffer,r=void 0===n?null:n,i=e.color,o=void 0===i?null:i,a=e.depth,s=void 0===a?null:a,u=e.stencil,c=void 0===u?null:u,l={};r&&(l.framebuffer=r);var h=0;o&&(h|=st,!0!==o&&(l.clearColor=o)),s&&(h|=ot,!0!==s&&(l.clearDepth=s)),c&&(h|=at,!0!==s&&(l.clearStencil=s)),Object(C.a)(0!==h,ft),Object(R.c)(t,l,function(){t.clear(h)})}var pt=n("7pNt");function vt(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Object(C.a)(!1),0}}var gt=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(g.a)(this,e),(n=Object(U.a)(this,Object(z.a)(e).call(this,t,r))).width=null,n.height=null,n.attachments={},n.readBuffer=36064,n.drawBuffers=[36064],n.initialize(r),Object.seal(Object(K.a)(Object(K.a)(n))),n}return Object(G.a)(e,t),Object(P.a)(e,[{key:"MAX_COLOR_ATTACHMENTS",get:function(){return this.gl.getParameter(this.gl.MAX_COLOR_ATTACHMENTS)}},{key:"MAX_DRAW_BUFFERS",get:function(){return this.gl.getParameter(this.gl.MAX_DRAW_BUFFERS)}}],[{key:"isSupported",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.colorBufferFloat,r=e.colorBufferHalfFloat;return n&&t.getExtension(Object(o.n)(t)?"EXT_color_buffer_float":"WEBGL.color_buffer_float"),r&&t.getExtension(Object(o.n)(t)?"EXT_color_buffer_float":"EXT_color_buffer_half_float")}},{key:"getDefaultFramebuffer",value:function(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new e(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}}]),Object(P.a)(e,[{key:"initialize",value:function(t){var e=t.width,n=void 0===e?1:e,r=t.height,i=void 0===r?1:r,o=t.attachments,a=void 0===o?null:o,s=t.color,u=void 0===s||s,c=t.depth,l=void 0===c||c,h=t.stencil,f=void 0!==h&&h,d=t.check,p=void 0===d||d,v=t.readBuffer,g=t.drawBuffers;if(Object(C.a)(n>=0&&i>=0,"Width and height need to be integers"),this.width=n,this.height=i,a)for(var y in a){var m=a[y];(Array.isArray(m)?m[0]:m).resize({width:n,height:i})}else a=this._createDefaultAttachments(u,l,f,n,i);this.update({clearAttachments:!0,attachments:a,readBuffer:v,drawBuffers:g}),a&&p&&this.checkStatus()}},{key:"update",value:function(t){var e=t.attachments,n=void 0===e?{}:e,r=t.readBuffer,i=t.drawBuffers,o=t.clearAttachments,a=void 0!==o&&o,s=t.resizeAttachments,u=void 0===s||s;this.attach(n,{clearAttachments:a,resizeAttachments:u});var c=this.gl,l=c.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),c.bindFramebuffer(36160,l||null),this}},{key:"resize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.width,n=t.height;if(null===this.handle)return Object(C.a)(void 0===e&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;for(var r in void 0===e&&(e=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&l.g.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(e,"x").concat(n)),this.attachments)this.attachments[r].resize({width:e,height:n});return this.width=e,this.height=n,this}},{key:"attach",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.clearAttachments,i=void 0!==r&&r,o=n.resizeAttachments,a=void 0===o||o,s={};i&&Object.keys(this.attachments).forEach(function(t){s[t]=null}),Object.assign(s,t);var u=this.gl.bindFramebuffer(36160,this.handle);for(var c in s){Object(C.a)(void 0!==c,"Misspelled framebuffer binding point?");var l=Number(c),h=s[l],f=h;if(f)if(f instanceof it)this._attachRenderbuffer({attachment:l,renderbuffer:f});else if(Array.isArray(h)){var d=Object(tt.a)(h,3),p=d[0],v=d[1],g=void 0===v?0:v,y=d[2],m=void 0===y?0:y;f=p,this._attachTexture({attachment:l,texture:p,layer:g,level:m})}else this._attachTexture({attachment:l,texture:f,layer:0,level:0});else this._unattach(l);a&&f&&f.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,u||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter(function(t){return!e.attachments[t]}).forEach(function(t){delete e.attachments[t]})}},{key:"checkStatus",value:function(){var t=this.gl,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);if(t.bindFramebuffer(36160,e||null),36053!==n)throw new Error(function(t){return(gt.STATUS||{})[t]||"Framebuffer error ".concat(t)}(n));return this}},{key:"clear",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.color,n=t.depth,r=t.stencil,i=t.drawBuffers,a=void 0===i?[]:i,s=this.gl.bindFramebuffer(36160,this.handle);return(e||n||r)&&dt(this.gl,{color:e,depth:n,stencil:r}),a.forEach(function(t,e){!function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.framebuffer,r=void 0===n?null:n,i=e.buffer,a=void 0===i?ut:i,s=e.drawBuffer,u=void 0===s?0:s,c=e.value,l=void 0===c?[0,0,0,0]:c;Object(o.d)(t),Object(R.c)(t,{framebuffer:r},function(){switch(a){case ut:switch(l.constructor){case Int32Array:t.clearBufferiv(a,u,l);break;case Uint32Array:t.clearBufferuiv(a,u,l);break;case Float32Array:default:t.clearBufferfv(a,u,l)}break;case ct:t.clearBufferfv(ct,0,[l]);break;case lt:t.clearBufferiv(lt,0,[l]);break;case ht:var e=Object(tt.a)(l,2),n=e[0],r=e[1];t.clearBufferfi(ht,0,n,r);break;default:Object(C.a)(!1,ft)}})}({drawBuffer:e,value:t})}),this.gl.bindFramebuffer(36160,s||null),this}},{key:"readPixels",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,o=t.width,a=void 0===o?this.width:o,s=t.height,u=void 0===s?this.height:s,c=t.format,l=void 0===c?6408:c,h=t.type,f=t.pixelArray,d=void 0===f?null:f,p=t.attachment,v=void 0===p?36064:p;this.gl;if(36064===v&&null===this.handle&&(v=1028),Object(C.a)(this.attachments[v]),h=h||this.attachments[v].type,!d){h=h||5121;var g=Object(pt.c)(h,{clamped:!1}),y=vt(l);d=d||new g(a*u*y)}h=h||Object(pt.b)(d);var m=this.gl.bindFramebuffer(36160,this.handle);return this.gl.readPixels(n,i,a,u,l,h,d),this.gl.bindFramebuffer(36160,m||null),d}},{key:"readPixelsToBuffer",value:function(t){var e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,a=t.width,s=void 0===a?this.width:a,u=t.height,c=void 0===u?this.height:u,l=t.format,h=void 0===l?6408:l,f=t.type,d=t.buffer,p=void 0===d?null:d,v=t.byteOffset,g=void 0===v?0:v,y=this.gl;if(Object(o.d)(y),f=f||(p?p.type:5121),!p){var m=vt(h),_=function(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return Object(C.a)(!1),0}}(f),b=g+s*c*m*_;p=new B.a(y,{bytes:b,type:f,size:m})}return p.bind({target:35051}),Object(R.c)(y,{framebuffer:this},function(){y.readPixels(n,i,s,c,h,f,g)}),p.unbind({target:35051}),p}},{key:"copyToDataUrl",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.attachment,n=void 0===e?36064:e,r=t.maxHeight,i=void 0===r?Number.MAX_SAFE_INTEGER:r,a=this.readPixels({attachment:n}),s=this.width,u=this.height;u>i;){var c=Object(o.q)({data:a,width:s,height:u});a=c.data,s=c.width,u=c.height}Object(o.h)({data:a,width:s,height:u});var l=document.createElement("canvas");l.width=s,l.height=u;var h=l.getContext("2d"),f=h.createImageData(s,u);return f.data.set(a),h.putImageData(f,0,0),l.toDataURL()}},{key:"copyToImage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.image,n=void 0===e?null:e,r=t.attachment,i=void 0===r?36064:r,o=t.maxHeight,a=(void 0===o&&Number.MAX_SAFE_INTEGER,this.readDataUrl({attachment:i}));return(n=n||new Image).src=a,n}},{key:"copyToTexture",value:function(t){var e=t.texture,n=t.target,r=t.xoffset,i=void 0===r?0:r,o=t.yoffset,a=void 0===o?0:o,s=t.zoffset,u=void 0===s?0:s,c=t.mipmapLevel,l=void 0===c?0:c,h=(t.attachment,t.x),f=void 0===h?0:h,d=t.y,p=void 0===d?0:d,v=t.width,g=t.height,y=this.gl,m=y.bindFramebuffer(36160,this.handle);switch(Object(C.a)(n||e),e&&(v=Number.isFinite(v)?v:e.width,g=Number.isFinite(g)?g:e.height,e.bind(0)),e.target){case 3553:case 34067:y.copyTexSubImage2D(n||e.target,l,i,a,f,p,v,g);break;case 35866:case 32879:y.copyTexSubImage3D(n||e.target,l,i,a,u,f,p,v,g)}return e&&e.unbind(),y.bindFramebuffer(36160,m||null),e}},{key:"blit",value:function(t){var e=t.srcFramebuffer,n=t.attachment,r=void 0===n?36064:n,i=t.srcX0,a=void 0===i?0:i,s=t.srcY0,u=void 0===s?0:s,c=t.srcX1,l=t.srcY1,h=t.dstX0,f=void 0===h?0:h,d=t.dstY0,p=void 0===d?0:d,v=t.dstX1,g=t.dstY1,y=t.color,m=void 0===y||y,_=t.depth,b=void 0!==_&&_,w=t.stencil,x=void 0!==w&&w,E=t.mask,O=void 0===E?0:E,P=t.filter,S=void 0===P?9728:P,T=this.gl;Object(o.d)(T),e.handle||36064!==r||(r=1028),m&&(O|=16384),b&&(O|=256),x&&(O|=1024),Object(C.a)(O),c=void 0===c?e.width:c,l=void 0===l?e.height:l,v=void 0===v?this.width:v,g=void 0===g?this.height:g;var A=T.bindFramebuffer(36009,this.handle),M=T.bindFramebuffer(36008,e.handle);return T.readBuffer(r),T.blitFramebuffer(a,u,c,l,f,p,v,g,O,S),T.readBuffer(this.readBuffer),T.bindFramebuffer(36008,M||null),T.bindFramebuffer(36009,A||null),this}},{key:"invalidate",value:function(t){var e=t.attachments,n=void 0===e?[]:e,r=t.x,i=void 0===r?0:r,a=t.y,s=void 0===a?0:a,u=t.width,c=t.height,l=this.gl;Object(o.d)(l);var h=l.bindFramebuffer(36008,this.handle);return 0===i&&0===s&&void 0===u&&void 0===c?l.invalidateFramebuffer(36008,n):l.invalidateFramebuffer(36008,n,i,s,u,c),l.bindFramebuffer(36008,h),this}},{key:"getAttachmentParameter",value:function(t,e,n){var r=this._getAttachmentParameterFallback(e);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&r>1e3&&(r=Object(i.c)(this.gl,r)),r}},{key:"getAttachmentParameters",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[],r={},o=!0,a=!1,s=void 0;try{for(var u,c=n[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;r[e?Object(i.c)(this.gl,l):l]=this.getAttachmentParameter(t,l,e)}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return r}},{key:"getParameters",value:function(){for(var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=Object.keys(this.attachments),n={},r=0;r<e.length;r++){var o=e[r],a=Number(o);n[t?Object(i.c)(this.gl,a):a]=this.getAttachmentParameters(a,t)}return n}},{key:"show",value:function(){return"undefined"!=typeof window&&window.open(this.copyToDataUrl(),"luma-debug-texture"),this}},{key:"log",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t>l.g.priority||"undefined"==typeof window)return this;e=e||"Framebuffer ".concat(this.id);var n=this.copyToDataUrl({maxHeight:100});return l.g.image({priority:t,message:e,image:n},e)(),this}},{key:"bind",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).target,e=void 0===t?36160:t;return this.gl.bindFramebuffer(e,this.handle),this}},{key:"unbind",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).target,e=void 0===t?36160:t;return this.gl.bindFramebuffer(e,null),this}},{key:"_createDefaultAttachments",value:function(t,e,n,r,i){var o,a=null;t&&((a=a||{})[36064]=new et.a(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:i,mipmaps:!1,parameters:(o={},Object(O.a)(o,10241,9728),Object(O.a)(o,10240,9728),Object(O.a)(o,10242,33071),Object(O.a)(o,10243,33071),o)}));return e&&n?(a=a||{})[33306]=new it(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}):e?(a=a||{})[36096]=new it(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:i}):n&&Object(C.a)(!1),a}},{key:"_unattach",value:function(t){var e=this.attachments[t];e&&(e instanceof it?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}},{key:"_attachRenderbuffer",value:function(t){var e=t.attachment,n=void 0===e?36064:e,r=t.renderbuffer;this.gl.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}},{key:"_attachTexture",value:function(t){var e=t.attachment,n=void 0===e?36064:e,r=t.texture,i=t.layer,o=t.level,a=this.gl;switch(a.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:a.framebufferTextureLayer(36160,n,r.target,o,i);break;case 34067:var s=function(t){return t<34069?t+34069:t}(i);a.framebufferTexture2D(36160,n,s,r.handle,o);break;case 3553:a.framebufferTexture2D(36160,n,3553,r.handle,o);break;default:Object(C.a)(!1,"Illegal texture type")}a.bindTexture(r.target,null),this.attachments[n]=r}},{key:"_setReadBuffer",value:function(t,e){Object(o.n)(t)?t.readBuffer(e):Object(C.a)(36064===e||1029===e,"Multiple render targets not supported"),this.readBuffer=e}},{key:"_setDrawBuffers",value:function(t,e){if(Object(o.n)(t))t.drawBuffers(e);else{var n=t.getExtension("WEBGL.draw_buffers");n?n.drawBuffersWEBGL(e):Object(C.a)(1===e.length&&(36064===e[0]||1029===e[0]),"Multiple render targets not supported")}this.drawBuffers=e}},{key:"_getAttachmentParameterFallback",value:function(t){var e=function(t){if(t.luma=t.luma||{},!t.luma.caps)for(var e in t.luma.caps={},t.luma.caps.webgl2=Object(o.n)(t),L)t.luma.caps[e]=D(t,e);return t.luma.caps}(this.gl);switch(t){case 36052:return e.webgl2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.webgl2?null:8;case 33297:return e.webgl2?null:5125;case 33296:return e.webgl2||e.EXT_sRGB?null:9729;default:return null}}},{key:"_createHandle",value:function(){return this.gl.createFramebuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteFramebuffer(this.handle)}},{key:"_bindHandle",value:function(t){return this.gl.bindFramebuffer(36160,t)}},{key:"color",get:function(){return this.attachments[36064]||null}},{key:"texture",get:function(){return this.attachments[36064]||null}},{key:"depth",get:function(){return this.attachments[36096]||this.attachments[33306]||null}},{key:"stencil",get:function(){return this.attachments[36128]||this.attachments[33306]||null}}]),e}(V.a);gt.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];var yt,mt=function(t){function e(t,n){var r;return Object(g.a)(this,e),Object(o.d)(t),r=Object(U.a)(this,Object(z.a)(e).call(this,t,n)),Object.seal(Object(K.a)(Object(K.a)(r))),r}return Object(G.a)(e,t),Object(P.a)(e,null,[{key:"isSupported",value:function(t){return Object(o.n)(t)}}]),Object(P.a)(e,[{key:"bind",value:function(t){return this.gl.bindSampler(t,this.handle),this}},{key:"unbind",value:function(t){return this.gl.bindSampler(t,null),this}},{key:"_createHandle",value:function(){return this.gl.createSampler()}},{key:"_deleteHandle",value:function(){this.gl.deleteSampler(this.handle)}},{key:"_getParameter",value:function(t){return this.gl.getSamplerParameter(this.handle,t)}},{key:"_setParameter",value:function(t,e){switch(t){case 33082:case 33083:this.gl.samplerParameterf(this.handle,t,e);break;default:this.gl.samplerParameteri(this.handle,t,e)}return this}}]),e}(V.a),_t=(yt={},Object(O.a)(yt,5126,function(t,e,n){return t.uniform1fv(e,Pt(n,1))}),Object(O.a)(yt,35664,function(t,e,n){return t.uniform2fv(e,Pt(n,2))}),Object(O.a)(yt,35665,function(t,e,n){return t.uniform3fv(e,Pt(n,3))}),Object(O.a)(yt,35666,function(t,e,n){return t.uniform4fv(e,Pt(n,4))}),Object(O.a)(yt,5124,function(t,e,n){return t.uniform1iv(e,St(n,1))}),Object(O.a)(yt,35667,function(t,e,n){return t.uniform2iv(e,St(n,2))}),Object(O.a)(yt,35668,function(t,e,n){return t.uniform3iv(e,St(n,3))}),Object(O.a)(yt,35669,function(t,e,n){return t.uniform4iv(e,St(n,4))}),Object(O.a)(yt,35670,function(t,e,n){return t.uniform1iv(e,St(n,1))}),Object(O.a)(yt,35671,function(t,e,n){return t.uniform2iv(e,St(n,2))}),Object(O.a)(yt,35672,function(t,e,n){return t.uniform3iv(e,St(n,3))}),Object(O.a)(yt,35673,function(t,e,n){return t.uniform4iv(e,St(n,4))}),Object(O.a)(yt,35674,function(t,e,n){return t.uniformMatrix2fv(e,!1,Pt(n,4))}),Object(O.a)(yt,35675,function(t,e,n){return t.uniformMatrix3fv(e,!1,Pt(n,9))}),Object(O.a)(yt,35676,function(t,e,n){return t.uniformMatrix4fv(e,!1,Pt(n,16))}),Object(O.a)(yt,35678,function(t,e,n){return t.uniform1i(e,n)}),Object(O.a)(yt,35680,function(t,e,n){return t.uniform1i(e,n)}),Object(O.a)(yt,5125,function(t,e,n){return t.uniform1uiv(e,Tt(n,1))}),Object(O.a)(yt,36294,function(t,e,n){return t.uniform2uiv(e,Tt(n,2))}),Object(O.a)(yt,36295,function(t,e,n){return t.uniform3uiv(e,Tt(n,3))}),Object(O.a)(yt,36296,function(t,e,n){return t.uniform4uiv(e,Tt(n,4))}),Object(O.a)(yt,35685,function(t,e,n){return t.uniformMatrix2x3fv(e,!1,Pt(n,6))}),Object(O.a)(yt,35686,function(t,e,n){return t.uniformMatrix2x4fv(e,!1,Pt(n,8))}),Object(O.a)(yt,35687,function(t,e,n){return t.uniformMatrix3x2fv(e,!1,Pt(n,6))}),Object(O.a)(yt,35688,function(t,e,n){return t.uniformMatrix3x4fv(e,!1,Pt(n,12))}),Object(O.a)(yt,35689,function(t,e,n){return t.uniformMatrix4x2fv(e,!1,Pt(n,8))}),Object(O.a)(yt,35690,function(t,e,n){return t.uniformMatrix4x3fv(e,!1,Pt(n,12))}),Object(O.a)(yt,35679,function(t,e,n){return t.uniform1i(e,n)}),Object(O.a)(yt,35682,function(t,e,n){return t.uniform1i(e,n)}),Object(O.a)(yt,36289,function(t,e,n){return t.uniform1i(e,n)}),Object(O.a)(yt,36292,function(t,e,n){return t.uniform1i(e,n)}),Object(O.a)(yt,36293,function(t,e,n){return t.uniform1i(e,n)}),Object(O.a)(yt,36298,function(t,e,n){return t.uniform1i(e,n)}),Object(O.a)(yt,36299,function(t,e,n){return t.uniform1i(e,n)}),Object(O.a)(yt,36300,function(t,e,n){return t.uniform1i(e,n)}),Object(O.a)(yt,36303,function(t,e,n){return t.uniform1i(e,n)}),Object(O.a)(yt,36306,function(t,e,n){return t.uniform1i(e,n)}),Object(O.a)(yt,36307,function(t,e,n){return t.uniform1i(e,n)}),Object(O.a)(yt,36308,function(t,e,n){return t.uniform1i(e,n)}),Object(O.a)(yt,36311,function(t,e,n){return t.uniform1i(e,n)}),yt),bt={},wt={},xt={},Et=[0];function Ot(t,e,n,r){1===e&&"boolean"==typeof t&&(t=t?1:0),Number.isFinite(t)&&(Et[0]=t,t=Et);var i=t.length;if(i%e&&l.g.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;var o=r[i];o||(o=new n(i),r[i]=o);for(var a=0;a<i;a++)o[a]=t[a];return o}function Pt(t,e){return Ot(t,e,Float32Array,bt)}function St(t,e){return Ot(t,e,Int32Array,wt)}function Tt(t,e){return Ot(t,e,Uint32Array,xt)}function Ct(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};var e=t.match(/([^\[]*)(\[[0-9]+\])?/);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:e[1],length:e[2]||1,isArray:Boolean(e[2])}}function At(t,e,n){var r=_t[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r.bind(null,t,e)}function Mt(t){return Array.isArray(t)||ArrayBuffer.isView(t)?function(t){if(0===t.length)return!1;for(var e=Math.min(t.length,16),n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t):!!isFinite(t)||(!0===t||!1===t||(t instanceof $.a||t instanceof mt||(t instanceof it||t instanceof gt&&Boolean(t.texture))))}function kt(t,e){if(Array.isArray(t)||ArrayBuffer.isView(t)){if(!e)return!1;var n=t.length;if(e.length!==n)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return t===e}var jt,Rt=n("FVJL"),Lt=5120,It=5121,Dt=5122,Ft=5123,Nt=0,Bt=1,Ut=2,zt=3,Gt=4,Vt=5,Wt=6,Zt=5126,Ht=(jt={},Object(O.a)(jt,Zt,[Zt,1,"float"]),Object(O.a)(jt,35664,[Zt,2,"vec2"]),Object(O.a)(jt,35665,[Zt,3,"vec3"]),Object(O.a)(jt,35666,[Zt,4,"vec4"]),Object(O.a)(jt,5124,[5124,1,"int"]),Object(O.a)(jt,35667,[5124,2,"ivec2"]),Object(O.a)(jt,35668,[5124,3,"ivec3"]),Object(O.a)(jt,35669,[5124,4,"ivec4"]),Object(O.a)(jt,5125,[5125,1,"uint"]),Object(O.a)(jt,36294,[5125,2,"uvec2"]),Object(O.a)(jt,36295,[5125,3,"uvec3"]),Object(O.a)(jt,36296,[5125,4,"uvec4"]),Object(O.a)(jt,35670,[Zt,1,"bool"]),Object(O.a)(jt,35671,[Zt,2,"bvec2"]),Object(O.a)(jt,35672,[Zt,3,"bvec3"]),Object(O.a)(jt,35673,[Zt,4,"bvec4"]),Object(O.a)(jt,35674,[Zt,8,"mat2"]),Object(O.a)(jt,35685,[Zt,8,"mat2x3"]),Object(O.a)(jt,35686,[Zt,8,"mat2x4"]),Object(O.a)(jt,35675,[Zt,12,"mat3"]),Object(O.a)(jt,35687,[Zt,12,"mat3x2"]),Object(O.a)(jt,35688,[Zt,12,"mat3x4"]),Object(O.a)(jt,35676,[Zt,16,"mat4"]),Object(O.a)(jt,35689,[Zt,16,"mat4x2"]),Object(O.a)(jt,35690,[Zt,16,"mat4x3"]),jt);function Xt(t){switch(t){case Nt:return Nt;case Bt:case zt:case Ut:return Bt;case Gt:case Vt:case Wt:return Gt;default:return Object(C.a)(!1),0}}function Yt(t){var e=Ht[t];if(!e)return null;var n=Object(tt.a)(e,2);return{type:n[0],components:n[1]}}function Jt(t,e){switch(t){case Lt:case It:case Dt:case Ft:t=Zt}for(var n in Ht){var r=Object(tt.a)(Ht[n],3),i=r[0],o=r[1],a=r[2];if(i===t&&o===e)return{glType:n,name:a}}return null}var qt=function(){function t(e){Object(g.a)(this,t),this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}return Object(P.a)(t,[{key:"getAttributeInfo",value:function(t){var e=Number(t);return Number.isFinite(e)?this.attributeInfos[e]:this.attributeInfosByName[t]||null}},{key:"getAttributeLocation",value:function(t){var e=this.getAttributeInfo(t);return e?e.location:-1}},{key:"getAttributeAccessor",value:function(t){var e=this.getAttributeInfo(t);return e?e.accessor:null}},{key:"getVaryingInfo",value:function(t){var e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}},{key:"getVaryingIndex",value:function(t){var e=this.getVaryingInfo();return e?e.location:-1}},{key:"getVaryingAccessor",value:function(t){var e=this.getVaryingInfo();return e?e.accessor:null}},{key:"_readAttributesFromProgram",value:function(t){for(var e=t.gl,n=e.getProgramParameter(t.handle,35721),r=0;r<n;r++){var i=e.getActiveAttrib(t.handle,r),o=i.name,a=i.type,s=i.size,u=e.getAttribLocation(t.handle,o);u>=0&&this._addAttribute(u,o,a,s)}this.attributeInfos.sort(function(t,e){return t.location-e.location})}},{key:"_readVaryingsFromProgram",value:function(t){var e=t.gl;if(Object(o.n)(e)){for(var n=e.getProgramParameter(t.handle,35971),r=0;r<n;r++){var i=e.getTransformFeedbackVarying(t.handle,r),a=i.name,s=i.type,u=i.size;this._addVarying(r,a,s,u)}this.varyingInfos.sort(function(t,e){return t.location-e.location})}}},{key:"_addAttribute",value:function(t,e,n,r){var i=Yt(n),o={type:i.type,size:r*i.components};this._inferProperties(t,e,o);var a={location:t,name:e,accessor:new Rt.a(o)};this.attributeInfos.push(a),this.attributeInfosByName[a.name]=a}},{key:"_inferProperties",value:function(t,e,n){/instance/i.test(e)&&(n.divisor=1)}},{key:"_addVarying",value:function(t,e,n,r){var i=Yt(n),o=i.type,a=i.components,s={location:t,name:e,accessor:new Rt.a({type:o,size:r*a})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}]),t}(),Qt=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(g.a)(this,e),(n=Object(U.a)(this,Object(z.a)(e).call(this,t,r))).stubRemovedMethods("Program","v6.0",["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"]),n._isCached=!1,n.initialize(r),Object.seal(Object(K.a)(Object(K.a)(n))),n._setId(r.id),n}return Object(G.a)(e,t),Object(P.a)(e,[{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.vs,n=t.fs,r=t.varyings,i=t.bufferMode,a=void 0===i?35981:i;return this.vs="string"==typeof e?new Y(this.gl,{id:"".concat(t.id,"-vs"),source:e}):e,this.fs="string"==typeof n?new J(this.gl,{id:"".concat(t.id,"-fs"),source:n}):n,Object(C.a)(this.vs instanceof Y),Object(C.a)(this.fs instanceof J),this.uniforms={},this.samplers={},r&&(Object(o.d)(this.gl),this.varyings=r,this.gl.transformFeedbackVaryings(this.handle,r,a)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new qt(this),this.setProps(t)}},{key:"delete",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isCached?this:q(Object(z.a)(e.prototype),"delete",this).call(this,t)}},{key:"setProps",value:function(t){return"uniforms"in t&&this.setUniforms(t.uniforms,t.samplers),this}},{key:"draw",value:function(t){var e=this,n=t.logPriority,r=t.drawMode,a=void 0===r?4:r,s=t.vertexCount,u=t.offset,c=void 0===u?0:u,h=t.start,f=t.end,d=t.isIndexed,p=void 0!==d&&d,v=t.indexType,g=void 0===v?5123:v,y=t.isInstanced,m=void 0!==y&&y,_=t.instanceCount,b=void 0===_?0:_,w=t.vertexArray,x=void 0===w?null:w,E=t.transformFeedback,O=t.framebuffer,P=t.parameters,S=void 0===P?{}:P,T=t.uniforms,A=void 0===T?{}:T,M=t.samplers,k=void 0===M?{}:M;if(void 0!==n){var j=O?O.id:"default",L="mode=".concat(Object(i.a)(this.gl,a)," verts=").concat(s," ")+"instances=".concat(b," indexType=").concat(Object(i.a)(this.gl,g)," ")+"isInstanced=".concat(m," isIndexed=").concat(p," ")+"Framebuffer=".concat(j);l.g.log(n,L)()}return this.gl.useProgram(this.handle),Object(C.a)(x),x.bindForDraw(s,b,function(){if(A&&(l.g.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)"),e.setUniforms(A,k)),e._bindTextures(),void 0!==O&&(S=Object.assign({},S,{framebuffer:O})),E){var t=Xt(a);E.begin(t)}Object(R.c)(e.gl,S,function(){p&&m?e.gl.drawElementsInstanced(a,s,g,c,b):p&&Object(o.n)(e.gl)&&!isNaN(h)&&!isNaN(f)?e.gl.drawRangeElements(a,h,f,s,g,c):p?e.gl.drawElements(a,s,g,c):m?e.gl.drawArraysInstanced(a,c,s,b):e.gl.drawArrays(a,c,s)}),E&&E.end()}),this}},{key:"setSamplers",value:function(t){Object.assign(this.samplers,t)}},{key:"setUniforms",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=!1,o={};for(var a in e)kt(this.uniforms[a],e[a])||(i=!0,o[a]=e[a],this.uniforms[a]=(t=e[a],Array.isArray(t)||ArrayBuffer.isView(t)?t.slice():t));return i&&(r(),function(t,e,n){for(var r in t){var i=t[r];if((!n||Boolean(n[r]))&&!Mt(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}}(o,this.id,this._uniformSetters),Object.assign(this.samplers,n),this._setUniforms(o)),this}},{key:"_bindTextures",value:function(){for(var t in this.uniforms){var e=this._uniformSetters[t];if(e&&void 0!==e.textureIndex){var n=this.uniforms[t],r=this.samplers[t];n instanceof gt&&(n=n.texture),n instanceof $.a&&n.bind(e.textureIndex),r&&r.bind(e.textureIndex)}}}},{key:"_setUniforms",value:function(t){for(var e in this.gl.useProgram(this.handle),t){var n=t[e],r=this._uniformSetters[e];if(r)if(n instanceof gt&&(n=n.texture),n instanceof $.a){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);var i=n,o=r.textureIndex;i.bind(o),r(o)}else r(n)}return this}},{key:"_createHandle",value:function(){return this.gl.createProgram()}},{key:"_deleteHandle",value:function(){this.gl.deleteProgram(this.handle)}},{key:"_getOptionsFromHandle",value:function(t){var e=this.gl.getAttachedShaders(t),n={},r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new Y({handle:u});break;case 35632:n.fs=new J({handle:u})}}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}},{key:"_getParameter",value:function(t){return this.gl.getProgramParameter(this.handle,t)}},{key:"_setId",value:function(t){if(!t){var e=this._getName();this.id=Object(l.i)(e)}}},{key:"_getName",value:function(){var t=this.vs.getName()||this.fs.getName();return t=(t=t.replace(/shader/i,""))?"".concat(t,"-program"):"program"}},{key:"_compileAndLink",value:function(){var t=this.gl;if((t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),l.g.time(4,"linkProgram for ".concat(this._getName()))(),t.linkProgram(this.handle),l.g.timeEnd(4,"linkProgram for ".concat(this._getName()))(),t.debug||l.g.priority>0)&&(t.validateProgram(this.handle),!t.getProgramParameter(this.handle,35714)))throw new Error("Error linking: ".concat(t.getProgramInfoLog(this.handle)))}},{key:"_readUniformLocationsFromLinkedProgram",value:function(){var t=this.gl;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(var e=0;e<this._uniformCount;e++){var n=this.gl.getActiveUniform(this.handle,e),r=Ct(n.name),i=r.name,o=(r.isArray,t.getUniformLocation(this.handle,i));this._uniformSetters[i]=At(t,o,n)}this._textureIndexCounter=0}},{key:"reset",value:function(){}},{key:"getActiveUniforms",value:function(t,e){return this.gl.getActiveUniforms(this.handle,t,e)}},{key:"getUniformBlockIndex",value:function(t){return this.gl.getUniformBlockIndex(this.handle,t)}},{key:"getActiveUniformBlockParameter",value:function(t,e){return this.gl.getActiveUniformBlockParameter(this.handle,t,e)}},{key:"uniformBlockBinding",value:function(t,e){this.gl.uniformBlockBinding(this.handle,t,e)}}]),e}(V.a),Kt=(n("A2OQ"),V.a,function(t){return t}),$t=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(g.a)(this,e),n=Object(U.a)(this,Object(z.a)(e).call(this,t,r));var i=r.onComplete,o=void 0===i?Kt:i,a=r.onError,s=void 0===a?Kt:a;return n.target=null,n.onComplete=o,n.onError=s,n.promise=null,Object.seal(Object(K.a)(Object(K.a)(n))),n}return Object(G.a)(e,t),Object(P.a)(e,null,[{key:"isSupported",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Object(o.n)(t),r=N(t,I.TIMER_QUERY),i=n||r,a=!0,s=!1,u=void 0;try{for(var c,l=e[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){switch(c.value){case"queries":i=i&&n;break;case"timers":i=i&&r;break;case"timestamps":var h=r?t.getQuery(36392,34916):0;i=i&&h>0;break;default:Object(C.a)(!1)}}}catch(t){s=!0,u=t}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}return i}}]),Object(P.a)(e,[{key:"beginTimeElapsedQuery",value:function(){return this.begin(35007)}},{key:"beginOcclusionQuery",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).conservative,e=void 0!==t&&t;return this.begin(e?36202:35887)}},{key:"beginTransformFeedbackQuery",value:function(){return this.begin(35976)}},{key:"getTimestamp",value:function(){T.beginQuery(this,this.onComplete,this.onError);try{this.gl.queryCounter(this.handle,36392)}catch(t){T.rejectQuery(this,'Timer queries require "EXT_disjoint_timer_query" extension')}return this}},{key:"begin",value:function(t){T.beginQuery(this,this.onComplete,this.onError),this.target=t;try{this.gl.beginQuery(this.target,this.handle)}catch(t){T.rejectQuery(this,"Query not supported")}return this}},{key:"end",value:function(){return this.target&&(this.gl.endQuery(this.target),this.target=null),this}},{key:"cancel",value:function(){return this.end(),T.cancelQuery(this),this}},{key:"isResultAvailable",value:function(){return this.gl.getQueryParameter(this.handle,34919)}},{key:"getResult",value:function(){var t=this.gl.getQueryParameter(this.handle,34918);return Number.isFinite(t)?t/1e6:0}},{key:"_createHandle",value:function(){return e.isSupported(this.gl)?this.gl.createQuery():null}},{key:"_deleteHandle",value:function(){T.deleteQuery(this),this.gl.deleteQuery(this.handle)}}],[{key:"poll",value:function(t){T.poll(t)}}]),e}(V.a);T.setInvalidator({queryType:$t,errorMessage:"Disjoint GPU operation invalidated timer queries",checkInvalid:function(t){return t.getParameter(36795)}});n("Nx27"),$.a;var te=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(g.a)(this,e),Object(o.d)(t),(n=Object(U.a)(this,Object(z.a)(e).call(this,t,r))).initialize(r),n.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(Object(K.a)(Object(K.a)(n))),n}return Object(G.a)(e,t),Object(P.a)(e,null,[{key:"isSupported",value:function(t){return Object(o.n)(t)}}]),Object(P.a)(e,[{key:"initialize",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Object(l.d)(this.buffers)||this.bind(function(){return t._unbindBuffers()}),this.setProps(e),this}},{key:"setProps",value:function(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}},{key:"setBuffers",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind(function(){for(var n in e)t.setBuffer(n,e[n])}),this}},{key:"setBuffer",value:function(t,e,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=this._getVaryingIndex(t);return o<0?(this.unused[t]=e,l.g.warn(function(){return"".concat(r.id," unused varying buffer ").concat(t)})(),this):(this.buffers[o]=e,this.bindOnUse||this._bindBuffer(o,e,n,i),this)}},{key:"begin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}},{key:"end",value:function(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}},{key:"_getVaryingInfo",value:function(t){return this.configuration&&this.configuration.getVaryingInfo(t)}},{key:"_getVaryingIndex",value:function(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;var e=Number(t);return Number.isFinite(e)?e:-1}},{key:"_bindBuffers",value:function(){if(this.bindOnUse)for(var t in this.buffers)this._bindBuffer(t,this.buffers[t])}},{key:"_unbindBuffers",value:function(){if(this.bindOnUse)for(var t in this.buffers)this._bindBuffer(t,null)}},{key:"_bindBuffer",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,i=e&&e.handle;return i&&void 0!==r?this.gl.bindBufferRange(35982,t,i,n,r):this.gl.bindBufferBase(35982,t,i),this}},{key:"_createHandle",value:function(){return this.gl.createTransformFeedback()}},{key:"_deleteHandle",value:function(){this.gl.deleteTransformFeedback(this.handle)}},{key:"_bindHandle",value:function(t){this.gl.bindTransformFeedback(36386,this.handle)}}]),e}(V.a),ee=null;function ne(t,e){var n;return new t((n=t.BYTES_PER_ELEMENT*e,(!ee||ee.byteLength<n)&&(ee=new ArrayBuffer(n)),ee),0,e)}var re=n("K9nA"),ie=n("5ku3"),oe=n("I0ug");var ae=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(g.a)(this,e);var i=r.id||r.program&&r.program.id;return(n=Object(U.a)(this,Object(z.a)(e).call(this,t,Object.assign({},r,{id:i})))).hasVertexArrays=e.isSupported(t),n.buffer=null,n.bufferValue=null,n.initialize(r),Object.seal(Object(K.a)(Object(K.a)(n))),n}return Object(G.a)(e,t),Object(P.a)(e,null,[{key:"isSupported",value:function(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).constantAttributeZero?Object(o.n)(t)||"Chrome"===function(t){if(!t&&!Object(ie.a)())return"Node";if(Object(oe.a)(t))return"Electron";var e="undefined"!=typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";var r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i?"IE":re.b.chrome?"Chrome":re.b.safari?"Safari":re.b.mozInnerScreenX?"Firefox":"Unknown"}():Object(o.n)(t)||t.getExtension("OES_vertex_array_object")}},{key:"getDefaultArray",value:function(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new e(t,{handle:null})),t.luma.defaultVertexArray}},{key:"getMaxAttributes",value:function(t){return e.MAX_ATTRIBUTES=e.MAX_ATTRIBUTES||t.getParameter(34921),e.MAX_ATTRIBUTES}},{key:"setConstant",value:function(t,n,r){switch(r.constructor){case Float32Array:e._setConstantFloatArray(t,n,r);break;case Int32Array:e._setConstantIntArray(t,n,r);break;case Uint32Array:e._setConstantUintArray(t,n,r);break;default:Object(l.a)(!1)}}}]),Object(P.a)(e,[{key:"delete",value:function(){q(Object(z.a)(e.prototype),"delete",this).call(this),this.buffer&&this.buffer.delete()}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.setProps(t)}},{key:"setProps",value:function(t){return this}},{key:"setElementBuffer",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(l.a)(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(function(){t.gl.bindBuffer(34963,e?e.handle:null)}),this}},{key:"setBuffer",value:function(t,e,n){if(34963===e.target)return this.setElementBuffer(e,n);var r=n.size,i=n.type,a=n.stride,s=n.offset,u=n.normalized,c=n.integer,h=n.divisor,f=this.gl;return t=Number(t),this.bind(function(){f.bindBuffer(34962,e.handle),c?(Object(l.a)(Object(o.n)(f)),f.vertexAttribIPointer(t,r,i,a,s)):f.vertexAttribPointer(t,r,i,u,a,s),f.enableVertexAttribArray(t),f.vertexAttribDivisor(t,h||0)}),this}},{key:"enable",value:function(t){var n=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!r&&0===t&&!e.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind(function(){return r?n.gl.enableVertexAttribArray(t):n.gl.disableVertexAttribArray(t)})),this}},{key:"getConstantBuffer",value:function(t,e,n){var r=this._normalizeConstantArrayValue(e,n),i=r.byteLength*t,o=r.length*t,a=!this.buffer;if(this.buffer=this.buffer||new B.a(this.gl,i),a=(a=a||this.buffer.setByteLength(i))||!this._compareConstantArrayValues(r,this.bufferValue)){var s=ne(e.constructor,o);!function(t){for(var e=t.target,n=t.source,r=t.start,i=void 0===r?0:r,o=t.count,a=void 0===o?1:o,s=n.length,u=a*s,c=0,l=i;c<s;c++)e[l++]=n[c];for(;c<u;)c<u-c?(e.copyWithin(i+c,i,i+c),c*=2):(e.copyWithin(i+c,i,i+u-c),c=u)}({target:s,source:r,start:0,count:o}),this.buffer.subData(s),this.bufferValue=e}return this.buffer}},{key:"_normalizeConstantArrayValue",value:function(t,e){return Array.isArray(t)?new Float32Array(t):t}},{key:"_compareConstantArrayValues",value:function(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}},{key:"_createHandle",value:function(){return this.hasVertexArrays=e.isSupported(this.gl),this.hasVertexArrays?this.gl.createVertexArray():null}},{key:"_deleteHandle",value:function(t){return this.hasVertexArrays&&this.gl.deleteVertexArray(t),[this.elements]}},{key:"_bindHandle",value:function(t){this.hasVertexArrays&&this.gl.bindVertexArray(t)}},{key:"_getParameter",value:function(t,e){var n=this,r=e.location;return Object(l.a)(Number.isFinite(r)),this.bind(function(){switch(t){case 34373:return n.gl.getVertexAttribOffset(r,t);default:return n.gl.getVertexAttrib(r,t)}})}},{key:"MAX_ATTRIBUTES",get:function(){return e.getMaxAttributes(this.gl)}}],[{key:"_setConstantFloatArray",value:function(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:Object(l.a)(!1)}}},{key:"_setConstantIntArray",value:function(t,e,n){switch(Object(l.a)(Object(o.n)(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:Object(l.a)(!1)}}},{key:"_setConstantUintArray",value:function(t,e,n){switch(Object(l.a)(Object(o.n)(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:Object(l.a)(!1)}}}]),e}(V.a),se=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(g.a)(this,t);var r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.vertexArrayObject=ae.isSupported(e)?new ae(e):ae.getDefaultArray(e),Object(l.h)(this,"VertexArray","v6.0",["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"]),this.initialize(n),Object.seal(this)}return Object(P.a)(t,[{key:"delete",value:function(){this.buffer&&this.buffer.delete()}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}},{key:"reset",value:function(){this.elements=null;var t=this.vertexArrayObject.MAX_ATTRIBUTES;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}},{key:"setProps",value:function(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}},{key:"clearDrawParams",value:function(){this.drawParams=null}},{key:"getDrawParams",value:function(t){return this.drawParams=this.drawParams||this._updateDrawParams(),Object.assign({},this.drawParams,t)}},{key:"setAttributes",value:function(t){var e=this;return this.vertexArrayObject.bind(function(){for(var n in t){var r=t[n];if(r instanceof B.a)e.setBuffer(n,r);else if(Array.isArray(r)&&r.length&&r[0]instanceof B.a){var i=r[0],o=r[1];e.setBuffer(n,i,o)}else{if(!ArrayBuffer.isView(r)&&!Array.isArray(r))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");e.setConstant(n,r)}}e.gl.bindBuffer(34962,null)}),this}},{key:"setElementBuffer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=t,this.clearDrawParams(),this.vertexArrayObject.isDefaultArray||this.vertexArrayObject.setElementBuffer(t,e),this}},{key:"setBuffer",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===e.target)return this.setElementBuffer(e);var r=this._resolveLocationAndAccessor(t,e,e.accessor,n),i=r.location,o=r.accessor;return i>=0&&(this.values[i]=e,this.accessors[i]=o,this.clearDrawParams(),this.vertexArrayObject.isDefaultArray||this.vertexArrayObject.setBuffer(i,e,o)),this}},{key:"setConstant",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this._resolveLocationAndAccessor(t,e,n),i=r.location,o=r.accessor;return i>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e,o),this.values[i]=e,this.accessors[i]=o,this.clearDrawParams(),this.vertexArrayObject.isDefaultArray||this.vertexArrayObject.enable(i,!1)),this}},{key:"unbindBuffers",value:function(){var t=this;return this.vertexArrayObject.bind(function(){t.elements&&t.setElementBuffer(null),t.buffer=t.buffer||new B.a(t.gl,{size:4});for(var e=0;e<t.vertexArrayObject.MAX_ATTRIBUTES;e++)t.values[e]instanceof B.a&&(t.gl.disableVertexAttribArray(e),t.gl.bindBuffer(34962,t.buffer.handle),t.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}},{key:"bindBuffers",value:function(){var t=this;return this.vertexArrayObject.bind(function(){t.elements&&t.setElementBuffer(t.elements);for(var e=0;e<t.vertexArrayObject.MAX_ATTRIBUTES;e++){var n=t.values[e];n instanceof B.a&&t.setBuffer(e,n)}}),this}},{key:"bindForDraw",value:function(t,e,n){var r,i=this;return this.vertexArrayObject.bind(function(){i._setConstantAttributes(t,e),i.vertexArrayObject.hasVertexArrays||i.bindBuffers(),r=n(),i.vertexArrayObject.hasVertexArrays||i.unbindBuffers()}),r}},{key:"_resolveLocationAndAccessor",value:function(t,e,n,r){var i=this,o=this._getAttributeIndex(t);if(!Number.isFinite(o)||o<0)return this.unused[t]=e,l.g.once(3,function(){return"unused value ".concat(t," in ").concat(i.id)})(),this;var a=this._getAttributeInfo(t),s=Rt.a.resolve(a.accessor,n,r),u=s.size,c=s.type;return Object(l.a)(Number.isFinite(u)&&Number.isFinite(c)),{location:o,accessor:s}}},{key:"_getAttributeInfo",value:function(t){return this.configuration&&this.configuration.getAttributeInfo(t)}},{key:"_getAttributeIndex",value:function(t){if(this.configuration)return this.configuration.getAttributeLocation(t);var e=Number(t);return Number.isFinite(e)?e:-1}},{key:"_setConstantAttributes",value:function(t,e){var n=Math.max(0|t,0|e),r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,n);for(var i=1;i<this.vertexArrayObject.MAX_ATTRIBUTES;i++)r=this.values[i],ArrayBuffer.isView(r)&&this._setConstantAttribute(i,r)}},{key:"_setConstantAttributeZero",value:function(t,e){if(ae.isSupported(this.gl,{constantAttributeZero:!0}))this._setConstantAttribute(0,t);else{var n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}}},{key:"_setConstantAttribute",value:function(t,e){ae.setConstant(this.gl,t,e),this.vertexArrayObject.isDefault&&this.vertexArrayObject.enable(t,!1)}},{key:"_updateDrawParams",value:function(){for(var t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0},e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elements.accessor.type),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}},{key:"_updateDrawParamsForLocation",value:function(t,e){var n=this.values[e],r=this.accessors[e];if(n){var i=r.divisor>0;if(t.isInstanced=t.isInstanced||i,n instanceof B.a){var o=n;if(i){var a=o.getVertexCount(r);t.instanceCount=Math.min(t.instanceCount,a)}else{var s=o.getVertexCount(r);t.vertexCount=Math.min(t.vertexCount,s)}}}}},{key:"setElements",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.g.deprecated("setElements","setElementBuffer"),this.setElementBuffer(t,e)}}]),t}(),ue=n("dByZ"),ce=n("zGma"),le=function(){function t(e){var n=e.id;e.display;Object(g.a)(this,t),this.id=n||Object(l.i)(this.constructor.name),this.display=!0,this.position=new ue.a,this.rotation=new ue.a,this.scale=new ue.a(1,1,1),this.matrix=new ce.a,this.userData={}}return Object(P.a)(t,[{key:"toString",value:function(){return"{id: ".concat(this.id,", children: ").concat(this.children,")}")}},{key:"setPosition",value:function(t){return Object(C.a)(3===t.length,"setPosition requires vector argument"),this.position=t,this}},{key:"setRotation",value:function(t){return Object(C.a)(3===t.length,"setRotation requires vector argument"),this.rotation=t,this}},{key:"setScale",value:function(t){return Object(C.a)(3===t.length,"setScale requires vector argument"),this.scale=t,this}},{key:"setMatrixComponents",value:function(t){var e=t.position,n=t.rotation,r=t.scale,i=t.update,o=void 0===i||i;return e&&this.setPosition(e),n&&this.setRotation(n),r&&this.setScale(r),o&&this.updateMatrix(),this}},{key:"updateMatrix",value:function(){var t=this.position,e=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(t),this.matrix.rotateXYZ(e),this.matrix.scale(n),this}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.position,n=t.rotation,r=t.scale;return e&&this.setPosition(e),n&&this.setRotation(n),r&&this.setScale(r),this.updateMatrix(),this}},{key:"getCoordinateUniforms",value:function(t,e){Object(C.a)(t),e=e||this.matrix;var n=new ce.a(t).multiplyRight(e),r=n.invert(),i=r.transpose();return{viewMatrix:t,modelMatrix:e,objectMatrix:e,worldMatrix:n,worldInverseMatrix:r,worldInverseTransposeMatrix:i}}},{key:"transform",value:function(){if(this.parent){var t=this.parent;this.endPosition.set(this.position.add(t.endPosition)),this.endRotation.set(this.rotation.add(t.endRotation)),this.endScale.set(this.scale.add(t.endScale))}else this.endPosition.set(this.position),this.endRotation.set(this.rotation),this.endScale.set(this.scale);for(var e=this.children,n=0;n<e.length;++n)e[n].transform();return this}}]),t}(),he=(n("KQm4"),function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(g.a)(this,t);var r=n.id,i=void 0===r?Object(l.i)("attribute"):r,o=n.type,a=n.isIndexed,s=void 0!==a&&a;this.gl=e,this.id=i,this.isIndexed=s,this.target=s?34963:34962,this.type=o,this.value=null,this.externalBuffer=null,this.buffer=null,this.userData={},this.update(n),Object.seal(this),this._validateAttributeDefinition()}return Object(P.a)(t,[{key:"delete",value:function(){this.buffer&&(this.buffer.delete(),this.buffer=null)}},{key:"update",value:function(t){var e=t.value,n=t.buffer,r=t.constant,i=void 0===r?this.constant||!1:r;this.constant=i,n?(this.externalBuffer=n,this.constant=!1,this.type=n.accessor.type,void 0!==n.accessor.divisor&&(this.divisor=n.accessor.divisor)):e&&(this.externalBuffer=null,this.value=e,i||(this.buffer=this.buffer||new B.a(this.gl,Object.assign({},t,{id:this.id,target:this.target,type:this.type})),this.buffer.setData({data:e}),this.type=this.buffer.accessor.type)),this._setAccessor(t)}},{key:"getBuffer",value:function(){return this.constant?null:this.externalBuffer||this.buffer}},{key:"getValue",value:function(){if(this.constant)return this.value;var t=this.externalBuffer||this.buffer;return t?[t,this]:null}},{key:"_setAccessor",value:function(t){var e=t.size,n=void 0===e?this.size:e,r=t.offset,i=void 0===r?this.offset||0:r,o=t.stride,a=void 0===o?this.stride||0:o,s=t.normalized,u=void 0===s?this.normalized||!1:s,c=t.integer,h=void 0===c?this.integer||!1:c,f=t.divisor,d=void 0===f?this.divisor||0:f,p=t.instanced,v=t.isInstanced;this.size=n,this.offset=i,this.stride=a,this.normalized=u,this.integer=h,this.divisor=d,void 0!==v&&(l.g.deprecated("Attribute.isInstanced"),this.divisor=v?1:0),void 0!==p&&(l.g.deprecated("Attribute.instanced"),this.divisor=p?1:0)}},{key:"_validateAttributeDefinition",value:function(){}}]),t}()),fe={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};function de(t){var e="string"==typeof t?fe[t]||fe.TRIANGLES:t;return Object(C.a)(e>=0&&e<=fe.TRIANGLE_FAN,"Illegal drawMode"),e}var pe=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(g.a)(this,t);var n=e.id,r=e.drawMode,i=void 0===r?fe.TRIANGLES:r,o=e.vertexCount,a=void 0===o?void 0:o,s=e.attributes;this.id=n||Object(l.i)(this.constructor.name),this.drawMode=de(i),this.vertexCount=a,this.attributes={},this.needsRedraw=!0,this.userData={},Object.seal(this),s&&this.setAttributes(s)}return Object(P.a)(t,[{key:"setNeedsRedraw",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.needsRedraw=t,this}},{key:"getNeedsRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).clearRedrawFlags,e=void 0!==t&&t,n=!1;return n=n||this.needsRedraw,this.needsRedraw=this.needsRedraw&&!e,n}},{key:"setVertexCount",value:function(t){this.vertexCount=t}},{key:"getVertexCount",value:function(){return void 0!==this.vertexCount?this.vertexCount:this.attributes.indices?this.attributes.indices.value.length:this.attributes.vertices?this.attributes.vertices.value.length/3:!!this.attributes.positions&&this.attributes.positions.value.length/3}},{key:"hasAttribute",value:function(t){return Boolean(this.attributes[t])}},{key:"getAttribute",value:function(t){var e=this.attributes[t];return Object(C.a)(e),e.value}},{key:"getArray",value:function(t){var e=this.attributes[t];return Object(C.a)(e),e.value}},{key:"getAttributes",value:function(){return this.attributes}},{key:"setAttributes",value:function(t){for(var e in t){var n=t[e];n=ArrayBuffer.isView(n)?{value:n}:n,Object(C.a)(ArrayBuffer.isView(n.value),"".concat(this._print(e),": must be typed array or object with value as typed array")),this._autoDetectAttribute(e,n),this.attributes[e]=n}return this.setNeedsRedraw(),this}},{key:"_autoDetectAttribute",value:function(t,e){var n;switch(t){case"indices":n=n||"indices";break;case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break;case"indices":e.size=e.size||1,e.isIndexed=void 0===e.isIndexed||e.isIndexed,Object(C.a)(e.value instanceof Uint16Array||e.value instanceof Uint32Array,'attribute array for "indices" must be of integer type')}Object(C.a)(e.size,"attribute ".concat(t," needs size"))}},{key:"_print",value:function(t){return"Geometry ".concat(this.id," attribute ").concat(t)}}]),t}(),ve="#define SHADER_NAME luma_modular_vertex\n\n// object attributes\nattribute vec3 positions;\nattribute vec3 normals;\nattribute vec4 colors;\nattribute vec2 texCoords;\nattribute vec3 pickingColors;\n\nvoid main(void) {\n\n  // Set up position\n#ifdef MODULE_GEOMETRY\n  geometry_setPosition(positions);\n  geometry_setNormal(normals);\n#endif\n\n#ifdef MODULE_PROJECT\n  project_setPositionAndNormal_Model(positions, normals);\n  gl_Position = project_model_to_clipspace(positions);\n#endif\n\n  // Set up depth\n#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n\n#ifdef MODULE_DIFFUSE\n  diffuse_setTextureCoordinate(texCoords);\n#endif\n\n  // Set up color calculations\n#ifdef MODULE_MATERIAL\n  material_setDiffuseColor(colors);\n  material_setDiffuseTextureCoordinates(texCoords);\n#endif\n\n#ifdef MODULE_LIGHTING\n  lighting_setPositionAndNormal(positions, normals);\n  lighting_apply_light(positions);\n  lighting_apply_reflection(positions);\n#endif\n\n#ifdef MODULE_PICKING\n  picking_setPickingColor(pickingColors);\n#endif\n\n}\n",ge="#define SHADER_NAME luma-modular-fragment\n\nprecision highp float;\n\n// varyings\nvarying vec4 vColor;\n\nvoid main(){\n  gl_FragColor = vec4(1., 0., 1., 1.);\n\n#ifdef MODULE_DIFFUSE\n  gl_FragColor = diffuse_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth(gl_Position);\n#endif\n}\n",ye="vs",me="fs";function _e(t,e,n){switch(e){case 300:return n?function(t){return t.replace(/attribute\s+/g,"in ").replace(/varying\s+/g,"out ").replace(/texture2D\(/g,"texture(").replace(/textureCube\(+/g,"texture(")}(t):function(t){return t.replace(/varying\s+/g,"in ").replace(/texture2D\(/g,"texture(").replace(/textureCube\(/g,"texture(")}(t);case 100:return n?function(t){return t.replace(/^in\s+/gm,"attribute ").replace(/^out\s+/gm,"varying ").replace(/texture\(/g,"texture2D(")}(t):function(t){return t.replace(/^in\s+/gm,"varying ").replace(/texture\(/g,"texture2D(")}(t);default:throw new Error("unknown GLSL version ".concat(e))}}function be(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}var we=function(){function t(e){var n=e.name,r=e.vs,i=e.fs,o=e.dependencies,a=void 0===o?[]:o,s=e.getUniforms,u=void 0===s?function(){return{}}:s,c=e.deprecations,l=void 0===c?[]:c,h=e.vertexShader,f=e.fragmentShader;Object(g.a)(this,t),be("string"==typeof n),this.name=n,this.vs=r||h,this.fs=i||f,this.getModuleUniforms=u,this.dependencies=a,this.deprecations=this._parseDeprecationDefinitions(l)}return Object(P.a)(t,[{key:"getModuleSource",value:function(t,e){var n;switch(t){case"vs":n=_e(this.vs||"",e,!0);break;case"fs":n=_e(this.fs||"",e,!1);break;default:be(!1)}return"string"!=typeof n?"":"#define MODULE_".concat(this.name.toUpperCase(),"\n").concat(n,"// END MODULE_").concat(this.name,"\n\n")}},{key:"getUniforms",value:function(t,e){return this.getModuleUniforms(t,e)}},{key:"checkDeprecations",value:function(t,e){this.deprecations.forEach(function(n){n.regex.test(t)&&(n.deprecated&&e?e.deprecated(n.old,n.new)():e&&e.removed(n.old,n.new)())})}},{key:"_parseDeprecationDefinitions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.forEach(function(t){switch(t.type){case"function":t.regex=new RegExp("\\b".concat(t.old,"\\("));break;default:t.regex=new RegExp("".concat(t.type," ").concat(t.old,";"))}}),t}}]),t}(),xe=new(function(){function t(){Object(g.a)(this,t),this.shaderModules={},this.defaultShaderModules=[]}return Object(P.a)(t,[{key:"setDefaultShaderModules",value:function(t){this.defaultShaderModules=this.resolveModules(t)}},{key:"registerShaderModules",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ignoreMultipleRegistrations,n=void 0!==e&&e,r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;this._registerShaderModule(u,n)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}},{key:"getShaderModule",value:function(t){if(t instanceof we)return t;if("string"!=typeof t)return this._registerShaderModule(t,!0);var e=this.shaderModules[t];return e||be(!1,"Unknown shader module ".concat(t)),e}},{key:"resolveModules",value:function(t){var e=this;return t.map(function(t){return e.getShaderModule(t)})}},{key:"_registerShaderModule",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t instanceof we)return t;if(be(t.name,"shader module has no name"),this.shaderModules[t.name]&&!e)throw new Error("shader module ".concat(t.name," already registered"));return(t=new we(t)).dependencies=this.resolveModules(t.dependencies),this.shaderModules[t.name]=t,this.shaderModules[t.name]}}]),t}());function Ee(t){xe.setDefaultShaderModules(t)}function Oe(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ignoreMultipleRegistrations,n=void 0!==e&&e;xe.registerShaderModules(t,{ignoreMultipleRegistrations:n})}function Pe(t){var e={},n={};return Se({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort(function(t,e){return n[e]-n[t]}).map(function(t){return e[t]})}function Se(t){var e=t.modules,n=t.level,r=t.moduleMap,i=t.moduleDepth;if(n>=5)throw new Error("Possible loop in shader dependency graph");var o=!0,a=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;r[l.name]=l,(void 0===i[l.name]||i[l.name]<n)&&(i[l.name]=n)}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}var h=!0,f=!1,d=void 0;try{for(var p,v=e[Symbol.iterator]();!(h=(p=v.next()).done);h=!0){var g=p.value;g.dependencies&&Se({modules:g.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}}catch(t){f=!0,d=t}finally{try{h||null==v.return||v.return()}finally{if(f)throw d}}}var Te=32874,Ce=7936,Ae=7937,Me=7938,ke=35724,je={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Re={};Object.keys(je).forEach(function(t){Re[t]=t});var Le={};function Ie(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=je[e];if(be(r,e),!function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e="undefined"!=typeof window&&window.navigator||{},n=t.userAgent||e.userAgent||"",r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i}(n))return!0;if(e in Le)return Le[e];var i=r[0],o=n.behavior||"enable",a="#extension GL_".concat(i," : ").concat(o,"\nvoid main(void) {}"),s=t.createShader(35633);t.shaderSource(s,a),t.compileShader(s);var u=t.getShaderParameter(s,35713);return t.deleteShader(s),Le[e]=u,u}function De(t,e){var n=je[e];be(n,e);var r=function(t){return Boolean(t&&("undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||32874===Te))}(t)&&n[1]||n[0],i="string"==typeof r?Boolean(t.getExtension(r)):r;return be(!1===i||!0===i),i}function Fe(t,e){return(e=Array.isArray(e)?e:[e]).every(function(e){return De(t,e)})}function Ne(t){switch(function(t){var e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||Ce),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||Ae);return{gpuVendor:function(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}(n,r),vendor:n,renderer:r,version:t.getParameter(Me),shadingLanguageVersion:t.getParameter(ke)}}(t).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}var Be,Ue,ze=n("9lTW"),Ge=n.n(ze),Ve=(Be={},Object(O.a)(Be,ye,"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n"),Object(O.a)(Be,me,"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"),Be),We=/void main\s*\([^\)]*\)\s*\{\n?/,Ze=/}\n?[^{}]*$/;function He(t){var e={};return Ge()(Array.isArray(t)&&t.length>1),t.forEach(function(t){for(var n in t)e[n]=e[n]?"".concat(e[n],"\n").concat(t[n]):t[n]}),e}var Xe=(Ue={},Object(O.a)(Ue,ye,"vertex"),Object(O.a)(Ue,me,"fragment"),Ue),Ye="precision highp float;\n\n";function Je(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.vs,r=e.fs,i=function(t){return t=t.concat(xe.defaultShaderModules),Pe(t=xe.resolveModules(t))}(e.modules||[]);return{gl:t,vs:qe(t,Object.assign({},e,{source:n,type:ye,modules:i})),fs:qe(t,Object.assign({},e,{source:r,type:me,modules:i})),getUniforms:Qe(i),modules:Ke(i)}}function qe(t,e){var n=e.id,r=e.source,i=e.type,o=e.modules,a=void 0===o?[]:o,s=e.defines,u=void 0===s?{}:s,c=e.inject,l=void 0===c?{}:c,h=e.prologue,f=void 0===h||h,d=e.log;be("string"==typeof r,"shader source must be a string");var p=i===ye,v=r.split("\n"),g=100,y="",m=r;0===v[0].indexOf("#version ")&&(g=300,y=v[0],m=v.slice(1).join("\n"));var _=f?"".concat(y,"\n").concat(function(t){var e=t.id,n=t.source,r=t.type;return e&&"string"==typeof e&&-1===n.indexOf("SHADER_NAME")?"\n#define SHADER_NAME ".concat(e,"_").concat(Xe[r],"\n\n"):""}({id:n,source:r,type:i}),"\n").concat(Ne(t),"\n").concat(function(t,e,n){var r="#if (__VERSION__ > 120)\n\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return Fe(t,Re.GLSL_FRAG_DEPTH)&&(r+="// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),Fe(t,Re.GLSL_DERIVATIVES)&&Ie(t,Re.GLSL_DERIVATIVES)&&(r+="// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define DERIVATIVES\n#endif\n"),Fe(t,Re.GLSL_FRAG_DATA)&&Ie(t,Re.GLSL_FRAG_DATA,{behavior:"require"})&&(r+="// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define DRAW_BUFFERS\n#endif\n"),Fe(t,Re.GLSL_TEXTURE_LOD)&&(r+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n# define TEXTURE_LOD\n#define texture2DLod texture2DLodEXT\n#define texture2DProjLod texture2DProjLodEXT\n#define texture2DProjLod texture2DProjLodEXT\n#define textureCubeLod textureCubeLodEXT\n#define texture2DGrad texture2DGradEXT\n#define texture2DProjGrad texture2DProjGradEXT\n#define texture2DProjGrad texture2DProjGradEXT\n#define textureCubeGrad textureCubeGradEXT\n#endif\n"),r}(t),"\n").concat(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=0,n="";for(var r in t){0===e&&(n+="\n// APPLICATION DEFINES\n"),e++;var i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],"\n"))}0===e&&(n+="\n");return n}(u),"\n").concat(p?"":Ye,"\n"):"".concat(y,"\n"),b=!1,w=!0,x=!1,E=void 0;try{for(var O,P=a[Symbol.iterator]();!(w=(O=P.next()).done);w=!0){var S=O.value;switch(S.name){case"inject":b=!0;break;default:S.checkDeprecations(m,d),_+=S.getModuleSource(i,g)}}}catch(t){x=!0,E=t}finally{try{w||null==P.return||P.return()}finally{if(x)throw E}}return _=function(t,e,n,r){var i=e===ye,o=function(e){var r=n[e];switch(e){case"vs:#decl":i&&(t=t.replace(We,function(t){return"".concat(r,"\n").concat(t)}));break;case"vs:#main-start":i&&(t=t.replace(We,function(t){return t+r}));break;case"vs:#main-end":i&&(t=t.replace(Ze,function(t){return r+t}));break;case"fs:#decl":i||(t=t.replace(We,function(t){return"".concat(r,"\n").concat(t)}));break;case"fs:#main-start":i||(t=t.replace(We,function(t){return t+r}));break;case"fs:#main-end":i||(t=t.replace(Ze,function(t){return r+t}));break;default:t=t.replace(e,function(t){return t+r})}};for(var a in n)o(a);return r&&(t=t.replace("}s*$",function(t){return t+Ve[e]})),t}(_+=m,i,l,b)}function Qe(t){return function(e){var n={},r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value.getUniforms(e,n);Object.assign(n,u)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}function Ke(t){var e,n={},r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value,c=(e=u,xe.getShaderModule(e));n[u]=c}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}var $e={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 0.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 0.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null};function tn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.fround(t),i=t-r;return e[n]=r,e[n+1]=i,e}var en="uniform float ONE;\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * ONE - (t - a);\n  float a_lo = a * ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * ONE;\n  float err = b - (sum - a) * ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *\n    a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n",nn="".concat(en,"\n").concat("const vec2 E_FP64 = vec2(2.7182817459106445e+00, 8.254840366817007e-08);\nconst vec2 LOG2_FP64 = vec2(0.6931471824645996e+00, -1.9046542121259336e-09);\nconst vec2 PI_FP64 = vec2(3.1415927410125732, -8.742278012618954e-8);\nconst vec2 TWO_PI_FP64 = vec2(6.2831854820251465, -1.7484556025237907e-7);\nconst vec2 PI_2_FP64 = vec2(1.5707963705062866, -4.371139006309477e-8);\nconst vec2 PI_4_FP64 = vec2(0.7853981852531433, -2.1855695031547384e-8);\nconst vec2 PI_16_FP64 = vec2(0.19634954631328583, -5.463923757886846e-9);\nconst vec2 PI_16_2_FP64 = vec2(0.39269909262657166, -1.0927847515773692e-8);\nconst vec2 PI_16_3_FP64 = vec2(0.5890486240386963, -1.4906100798128818e-9);\nconst vec2 PI_180_FP64 = vec2(0.01745329238474369, 1.3519960498364902e-10);\n\nconst vec2 SIN_TABLE_0_FP64 = vec2(0.19509032368659973, -1.6704714833615242e-9);\nconst vec2 SIN_TABLE_1_FP64 = vec2(0.3826834261417389, 6.22335089017767e-9);\nconst vec2 SIN_TABLE_2_FP64 = vec2(0.5555702447891235, -1.1769521357507529e-8);\nconst vec2 SIN_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617041793133e-8);\n\nconst vec2 COS_TABLE_0_FP64 = vec2(0.9807852506637573, 2.9739473106360492e-8);\nconst vec2 COS_TABLE_1_FP64 = vec2(0.9238795042037964, 2.8307490351764386e-8);\nconst vec2 COS_TABLE_2_FP64 = vec2(0.8314695954322815, 1.6870263741530778e-8);\nconst vec2 COS_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617152815436e-8);\n\nconst vec2 INVERSE_FACTORIAL_3_FP64 = vec2(1.666666716337204e-01, -4.967053879312289e-09);\nconst vec2 INVERSE_FACTORIAL_4_FP64 = vec2(4.16666679084301e-02, -1.2417634698280722e-09);\nconst vec2 INVERSE_FACTORIAL_5_FP64 = vec2(8.333333767950535e-03, -4.34617203337595e-10);\nconst vec2 INVERSE_FACTORIAL_6_FP64 = vec2(1.3888889225199819e-03, -3.3631094437103215e-11);\nconst vec2 INVERSE_FACTORIAL_7_FP64 = vec2(1.9841270113829523e-04,  -2.725596874933456e-12);\nconst vec2 INVERSE_FACTORIAL_8_FP64 = vec2(2.4801587642286904e-05, -3.406996025904184e-13);\nconst vec2 INVERSE_FACTORIAL_9_FP64 = vec2(2.75573188446287533e-06, 3.7935713937038186e-14);\nconst vec2 INVERSE_FACTORIAL_10_FP64 = vec2(2.755731998149713e-07, -7.575112367869873e-15);\n\nfloat nint(float d) {\n    if (d == floor(d)) return d;\n    return floor(d + 0.5);\n}\n\nvec2 nint_fp64(vec2 a) {\n    float hi = nint(a.x);\n    float lo;\n    vec2 tmp;\n    if (hi == a.x) {\n        lo = nint(a.y);\n        tmp = quickTwoSum(hi, lo);\n    } else {\n        lo = 0.0;\n        if (abs(hi - a.x) == 0.5 && a.y < 0.0) {\n            hi -= 1.0;\n        }\n        tmp = vec2(hi, lo);\n    }\n    return tmp;\n}\n\nvec2 exp_fp64(vec2 a) {\n  const int k_power = 4;\n  const float k = 16.0;\n\n  const float inv_k = 1.0 / k;\n\n  if (a.x <= -88.0) return vec2(0.0, 0.0);\n  if (a.x >= 88.0) return vec2(1.0 / 0.0, 1.0 / 0.0);\n  if (a.x == 0.0 && a.y == 0.0) return vec2(1.0, 0.0);\n  if (a.x == 1.0 && a.y == 0.0) return E_FP64;\n\n  float m = floor(a.x / LOG2_FP64.x + 0.5);\n  vec2 r = sub_fp64(a, mul_fp64(LOG2_FP64, vec2(m, 0.0))) * inv_k;\n  vec2 s, t, p;\n\n  p = mul_fp64(r, r);\n  s = sum_fp64(r, p * 0.5);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_3_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_4_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_5_FP64);\n\n  s = sum_fp64(s, t);\n  for (int i = 0; i < k_power; i++) {\n    s = sum_fp64(s * 2.0, mul_fp64(s, s));\n  }\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = sum_fp64(s, vec2(ONE, 0.0));\n#else\n  s = sum_fp64(s, vec2(1.0, 0.0));\n#endif\n\n  return s * pow(2.0, m);\n}\n\nvec2 log_fp64(vec2 a)\n{\n  if (a.x == 1.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x <= 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n  vec2 x = vec2(log(a.x), 0.0);\n  vec2 s;\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = vec2(ONE, 0.0);\n#else\n  s = vec2(1.0, 0.0);\n#endif\n\n  x = sub_fp64(sum_fp64(x, mul_fp64(a, exp_fp64(-x))), s);\n  return x;\n}\n\nvec2 sin_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(0.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  s = a;\n  r = a;\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_3_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_5_FP64);\n  s = sum_fp64(s, t);\n\n  return s;\n}\n\nvec2 cos_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(1.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  r = x;\n  s = sum_fp64(vec2(1.0, 0.0), r * 0.5);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_4_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_6_FP64);\n  s = sum_fp64(s, t);\n\n  return s;\n}\n\nvoid sincos_taylor_fp64(vec2 a, out vec2 sin_t, out vec2 cos_t) {\n  if (a.x == 0.0 && a.y == 0.0) {\n    sin_t = vec2(0.0, 0.0);\n    cos_t = vec2(1.0, 0.0);\n  }\n\n  sin_t = sin_taylor_fp64(a);\n  cos_t = sqrt_fp64(sub_fp64(vec2(1.0, 0.0), mul_fp64(sin_t, sin_t)));\n}\n\nvec2 sin_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return sin_taylor_fp64(t);\n        } else if (j == 1) {\n            return cos_taylor_fp64(t);\n        } else if (j == -1) {\n            return -cos_taylor_fp64(t);\n        } else {\n            return -sin_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 cos_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(1.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return cos_taylor_fp64(t);\n        } else if (j == 1) {\n            return -sin_taylor_fp64(t);\n        } else if (j == -1) {\n            return sin_taylor_fp64(t);\n        } else {\n            return -cos_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 tan_fp64(vec2 a) {\n    vec2 sin_a;\n    vec2 cos_a;\n\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n    vec2 sin_t, cos_t;\n    vec2 s, c;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#else\n        if (abs_k == 1) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs_k == 2) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs_k == 3) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs_k == 4) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#endif\n        if (k > 0) {\n            s = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            s = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return div_fp64(sin_a, cos_a);\n}\n\nvec2 radians_fp64(vec2 degree) {\n  return mul_fp64(degree, PI_180_FP64);\n}\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\nvoid vec2_sum_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sum_fp64(a[0], b[0]);\n    out_val[1] = sum_fp64(a[1], b[1]);\n}\n\nvoid vec2_sub_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sub_fp64(a[0], b[0]);\n    out_val[1] = sub_fp64(a[1], b[1]);\n}\n\nvoid vec2_mul_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = mul_fp64(a[0], b[0]);\n    out_val[1] = mul_fp64(a[1], b[1]);\n}\n\nvoid vec2_div_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = div_fp64(a[0], b[0]);\n    out_val[1] = div_fp64(a[1], b[1]);\n}\n\nvoid vec2_mix_fp64(vec2 x[2], vec2 y[2], float a, out vec2 out_val[2]) {\n  vec2 range[2];\n  vec2_sub_fp64(y, x, range);\n  vec2 portion[2];\n  portion[0] = range[0] * a;\n  portion[1] = range[1] * a;\n  vec2_sum_fp64(x, portion, out_val);\n}\n\nvec2 vec2_length_fp64(vec2 x[2]) {\n  return sqrt_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])));\n}\n\nvoid vec2_normalize_fp64(vec2 x[2], out vec2 out_val[2]) {\n  vec2 length = vec2_length_fp64(x);\n  vec2 length_vec2[2];\n  length_vec2[0] = length;\n  length_vec2[1] = length;\n\n  vec2_div_fp64(x, length_vec2, out_val);\n}\n\nvec2 vec2_distance_fp64(vec2 x[2], vec2 y[2]) {\n  vec2 diff[2];\n  vec2_sub_fp64(x, y, diff);\n  return vec2_length_fp64(diff);\n}\n\nvec2 vec2_dot_fp64(vec2 a[2], vec2 b[2]) {\n  vec2 v[2];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n\n  return sum_fp64(v[0], v[1]);\n}\nvoid vec3_sub_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec3_sum_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvec2 vec3_length_fp64(vec2 x[3]) {\n  return sqrt_fp64(sum_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])),\n    mul_fp64(x[2], x[2])));\n}\n\nvec2 vec3_distance_fp64(vec2 x[3], vec2 y[3]) {\n  vec2 diff[3];\n  vec3_sub_fp64(x, y, diff);\n  return vec3_length_fp64(diff);\n}\nvoid vec4_fp64(vec4 a, out vec2 out_val[4]) {\n  out_val[0].x = a[0];\n  out_val[0].y = 0.0;\n\n  out_val[1].x = a[1];\n  out_val[1].y = 0.0;\n\n  out_val[2].x = a[2];\n  out_val[2].y = 0.0;\n\n  out_val[3].x = a[3];\n  out_val[3].y = 0.0;\n}\n\nvoid vec4_scalar_mul_fp64(vec2 a[4], vec2 b, out vec2 out_val[4]) {\n  out_val[0] = mul_fp64(a[0], b);\n  out_val[1] = mul_fp64(a[1], b);\n  out_val[2] = mul_fp64(a[2], b);\n  out_val[3] = mul_fp64(a[3], b);\n}\n\nvoid vec4_sum_fp64(vec2 a[4], vec2 b[4], out vec2 out_val[4]) {\n  for (int i = 0; i < 4; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec4_dot_fp64(vec2 a[4], vec2 b[4], out vec2 out_val) {\n  vec2 v[4];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n  v[2] = mul_fp64(a[2], b[2]);\n  v[3] = mul_fp64(a[3], b[3]);\n\n  out_val = sum_fp64(sum_fp64(v[0], v[1]), sum_fp64(v[2], v[3]));\n}\n\nvoid mat4_vec4_mul_fp64(vec2 b[16], vec2 a[4], out vec2 out_val[4]) {\n  vec2 tmp[4];\n\n  for (int i = 0; i < 4; i++)\n  {\n    for (int j = 0; j < 4; j++)\n    {\n      tmp[j] = b[j + i * 4];\n    }\n    vec4_dot_fp64(a, tmp, out_val[i]);\n  }\n}\n"),rn={ONE:1};var on={name:"fp64",vs:nn,fs:null,fp64ify:tn,fp64LowPart:function(t){return t-Math.fround(t)},fp64ifyMatrix4:function(t){for(var e=new Float32Array(32),n=0;n<4;++n)for(var r=0;r<4;++r){var i=4*n+r;tn(t[4*r+n],e,2*i)}return e},getUniforms:function(){return Object.assign({},rn)}},an=("".concat(en),[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),sn={modelMatrix:an,viewMatrix:an,projectionMatrix:an,cameraPositionWorld:[0,0,0]};var un="varying vec4 project_vPositionWorld;\nvarying vec3 project_vNormalWorld;\n\nvec4 project_getPosition_World() {\n  return project_vPositionWorld;\n}\n\nvec3 project_getNormal_World() {\n  return project_vNormalWorld;\n}\n";"".concat(un,"\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewProjectionMatrix;\nuniform vec3 cameraPositionWorld;\n\nstruct World {\n  vec3 position;\n  vec3 normal;\n};\n\nWorld world;\n\nvoid project_setPosition(vec4 position) {\n  project_vPositionWorld = position;\n}\n\nvoid project_setNormal(vec3 normal) {\n  project_vNormalWorld = normal;\n}\n\nvoid project_setPositionAndNormal_World(vec3 position, vec3 normal) {\n  world.position = position;\n  world.normal = normal;\n}\n\nvoid project_setPositionAndNormal_Model(vec3 position, vec3 normal) {\n  world.position = (modelMatrix * vec4(position, 1.)).xyz;\n  world.normal = mat3(modelMatrix) * normal;\n}\n\nvec4 project_model_to_clipspace(vec4 position) {\n  return viewProjectionMatrix * modelMatrix * position;\n}\n\nvec4 project_model_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * modelMatrix * vec4(position, 1.);\n}\n\nvec4 project_world_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_view_to_clipspace(vec3 position) {\n  return projectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n"),"\n".concat(un);"".concat("\n","\n").concat("#define LIGHT_MAX 4\n\nuniform bool lighting_uEnableLights;\nuniform vec3 lighting_uAmbientColor;\nuniform vec3 lighting_uDirection;\nuniform vec3 lighting_uDirectionalColor;\nuniform int  lighting_uPointCount;\nuniform vec3 lighting_uPointLocation[LIGHT_MAX];\nuniform vec3 lighting_uPointColor[LIGHT_MAX];\nuniform bool lighting_uEnableReflections;\nvarying vec4 lighting_vPosition;\nvarying vec4 lighting_vNormal;\nvarying vec3 lighting_vColor;\nvarying vec3 lighting_vLightWeighting;\nvarying vec3 lighting_vReflection;\n\nvoid lighting_setPositionAndNormal(vec3 position, vec3 normal) {\n  lighting_vPosition = worldMatrix * vec4(position, 1.);\n  lighting_vNormal = worldInverseTransposeMatrix * vec4(normal, 1.);;\n}\n\nvoid lighting__getLightWeigting() {\n  float directionalLightWeighting = max(dot(lighting_vNormal.xyz, lighting_uDirection), 0.);\n  vec3 pointWeight = vec3(0., 0., 0.);\n  for (int i = 0; i < LIGHT_MAX; i++) {\n    if (i < numberPoints) {\n      vec4 mvLightPosition = viewMatrix * vec4(lighting_uPointLocation[i], 1.);\n      vec3 pointLightDirection = normalize(mvLightPosition.xyz - lighting_vPosition.xyz);\n      pointWeight += max(dot(lighting_vNormal.xyz, pointLightDirection), 0.) * pointColor[i];\n     } else {\n       break;\n     }\n   }\n   return ambientColor + (directionalColor * directionalLightWeighting) + pointWeight;\n}\n\nvoid lighting_apply(vec3 position, vec3 normal) {\n  lighting_setPositionAndNormal(position, normal);\n  if(!lighting_uEnableLights) {\n    lighting_vLightWeighting = vec3(1., 1., 1.);\n  } else {\n    lighting_vLightWeighting = lighting__getLightWeighting();\n  }\n}\n\nvoid lighting_set_reflection(vec3 position) {\n  if (lighting_uEnableReflections) {\n    lighting_vReflection = (viewInverseMatrix[3] - (worldMatrix * vec4(position, 1.))).xyz;\n  } else {\n    lighting_vReflection = vec3(1., 1., 1.);\n  }\n}\n","\n"),"".concat("\n","\n").concat("precision highp float;\n\n#define LIGHT_MAX 4\n\nvarying vec3 lighting_vLightWeighting;\n\nvec4 lighting_apply(vec4 color) {\n  return vec4(color.rgb * lighting_vLightWeighting, color.a);\n}\n\nuniform mat4 viewMatrix;\n\n\nvarying vec4 lighting_vColor;\nvarying vec4 lighting_vTransformedNormal;\nvarying vec4 lighting_vPosition;\n\nuniform float shininess;\nuniform bool enableSpecularMap;\nuniform bool enableLights;\n\nuniform vec3 ambientColor;\nuniform vec3 directionalColor;\nuniform vec3 lightingDirection;\n\nuniform vec3 lighting_uPointLocation[LIGHT_MAX];\nuniform vec3 lighting_uPointColor[LIGHT_MAX];\nuniform float lighting_uPointSpecularEnable[LIGHT_MAX];\nuniform vec3 lighting_uPointSpecularColor[LIGHT_MAX];\nuniform int numberPoints;\n\n\nvec3 lighting__calculate_light_weighting() {\n\treturn lighting__calculate_light_weighting(shininess);\n}\n\nvec3 lighting__calculate_light_weighting(shininess) {\n  vec3 normal = vTransformedNormal.xyz;\n  vec3 eyeDirection = normalize(-vPosition.xyz);\n\n  vec3 specularLight = vec3(0., 0., 0.);\n  vec3 diffuseLight = vec3(0., 0., 0.);\n\n  for (int i = 0; i < LIGHT_MAX; i++) {\n    if (i < numberPoints) {\n      vec3 transformedPointLocation = (viewMatrix * vec4(lighting_uPointLocation[i], 1.0)).xyz;\n      vec3 lightDirection = normalize(transformedPointLocation - vPosition.xyz);\n\n      if (lighting_uPointSpecularEnable > 0.) {\n        vec3 reflectionDirection = reflect(-lightDirection, normal);\n        float specularLightWeighting =\n          pow(max(dot(reflectionDirection, eyeDirection), 0.0), shininessVal);\n        specularLight += specularLightWeighting * lighting_uPointSpecularColor[i];\n      }\n\n      float diffuseLightWeighting = max(dot(normal, lightDirection), 0.0);\n      diffuseLight += diffuseLightWeighting * lighting_uPointColor[i];\n    } else {\n      break;\n    }\n  }\n\n  return ambientColor + diffuseLight + specularLight;\n}\n\nvoid lighting_filterColor(fragmentColor) {\n  if (!lighting_enable) {\n  \treturn fragmentColor;\n  } else {\n  \tvec3 lightWeighting = lighting__calculate_light_weighting();\n  \treturn vec4(fragmentColor.rgb * lightWeighting, fragmentColor.a);\n  }\n}\n\nuniform vec3 material_uAmbientColor;\nuniform vec3 material_uDiffuseColor;\nuniform vec3 material_uSpecularColor;\nuniform vec3 material_uEmissiveColor;\n\nuniform bool hasTexture1;\nuniform sampler2D sampler1;\n\nuniform mat4 viewMatrix;\n\nvoid apply_lighting(color) {\n  vec3 ambientLightWeighting = ambientColor;\n\n  vec3 normal = vTransformedNormal.xyz;\n  vec3 eyeDirection = normalize(-vPosition.xyz);\n\n  vec3 specularLight = vec3(0.0, 0.0, 0.0);\n  vec3 diffuseLight = vec3(0.0, 0.0, 0.0);\n\n  for (int i = 0; i < LIGHT_MAX; i++) {\n    if (i < numberPoints) {\n      vec3 transformedPointLocation = (viewMatrix * vec4(pointLocation[i], 1.0)).xyz;\n      vec3 lightDirection = normalize(transformedPointLocation - vPosition.xyz);\n\n      if (enableSpecularHighlights) {\n        vec3 reflectionDirection = reflect(-lightDirection, normal);\n        float specularLightWeighting =\n          pow(max(dot(reflectionDirection, eyeDirection), 0.0), shininess);\n        specularLight += specularLightWeighting * pointSpecularColor[i];\n      }\n\n      float diffuseLightWeighting = max(dot(normal, lightDirection), 0.0);\n      diffuseLight += diffuseLightWeighting * pointColor[i];\n    } else {\n        break;\n    }\n  }\n\n  vec3 matAmbientColor = material_uAmbientColor * color.rgb;\n  vec3 matDiffuseColor = material_uDiffuseColor * color.rgb;\n  vec3 matSpecularColor = material_uSpecularColor * color.rgb;\n  vec3 matEmissiveColor = material_uEmissiveColor * color.rgb;\n  gl_FragColor = vec4(\n    matAmbientColor * ambientLightWeighting\n    + matDiffuseColor * diffuseLightWeighting\n    + matSpecularColor * specularLightWeighting\n    + matEmissiveColor,\n    color.a\n  );\n}\n\n  vec3 lightWeighting;\n  if (!enableLights) {\n    lightWeighting = vec3(1.0, 1.0, 1.0);\n  } else {\n    vec3 lightDirection;\n    float specularLightWeighting = 0.0;\n    float diffuseLightWeighting = 0.0;\n    vec3  specularLight = vec3(0.0, 0.0, 0.0);\n    vec3  diffuseLight = vec3(0.0, 0.0, 0.0);\n\n    vec3 transformedPointLocation;\n    vec3 normal = vTransformedNormal.xyz;\n\n    vec3 eyeDirection = normalize(-vPosition.xyz);\n    vec3 reflectionDirection;\n\n    vec3 pointWeight = vec3(0.0, 0.0, 0.0);\n\n    for (int i = 0; i < LIGHT_MAX; i++) {\n      if (i < numberPoints) {\n        transformedPointLocation = (viewMatrix * vec4(pointLocation[i], 1.0)).xyz;\n        lightDirection = normalize(transformedPointLocation - vPosition.xyz);\n\n        if (enableSpecular[i] > 0.0) {\n          reflectionDirection = reflect(-lightDirection, normal);\n          specularLightWeighting = pow(max(dot(reflectionDirection, eyeDirection), 0.0), shininess);\n          specularLight += specularLightWeighting * pointSpecularColor[i];\n        }\n\n        diffuseLightWeighting = max(dot(normal, lightDirection), 0.0);\n        diffuseLight += diffuseLightWeighting * pointColor[i];\n      } else {\n        break;\n      }\n    }\n\n    lightWeighting = ambientColor + diffuseLight + specularLight;\n  }\nuniform float reflection;\nuniform float refraction;\n","\n"),new Float32Array([1,1,2]);var cn={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingThreshold:1,pickingActive:!1};var ln={name:"picking",vs:"uniform vec3 picking_uSelectedColor;\nuniform float picking_uThreshold;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Aselected;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    abs(vertexColor.r - picking_uSelectedColor.r) < picking_uThreshold &&\n    abs(vertexColor.g - picking_uSelectedColor.g) < picking_uThreshold &&\n    abs(vertexColor.b - picking_uSelectedColor.b) < picking_uThreshold;\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  picking_vRGBcolor_Aselected.a =\n    float(isVertexPicked(pickingColor));\n  picking_vRGBcolor_Aselected.rgb = pickingColor * COLOR_SCALE;\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Aselected;\n\nconst float COLOR_SCALE = 1. / 255.;\nvec4 picking_filterHighlightColor(vec4 color) {\n  bool selected = bool(picking_vRGBcolor_Aselected.a);\n\n  if (selected) {\n    vec4 highLightColor = picking_uHighlightColor * COLOR_SCALE;\n\n    float highLightAlpha = highLightColor.a;\n    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));\n\n    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);\n    return vec4(resultRGB, color.a);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  vec3 pickingColor = picking_vRGBcolor_Aselected.rgb;\n  if (picking_uActive && length(pickingColor) < 0.001) {\n    discard;\n  }\n  return picking_uActive ? vec4(pickingColor, 1.0) : color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cn,e={};if(void 0!==t.pickingSelectedColor)if(null===t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{var n=[t.pickingSelectedColor[0],t.pickingSelectedColor[1],t.pickingSelectedColor[2]];e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}return void 0!==t.pickingHighlightColor&&(e.picking_uHighlightColor=t.pickingHighlightColor),void 0!==t.pickingThreshold&&(e.picking_uThreshold=t.pickingThreshold),void 0!==t.pickingActive&&(e.picking_uActive=t.pickingActive?1:0),e}};var hn="void main() {}",fn="#version 300 es\n".concat(hn);function dn(t,e){e=Array.isArray(e)?e:[e];var n=t.replace(/^\s+/,"").split(/\s+/),r=Object(tt.a)(n,3),i=r[0],o=r[1],a=r[2];return e.includes(i)&&o&&a?{qualifier:i,type:o,name:a.split(";")[0]}:null}function pn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.version,n=void 0===e?100:e,r=t.input,i=t.inputType,o=t.output;if(!r)return 300===n?fn:hn;var a=function(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Ge()(!1),null}}(r,i);return 300===n?"#version 300 es\nin ".concat(i," ").concat(r,";\nout vec4 ").concat(o,";\nvoid main() {\n  ").concat(o," = ").concat(a,";\n}"):"varying ".concat(i," ").concat(r,";\nvoid main() {\n  gl_FragColor = ").concat(a,";\n}")}var vn={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},gn=n("kLp3"),yn=n.n(gn),mn={},_n=function t(e,n,r){e&&(n.length>1?t(e[n[0]],n.slice(1),r):e[n[0]]=r)},bn=new Map;function wn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.header,n=void 0===e?"Uniforms":e,r=t.program,i=t.uniforms,o=t.undefinedOnly,a=void 0!==o&&o;Object(C.a)(r);var s=r._uniformSetters,u={},c=Object.keys(s).sort(),h=0,f=!0,d=!1,p=void 0;try{for(var v,g=c[Symbol.iterator]();!(f=(v=g.next()).done);f=!0){var y=v.value;y.match(".*_.*")||y.match(".*Matrix")||xn({table:u,header:n,uniforms:i,uniformName:y,undefinedOnly:a})&&h++}}catch(t){d=!0,p=t}finally{try{f||null==g.return||g.return()}finally{if(d)throw p}}var m=!0,_=!1,b=void 0;try{for(var w,x=c[Symbol.iterator]();!(m=(w=x.next()).done);m=!0){var E=w.value;E.match(".*Matrix")&&xn({table:u,header:n,uniforms:i,uniformName:E,undefinedOnly:a})&&h++}}catch(t){_=!0,b=t}finally{try{m||null==x.return||x.return()}finally{if(_)throw b}}var P=!0,S=!1,T=void 0;try{for(var A,M=c[Symbol.iterator]();!(P=(A=M.next()).done);P=!0){var k=A.value;u[k]||xn({table:u,header:n,uniforms:i,uniformName:k,undefinedOnly:a})&&h++}}catch(t){S=!0,T=t}finally{try{P||null==M.return||M.return()}finally{if(S)throw T}}var j=0,R={};if(!a)for(var L in i){var I=i[L];u[L]||(j++,R[L]=Object(O.a)({Type:"NOT USED: ".concat(I)},n,Object(l.b)(I)))}return{table:u,count:h,unusedTable:R,unusedCount:j}}function xn(t){var e,n=t.table,r=t.header,i=t.uniforms,o=t.uniformName,a=t.undefinedOnly,s=i[o],u=function(t){return null!=t}(s);return(!a||!u)&&(n[o]=(e={},Object(O.a)(e,r,u?Object(l.b)(s):"N/A"),Object(O.a)(e,"Uniform Type",u?s:"NOT PROVIDED"),e),!0)}function En(t,e,n,r){var o,a,s,u,c=t.gl,h="NOT PROVIDED",f="N/A",d="N/A",p="N/A";if(n&&(h=n.type,f=n.size,a=-1!==(h=String(h).replace("Array","")).indexOf("nt")),e instanceof B.a){var v,g,y=e,m=y.getDebugData(),_=m.data;if(s=m.modified?"*":"",u=_,d=(p=y.byteLength)/_.BYTES_PER_ELEMENT/f,n){var b=n.divisor>0;g="".concat(b?"I ":"P "," ").concat(d," (x").concat(f,"=").concat(p," bytes ").concat(Object(i.c)(c,h),")")}else a=!0,g="".concat(p," bytes");return v={},Object(O.a)(v,r,"".concat(s).concat(Object(l.b)(u,{size:f,isInteger:a}))),Object(O.a)(v,"Format ",g),v}return u=e,f=e.length,a=-1!==(h=String(e.constructor.name).replace("Array","")).indexOf("nt"),o={},Object(O.a)(o,r,"".concat(Object(l.b)(u,{size:f,isInteger:a})," (constant)")),Object(O.a)(o,"Format ","".concat(f,"x").concat(h," (constant)")),o}function On(t,e){var n=Jt(e.type,e.size);return n?"".concat(t," (").concat(n.name,")"):t}function Pn(t){var e=t.accessor,n=Jt(e.type,e.size);return n?"".concat(n.name," ").concat(t.name):t.name}yn.a.listenFor("luma.gl",function(t){var e=mn[t.itemKey];if(e&&"edit"===t.type&&"uniforms"===t.valuePath[0]){var n=t.valuePath.slice(1);!function(t,e,n){y.b.__SEER_INITIALIZED__&&(bn.has(t)||bn.set(t,new Map),bn.get(t).set(e,n))}(t.itemKey,n,t.value);var r=e.getUniforms();_n(r,n,t.value),e.setUniforms(r)}});var Sn=["renderPickingBuffer","pickingEnabled"],Tn=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(g.a)(this,e),n=Object(U.a)(this,Object(z.a)(e).call(this,r)),Object(C.a)(Object(o.m)(t)),n.gl=t,n.lastLogTime=0,n.initialize(r),n}return Object(G.a)(e,t),Object(P.a)(e,[{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.props={},this.program=this._createProgram(t),this.vertexArray=new se(this.gl,{program:this.program}),this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.animatedUniforms={},this.animated=!1,this.animationLoop=null,this.timerQueryEnabled=!1,this.timeElapsedQuery=void 0,this.lastQueryReturned=!0,this.stats={accumulatedFrameTime:0,averageFrameTime:0,profileFrameCount:0},this.pickable=!0,this.setProps(t),this.setUniforms(Object.assign({},this.getModuleUniforms(),this.getModuleUniforms(t.moduleSettings))),this.isInstanced=t.isInstanced||t.instanced,this.onBeforeRender=t.onBeforeRender||function(){},this.onAfterRender=t.onAfterRender||function(){},Object(C.a)(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}},{key:"setProps",value:function(t){Object.assign(this.props,t),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"uniforms"in t&&this.setUniforms(t.uniforms,t.samplers),"pickable"in t&&(this.pickable=t.pickable),"timerQueryEnabled"in t&&(this.timerQueryEnabled=t.timerQueryEnabled&&$t.isSupported(this.gl,["timers"]),t.timerQueryEnabled&&!this.timerQueryEnabled&&l.g.warn("GPU timer not supported")()),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers),"_animationProps"in t&&this._setAnimationProps(t._animationProps),"_animationLoop"in t&&(this.animationLoop=t._animationLoop)}},{key:"delete",value:function(){for(var t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();var e;this.program.delete(),this.vertexArray.delete(),e=this.id,delete mn[e],yn.a.deleteItem("luma.gl",e)}},{key:"destroy",value:function(){this.delete()}},{key:"getNeedsRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).clearRedrawFlags,e=void 0!==t&&t,n=!1;return n=n||this.needsRedraw,this.needsRedraw=this.needsRedraw&&!e,this.geometry&&(n=n||this.geometry.getNeedsRedraw({clearRedrawFlags:e})),this.animated&&(n=n||"animated model ".concat(this.id)),n}},{key:"getDrawMode",value:function(){return this.drawMode}},{key:"getVertexCount",value:function(){return this.vertexCount}},{key:"getInstanceCount",value:function(){return this.instanceCount}},{key:"getProgram",value:function(){return this.program}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getUniforms",value:function(){return this.program.getUniforms}},{key:"setNeedsRedraw",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.needsRedraw=t,this}},{key:"setDrawMode",value:function(t){return this.props.drawMode=de(t),this}},{key:"setVertexCount",value:function(t){return Object(C.a)(Number.isFinite(t)),this.props.vertexCount=t,this}},{key:"setInstanceCount",value:function(t){return Object(C.a)(Number.isFinite(t)),this.instanceCount=t,this}},{key:"setGeometry",value:function(t){this.geometry=t;var e=this._createBuffersFromAttributeDescriptors(this.geometry.getAttributes());return this.vertexArray.setAttributes(e),this.setNeedsRedraw(),this}},{key:"setAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(l.d)(t))return this;Object.assign(this.attributes,t);var e=this._createBuffersFromAttributeDescriptors(t);return this.vertexArray.setAttributes(e),this.setNeedsRedraw(),this}},{key:"setUniforms",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=Object.assign({},e),function(t,e){if(y.b.__SEER_INITIALIZED__&&t){var n=bn.get(t);n&&n.forEach(function(t,n){_n(e,n,t)})}}(this.id,e),e=this._extractAnimatedUniforms(e),this.program.setUniforms(e,n,function(){t._checkForDeprecatedUniforms(e),t.setNeedsRedraw()})}},{key:"_setAnimationProps",value:function(t){var e=this;if(this.animated){Object(C.a)(t,"Model.draw(): animated uniforms but no animationProps");var n=this._evaluateAnimateUniforms(t);this.program.setUniforms(n,{},function(){e._checkForDeprecatedUniforms(n),e.setNeedsRedraw()})}}},{key:"updateModuleSettings",value:function(t){var e=this.getModuleUniforms(t||{});return this.setUniforms(e)}},{key:"clear",value:function(t){return dt(this.program.gl,t),this}},{key:"draw",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.moduleSettings,r=void 0===n?null:n,i=e.framebuffer,o=e.uniforms,a=void 0===o?{}:o,s=e.attributes,u=void 0===s?{}:s,c=e.samplers,h=void 0===c?{}:c,f=e.transformFeedback,d=void 0===f?this.transformFeedback:f,p=e.parameters,v=void 0===p?{}:p,g=e.vertexArray,y=void 0===g?this.vertexArray:g,m=e.animationProps;mn[(t=this).id]||(mn[t.id]=t,yn.a.listItem("luma.gl",t.id)),this.setAttributes(u),this.updateModuleSettings(r),this.setUniforms(a,h),this._refreshAnimationProps(m);var _=this._logDrawCallStart(2),b=this.vertexArray.getDrawParams(this.props);b.isInstanced&&!this.isInstanced&&l.g.warn("Found instanced attributes on non-instanced model",this.id)();var w=b.isIndexed,x=b.indexType,E=this.isInstanced,O=this.instanceCount;return this.onBeforeRender(),this._timerQueryStart(),this.program.draw(Object.assign({},e,{logPriority:_,uniforms:null,framebuffer:i,parameters:v,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:y,transformFeedback:d,isIndexed:w,indexType:x,isInstanced:E,instanceCount:O})),this._timerQueryEnd(),this.onAfterRender(),this.setNeedsRedraw(!1),this._logDrawCallEnd(_,y,i),this}},{key:"transform",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.discard,n=void 0===e||e,r=t.feedbackBuffers,i=t.unbindModels,o=void 0===i?[]:i,a=t.parameters;r&&this._setFeedbackBuffers(r),n&&(a=Object.assign({},a,Object(O.a)({},35977,n))),o.forEach(function(t){return t.vertexArray.unbindBuffers()});try{this.draw(Object.assign({},t,{parameters:a}))}finally{o.forEach(function(t){return t.vertexArray.bindBuffers()})}return this}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(C.a)(arguments.length<=1),this.draw({uniforms:t})}},{key:"_createProgram",value:function(t){var e=t.vs,n=void 0===e?null:e,r=t.fs,i=void 0===r?null:r,o=t.modules,a=void 0===o?null:o,s=t.defines,u=void 0===s?{}:s,c=t.inject,h=void 0===c?{}:c,f=t.shaderCache,d=void 0===f?null:f,p=t.varyings,v=void 0===p?null:p,g=t.bufferMode,y=void 0===g?35981:g,m=t.program,_=void 0===m?null:m;this.getModuleUniforms=function(t){};var b=this.id;if(!_){n=n||ve,i=i||ge;var w=Je(this.gl,{vs:n,fs:i,modules:a,inject:h,defines:u,log:l.g});n=w.vs,i=w.fs,_=d?d.getProgram(this.gl,{id:b,vs:n,fs:i}):new Qt(this.gl,{id:b,vs:n,fs:i,varyings:v,bufferMode:y}),this.getModuleUniforms=w.getUniforms||function(t){}}return Object(C.a)(_ instanceof Qt,"Model needs a program"),_}},{key:"_checkForDeprecatedUniforms",value:function(t){Sn.forEach(function(e){e in t&&l.g.deprecated(e,"use picking shader module and Model class updateModuleSettings()")()})}},{key:"_refreshAnimationProps",value:function(t){(t=t||this.animationLoop&&this.animationLoop.animationProps)&&this._setAnimationProps(t)}},{key:"_evaluateAnimateUniforms",value:function(t){if(!this.animated)return{};var e={};for(var n in this.animatedUniforms){var r=this.animatedUniforms[n];e[n]=r(t)}return e}},{key:"_extractAnimatedUniforms",value:function(t){var e=!1;for(var n in t){var r=t[n];"function"==typeof r?(this.animatedUniforms[n]=r,e=!0):delete this.animatedUniforms[n]}if(this.animated=!Object(l.d)(this.animatedUniforms),!e)return t;var i={};for(var o in t)this.animatedUniforms[o]||(i[o]=t[o]);return i}},{key:"_setFeedbackBuffers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(l.d)(t))return this;var e=this.program.gl;return this.transformFeedback=this.transformFeedback||new te(e,{program:this.program}),this.transformFeedback.setBuffers(t),this.setNeedsRedraw(),this}},{key:"_timerQueryStart",value:function(){!0===this.timerQueryEnabled&&(this.timeElapsedQuery||(this.timeElapsedQuery=new $t(this.gl)),this.lastQueryReturned&&(this.lastQueryReturned=!1,this.timeElapsedQuery.beginTimeElapsedQuery()))}},{key:"_timerQueryEnd",value:function(){if(!0===this.timerQueryEnabled&&(this.timeElapsedQuery.end(),this.timeElapsedQuery.isResultAvailable())){this.lastQueryReturned=!0;var t=this.timeElapsedQuery.getResult();this.stats.lastFrameTime=t,this.stats.accumulatedFrameTime+=t,this.stats.profileFrameCount++,this.stats.averageFrameTime=this.stats.accumulatedFrameTime/this.stats.profileFrameCount,l.g.log(2,"GPU time ".concat(this.program.id,": ").concat(this.stats.lastFrameTime,"ms average ").concat(this.stats.averageFrameTime,"ms accumulated: ").concat(this.stats.accumulatedFrameTime,"ms count: ").concat(this.stats.profileFrameCount))()}}},{key:"_createBuffersFromAttributeDescriptors",value:function(t){var e=this.program.gl,n={};for(var r in t){var i=t[r],o=this._attributes[r];i instanceof he?o=i:i instanceof B.a?(o=o||new he(e,Object.assign({},i,i.layout,{id:r}))).update({buffer:i}):o?o.update(i):o=new he(e,Object.assign({},i,{id:r})),this._attributes[r]=o,n[r]=o.getValue()}return n}},{key:"_logDrawCallStart",value:function(t){var e=t>3?0:1e4;if(!(l.g.priority<t||Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),l.g.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:l.g.priority<=2})(),t}},{key:"_logDrawCallEnd",value:function(t,e,n,r){if(void 0!==t){var i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.vertexArray,n=t.header,r=void 0===n?"Attributes":n;if(!e.configuration)return{};var i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=En(e,e.elements,null,r));var o=e.values;for(var a in o){var s=e._getAttributeInfo(a);if(s){var u="".concat(a,": ").concat(s.name),c=e.accessors[s.location];c&&(u="".concat(a,": ").concat(On(s.name,c))),i[u]=En(e,o[a],c,r)}}return i}({vertexArray:e,header:"".concat(this.id," attributes"),attributes:this._attributes}),o=wn({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),a=o.table,s=o.unusedTable,u=o.unusedCount,c=wn({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0}),h=c.table;c.count>0&&l.g.log("MISSING UNIFORMS",Object.keys(h))(),u>0&&l.g.log("UNUSED UNIFORMS",Object.keys(s))();var f=function(t){var e={},n="Accessors for ".concat(t.id),r=!0,i=!1,o=void 0;try{for(var a,s=t.attributeInfos[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(u){var c=Pn(u);e["in ".concat(c)]=Object(O.a)({},n,JSON.stringify(u.accessor))}}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}var l=!0,h=!1,f=void 0;try{for(var d,p=t.varyingInfos[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var v=d.value;if(v){var g=Pn(v);e["out ".concat(g)]=Object(O.a)({},n,JSON.stringify(v.accessor))}}}catch(t){h=!0,f=t}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}return e}(this.vertexArray.configuration);l.g.table(t,i)(),l.g.table(t,a)(),l.g.table(t+1,f)(),function(t,e){if(yn.a.isReady()&&!yn.a.throttle("luma.gl:".concat(t.id),1e3)){var n=t.geometry?Object.assign({},t.geometry.attributes,t.attributes):t.attributes,r=Object.assign({},t.uniforms,e);yn.a.multiUpdate("luma.gl",t.id,[{path:"objects.uniforms",data:r},{path:"objects.attributes",data:n}])}}(this,n),r&&r.log({priority:2,message:"Rendered to ".concat(r.id)}),l.g.groupEnd(2,">>> DRAWING MODEL ".concat(this.id))()}}},{key:"vertexCount",get:function(){return Number.isFinite(this.props.vertexCount)?this.props.vertexCount:this.geometry&&this.geometry.getVertexCount()}},{key:"drawMode",get:function(){return Number.isFinite(this.props.drawMode)?this.props.drawMode:this.geometry&&this.geometry.drawMode}}]),e}(le),Cn=n("U8pU"),An={preserveDrawingBuffer:!0},Mn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(g.a)(this,t);var n=e.onCreateContext,r=void 0===n?function(t){return j(t)}:n,i=e.onAddHTML,o=void 0===i?null:i,a=e.onInitialize,s=void 0===a?function(){}:a,u=e.onRender,c=void 0===u?function(){}:u,h=e.onFinalize,f=void 0===h?function(){}:h,d=e.gl,p=void 0===d?null:d,v=e.glOptions,y=void 0===v?{}:v,m=e.debug,_=void 0!==m&&m,b=e.createFramebuffer,w=void 0!==b&&b,x=e.autoResizeViewport,E=void 0===x||x,O=e.autoResizeDrawingBuffer,P=void 0===O||O,S=e.useDevicePixels,T=void 0===S||S;return"useDevicePixelRatio"in e&&(l.g.deprecated("useDevicePixelRatio","useDevicePixels")(),T=e.useDevicePixelRatio),this.props={onCreateContext:r,onAddHTML:o,onInitialize:s,onRender:c,onFinalize:f,gl:p,glOptions:y,debug:_,createFramebuffer:w},this.gl=p,this.needsRedraw=null,this.setProps({autoResizeViewport:E,autoResizeDrawingBuffer:P,useDevicePixels:T}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._renderFrame=this._renderFrame.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this),this}return Object(P.a)(t,[{key:"setNeedsRedraw",value:function(t){return Object(C.a)("string"==typeof t),this.needsRedraw=this.needsRedraw||t,this}},{key:"setProps",value:function(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}},{key:"start",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._stopped=!1,this._animationFrameId||(this._startPromise=d().then(function(){return t._stopped?null:(t._createWebGLContext(e),t._createFramebuffer(),t._startEventHandling(),t._initializeCallbackData(),t._updateCallbackData(),t._resizeCanvasDrawingBuffer(),t._resizeViewport(),t.onInitialize(t.animationProps))}).then(function(e){t._stopped||(t._addCallbackData(e||{}),!1===e||t._animationFrameId||(t._animationFrameId=Object(o.p)(t._renderFrame)))})),this}},{key:"stop",value:function(){return this._animationFrameId&&(this._finalizeCallbackData(),Object(o.f)(this._animationFrameId),this._animationFrameId=null,this._stopped=!0),this}},{key:"onCreateContext",value:function(){var t;return(t=this.props).onCreateContext.apply(t,arguments)}},{key:"onInitialize",value:function(){var t;return(t=this.props).onInitialize.apply(t,arguments)}},{key:"onRender",value:function(){var t;return(t=this.props).onRender.apply(t,arguments)}},{key:"onFinalize",value:function(){var t;return(t=this.props).onFinalize.apply(t,arguments)}},{key:"getHTMLControlValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=document.getElementById(t);return n?Number(n.value):e}},{key:"setViewParameters",value:function(){return l.g.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}},{key:"_clearNeedsRedraw",value:function(){this.needsRedraw=null}},{key:"_setupFrame",value:function(){this._onSetupFrame?this._onSetupFrame(this.animationProps):(this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer())}},{key:"_renderFrame",value:function(){this._stopped||(this._setupFrame(),this._updateCallbackData(),this.onRender(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit?this.gl.commit().then(this._renderFrame):this._animationFrameId=Object(o.p)(this._renderFrame))}},{key:"_initializeCallbackData",value:function(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),time:0,tick:0,tock:0,_loop:this,_animationLoop:this,_mousePosition:null}}},{key:"_updateCallbackData",value:function(){var t=this._getSizeAndAspect(),e=t.width,n=t.height,r=t.aspect;e===this.animationProps.width&&n===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.time=Date.now()-this.animationProps.startTime,this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps._offScreen=this.offScreen}},{key:"_finalizeCallbackData",value:function(){this.onFinalize(this.animationProps)}},{key:"_addCallbackData",value:function(t){"object"===Object(Cn.a)(t)&&null!==t&&(this.animationProps=Object.assign({},this.animationProps,t))}},{key:"_createWebGLContext",value:function(t){if(this.offScreen=t.canvas&&"undefined"!=typeof OffscreenCanvas&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,An,this.props.glOptions),this.gl=this.props.gl||this.onCreateContext(t),!Object(o.m)(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");this.props.debug&&(this.gl=_(this.gl)),Object(R.a)(this.gl),this._createInfoDiv()}},{key:"_createInfoDiv",value:function(){if(this.gl.canvas&&this.props.onAddHTML){var t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";var e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);var n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}},{key:"_getSizeAndAspect",value:function(){var t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight,n=1,r=this.gl.canvas,i=r.clientWidth,o=r.clientHeight;return i>=0&&o>=0?n=e>0?i/o:1:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}},{key:"_resizeViewport",value:function(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}},{key:"_resizeCanvasDrawingBuffer",value:function(){this.autoResizeDrawingBuffer&&function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.canvas){var n=e.useDevicePixels&&window.devicePixelRatio||1,r="width"in e?e.width:t.canvas.clientWidth,i="height"in e?e.height:t.canvas.clientHeight;return t.canvas.width=r*n,void(t.canvas.height=i*n)}var o=t.getExtension("STACKGL_resize_drawingbuffer");o&&"width"in e&&"height"in e&&o.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}},{key:"_createFramebuffer",value:function(){this.props.createFramebuffer&&(this.framebuffer=new gt(this.gl))}},{key:"_resizeFramebuffer",value:function(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}},{key:"_startEventHandling",value:function(){this.gl.canvas.addEventListener("mousemove",this._onMousemove),this.gl.canvas.addEventListener("mouseleave",this._onMouseleave)}},{key:"_onMousemove",value:function(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}},{key:"_onMouseleave",value:function(t){this.animationProps._mousePosition=null}}]),t}();new Uint8Array([0,0,0]);var kn,jn="transform_uSampler_",Rn="transform_uSize_",Ln="transform_position";function In(t){var e=t.vs,n=t.sourceTextureMap,r=t.targetTextureVarying,i=t.targetTexture,o=Object.keys(n).length,a=null,s={},u=e,c={};if(o>0||r){var l=u.split("\n"),h=l.slice();if(l.forEach(function(t,e,i){if(o>0){var u=function(t,e){var n={},r=function(t){return dn(t,["attribute","in"])}(t);if(!r)return null;var i=r.type,o=r.name;if(o&&e[o]){var a="// ".concat(t," => Replaced by Transform with a sampler"),s=function(t){var e="".concat(jn).concat(t),n="".concat(Rn).concat(t),r="  uniform sampler2D ".concat(e,";\n  uniform vec2 ").concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}(o),u=s.samplerName,c=s.sizeName,l=s.uniformDeclerations,h=function(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Ge()(!1),null}}(i),f="  ".concat(i," ").concat(o," = transform_getInput(").concat(u,", ").concat(c,").").concat(h,";\n");n[u]=o;var d={"vs:#decl":l,"vs:#main-start":f};return{updatedLine:a,inject:d,samplerTextureMap:n}}return null}(t,n);if(u){var l=u.updatedLine,f=u.inject;h[e]=l,c=He([c,f]),Object.assign(s,u.samplerTextureMap),o--}}r&&!a&&(a=function(t,e){var n=dn(t,["varying","out"]);if(!n)return null;return n.name===e?n.type:null}(t,r))}),r){Ge()(i);var f="".concat(Rn).concat(r),d="uniform vec2 ".concat(f,";\n"),p="     vec2 ".concat(Ln," = transform_getPos(").concat(f,");\n     gl_Position = vec4(").concat(Ln,", 0, 1.);\n");c=He([c,{"vs:#decl":d,"vs:#main-start":p}])}u=h.join("\n")}return{vs:u,targetTextureType:a,inject:c,samplerTextureMap:s}}var Dn=(kn={},Object(O.a)(kn,10241,9728),Object(O.a)(kn,10240,9728),Object(O.a)(kn,10242,33071),Object(O.a)(kn,10243,33071),kn),Fn=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(g.a)(this,t),Object(o.d)(e),this.gl=e,this.model=null,this.elementCount=0,this.currentIndex=0,this.sourceBuffers=new Array(2),this.sourceTextures=new Array(2),this.feedbackBuffers=new Array(2),this.targetTextures=new Array(2),this.transformFeedbacks=new Array(2),this.framebuffers=new Array(2),this._createdBuffers={},this.elementIDBuffer=null,this._targetRefTexName=null,this._initialize(n),Object.seal(this)}return Object(P.a)(t,null,[{key:"isSupported",value:function(t){return Object(o.n)(t)}}]),Object(P.a)(t,[{key:"delete",value:function(){for(var t in this._createdBuffers)this._createdBuffers[t].delete();this.model.delete()}},{key:"getBuffer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Object(C.a)(t&&this.feedbackBuffers[this.currentIndex][t]),this.feedbackBuffers[this.currentIndex][t]}},{key:"_getTargetTexture",value:function(){return this.framebuffers[this.currentIndex]?this.framebuffers[this.currentIndex].attachments[36064]:null}},{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.varyingName,n=void 0===e?null:e,r=t.packed,i=void 0!==r&&r;if(n&&this.feedbackBuffers[this.currentIndex][n])return this.feedbackBuffers[this.currentIndex][n].getData();Object(C.a)(!n||n===this.targetTextureVarying);var o=this.framebuffers[this.currentIndex].readPixels();if(!i)return o;for(var a=o.constructor,s=function(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Ge()(!1),null}}(this.targetTextureType),u=new a(o.length*s/4),c=0,l=0;l<o.length;l+=4)for(var h=0;h<s;h++)u[c++]=o[l+h];return u}},{key:"getFramebuffer",value:function(){return this.framebuffers[this.currentIndex]}},{key:"_getInputs",value:function(){var t={},e=this.currentIndex,n=Object.assign({},this.sourceBuffers[e]);if(this.hasSourceTextures||this.targetTextureVarying){for(var r in n.transform_elementID=this.elementIDBuffer,this.samplerTextureMap){var i=this.samplerTextureMap[r];t[r]=this.sourceTextures[e][i]}this._setSourceTextureParameters();var o=function(t){var e,n,r=t.sourceTextureMap,i=t.targetTextureVarying,o=t.targetTexture,a={};for(var s in i&&(e=o.width,n=o.height,a["".concat(Rn).concat(i)]=[e,n]),r){var u=r[s];e=u.width,n=u.height,a["".concat(Rn).concat(s)]=[e,n]}return a}({sourceTextureMap:this.sourceTextures[e],targetTextureVarying:this.targetTextureVarying,targetTexture:this.targetTextures[e]});Object.assign(t,o)}return{attributes:n,uniforms:t}}},{key:"run",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._getInputs(),n=e.attributes,r=e.uniforms;Object.assign(r,t.uniforms);var i=Object.assign({},t.parameters),o=t.clearRenderTarget,a=void 0===o||o,s=null,u=!0;this.renderingToTexture&&(u=!1,s=this.framebuffers[this.currentIndex],Object(C.a)(s),i.viewport=[0,0,s.width,s.height],a&&this.gl.clear(this.gl.COLOR_BUFFER_BIT)),this.model.setAttributes(n),this.model.transform(Object.assign({},t,{transformFeedback:this.transformFeedbacks[this.currentIndex],uniforms:r,discard:u,framebuffer:s,parameters:i}))}},{key:"swapBuffers",value:function(){l.g.deprecated("swapBuffers()","swap()"),this.swap()}},{key:"swap",value:function(){Object(C.a)(this.feedbackMap||this._swapTexture),this.currentIndex=(this.currentIndex+1)%2}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.elementCount&&this._setElementCount(t.elementCount);var e=t.sourceBuffers,n=void 0===e?null:e,r=t.feedbackBuffers,i=void 0===r?null:r,o=this.currentIndex;if(n||i){for(var a in i)Object(C.a)(i[a]instanceof B.a);Object.assign(this.sourceBuffers[o],n),Object.assign(this.feedbackBuffers[o],i),this._createFeedbackBuffers({feedbackBuffers:i}),this.transformFeedbacks[o]&&this.transformFeedbacks[o].setBuffers(this.feedbackBuffers[o]),this._setupSwapBuffers()}var s=t._sourceTextures,u=t._targetTexture;(s||u)&&(Object.assign(this.sourceTextures[o],s),this._updateTargetTexture(u||this._targetRefTexName,o),this._setupSwapTextures())}},{key:"_setSourceTextureParameters",value:function(){var t=this.currentIndex;for(var e in this.sourceTextures[t])this.sourceTextures[t][e].setParameters(Dn)}},{key:"_setElementCount",value:function(t){this.elementCount!==t&&(this.elementCount<t&&this._updateElementIDBuffer(t),this.model.setVertexCount(t),this.elementCount=t)}},{key:"_updateTargetTexture",value:function(t,e){var n=this._buildTargetTexture(t);n&&(this.targetTextures[e]=n,this.framebuffers[e]&&(this.framebuffers[e].update({attachments:Object(O.a)({},36064,this.targetTextures[e]),resizeAttachments:!1}),this.framebuffers[e].resize({width:n.width,height:n.height})))}},{key:"_initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._validateProps(t),n=e.feedbackBuffers,r=e.feedbackMap,i=t.sourceBuffers,o=t.varyings,a=t._targetTexture,s=t._targetTextureVarying,u=t._swapTexture,c=o;r&&!Array.isArray(o)&&(c=Object.values(r)),this.varyingsArray=c,this.feedbackMap=r,this._swapTexture=u,a&&(this.targetTextureVarying=s,this.renderingToTexture=!0,Object(C.a)(this.targetTextureVarying)),this._setupBuffers({sourceBuffers:i,feedbackBuffers:n}),this._setupTextures(t),this._setupSwapBuffers(),this._setupSwapTextures(),this._buildModel(Object.assign({},t,{id:t.id||"transform-model",drawMode:t.drawMode||0,varyings:c}))}},{key:"_validateProps",value:function(t){var e=t.feedbackBuffers,n=t.feedbackMap,r=t.destinationBuffers,i=t.sourceDestinationMap;r&&(l.g.deprecated("destinationBuffers","feedbackBuffers")(),e=e||r),i&&(l.g.deprecated("sourceDestinationMap","feedbackMap")(),n=n||i);var o=t.vs,a=t.elementCount,s=t.varyings,u=t._sourceTextures,c=t._targetTexture,h=t._targetTextureVarying,f=t._swapTexture;for(var d in Object(C.a)(o&&(s||n||c)&&a),e||{})Object(C.a)(e[d]instanceof B.a);for(var p in u||{})Object(C.a)(u[p]instanceof et.a);return Object(C.a)(!c||h),Object(C.a)(!f||u[f]),{feedbackBuffers:e,feedbackMap:n}}},{key:"_setupBuffers",value:function(t){var e=t.sourceBuffers,n=void 0===e?null:e,r=t.feedbackBuffers,i=void 0===r?null:r;this.sourceBuffers[0]=Object.assign({},n),this.feedbackBuffers[0]=Object.assign({},i),this._createFeedbackBuffers({feedbackBuffers:i}),this.sourceBuffers[1]={},this.feedbackBuffers[1]={}}},{key:"_setupTextures",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t._sourceTextures,n=t._targetTexture;if(this.sourceTextures[0]=Object.assign({},e),this.sourceTextures[1]={},this.hasSourceTextures=Object.keys(this.sourceTextures[0]).length>0,this.targetTextureVarying){var r=this._buildTargetTexture(n);Object(C.a)(r),this.targetTextures[0]=r,this.targetTextures[1]=null}}},{key:"_buildTargetTexture",value:function(t){var e;if(t instanceof et.a)return t;var n=this.sourceTextures[0][t];return n?(this._targetRefTexName=t,Object(o.g)(n,{parameters:(e={},Object(O.a)(e,10241,9728),Object(O.a)(e,10240,9728),Object(O.a)(e,10242,33071),Object(O.a)(e,10243,33071),e),pixelStore:Object(O.a)({},37440,!1)})):null}},{key:"_createFeedbackBuffers",value:function(t){var e=t.feedbackBuffers;if(this.feedbackMap){var n=this.currentIndex;for(var r in this.feedbackMap){var i=this.feedbackMap[r];if(!(i===this.targetTextureVarying||e&&e[i])){var o=this.sourceBuffers[n][r],a=o.bytes,s=o.type,u=o.usage,c=o.accessor,l=new B.a(this.gl,{bytes:a,type:s,usage:u,accessor:c});this._createdBuffers[i]&&this._createdBuffers[i].delete(),this._createdBuffers[i]=l,this.feedbackBuffers[n][i]=l}}}}},{key:"_createNewBuffer",value:function(t,e){var n=new B.a(this.gl,e);return this._createdBuffers[t]&&(this._createdBuffers[t].delete(),this._createdBuffers[t]=n),n}},{key:"_setupSwapBuffers",value:function(){if(this.feedbackMap){var t=this.currentIndex,e=(t+1)%2;for(var n in Object.assign(this.sourceBuffers[e],this.sourceBuffers[t]),Object.assign(this.feedbackBuffers[e],this.feedbackBuffers[t]),this.feedbackMap){var r=this.feedbackMap[n];r!==this.targetTextureVarying&&(this.sourceBuffers[e][n]=this.feedbackBuffers[t][r],this.feedbackBuffers[e][r]=this.sourceBuffers[t][n],Object(C.a)(this.feedbackBuffers[e][r]instanceof B.a))}this.transformFeedbacks[e]&&this.transformFeedbacks[e].setBuffers(this.feedbackBuffers[e])}}},{key:"_setupSwapTextures",value:function(){if(this._swapTexture&&this.targetTextureVarying){var t=this.currentIndex,e=(t+1)%2;Object.assign(this.sourceTextures[e],this.sourceTextures[t]),this.sourceTextures[e][this._swapTexture]=this.targetTextures[t],this._updateTargetTexture(this.sourceTextures[t][this._swapTexture],e)}}},{key:"_buildModel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._getShaders(t),n=e.vs,r=e.fs,i=e.modules,o=e.uniforms,a=e.inject,s=e.samplerTextureMap;this.model=new Tn(this.gl,Object.assign({},t,{vs:n,fs:r,vertexCount:t.elementCount,modules:i,uniforms:o,inject:a})),this.samplerTextureMap=s,this._setupTransformFeedback(),this._setupFramebuffers(),this._setElementCount(t.elementCount)}},{key:"_setupTransformFeedback",value:function(){Object(l.d)(this.feedbackBuffers[0])||(this.transformFeedbacks[0]=new te(this.gl,{program:this.model.program,buffers:this.feedbackBuffers[0]}),this.feedbackMap&&(this.transformFeedbacks[1]=new te(this.gl,{program:this.model.program,buffers:this.feedbackBuffers[1]})))}},{key:"_setupFramebuffers",value:function(){if(this.renderingToTexture){var t=this.targetTextures[0],e=t.width,n=t.height;if(this.framebuffers[0]=new gt(this.gl,{id:"".concat(this.id||"transform","-framebuffer-0"),width:e,height:n,attachments:Object(O.a)({},36064,this.targetTextures[0])}),this._swapTexture){var r=this.targetTextures[1];e=r.width,n=r.height,this.framebuffers[1]=new gt(this.gl,{id:"".concat(this.id||"transform","-framebuffer-1"),width:e,height:n,attachments:Object(O.a)({},36064,this.targetTextures[1])})}}}},{key:"_updateElementIDBuffer",value:function(t){if(this.hasSourceTextures||this.targetTextureVarying){var e=new Float32Array(t);e.forEach(function(t,e,n){n[e]=e}),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new B.a(this.gl,{data:e,size:1})}}},{key:"_getShaders",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._processVertexShader(t.vs),n=e.vs,r=e.uniforms,i=e.targetTextureType,a=e.inject,s=e.samplerTextureMap,u=He([t.inject||{},a]);return this.targetTextureType=i,{vs:n,fs:pn({version:Object(o.l)(n),input:this.targetTextureVarying,inputType:i,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[vn].concat(t.modules||[]):t.modules,uniforms:r,inject:u,samplerTextureMap:s}}},{key:"_processVertexShader",value:function(t){return In({vs:t,sourceTextureMap:this.sourceTextures[this.currentIndex],targetTextureVarying:this.targetTextureVarying,targetTexture:this.targetTextures[this.currentIndex]})}}]),t}(),Nn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.gl,r=e._cachePrograms,i=void 0!==r&&r;Object(g.a)(this,t),Object(C.a)(n),this.gl=n,this.vertexShaders={},this.fragmentShaders={},this.programs={},this._cachePrograms=i}return Object(P.a)(t,[{key:"delete",value:function(){return this}},{key:"getVertexShader",value:function(t,e){Object(C.a)("string"==typeof e),Object(C.a)(this._compareContexts(t,this.gl));var n=this.vertexShaders[e];return n||(n=new Y(t,e),this.vertexShaders[e]=n),n}},{key:"getFragmentShader",value:function(t,e){Object(C.a)("string"==typeof e),Object(C.a)(this._compareContexts(t,this.gl));var n=this.fragmentShaders[e];return n||(n=new J(t,e),this.fragmentShaders[e]=n),n}},{key:"getProgram",value:function(t,e){Object(C.a)(this._compareContexts(t,this.gl)),Object(C.a)("string"==typeof e.vs),Object(C.a)("string"==typeof e.fs),Object(C.a)("string"==typeof e.id);var n=this._getProgramKey(e),r=this.programs[n];return r?(this._resetProgram(r),r):(r=this._createNewProgram(t,e),this._cachePrograms&&this._checkProgramProp(r)&&(r._isCached=!0,this.programs[n]=r),r)}},{key:"_getProgramKey",value:function(t){return"".concat(t.id,"-").concat(t.vs,"-").concat(t.fs)}},{key:"_checkProgramProp",value:function(t){return!t.varyings}},{key:"_createNewProgram",value:function(t,e){var n=e.vs,r=e.fs,i=this.getVertexShader(t,n),o=this.getFragmentShader(t,r);return new Qt(this.gl,Object.assign({},e,{vs:i,fs:o}))}},{key:"_resetProgram",value:function(t,e){t.reset()}},{key:"_compareContexts",value:function(t,e){return(t.gl||t)===(e.gl||e)}}]),t}(),Bn=function(){function t(e,n){Object(g.a)(this,t);var r=n.id,i=void 0===r?"pass":r;this.id=i,this.gl=e,this.props={enabled:!0,screen:!1,swap:!1},Object.assign(this.props,n)}return Object(P.a)(t,[{key:"setProps",value:function(t){Object.assign(this.props,t)}},{key:"render",value:function(t,e){var n=this;if(this.props.enabled){var r=this.gl,i={gl:r,outputBuffer:t.writeBuffer,inputBuffer:t.readBuffer,animationProps:e,swapBuffers:function(){return t._swapFramebuffers()}};this.props.screen?(i.inputBuffer=i.outputBuffer,i.outputBuffer=gt.getDefaultFramebuffer(r)):this.props.swap&&(i.inputBuffer=t.writeBuffer,i.outputBuffer=t.readBuffer),Object(R.c)(r,{framebuffer:i.outputBuffer},function(){return n._renderPass(i)}),this.props.debug&&i.outputBuffer.log(0,this.id),this.props.swap&&t._swapFramebuffers()}}},{key:"_renderPass",value:function(t){t.gl,t.inputBuffer,t.outputBuffer,t.animationProps}}]),t}(),Un=function(t){function e(t,n){return Object(g.a)(this,e),n=Array.isArray(n)?{passes:n}:n,Object(U.a)(this,Object(z.a)(e).call(this,t,Object.assign({id:"composite-pass"},n)))}return Object(G.a)(e,t),Object(P.a)(e,[{key:"render",value:function(){var t=this.props.passes,e=void 0===t?[]:t,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.render.apply(s,arguments)}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}}]),e}(Bn),zn=function(){function t(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(g.a)(this,t),this.gl=e,this.framebuffer1=new gt(e,{id:"multi-pass-1",stencil:!0}),this.framebuffer2=new gt(e,{id:"multi-pass-2",stencil:!0}),this.reset()}return Object(P.a)(t,[{key:"reset",value:function(){this.framebuffer1.resize(),this.framebuffer2.resize(),this.writeBuffer=this.framebuffer1,this.readBuffer=this.framebuffer2,this.maskActive=!1}},{key:"_swapFramebuffers",value:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t}}]),t}(),Gn=function(t){function e(t,n){var r;return Object(g.a)(this,e),n=Array.isArray(n)?{passes:n}:n,(r=Object(U.a)(this,Object(z.a)(e).call(this,t,Object.assign({id:"multi-pass"},n)))).renderState=new zn(t,n),r}return Object(G.a)(e,t),Object(P.a)(e,[{key:"render",value:function(t){this.renderState.reset();var e=this.props.passes,n=void 0===e?[]:e,r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){a.value.render(this.renderState,t)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return this}}]),e}(Un),Vn=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(g.a)(this,e),Object(U.a)(this,Object(z.a)(e).call(this,t,Object.assign({id:"clear-pass"},n)))}return Object(G.a)(e,t),Object(P.a)(e,[{key:"_renderPass",value:function(t){var e=t.gl,n=this.props.clearBits,r=void 0===n?16640:n;e.clear(r)}}]),e}(Bn),Wn={x:[2,0,1],y:[0,1,2],z:[1,2,0]},Zn=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(g.a)(this,e);for(var n=t.bottomRadius,r=void 0===n?0:n,i=t.topRadius,o=void 0===i?0:i,a=t.height,s=void 0===a?1:a,u=t.nradial,c=void 0===u?10:u,l=t.nvertical,h=void 0===l?10:l,f=t.verticalAxis,d=void 0===f?"y":f,p=t.topCap,v=void 0!==p&&p,y=t.bottomCap,m=void 0!==y&&y,_=(v?2:0)+(m?2:0),b=(c+1)*(h+1+_),w=Math.atan2(r-o,s),x=Math.sin,E=Math.cos,O=Math.PI,P=E(w),S=x(w),T=v?-2:0,C=h+(m?2:0),A=c+1,M=new Float32Array(3*b),k=new Float32Array(3*b),j=new Float32Array(2*b),R=new Uint16Array(c*(h+_)*6),L=Wn[d],I=0,D=0,F=T;F<=C;F++){var N=F/h,B=s*N,G=void 0;F<0?(B=0,N=1,G=r):F>h?(B=s,N=1,G=o):G=r+F/h*(o-r),-2!==F&&F!==h+2||(G=0,N=0),B-=s/2;for(var V=0;V<A;V++){var W=x(V*O*2/c),Z=E(V*O*2/c);M[I+L[0]]=W*G,M[I+L[1]]=B,M[I+L[2]]=Z*G,k[I+L[0]]=F<0||F>h?0:W*P,k[I+L[1]]=F<0?-1:F>h?1:S,k[I+L[2]]=F<0||F>h?0:Z*P,j[D+0]=V/c,j[D+1]=N,D+=2,I+=3}}for(var H=0;H<h+_;H++)for(var X=0;X<c;X++){var Y=6*(H*c+X);R[Y+0]=A*(H+0)+0+X,R[Y+1]=A*(H+0)+1+X,R[Y+2]=A*(H+1)+1+X,R[Y+3]=A*(H+0)+0+X,R[Y+4]=A*(H+1)+1+X,R[Y+5]=A*(H+1)+0+X}return Object(U.a)(this,Object(z.a)(e).call(this,Object.assign({},t,{attributes:{positions:M,normals:k,texCoords:j,indices:R}})))}return Object(G.a)(e,t),e}(pe);new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]);var Hn=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(g.a)(this,e);var n=t.radius,r=void 0===n?1:n;return Object(U.a)(this,Object(z.a)(e).call(this,Object.assign({},t,{bottomRadius:r,topRadius:r})))}return Object(G.a)(e,t),e}(Zn);var Xn="attribute vec2 aClipSpacePosition;\nattribute vec2 aTexCoord;\nattribute vec2 aCoordinate;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main(void) {\n  gl_Position = vec4(aClipSpacePosition, 0., 1.);\n  position = aClipSpacePosition;\n  coordinate = aCoordinate;\n  uv = aTexCoord;\n}\n",Yn=[-1,-1,1,-1,-1,1,1,1],Jn=function(t){function e(t,n){var r;Object(g.a)(this,e);var i=Yn.map(function(t){return-1===t?0:t});return(r=Object(U.a)(this,Object(z.a)(e).call(this,t,Object.assign({},n,{vs:Xn,geometry:new pe({drawMode:5,vertexCount:4,attributes:{aClipSpacePosition:{size:2,value:new Float32Array(Yn)},aTexCoord:{size:2,value:new Float32Array(i)},aCoordinate:{size:2,value:new Float32Array(i)}}})})))).setVertexCount(4),r}return Object(G.a)(e,t),e}(Tn),qn="uniform sampler2D uDiffuseSampler;\nuniform float uOpacity;\n\nvarying vec2 uv;\n\nvoid main() {\n  vec4 texel = texture2D(uDiffuseSampler, uv);\n  gl_FragColor = uOpacity * texel;\n}\n",Qn=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(g.a)(this,e),(n=Object(U.a)(this,Object(z.a)(e).call(this,t,Object.assign({id:"copy-pass",swap:!0},r)))).clipspace=new Jn(t,{id:"copy-pass",fs:qn}),n}return Object(G.a)(e,t),Object(P.a)(e,[{key:"_renderPass",value:function(t){var e=t.inputBuffer,n=this.props.opacity,r=void 0===n?1:n;this.clipspace.draw({uniforms:{uDiffuseSampler:e,uOpacity:r},parameters:{depthWrite:!1,depthTest:!1}})}}]),e}(Bn),Kn="uniform sampler2D uDiffuseSampler;\nuniform float uOpacity;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 texel = texture2D(uDiffuseSampler, uv);\n  gl_FragColor = uOpacity * texel;\n}\n",$n=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(g.a)(this,e),n=Object(U.a)(this,Object(z.a)(e).call(this,t,Object.assign({id:"texture-pass"},r)));var i=r.texture,o=r.opacity,a=void 0===o?1:o;return n.clipspace=new Jn(t,{id:"texture-pass",fs:Kn,uniforms:{uDiffuseSampler:i,uOpacity:a}}),n}return Object(G.a)(e,t),Object(P.a)(e,[{key:"_renderPass",value:function(){this.clipspace.draw({parameters:{depthWrite:!1,depthTest:!1}})}}]),e}(Bn);n("tVzf");n("gBGw");n.d(e,"v",function(){return r.d}),n.d(e,"q",function(){return j}),n.d(e,"A",function(){return v.a}),n.d(e,"z",function(){return R.b}),n.d(e,"B",function(){return R.c}),n.d(e,"d",function(){return I}),n.d(e,"t",function(){return F}),n.d(e,"u",function(){return N}),n.d(e,"b",function(){return B.a}),n.d(e,"e",function(){return gt}),n.d(e,"h",function(){return et.a}),n.d(e,"p",function(){return dt}),n.d(e,"g",function(){return Tn}),n.d(e,"a",function(){return Mn}),n.d(e,"i",function(){return Fn}),n.d(e,"j",function(){return he}),n.d(e,"n",function(){return Nn}),n.d(e,"m",function(){return Gn}),n.d(e,"k",function(){return Vn}),n.d(e,"l",function(){return Qn}),n.d(e,"o",function(){return $n}),n.d(e,"f",function(){return pe}),n.d(e,"c",function(){return Hn}),n.d(e,"y",function(){return Ee}),n.d(e,"x",function(){return Oe}),n.d(e,"r",function(){return $e}),n.d(e,"s",function(){return on}),n.d(e,"w",function(){return ln}),n("c8wm")},LtGd:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n("so2h"),i=n("K9nA");function o(){if(!r.b){var t=i.a.hrtime();return t[0]+t[1]/1e6}return i.b.performance?i.b.performance.now():Date.now()}o()},MCLT:function(t,e,n){(function(t,r){var i=/%[sdj%]/g;e.format=function(t){if(!y(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(t).replace(i,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),u=r[n];n<o;u=r[++n])v(u)||!b(u)?a+=" "+u:a+=" "+s(u);return a},e.deprecate=function(n,i){if(m(t.process))return function(){return e.deprecate(n,i).apply(this,arguments)};if(!0===r.noDeprecation)return n;var o=!1;return function(){if(!o){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),o=!0}return n.apply(this,arguments)}};var o,a={};function s(t,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&e._extend(r,n),m(r.showHidden)&&(r.showHidden=!1),m(r.depth)&&(r.depth=2),m(r.colors)&&(r.colors=!1),m(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),l(r,t,r.depth)}function u(t,e){var n=s.styles[e];return n?"["+s.colors[n][0]+"m"+t+"["+s.colors[n][1]+"m":t}function c(t,e){return t}function l(t,n,r){if(t.customInspect&&n&&E(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return y(i)||(i=l(t,i,r)),i}var o=function(t,e){if(m(e))return t.stylize("undefined","undefined");if(y(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(g(e))return t.stylize(""+e,"number");if(p(e))return t.stylize(""+e,"boolean");if(v(e))return t.stylize("null","null")}(t,n);if(o)return o;var a=Object.keys(n),s=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),x(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(n);if(0===a.length){if(E(n)){var u=n.name?": "+n.name:"";return t.stylize("[Function"+u+"]","special")}if(_(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return t.stylize(Date.prototype.toString.call(n),"date");if(x(n))return h(n)}var c,b="",O=!1,P=["{","}"];(d(n)&&(O=!0,P=["[","]"]),E(n))&&(b=" [Function"+(n.name?": "+n.name:"")+"]");return _(n)&&(b=" "+RegExp.prototype.toString.call(n)),w(n)&&(b=" "+Date.prototype.toUTCString.call(n)),x(n)&&(b=" "+h(n)),0!==a.length||O&&0!=n.length?r<0?_(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=O?function(t,e,n,r,i){for(var o=[],a=0,s=e.length;a<s;++a)T(e,String(a))?o.push(f(t,e,n,r,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(f(t,e,n,r,i,!0))}),o}(t,n,r,s,a):a.map(function(e){return f(t,n,r,s,e,O)}),t.seen.pop(),function(t,e,n){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(c,b,P)):P[0]+b+P[1]}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,n,r,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?s=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(s=t.stylize("[Setter]","special")),T(r,i)||(a="["+i+"]"),s||(t.seen.indexOf(u.value)<0?(s=v(n)?l(t,u.value,null):l(t,u.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n")):s=t.stylize("[Circular]","special")),m(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function d(t){return Array.isArray(t)}function p(t){return"boolean"==typeof t}function v(t){return null===t}function g(t){return"number"==typeof t}function y(t){return"string"==typeof t}function m(t){return void 0===t}function _(t){return b(t)&&"[object RegExp]"===O(t)}function b(t){return"object"==typeof t&&null!==t}function w(t){return b(t)&&"[object Date]"===O(t)}function x(t){return b(t)&&("[object Error]"===O(t)||t instanceof Error)}function E(t){return"function"==typeof t}function O(t){return Object.prototype.toString.call(t)}function P(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(m(o)&&(o=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!a[t])if(new RegExp("\\b"+t+"\\b","i").test(o)){var n=r.pid;a[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else a[t]=function(){};return a[t]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=p,e.isNull=v,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=y,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=m,e.isRegExp=_,e.isObject=b,e.isDate=w,e.isError=x,e.isFunction=E,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n("1gqn");var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){var t,n;console.log("%s - %s",(t=new Date,n=[P(t.getHours()),P(t.getMinutes()),P(t.getSeconds())].join(":"),[t.getDate(),S[t.getMonth()],n].join(" ")),e.format.apply(e,arguments))},e.inherits=n("P7XM"),e._extend=function(t,e){if(!e||!b(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,n("yLpj"),n("8oxB"))},MgzW:function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,a,s=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),u=1;u<arguments.length;u++){for(var c in n=Object(arguments[u]))i.call(n,c)&&(s[c]=n[c]);if(r){a=r(n);for(var l=0;l<a.length;l++)o.call(n,a[l])&&(s[a[l]]=n[a[l]])}}return s}},N2HP:function(t,e){t.exports=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}},"NaB/":function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n("1OyB"),i=n("vuIU"),o=n("c8wm"),a=n("xo4u"),s=n("ket5"),u=n("lvHR"),c="Resource subclass must define virtual methods",l=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(r.a)(this,t),Object(a.e)(e);var i=n.id,o=n.userData,u=void 0===o?{}:o;this.gl=e,this.id=i||Object(s.i)(this.constructor.name),this.userData=u,this._bound=!1,this._handle=n.handle,void 0===this._handle&&(this._handle=this._createHandle()),this._addStats()}return Object(i.a)(t,[{key:"toString",value:function(){return"".concat(this.constructor.name,"(").concat(this.id,")")}},{key:"delete",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).deleteChildren,e=void 0!==t&&t,n=this._handle&&this._deleteHandle(this._handle);return this._handle=null,this._removeStats(),n&&e&&n.filter(Boolean).forEach(function(t){t.delete()}),this}},{key:"bind",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!=typeof e?(this._bindHandle(e),this):(this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t)}},{key:"unbind",value:function(){this.bind(null)}},{key:"getParameter",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=Object(a.j)(this.gl,t),Object(u.a)(t);var n=(this.constructor.PARAMETERS||{})[t];if(n){var r=Object(a.n)(this.gl);if(!((!("webgl2"in n)||r)&&(!("extension"in n)||this.gl.getExtension(n.extension)))){var i=n.webgl1,o="webgl2"in n?n.webgl2:n.webgl1;return r?o:i}}return this._getParameter(t,e)}},{key:"getParameters",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},n=e.parameters,r=e.keys,i=this.constructor.PARAMETERS||{},o=Object(a.n)(this.gl),s={},u=n||Object.keys(i),c=!0,l=!1,h=void 0;try{for(var f,d=u[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var p=f.value,v=i[p];if(v&&(!("webgl2"in v)||o)&&(!("extension"in v)||this.gl.getExtension(v.extension))){var g=r?Object(a.i)(this.gl,p):p;s[g]=this.getParameter(p,t),r&&"GLenum"===v.type&&(s[g]=Object(a.i)(this.gl,s[g]))}}}catch(t){l=!0,h=t}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}return s}},{key:"setParameter",value:function(t,e){t=Object(a.j)(this.gl,t),Object(u.a)(t);var n=(this.constructor.PARAMETERS||{})[t];if(n){var r=Object(a.n)(this.gl);if(!((!("webgl2"in n)||r)&&(!("extension"in n)||this.gl.getExtension(n.extension))))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(e=Object(a.j)(e))}return this._setParameter(t,e),this}},{key:"setParameters",value:function(t){for(var e in t)this.setParameter(e,t[e]);return this}},{key:"stubRemovedMethods",value:function(t,e,n){return Object(s.h)(this,t,e,n)}},{key:"initialize",value:function(t){}},{key:"_createHandle",value:function(){throw new Error(c)}},{key:"_deleteHandle",value:function(){throw new Error(c)}},{key:"_bindHandle",value:function(){throw new Error(c)}},{key:"_getOptsFromHandle",value:function(){throw new Error(c)}},{key:"_getParameter",value:function(t,e){throw new Error(c)}},{key:"_setParameter",value:function(t,e){throw new Error(c)}},{key:"_context",value:function(){return this.gl.luma=this.gl.luma||{},this.gl.luma}},{key:"_addStats",value:function(){var t=this.constructor.name,e=o.default.stats;e.resourceCount=e.resourceCount||0,e.resourceMap=e.resourceMap||{},e.resourceCount++,e.resourceMap[t]=e.resourceMap[t]||{created:0,active:0},e.resourceMap[t].created++,e.resourceMap[t].active++}},{key:"_removeStats",value:function(){var t=this.constructor.name;o.default.stats.resourceMap[t].active--}},{key:"handle",get:function(){return this._handle}}]),t}()},NhK1:function(t,e,n){"use strict";var r=n("TqRt");Object.defineProperty(e,"__esModule",{value:!0}),e.installParameterDefinitions=function(){},e.TEXTURE_PARAMETERS=e.SAMPLER_PARAMETERS=e.RENDERBUFFER_PARAMETERS=e.PROGRAM_PARAMETERS=e.FRAMEBUFFER_STATUS=e.FRAMEBUFFER_ATTACHMENT_PARAMETERS=e.FENCE_SYNC_PARAMETERS=e.BUFFER_PARAMETERS=e.GLboolean=e.GLuint=e.GLint=e.GLfloat=e.GLenum=void 0;var i,o,a,s,u,c,l=r(n("lSNA"));e.GLenum="GLenum";e.GLfloat="GLfloat";e.GLint="GLint";e.GLuint="GLint";e.GLboolean="GLboolean";var h=(i={},(0,l.default)(i,34660,{webgl1:0}),(0,l.default)(i,34661,{webgl1:0}),i);e.BUFFER_PARAMETERS=h;e.FENCE_SYNC_PARAMETERS=[37138,37140,37139,37141];e.FRAMEBUFFER_ATTACHMENT_PARAMETERS=[36049,36048,36051,36050,33296,36052,33298,33299,33300,33301,33302,33303,33297];var f=(o={},(0,l.default)(o,36053,"Success. Framebuffer is correctly set up"),(0,l.default)(o,36054,"Framebuffer attachment types mismatched or some attachment point not attachment complete"),(0,l.default)(o,36055,"Framebuffer has no attachment"),(0,l.default)(o,36057,"Framebuffer attachments do not have the same size"),(0,l.default)(o,36061,"Framebuffer attachment format not supported or depth and stencil attachments are not same"),(0,l.default)(o,36182,"Framebuffer attachement SAMPLES differs among renderbuffers, or are mixed with textures"),o);e.FRAMEBUFFER_STATUS=f;var d=(a={},(0,l.default)(a,35712,{webgl1:0}),(0,l.default)(a,35714,{webgl1:0}),(0,l.default)(a,35715,{webgl1:0}),(0,l.default)(a,35717,{webgl1:0}),(0,l.default)(a,35721,{webgl1:0}),(0,l.default)(a,35718,{webgl1:0}),(0,l.default)(a,35967,{webgl2:0}),(0,l.default)(a,35971,{webgl2:0}),(0,l.default)(a,35382,{webgl2:0}),a);e.PROGRAM_PARAMETERS=d;var p=(s={},(0,l.default)(s,36162,{webgl1:0}),(0,l.default)(s,36163,{webgl1:0}),(0,l.default)(s,36164,{type:"GLenum",webgl1:32854}),(0,l.default)(s,36177,{webgl1:0}),(0,l.default)(s,36178,{webgl1:0}),(0,l.default)(s,36176,{webgl1:0}),(0,l.default)(s,36179,{webgl1:0}),(0,l.default)(s,36180,{webgl1:0}),(0,l.default)(s,36181,{webgl1:0}),(0,l.default)(s,36011,{webgl2:1}),s);e.RENDERBUFFER_PARAMETERS=p;var v=(u={},(0,l.default)(u,10240,{webgl2:!0}),(0,l.default)(u,10241,{webgl2:!0}),(0,l.default)(u,10242,{webgl2:!0}),(0,l.default)(u,10243,{webgl2:!0}),(0,l.default)(u,32882,{webgl2:!0}),(0,l.default)(u,33084,{webgl2:!0}),(0,l.default)(u,33085,{webgl2:!0}),(0,l.default)(u,34893,{webgl2:!0}),(0,l.default)(u,34892,{webgl2:!0}),(0,l.default)(u,33082,{webgl2:!0}),(0,l.default)(u,33083,{webgl2:!0}),u);e.SAMPLER_PARAMETERS=v;var g=(c={},(0,l.default)(c,10240,{type:"GLenum",webgl1:9729}),(0,l.default)(c,10241,{type:"GLenum",webgl1:9986}),(0,l.default)(c,10242,{type:"GLenum",webgl1:10497}),(0,l.default)(c,10243,{type:"GLenum",webgl1:10497}),(0,l.default)(c,32882,{type:"GLenum",webgl2:10497}),(0,l.default)(c,33084,{webgl2:0}),(0,l.default)(c,33085,{webgl2:1e3}),(0,l.default)(c,34893,{type:"GLenum",webgl2:515}),(0,l.default)(c,34892,{type:"GLenum",webgl2:0}),(0,l.default)(c,33082,{webgl2:-1e3}),(0,l.default)(c,33083,{webgl2:1e3}),(0,l.default)(c,4096,{webgl1:0}),(0,l.default)(c,4097,{webgl1:0}),c);e.TEXTURE_PARAMETERS=g},Nx27:function(t,e,n){"use strict";n.d(e,"a",function(){return d});var r=n("1OyB"),i=n("md7G"),o=n("foSv"),a=n("vuIU"),s=n("Ji7U"),u=n("JX7q"),c=n("xo4u"),l=n("Sr2d"),h=n("6Sts"),f=n("Gujg"),d=function(t){function e(t){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.a)(this,e),Object(c.d)(t),(n=Object(i.a)(this,Object(o.a)(e).call(this,t,Object.assign({},a,{target:a.target||32879})))).width=null,n.height=null,n.depth=null,Object.seal(Object(u.a)(Object(u.a)(n))),n.setImageData(a),a.generateMipmap&&n.generateMipmap(),n}return Object(s.a)(e,t),Object(a.a)(e,null,[{key:"isSupported",value:function(t){return Object(c.n)(t)}}]),Object(a.a)(e,[{key:"initialize",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.opts=Object.assign({},this.opts,e);var n=this.opts,r=n.pixels,i=n.settings;i&&(Object(l.c)(i,function(){r&&t.setImage3D(t.opts)}),this.setParameters(e))}},{key:"setImage3D",value:function(t){var e=t.level,n=void 0===e?0:e,r=t.internalformat,i=void 0===r?6408:r,o=t.width,a=t.height,s=t.depth,u=void 0===s?1:s,c=t.border,l=void 0===c?0:c,h=t.format,d=t.type,p=void 0===d?5121:d,v=t.offset,g=void 0===v?0:v,y=t.pixels;ArrayBuffer.isView(y)?this.gl.texImage3D(this.target,n,i,o,a,u,l,h,p,y):y instanceof f.a&&(this.gl.bindBuffer(35052,y.handle),this.gl.texImage3D(this.target,n,i,o,a,u,l,h,p,g),this.gl.bindBuffer(35052,y.handle))}}]),e}(h.a)},ODXe:function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.d(e,"a",function(){return r})},OIVS:function(t,e,n){"use strict";function r(t,e){if(t===e)return!0;if(Array.isArray(t)){var n=t.length;if(!e||e.length!==n)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function i(t){var e,n={};return function(i){for(var o in i)if(!r(i[o],n[o])){e=t(i),n=i;break}return e}}n.d(e,"a",function(){return i})},P7XM:function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},QCnb:function(t,e,n){"use strict";t.exports=n("+wdc")},QLaP:function(t,e,n){"use strict";t.exports=function(t,e,n,r,i,o,a,s){if(!t){var u;if(void 0===e)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,i,o,a,s],l=0;(u=new Error(e.replace(/%s/g,function(){return c[l++]}))).name="Invariant Violation"}throw u.framesToPop=1,u}}},Qizj:function(t,e){t.exports=function(t,e,n,r){var i=n[1],o=n[2],a=e[1]-i,s=e[2]-o,u=Math.sin(r),c=Math.cos(r);return t[0]=e[0],t[1]=i+a*c-s*u,t[2]=o+a*u+s*c,t}},RP4a:function(t,e){t.exports=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],l=e[9],h=e[10],f=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=o*i-c*r,t[1]=a*i-l*r,t[2]=s*i-h*r,t[3]=u*i-f*r,t[8]=o*r+c*i,t[9]=a*r+l*i,t[10]=s*r+h*i,t[11]=u*r+f*i,t}},S4Ro:function(t,e,n){"use strict";n.d(e,"a",function(){return h});var r=n("1OyB"),i=n("vuIU"),o=n("md7G"),a=n("foSv"),s=n("Ji7U"),u=n("h6m0"),c=n("N2HP"),l=n.n(c),h=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(r.a)(this,e),t=Object(o.a)(this,Object(a.a)(e).call(this)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,i),t}return Object(s.a)(e,t),Object(i.a)(e,[{key:"cross",value:function(t){return l()(this,this,t),this.check()}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"operation",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.apply(void 0,[this,this].concat(n)),this.check()}},{key:"ELEMENTS",get:function(){return 2}}]),e}(u.a)},"SR+o":function(t,e,n){"use strict";n.d(e,"a",function(){return h});var r=n("1OyB"),i=n("md7G"),o=n("foSv"),a=n("vuIU"),s=n("Ji7U"),u=n("JX7q"),c=n("6Sts"),l=n("xo4u"),h=function(t){function e(t){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.a)(this,e),Object(l.e)(t),(n=Object(i.a)(this,Object(o.a)(e).call(this,t,Object.assign({},a,{target:3553})))).initialize(a),Object.seal(Object(u.a)(Object(u.a)(n))),n}return Object(s.a)(e,t),Object(a.a)(e,null,[{key:"isSupported",value:function(t,e){return c.a.isSupported(t,e)}}]),Object(a.a)(e,[{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit,e=this.gl;if(void 0===t)throw new Error("Texture.bind: must specify texture unit");return this.textureUnit=t,e.activeTexture(33984+t),e.bindTexture(this.target,this.handle),t}},{key:"unbind",value:function(){var t=this.gl;if(void 0===this.textureUnit)throw new Error("Texture.unbind: texture unit not specified");return t.activeTexture(33984+this.textureUnit),t.bindTexture(this.target,null),this.textureUnit}},{key:"getActiveUnit",value:function(){return this.gl.getParameter(34016)-33984}}]),e}(c.a)},Sr2d:function(t,e,n){"use strict";n.d(e,"b",function(){return h}),n.d(e,"c",function(){return f});var r=n("ODXe"),i=n("KQm4"),o=n("r+5q"),a=n("62Ki");n.d(e,"a",function(){return a.c});var s=n("ket5"),u=n("lvHR"),c={framebuffer:function(t,e){var n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:function(t,e){return e?t.enable(3042):t.disable(3042)},blendColor:function(t,e){return t.blendColor.apply(t,Object(i.a)(e))},blendEquation:function(t,e){e=l(e)?e:[e,e],t.blendEquationSeparate.apply(t,Object(i.a)(e))},blendFunc:function(t,e){e=l(e)&&2===e.length?Object(i.a)(e).concat(Object(i.a)(e)):e,t.blendFuncSeparate.apply(t,Object(i.a)(e))},clearColor:function(t,e){return t.clearColor.apply(t,Object(i.a)(e))},clearDepth:function(t,e){return t.clearDepth(e)},clearStencil:function(t,e){return t.clearStencil(e)},colorMask:function(t,e){return t.colorMask.apply(t,Object(i.a)(e))},cull:function(t,e){return e?t.enable(2884):t.disable(2884)},cullFace:function(t,e){return t.cullFace(e)},depthTest:function(t,e){return e?t.enable(2929):t.disable(2929)},depthFunc:function(t,e){return t.depthFunc(e)},depthMask:function(t,e){return t.depthMask(e)},depthRange:function(t,e){return t.depthRange.apply(t,Object(i.a)(e))},dither:function(t,e){return e?t.enable(3024):t.disable(3024)},derivativeHint:function(t,e){t.hint(35723,e)},frontFace:function(t,e){return t.frontFace(e)},mipmapHint:function(t,e){return t.hint(33170,e)},lineWidth:function(t,e){return t.lineWidth(e)},polygonOffsetFill:function(t,e){return e?t.enable(32823):t.disable(32823)},polygonOffset:function(t,e){return t.polygonOffset.apply(t,Object(i.a)(e))},sampleCoverage:function(t,e){return t.sampleCoverage.apply(t,Object(i.a)(e))},scissorTest:function(t,e){return e?t.enable(3089):t.disable(3089)},scissor:function(t,e){return t.scissor.apply(t,Object(i.a)(e))},stencilTest:function(t,e){return e?t.enable(2960):t.disable(2960)},stencilMask:function(t,e){var n=e=l(e)?e:[e,e],i=Object(r.a)(n,2),o=i[0],a=i[1];t.stencilMaskSeparate(1028,o),t.stencilMaskSeparate(1029,a)},stencilFunc:function(t,e){var n=e=l(e)&&3===e.length?Object(i.a)(e).concat(Object(i.a)(e)):e,o=Object(r.a)(n,6),a=o[0],s=o[1],u=o[2],c=o[3],h=o[4],f=o[5];t.stencilFuncSeparate(1028,a,s,u),t.stencilFuncSeparate(1029,c,h,f)},stencilOp:function(t,e){var n=e=l(e)&&3===e.length?Object(i.a)(e).concat(Object(i.a)(e)):e,o=Object(r.a)(n,6),a=o[0],s=o[1],u=o[2],c=o[3],h=o[4],f=o[5];t.stencilOpSeparate(1028,a,s,u),t.stencilOpSeparate(1029,c,h,f)},viewport:function(t,e){return t.viewport.apply(t,Object(i.a)(e))}};function l(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function h(t,e){for(var n in Object(a.d)(t,e),e){var r=c[n];r&&r(t,e[n],n)}}function f(t,e,n){if(Object(s.d)(e))return n(t);var r,i=e.nocatch,a=void 0===i||i;if(Object(u.a)(!e.frameBuffer),Object(o.c)(t),h(t,e),a)r=n(t),Object(o.b)(t);else try{r=n(t)}finally{Object(o.b)(t)}return r}},T2Xe:function(t,e){t.exports=function(t,e,n,r){var i=n[0],o=n[2],a=e[0]-i,s=e[2]-o,u=Math.sin(r),c=Math.cos(r);return t[0]=i+s*u+a*c,t[1]=e[1],t[2]=o+s*c-a*u,t}},TZTB:function(t,e,n){(function(e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i="object"!==(void 0===e?"undefined":r(e))||"[object process]"!==String(e)||e.browser;t.exports={window:"undefined"!=typeof window?window:n,global:void 0!==n?n:window,document:"undefined"!=typeof document?document:{},isBrowser:i}}).call(this,n("8oxB"),n("yLpj"))},TjS6:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r,i=n("rePB"),o=function(t){return s(t)?void 0:0},a=(r={},Object(i.a)(r,3074,function(t){return s(t)?void 0:36064}),Object(i.a)(r,35723,function(t){return s(t)?void 0:4352}),Object(i.a)(r,35977,o),Object(i.a)(r,32937,o),Object(i.a)(r,36795,function(t,e){var n=s(t)?t.getExtension("EXT_disjoint_timer_query_webgl2"):t.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0}),Object(i.a)(r,37445,function(t,e){var n=t.getExtension("WEBGL_debug_renderer_info");return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)}),Object(i.a)(r,37446,function(t,e){var n=t.getExtension("WEBGL_debug_renderer_info");return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)}),Object(i.a)(r,34047,function(t,e){var n=t.luma.extensions.EXT_texture_filter_anisotropic;return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1}),Object(i.a)(r,32883,o),Object(i.a)(r,35071,o),Object(i.a)(r,37447,o),Object(i.a)(r,36063,function(t,e){if(!s(t)){var n=t.getExtension("WEBGL_draw_buffers");return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}}),Object(i.a)(r,35379,o),Object(i.a)(r,35374,o),Object(i.a)(r,35377,o),Object(i.a)(r,34852,function(t){if(!s(t)){var e=t.getExtension("WEBGL_draw_buffers");return e?e.MAX_DRAW_BUFFERS_WEBGL:0}}),Object(i.a)(r,36203,function(t){return t.getExtension("OES_element_index")?2147483647:65535}),Object(i.a)(r,33001,function(t){return t.getExtension("OES_element_index")?16777216:65535}),Object(i.a)(r,33e3,function(t){return 16777216}),Object(i.a)(r,37157,o),Object(i.a)(r,35373,o),Object(i.a)(r,35657,o),Object(i.a)(r,36183,o),Object(i.a)(r,37137,o),Object(i.a)(r,34045,o),Object(i.a)(r,35978,o),Object(i.a)(r,35979,o),Object(i.a)(r,35968,o),Object(i.a)(r,35376,o),Object(i.a)(r,35375,o),Object(i.a)(r,35659,o),Object(i.a)(r,37154,o),Object(i.a)(r,35371,o),Object(i.a)(r,35658,o),Object(i.a)(r,35076,o),Object(i.a)(r,35077,o),Object(i.a)(r,35380,o),r);function s(t){return t&&!0}function u(t,e,n){var r=a[n],i="function"==typeof r?r(t,e,n):r;return void 0!==i?i:e(n)}},TqRt:function(t,e){t.exports=function(t){return t&&t.__esModule?t:{default:t}}},U8pU:function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return(i="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(t){return r(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":r(t)})(t)}n.d(e,"a",function(){return i})},V3d6:function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"b",function(){return i});var r={LNGLAT:1,LNGLAT_EXPERIMENTAL:1,LNGLAT_DEPRECATED:5,METER_OFFSETS:2,METERS:2,LNGLAT_OFFSETS:3,IDENTITY:0},i={panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}}},V8ep:function(t,e,n){"use strict";n.d(e,"a",function(){return v}),n.d(e,"b",function(){return y});var r=n("ZaHm"),i=n("bl9R"),o=n("V3d6"),a=n("OIVS"),s=n("Jh/b"),u=n("VMBB"),c=n("puIE"),l=[0,0,0,0],h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],d=[0,0,0],p=[0,0,0],v=12,g=Object(a.a)(function(t){var e=t.viewport,n=t.devicePixelRatio,a=t.coordinateSystem,s=t.coordinateOrigin,f=t.wrapLongitude,p=e.zoom;Object(u.a)(p>=0);var g=function(t){var e,n=t.viewport,a=t.coordinateSystem,s=t.coordinateOrigin,u=t.coordinateZoom,f=n.viewMatrixUncentered,d=n.viewMatrix,p=n.projectionMatrix,g=n.viewProjectionMatrix,y=function(t){switch(t){case o.a.LNGLAT:case o.a.LNGLAT_EXPERIMENTAL:default:return c.a.LNGLAT_AUTO_OFFSET;case o.a.LNGLAT_DEPRECATED:return c.a.LNG_LAT;case o.a.METER_OFFSETS:case o.a.METERS:return c.a.METER_OFFSETS;case o.a.LNGLAT_OFFSETS:return c.a.LNGLAT_OFFSETS;case o.a.IDENTITY:return c.a.IDENTITY}}(a),m=s;if(y===c.a.LNGLAT_AUTO_OFFSET)if(u<v)y=c.a.LNG_LAT;else{var _=Math.fround(n.longitude),b=Math.fround(n.latitude);m=[_,b]}switch(y){case c.a.IDENTITY:case c.a.LNG_LAT:e=l;break;case c.a.LNGLAT_OFFSETS:case c.a.METER_OFFSETS:case c.a.LNGLAT_AUTO_OFFSET:var w=n.projectFlat(m,Math.pow(2,u));e=i.b([],[w[0],w[1],0,1],g),d=f||d,g=r.c([],p,d),g=r.c([],g,h);break;default:throw new Error("Unknown projection mode")}return{viewMatrix:d,viewProjectionMatrix:g,projectionCenter:e,cameraPos:n.cameraPosition,shaderCoordinateSystem:y,shaderCoordinateOrigin:m}}({coordinateSystem:a,coordinateOrigin:s,coordinateZoom:p,viewport:e}),y=g.projectionCenter,m=g.viewProjectionMatrix,_=g.cameraPos,b=g.shaderCoordinateSystem,w=g.shaderCoordinateOrigin;Object(u.a)(m,"Viewport missing modelViewProjectionMatrix");var x=e.getDistanceScales(),E=[e.width*n,e.height*n],O={project_uCoordinateSystem:b,project_uCenter:y,project_uWrapLongitude:f,project_uAntimeridian:(e.longitude||0)-180,project_uViewportSize:E,project_uDevicePixelRatio:n,project_uFocalDistance:e.focalDistance||1,project_uPixelsPerMeter:x.pixelsPerMeter,project_uPixelsPerDegree:x.pixelsPerDegree,project_uPixelsPerUnit:x.pixelsPerMeter,project_uPixelsPerUnit2:d,project_uScale:e.scale,project_uViewProjectionMatrix:m,project_uCameraPosition:_},P=e.getDistanceScales(w);switch(b){case c.a.METER_OFFSETS:O.project_uPixelsPerUnit=P.pixelsPerMeter,O.project_uPixelsPerUnit2=P.pixelsPerMeter2;break;case c.a.LNGLAT_AUTO_OFFSET:O.project_coordinate_origin=w;case c.a.LNGLAT_OFFSETS:O.project_uPixelsPerUnit=P.pixelsPerDegree,O.project_uPixelsPerUnit2=P.pixelsPerDegree2}return O});function y(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.viewport,n=t.devicePixelRatio,r=void 0===n?1:n,i=t.modelMatrix,a=void 0===i?null:i,c=t.coordinateSystem,l=void 0===c?o.a.LNGLAT:c,h=t.coordinateOrigin,d=void 0===h?p:h,v=t.wrapLongitude,y=void 0!==v&&v,m=t.projectionMode,_=t.positionOrigin;return Object(u.a)(e),void 0!==m&&s.a.removed("projectionMode","coordinateSystem")(),void 0!==_&&s.a.removed("positionOrigin","coordinateOrigin")(),Object.assign({project_uModelMatrix:a||f},g({viewport:e,devicePixelRatio:r,coordinateSystem:l,coordinateOrigin:d,wrapLongitude:y}))}},VFMm:function(t,e,n){},VKpO:function(t,e,n){"use strict";n.d(e,"a",function(){return s}),n.d(e,"d",function(){return u}),n.d(e,"c",function(){return c}),n.d(e,"b",function(){return l});var r=n("2cIc"),i=n.n(r),o=n("YllZ"),a=n.n(o);function s(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function u(t,e){var n=a()([],e,t);return i()(n,n,1/n[3]),n}function c(t,e){var n=t%e;return n<0?e+n:n}function l(t,e,n){return n*e+(1-n)*t}},VMBB:function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}n.d(e,"a",function(){return r})},Vame:function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return r}),n.d(e,"b",function(){return i});var r="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",i="undefined"!=typeof window?window:t;void 0!==t||window,"undefined"!=typeof document&&document}).call(this,n("yLpj"))},VmRL:function(t,e,n){"use strict";function r(t,e,n){n=n||2;var r,s,u,c,l,d,v,g=e&&e.length,y=g?e[0]*n:t.length,m=i(t,0,y,n,!0),_=[];if(!m)return _;if(g&&(m=function(t,e,n,r){var a,s,u,c,l,d=[];for(a=0,s=e.length;a<s;a++)u=e[a]*r,c=a<s-1?e[a+1]*r:t.length,(l=i(t,u,c,r,!1))===l.next&&(l.steiner=!0),d.push(p(l));for(d.sort(h),a=0;a<d.length;a++)f(d[a],n),n=o(n,n.next);return n}(t,e,m,n)),t.length>80*n){r=u=t[0],s=c=t[1];for(var b=n;b<y;b+=n)(l=t[b])<r&&(r=l),(d=t[b+1])<s&&(s=d),l>u&&(u=l),d>c&&(c=d);v=0!==(v=Math.max(u-r,c-s))?1/v:0}return a(m,_,n,r,s,v),_}function i(t,e,n,r,i){var o,a;if(i===P(t,e,n,r)>0)for(o=e;o<n;o+=r)a=x(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=x(o,t[o],t[o+1],a);return a&&m(a,a.next)&&(E(a),a=a.next),a}function o(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!m(r,r.next)&&0!==y(r.prev,r,r.next))r=r.next;else{if(E(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function a(t,e,n,r,i,h,f){if(t){!f&&h&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=d(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(t,r,i,h);for(var p,v,g=t;t.prev!==t.next;)if(p=t.prev,v=t.next,h?u(t,r,i,h):s(t))e.push(p.i/n),e.push(t.i/n),e.push(v.i/n),E(t),t=v.next,g=v.next;else if((t=v)===g){f?1===f?a(t=c(t,e,n),e,n,r,i,h,2):2===f&&l(t,e,n,r,i,h):a(o(t),e,n,r,i,h,1);break}}}function s(t){var e=t.prev,n=t,r=t.next;if(y(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(v(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&y(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(t,e,n,r){var i=t.prev,o=t,a=t.next;if(y(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=d(s,u,e,n,r),f=d(c,l,e,n,r),p=t.prevZ,g=t.nextZ;p&&p.z>=h&&g&&g.z<=f;){if(p!==t.prev&&p!==t.next&&v(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&y(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,g!==t.prev&&g!==t.next&&v(i.x,i.y,o.x,o.y,a.x,a.y,g.x,g.y)&&y(g.prev,g,g.next)>=0)return!1;g=g.nextZ}for(;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&v(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&y(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;g&&g.z<=f;){if(g!==t.prev&&g!==t.next&&v(i.x,i.y,o.x,o.y,a.x,a.y,g.x,g.y)&&y(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function c(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!m(i,o)&&_(i,r,r.next,o)&&b(i,o)&&b(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),E(r),E(r.next),r=t=o),r=r.next}while(r!==t);return r}function l(t,e,n,r,i,s){var u=t;do{for(var c=u.next.next;c!==u.prev;){if(u.i!==c.i&&g(u,c)){var l=w(u,c);return u=o(u,u.next),l=o(l,l.next),a(u,e,n,r,i,s),void a(l,e,n,r,i,s)}c=c.next}u=u.next}while(u!==t)}function h(t,e){return t.x-e.x}function f(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n.prev;var u,c=n,l=n.x,h=n.y,f=1/0;r=n.next;for(;r!==c;)i>=r.x&&r.x>=l&&i!==r.x&&v(o<h?i:a,o,l,h,o<h?a:i,o,r.x,r.y)&&((u=Math.abs(o-r.y)/(i-r.x))<f||u===f&&r.x>n.x)&&b(r,t)&&(n=r,f=u),r=r.next;return n}(t,e)){var n=w(e,t);o(n,n.next)}}function d(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function p(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function v(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&_(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&b(t,e)&&b(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function y(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function m(t,e){return t.x===e.x&&t.y===e.y}function _(t,e,n,r){return!!(m(t,e)&&m(n,r)||m(t,r)&&m(n,e))||y(t,e,n)>0!=y(t,e,r)>0&&y(n,r,t)>0!=y(n,r,e)>0}function b(t,e){return y(t.prev,t,t.next)<0?y(t,e,t.next)>=0&&y(t,t.prev,e)>=0:y(t,e,t.prev)<0||y(t,t.next,e)<0}function w(t,e){var n=new O(t.i,t.x,t.y),r=new O(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function x(t,e,n,r){var i=new O(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function E(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function O(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function P(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}t.exports=r,t.exports.default=r,r.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(P(t,0,o,n));if(i)for(var s=0,u=e.length;s<u;s++){var c=e[s]*n,l=s<u-1?e[s+1]*n:t.length;a-=Math.abs(P(t,c,l,n))}var h=0;for(s=0;s<r.length;s+=3){var f=r[s]*n,d=r[s+1]*n,p=r[s+2]*n;h+=Math.abs((t[f]-t[p])*(t[d+1]-t[f+1])-(t[f]-t[d])*(t[p+1]-t[f+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},WSjQ:function(t,e){t.exports=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,h=r*s,f=i*a,d=i*s,p=i*u,v=o*a,g=o*s,y=o*u;return t[0]=1-h-p,t[1]=l+y,t[2]=f-g,t[3]=0,t[4]=l-y,t[5]=1-c-p,t[6]=d+v,t[7]=0,t[8]=f+g,t[9]=d-v,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},WbBG:function(t,e,n){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},WsjP:function(t,e,n){"use strict";n.d(e,"c",function(){return c}),n.d(e,"d",function(){return l}),n.d(e,"b",function(){return h}),n.d(e,"a",function(){return f});var r=n("JD4l"),i=n("lvHR"),o=34962,a=32874,s="Invalid WebGLRenderingContext",u="Requires WebGL2";function c(t){return Boolean(t&&(t instanceof r.c||t.ARRAY_BUFFER===o))}function l(t){return Boolean(t&&(t instanceof r.a||t.TEXTURE_BINDING_3D===a))}function h(t){Object(i.a)(c(t),s)}function f(t){Object(i.a)(l(t),u)}},YllZ:function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}},ZaHm:function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"c",function(){return o}),n.d(e,"i",function(){return a}),n.d(e,"h",function(){return s}),n.d(e,"e",function(){return u}),n.d(e,"f",function(){return c}),n.d(e,"g",function(){return l}),n.d(e,"d",function(){return h}),n.d(e,"b",function(){return f});var r=n("yU0y");function i(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],p=e[12],v=e[13],g=e[14],y=e[15],m=n*s-r*a,_=n*u-i*a,b=n*c-o*a,w=r*u-i*s,x=r*c-o*s,E=i*c-o*u,O=l*v-h*p,P=l*g-f*p,S=l*y-d*p,T=h*g-f*v,C=h*y-d*v,A=f*y-d*g,M=m*A-_*C+b*T+w*S-x*P+E*O;return M?(M=1/M,t[0]=(s*A-u*C+c*T)*M,t[1]=(i*C-r*A-o*T)*M,t[2]=(v*E-g*x+y*w)*M,t[3]=(f*x-h*E-d*w)*M,t[4]=(u*S-a*A-c*P)*M,t[5]=(n*A-i*S+o*P)*M,t[6]=(g*b-p*E-y*_)*M,t[7]=(l*E-f*b+d*_)*M,t[8]=(a*C-s*S+c*O)*M,t[9]=(r*S-n*C-o*O)*M,t[10]=(p*x-v*b+y*m)*M,t[11]=(h*b-l*x-d*m)*M,t[12]=(s*P-a*T-u*O)*M,t[13]=(n*T-r*P+i*O)*M,t[14]=(v*_-p*w-g*m)*M,t[15]=(l*w-h*_+f*m)*M,t):null}function o(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],v=e[12],g=e[13],y=e[14],m=e[15],_=n[0],b=n[1],w=n[2],x=n[3];return t[0]=_*r+b*s+w*h+x*v,t[1]=_*i+b*u+w*f+x*g,t[2]=_*o+b*c+w*d+x*y,t[3]=_*a+b*l+w*p+x*m,_=n[4],b=n[5],w=n[6],x=n[7],t[4]=_*r+b*s+w*h+x*v,t[5]=_*i+b*u+w*f+x*g,t[6]=_*o+b*c+w*d+x*y,t[7]=_*a+b*l+w*p+x*m,_=n[8],b=n[9],w=n[10],x=n[11],t[8]=_*r+b*s+w*h+x*v,t[9]=_*i+b*u+w*f+x*g,t[10]=_*o+b*c+w*d+x*y,t[11]=_*a+b*l+w*p+x*m,_=n[12],b=n[13],w=n[14],x=n[15],t[12]=_*r+b*s+w*h+x*v,t[13]=_*i+b*u+w*f+x*g,t[14]=_*o+b*c+w*d+x*y,t[15]=_*a+b*l+w*p+x*m,t}function a(t,e,n){var r,i,o,a,s,u,c,l,h,f,d,p,v=n[0],g=n[1],y=n[2];return e===t?(t[12]=e[0]*v+e[4]*g+e[8]*y+e[12],t[13]=e[1]*v+e[5]*g+e[9]*y+e[13],t[14]=e[2]*v+e[6]*g+e[10]*y+e[14],t[15]=e[3]*v+e[7]*g+e[11]*y+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=f,t[10]=d,t[11]=p,t[12]=r*v+s*g+h*y+e[12],t[13]=i*v+u*g+f*y+e[13],t[14]=o*v+c*g+d*y+e[14],t[15]=a*v+l*g+p*y+e[15]),t}function s(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function u(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+h*r,t[7]=u*i+f*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=h*i-s*r,t[11]=f*i-u*r,t}function c(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],l=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-l*r,t[2]=s*i-h*r,t[3]=u*i-f*r,t[8]=o*r+c*i,t[9]=a*r+l*i,t[10]=s*r+h*i,t[11]=u*r+f*i,t}function l(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+h*r,t[3]=u*i+f*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=h*i-s*r,t[7]=f*i-u*r,t}function h(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function f(t,e,n,i){var o,a,s,u,c,l,h,f,d,p,v=e[0],g=e[1],y=e[2],m=i[0],_=i[1],b=i[2],w=n[0],x=n[1],E=n[2];return Math.abs(v-w)<r.b&&Math.abs(g-x)<r.b&&Math.abs(y-E)<r.b?function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}(t):(h=v-w,f=g-x,d=y-E,o=_*(d*=p=1/Math.sqrt(h*h+f*f+d*d))-b*(f*=p),a=b*(h*=p)-m*d,s=m*f-_*h,(p=Math.sqrt(o*o+a*a+s*s))?(o*=p=1/p,a*=p,s*=p):(o=0,a=0,s=0),u=f*s-d*a,c=d*o-h*s,l=h*a-f*o,(p=Math.sqrt(u*u+c*c+l*l))?(u*=p=1/p,c*=p,l*=p):(u=0,c=0,l=0),t[0]=o,t[1]=u,t[2]=h,t[3]=0,t[4]=a,t[5]=c,t[6]=f,t[7]=0,t[8]=s,t[9]=l,t[10]=d,t[11]=0,t[12]=-(o*v+a*g+s*y),t[13]=-(u*v+c*g+l*y),t[14]=-(h*v+f*g+d*y),t[15]=1,t)}},ahXh:function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return i}),n.d(e,"d",function(){return a}),n.d(e,"c",function(){return s});var r={};function i(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function o(t){return Math.round(t/r.EPSILON)*r.EPSILON}function a(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).precision,n=void 0===e?r.precision||4:e;return t=o(t),parseFloat(t.toPrecision(n))}function s(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t===e)return!0;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!s(t[n],e[n]))return!1;return!0}return Math.abs(t-e)<=r.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}r.EPSILON=1e-12,r.debug=!0,r.precision=4,r.printTypes=!1,r.printDegrees=!1,r.printRowMajor=!0},akFz:function(t,e,n){"use strict";n.r(e);var r=n("q1tI"),i=n.n(r),o=n("i8i4"),a=n("2W6z"),s=n.n(a),u=n("17x9"),c=n.n(u),l=n("g8bd"),h=n.n(l),f=n("QLaP"),d=n.n(f);function p(t){return"/"===t.charAt(0)}function v(t,e){for(var n=e,r=n+1,i=t.length;r<i;n+=1,r+=1)t[n]=t[r];t.pop()}var g=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=t&&t.split("/")||[],r=e&&e.split("/")||[],i=t&&p(t),o=e&&p(e),a=i||o;if(t&&p(t)?r=n:n.length&&(r.pop(),r=r.concat(n)),!r.length)return"/";var s=void 0;if(r.length){var u=r[r.length-1];s="."===u||".."===u||""===u}else s=!1;for(var c=0,l=r.length;l>=0;l--){var h=r[l];"."===h?v(r,l):".."===h?(v(r,l),c++):c&&(v(r,l),c--)}if(!a)for(;c--;c)r.unshift("..");!a||""===r[0]||r[0]&&p(r[0])||r.unshift("");var f=r.join("/");return s&&"/"!==f.substr(-1)&&(f+="/"),f},y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};var m=function t(e,n){if(e===n)return!0;if(null==e||null==n)return!1;if(Array.isArray(e))return Array.isArray(n)&&e.length===n.length&&e.every(function(e,r){return t(e,n[r])});var r=void 0===e?"undefined":y(e);if(r!==(void 0===n?"undefined":y(n)))return!1;if("object"===r){var i=e.valueOf(),o=n.valueOf();if(i!==e||o!==n)return t(i,o);var a=Object.keys(e),s=Object.keys(n);return a.length===s.length&&a.every(function(r){return t(e[r],n[r])})}return!1},_=function(t){return"/"===t.charAt(0)?t:"/"+t},b=function(t){return"/"===t.charAt(0)?t.substr(1):t},w=function(t,e){return new RegExp("^"+e+"(\\/|\\?|#|$)","i").test(t)},x=function(t,e){return w(t,e)?t.substr(e.length):t},E=function(t){return"/"===t.charAt(t.length-1)?t.slice(0,-1):t},O=function(t){var e=t.pathname,n=t.search,r=t.hash,i=e||"/";return n&&"?"!==n&&(i+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(i+="#"===r.charAt(0)?r:"#"+r),i},P=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},S=function(t,e,n,r){var i=void 0;"string"==typeof t?(i=function(t){var e=t||"/",n="",r="",i=e.indexOf("#");-1!==i&&(r=e.substr(i),e=e.substr(0,i));var o=e.indexOf("?");return-1!==o&&(n=e.substr(o),e=e.substr(0,o)),{pathname:e,search:"?"===n?"":n,hash:"#"===r?"":r}}(t)).state=e:(void 0===(i=P({},t)).pathname&&(i.pathname=""),i.search?"?"!==i.search.charAt(0)&&(i.search="?"+i.search):i.search="",i.hash?"#"!==i.hash.charAt(0)&&(i.hash="#"+i.hash):i.hash="",void 0!==e&&void 0===i.state&&(i.state=e));try{i.pathname=decodeURI(i.pathname)}catch(t){throw t instanceof URIError?new URIError('Pathname "'+i.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):t}return n&&(i.key=n),r?i.pathname?"/"!==i.pathname.charAt(0)&&(i.pathname=g(i.pathname,r.pathname)):i.pathname=r.pathname:i.pathname||(i.pathname="/"),i},T=function(t,e){return t.pathname===e.pathname&&t.search===e.search&&t.hash===e.hash&&t.key===e.key&&m(t.state,e.state)},C=function(){var t=null,e=[];return{setPrompt:function(e){return h()(null==t,"A history supports only one prompt at a time"),t=e,function(){t===e&&(t=null)}},confirmTransitionTo:function(e,n,r,i){if(null!=t){var o="function"==typeof t?t(e,n):t;"string"==typeof o?"function"==typeof r?r(o,i):(h()(!1,"A history needs a getUserConfirmation function in order to use a prompt message"),i(!0)):i(!1!==o)}else i(!0)},appendListener:function(t){var n=!0,r=function(){n&&t.apply(void 0,arguments)};return e.push(r),function(){n=!1,e=e.filter(function(t){return t!==r})}},notifyListeners:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];e.forEach(function(t){return t.apply(void 0,n)})}}},A=!("undefined"==typeof window||!window.document||!window.document.createElement),M=function(t,e,n){return t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)},k=function(t,e,n){return t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent("on"+e,n)},j=function(t,e){return e(window.confirm(t))},R=("function"==typeof Symbol&&Symbol.iterator,Object.assign,Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}),L={hashbang:{encodePath:function(t){return"!"===t.charAt(0)?t:"!/"+b(t)},decodePath:function(t){return"!"===t.charAt(0)?t.substr(1):t}},noslash:{encodePath:b,decodePath:_},slash:{encodePath:_,decodePath:_}},I=function(){var t=window.location.href,e=t.indexOf("#");return-1===e?"":t.substring(e+1)},D=function(t){var e=window.location.href.indexOf("#");window.location.replace(window.location.href.slice(0,e>=0?e:0)+"#"+t)},F=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d()(A,"Hash history needs a DOM");var e=window.history,n=-1===window.navigator.userAgent.indexOf("Firefox"),r=t.getUserConfirmation,i=void 0===r?j:r,o=t.hashType,a=void 0===o?"slash":o,s=t.basename?E(_(t.basename)):"",u=L[a],c=u.encodePath,l=u.decodePath,f=function(){var t=l(I());return h()(!s||w(t,s),'You are attempting to use a basename on a page whose URL path does not begin with the basename. Expected path "'+t+'" to begin with "'+s+'".'),s&&(t=x(t,s)),S(t)},p=C(),v=function(t){R(Z,t),Z.length=e.length,p.notifyListeners(Z.location,Z.action)},g=!1,y=null,m=function(){var t=I(),e=c(t);if(t!==e)D(e);else{var n=f(),r=Z.location;if(!g&&T(r,n))return;if(y===O(n))return;y=null,b(n)}},b=function(t){g?(g=!1,v()):p.confirmTransitionTo(t,"POP",i,function(e){e?v({action:"POP",location:t}):P(t)})},P=function(t){var e=Z.location,n=U.lastIndexOf(O(e));-1===n&&(n=0);var r=U.lastIndexOf(O(t));-1===r&&(r=0);var i=n-r;i&&(g=!0,z(i))},F=I(),N=c(F);F!==N&&D(N);var B=f(),U=[O(B)],z=function(t){h()(n,"Hash history go(n) causes a full page reload in this browser"),e.go(t)},G=0,V=function(t){1===(G+=t)?M(window,"hashchange",m):0===G&&k(window,"hashchange",m)},W=!1,Z={length:e.length,action:"POP",location:B,createHref:function(t){return"#"+c(s+O(t))},push:function(t,e){h()(void 0===e,"Hash history cannot push state; it is ignored");var n=S(t,void 0,void 0,Z.location);p.confirmTransitionTo(n,"PUSH",i,function(t){if(t){var e=O(n),r=c(s+e);if(I()!==r){y=e,function(t){window.location.hash=t}(r);var i=U.lastIndexOf(O(Z.location)),o=U.slice(0,-1===i?0:i+1);o.push(e),U=o,v({action:"PUSH",location:n})}else h()(!1,"Hash history cannot PUSH the same path; a new entry will not be added to the history stack"),v()}})},replace:function(t,e){h()(void 0===e,"Hash history cannot replace state; it is ignored");var n=S(t,void 0,void 0,Z.location);p.confirmTransitionTo(n,"REPLACE",i,function(t){if(t){var e=O(n),r=c(s+e);I()!==r&&(y=e,D(r));var i=U.indexOf(O(Z.location));-1!==i&&(U[i]=e),v({action:"REPLACE",location:n})}})},go:z,goBack:function(){return z(-1)},goForward:function(){return z(1)},block:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=p.setPrompt(t);return W||(V(1),W=!0),function(){return W&&(W=!1,V(-1)),e()}},listen:function(t){var e=p.appendListener(t);return V(1),function(){V(-1),e()}}};return Z},N=("function"==typeof Symbol&&Symbol.iterator,Object.assign,Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t});function B(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var U=function(t){function e(){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r=B(this,t.call.apply(t,[this].concat(o))),r.state={match:r.computeMatch(r.props.history.location.pathname)},B(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getChildContext=function(){return{router:N({},this.context.router,{history:this.props.history,route:{location:this.props.history.location,match:this.state.match}})}},e.prototype.computeMatch=function(t){return{path:"/",url:"/",params:{},isExact:"/"===t}},e.prototype.componentWillMount=function(){var t=this,e=this.props,n=e.children,r=e.history;d()(null==n||1===i.a.Children.count(n),"A <Router> may have only one child element"),this.unlisten=r.listen(function(){t.setState({match:t.computeMatch(r.location.pathname)})})},e.prototype.componentWillReceiveProps=function(t){s()(this.props.history===t.history,"You cannot change <Router history>")},e.prototype.componentWillUnmount=function(){this.unlisten()},e.prototype.render=function(){var t=this.props.children;return t?i.a.Children.only(t):null},e}(i.a.Component);U.propTypes={history:c.a.object.isRequired,children:c.a.node},U.contextTypes={router:c.a.object},U.childContextTypes={router:c.a.object.isRequired};var z=U;function G(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var V=function(t){function e(){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r=G(this,t.call.apply(t,[this].concat(o))),r.history=F(r.props),G(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentWillMount=function(){s()(!this.props.history,"<HashRouter> ignores the history prop. To use a custom history, use `import { Router }` instead of `import { HashRouter as Router }`.")},e.prototype.render=function(){return i.a.createElement(z,{history:this.history,children:this.props.children})},e}(i.a.Component);V.propTypes={basename:c.a.string,getUserConfirmation:c.a.func,hashType:c.a.oneOf(["hashbang","noslash","slash"]),children:c.a.node};var W=V,Z=(n("0cfB"),n("vRGJ")),H=n.n(Z),X={},Y=0,J=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];"string"==typeof e&&(e={path:e});var r=e,i=r.path,o=r.exact,a=void 0!==o&&o,s=r.strict,u=void 0!==s&&s,c=r.sensitive;if(null==i)return n;var l=function(t,e){var n=""+e.end+e.strict+e.sensitive,r=X[n]||(X[n]={});if(r[t])return r[t];var i=[],o={re:H()(t,i,e),keys:i};return Y<1e4&&(r[t]=o,Y++),o}(i,{end:a,strict:u,sensitive:void 0!==c&&c}),h=l.re,f=l.keys,d=h.exec(t);if(!d)return null;var p=d[0],v=d.slice(1),g=t===p;return a&&!g?null:{path:i,url:"/"===i&&""===p?"/":p,isExact:g,params:f.reduce(function(t,e,n){return t[e.name]=v[n],t},{})}};var q=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentWillMount=function(){d()(this.context.router,"You should not use <Switch> outside a <Router>")},e.prototype.componentWillReceiveProps=function(t){s()(!(t.location&&!this.props.location),'<Switch> elements should not change from uncontrolled to controlled (or vice versa). You initially used no "location" prop and then provided one on a subsequent render.'),s()(!(!t.location&&this.props.location),'<Switch> elements should not change from controlled to uncontrolled (or vice versa). You provided a "location" prop initially but omitted it on a subsequent render.')},e.prototype.render=function(){var t=this.context.router.route,e=this.props.children,n=this.props.location||t.location,r=void 0,o=void 0;return i.a.Children.forEach(e,function(e){if(null==r&&i.a.isValidElement(e)){var a=e.props,s=a.path,u=a.exact,c=a.strict,l=a.sensitive,h=a.from,f=s||h;o=e,r=J(n.pathname,{path:f,exact:u,strict:c,sensitive:l},t.match)}}),r?i.a.cloneElement(o,{location:n,computedMatch:r}):null},e}(i.a.Component);q.contextTypes={router:c.a.shape({route:c.a.object.isRequired}).isRequired},q.propTypes={children:c.a.node,location:c.a.object};var Q=q,K=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};function $(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var tt=function(t){return 0===i.a.Children.count(t)},et=function(t){function e(){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r=$(this,t.call.apply(t,[this].concat(o))),r.state={match:r.computeMatch(r.props,r.context.router)},$(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getChildContext=function(){return{router:K({},this.context.router,{route:{location:this.props.location||this.context.router.route.location,match:this.state.match}})}},e.prototype.computeMatch=function(t,e){var n=t.computedMatch,r=t.location,i=t.path,o=t.strict,a=t.exact,s=t.sensitive;if(n)return n;d()(e,"You should not use <Route> or withRouter() outside a <Router>");var u=e.route,c=(r||u.location).pathname;return J(c,{path:i,strict:o,exact:a,sensitive:s},u.match)},e.prototype.componentWillMount=function(){s()(!(this.props.component&&this.props.render),"You should not use <Route component> and <Route render> in the same route; <Route render> will be ignored"),s()(!(this.props.component&&this.props.children&&!tt(this.props.children)),"You should not use <Route component> and <Route children> in the same route; <Route children> will be ignored"),s()(!(this.props.render&&this.props.children&&!tt(this.props.children)),"You should not use <Route render> and <Route children> in the same route; <Route children> will be ignored")},e.prototype.componentWillReceiveProps=function(t,e){s()(!(t.location&&!this.props.location),'<Route> elements should not change from uncontrolled to controlled (or vice versa). You initially used no "location" prop and then provided one on a subsequent render.'),s()(!(!t.location&&this.props.location),'<Route> elements should not change from controlled to uncontrolled (or vice versa). You provided a "location" prop initially but omitted it on a subsequent render.'),this.setState({match:this.computeMatch(t,e.router)})},e.prototype.render=function(){var t=this.state.match,e=this.props,n=e.children,r=e.component,o=e.render,a=this.context.router,s=a.history,u=a.route,c=a.staticContext,l={match:t,location:this.props.location||u.location,history:s,staticContext:c};return r?t?i.a.createElement(r,l):null:o?t?o(l):null:"function"==typeof n?n(l):n&&!tt(n)?i.a.Children.only(n):null},e}(i.a.Component);et.propTypes={computedMatch:c.a.object,path:c.a.string,exact:c.a.bool,strict:c.a.bool,sensitive:c.a.bool,component:c.a.func,render:c.a.func,children:c.a.oneOfType([c.a.func,c.a.node]),location:c.a.object},et.contextTypes={router:c.a.shape({history:c.a.object.isRequired,route:c.a.object.isRequired,staticContext:c.a.object})},et.childContextTypes={router:c.a.object.isRequired};var nt=et,rt={},it=0,ot=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"/"===t?t:function(t){var e=t,n=rt[e]||(rt[e]={});if(n[t])return n[t];var r=H.a.compile(t);return it<1e4&&(n[t]=r,it++),r}(t)(e,{pretty:!0})},at=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};var st=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.isStatic=function(){return this.context.router&&this.context.router.staticContext},e.prototype.componentWillMount=function(){d()(this.context.router,"You should not use <Redirect> outside a <Router>"),this.isStatic()&&this.perform()},e.prototype.componentDidMount=function(){this.isStatic()||this.perform()},e.prototype.componentDidUpdate=function(t){var e=S(t.to),n=S(this.props.to);T(e,n)?s()(!1,"You tried to redirect to the same route you're currently on: \""+n.pathname+n.search+'"'):this.perform()},e.prototype.computeTo=function(t){var e=t.computedMatch,n=t.to;return e?"string"==typeof n?ot(n,e.params):at({},n,{pathname:ot(n.pathname,e.params)}):n},e.prototype.perform=function(){var t=this.context.router.history,e=this.props.push,n=this.computeTo(this.props);e?t.push(n):t.replace(n)},e.prototype.render=function(){return null},e}(i.a.Component);st.propTypes={computedMatch:c.a.object,push:c.a.bool,from:c.a.string,to:c.a.oneOfType([c.a.string,c.a.object]).isRequired},st.defaultProps={push:!1},st.contextTypes={router:c.a.shape({history:c.a.shape({push:c.a.func.isRequired,replace:c.a.func.isRequired}).isRequired,staticContext:c.a.object}).isRequired};var ut=st,ct=(n("VFMm"),n("+mLN"),Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t});function lt(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var ht=function(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)},ft=function(t){function e(){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r=lt(this,t.call.apply(t,[this].concat(o))),r.handleClick=function(t){if(r.props.onClick&&r.props.onClick(t),!t.defaultPrevented&&0===t.button&&!r.props.target&&!ht(t)){t.preventDefault();var e=r.context.router.history,n=r.props,i=n.replace,o=n.to;i?e.replace(o):e.push(o)}},lt(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.render=function(){var t=this.props,e=(t.replace,t.to),n=t.innerRef,r=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(t,["replace","to","innerRef"]);d()(this.context.router,"You should not use <Link> outside a <Router>"),d()(void 0!==e,'You must specify the "to" property');var o=this.context.router.history,a="string"==typeof e?S(e,null,null,o.location):e,s=o.createHref(a);return i.a.createElement("a",ct({},r,{onClick:this.handleClick,href:s,ref:n}))},e}(i.a.Component);ft.propTypes={onClick:c.a.func,target:c.a.string,replace:c.a.bool,to:c.a.oneOfType([c.a.string,c.a.object]).isRequired,innerRef:c.a.oneOfType([c.a.string,c.a.func])},ft.defaultProps={replace:!1},ft.contextTypes={router:c.a.shape({history:c.a.shape({push:c.a.func.isRequired,replace:c.a.func.isRequired,createHref:c.a.func.isRequired}).isRequired}).isRequired};var dt=ft,pt=n("cTfP"),vt=n.n(pt);n("1o6E");var gt=function(t){var e,n;function r(e,n){var r;return(r=t.call(this,e,n)||this).state={isMobel:!1},r}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var o=r.prototype;return o.componentDidMount=function(){},o.handleDefEvent=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},o.openDocs=function(t){window.open("./docs/index.html")},o.render=function(){var t=this;return i.a.createElement("div",{className:"header clearfix",onClick:function(e){return t.handleDefEvent(e)}},i.a.createElement("div",{className:"navbar-collapse clearfix"},i.a.createElement("ul",{className:"nav navbar-nav navbar-right"},i.a.createElement("li",{id:"nav-github"},i.a.createElement("a",{href:"https://github.com/sakitam-fdd/ol-deckgl",target:"_blank"},i.a.createElement("img",{src:vt.a,width:"18"}))))))},r}(r.Component);var yt=n("u1xf"),mt=n.n(yt);n("9w8u");function _t(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var bt=function(t){var e,n;function r(e,n){var r,i,o,a;return r=t.call(this,e,n)||this,i=_t(_t(r)),a=function(t,e,n){t.preventDefault?t.preventDefault():t.returnValue=!1,"origin"===e&&window.open(n.url)},(o="handleClick")in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,r.state={charts:[]},r}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var o=r.prototype;return o.componentDidMount=function(){var t,e,n,r=this;t="./static/json/config.json",e=function(t){t&&r.setState({charts:t})},(n=new XMLHttpRequest).responseType="json",n.open("get",t,!0),n.onload=function(){if(!(n.status>=200&&n.status<300))throw new Error(n.statusText);e(n.response)},n.send()},o.getArtList=function(){return this.state.charts.map(function(t,e){return i.a.createElement("li",{className:"chart",key:e},i.a.createElement("div",{className:"chart_wrap"},i.a.createElement("span",{className:"chart_bg",style:{backgroundImage:"url('"+t.imgSrc+"')"}},i.a.createElement("div",{className:"chart_hover animation clearfix"},i.a.createElement(dt,{to:t.link},i.a.createElement("div",{className:"chart_magnifier_right"},i.a.createElement("div",null,i.a.createElement("img",{src:mt.a})),i.a.createElement("div",null,""))))),i.a.createElement("div",{className:"chart_info"},i.a.createElement("div",{className:"chart_name"},t.chart_name),i.a.createElement("div",{className:"chart_detail clearfix"},i.a.createElement("div",{className:"chart_author pull-left"},i.a.createElement("span",{className:"chart_icon chart_author_icon"}),i.a.createElement("span",{className:"chart_icontxt"},t.chart_author)),i.a.createElement("div",{className:"chart_time pull-right"},i.a.createElement("span",{className:"chart_icon chart_time_icon"}),i.a.createElement("span",{className:"chart_icontxt"},t.chart_time))))))})},o.render=function(){return i.a.createElement("div",null,i.a.createElement(gt,null),i.a.createElement("div",{className:"main"},i.a.createElement("div",{className:"charts-list"},i.a.createElement("ul",{id:"charts-list-ul",className:"charts-list-ul clearfix"},this.getArtList()))))},r}(r.Component),wt=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},xt=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return wt(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}};var Et=xt(wt),Ot=Et.right,Pt=(Et.left,Ot);var St=Array.prototype,Tt=(St.slice,St.map,Math.sqrt(50)),Ct=Math.sqrt(10),At=Math.sqrt(2),Mt=function(t,e,n){var r,i,o,a,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=kt(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),o=new Array(i=Math.ceil(e-t+1));++s<i;)o[s]=(t+s)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),o=new Array(i=Math.ceil(t-e+1));++s<i;)o[s]=(t-s)/a;return r&&o.reverse(),o};function kt(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=Tt?10:o>=Ct?5:o>=At?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=Tt?10:o>=Ct?5:o>=At?2:1)}function jt(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=Tt?i*=10:o>=Ct?i*=5:o>=At&&(i*=2),e<t?-i:i}n("bwSX");var Rt=Array.prototype,Lt=Rt.map,It=Rt.slice;var Dt=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function Ft(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Nt(){}var Bt="\\s*([+-]?\\d+)\\s*",Ut="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",zt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Gt=/^#([0-9a-f]{3})$/,Vt=/^#([0-9a-f]{6})$/,Wt=new RegExp("^rgb\\("+[Bt,Bt,Bt]+"\\)$"),Zt=new RegExp("^rgb\\("+[zt,zt,zt]+"\\)$"),Ht=new RegExp("^rgba\\("+[Bt,Bt,Bt,Ut]+"\\)$"),Xt=new RegExp("^rgba\\("+[zt,zt,zt,Ut]+"\\)$"),Yt=new RegExp("^hsl\\("+[Ut,zt,zt]+"\\)$"),Jt=new RegExp("^hsla\\("+[Ut,zt,zt,Ut]+"\\)$"),qt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Qt(t){var e;return t=(t+"").trim().toLowerCase(),(e=Gt.exec(t))?new ne((e=parseInt(e[1],16))>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):(e=Vt.exec(t))?Kt(parseInt(e[1],16)):(e=Wt.exec(t))?new ne(e[1],e[2],e[3],1):(e=Zt.exec(t))?new ne(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Ht.exec(t))?$t(e[1],e[2],e[3],e[4]):(e=Xt.exec(t))?$t(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Yt.exec(t))?ie(e[1],e[2]/100,e[3]/100,1):(e=Jt.exec(t))?ie(e[1],e[2]/100,e[3]/100,e[4]):qt.hasOwnProperty(t)?Kt(qt[t]):"transparent"===t?new ne(NaN,NaN,NaN,0):null}function Kt(t){return new ne(t>>16&255,t>>8&255,255&t,1)}function $t(t,e,n,r){return r<=0&&(t=e=n=NaN),new ne(t,e,n,r)}function te(t){return t instanceof Nt||(t=Qt(t)),t?new ne((t=t.rgb()).r,t.g,t.b,t.opacity):new ne}function ee(t,e,n,r){return 1===arguments.length?te(t):new ne(t,e,n,null==r?1:r)}function ne(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function re(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function ie(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ae(t,e,n,r)}function oe(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof ae)return new ae(t.h,t.s,t.l,t.opacity);if(t instanceof Nt||(t=Qt(t)),!t)return new ae;if(t instanceof ae)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new ae(a,s,u,t.opacity)}(t):new ae(t,e,n,null==r?1:r)}function ae(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function se(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Dt(Nt,Qt,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),Dt(ne,ee,Ft(Nt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ne(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ne(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+re(this.r)+re(this.g)+re(this.b)},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),Dt(ae,oe,Ft(Nt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ae(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ae(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new ne(se(t>=240?t-240:t+120,i,r),se(t,i,r),se(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var ue=Math.PI/180,ce=180/Math.PI,le=.96422,he=1,fe=.82521,de=4/29,pe=6/29,ve=3*pe*pe,ge=pe*pe*pe;function ye(t){if(t instanceof _e)return new _e(t.l,t.a,t.b,t.opacity);if(t instanceof Se){if(isNaN(t.h))return new _e(t.l,0,0,t.opacity);var e=t.h*ue;return new _e(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof ne||(t=te(t));var n,r,i=Ee(t.r),o=Ee(t.g),a=Ee(t.b),s=be((.2225045*i+.7168786*o+.0606169*a)/he);return i===o&&o===a?n=r=s:(n=be((.4360747*i+.3850649*o+.1430804*a)/le),r=be((.0139322*i+.0971045*o+.7141733*a)/fe)),new _e(116*s-16,500*(n-s),200*(s-r),t.opacity)}function me(t,e,n,r){return 1===arguments.length?ye(t):new _e(t,e,n,null==r?1:r)}function _e(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function be(t){return t>ge?Math.pow(t,1/3):t/ve+de}function we(t){return t>pe?t*t*t:ve*(t-de)}function xe(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Ee(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Oe(t){if(t instanceof Se)return new Se(t.h,t.c,t.l,t.opacity);if(t instanceof _e||(t=ye(t)),0===t.a&&0===t.b)return new Se(NaN,0,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*ce;return new Se(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Pe(t,e,n,r){return 1===arguments.length?Oe(t):new Se(t,e,n,null==r?1:r)}function Se(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}Dt(_e,me,Ft(Nt,{brighter:function(t){return new _e(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new _e(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new ne(xe(3.1338561*(e=le*we(e))-1.6168667*(t=he*we(t))-.4906146*(n=fe*we(n))),xe(-.9787684*e+1.9161415*t+.033454*n),xe(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Dt(Se,Pe,Ft(Nt,{brighter:function(t){return new Se(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Se(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return ye(this).rgb()}}));var Te=-.14861,Ce=1.78277,Ae=-.29227,Me=-.90649,ke=1.97294,je=ke*Me,Re=ke*Ce,Le=Ce*Ae-Me*Te;function Ie(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof De)return new De(t.h,t.s,t.l,t.opacity);t instanceof ne||(t=te(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(Le*r+je*e-Re*n)/(Le+je-Re),o=r-i,a=(ke*(n-i)-Ae*o)/Me,s=Math.sqrt(a*a+o*o)/(ke*i*(1-i)),u=s?Math.atan2(a,o)*ce-120:NaN;return new De(u<0?u+360:u,s,i,t.opacity)}(t):new De(t,e,n,null==r?1:r)}function De(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Fe(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}Dt(De,Ie,Ft(Nt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new De(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new De(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*ue,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new ne(255*(e+n*(Te*r+Ce*i)),255*(e+n*(Ae*r+Me*i)),255*(e+n*(ke*r)),this.opacity)}}));var Ne=function(t){return function(){return t}};function Be(t,e){return function(n){return t+n*e}}function Ue(t,e){var n=e-t;return n?Be(t,n>180||n<-180?n-360*Math.round(n/360):n):Ne(isNaN(t)?e:t)}function ze(t){return 1==(t=+t)?Ge:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Ne(isNaN(e)?n:e)}}function Ge(t,e){var n=e-t;return n?Be(t,n):Ne(isNaN(t)?e:t)}var Ve=function t(e){var n=ze(e);function r(t,e){var r=n((t=ee(t)).r,(e=ee(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=Ge(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function We(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=ee(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}We(function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return Fe((n-r/e)*e,a,i,o,s)}}),We(function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],s=t[(r+2)%e];return Fe((n-r/e)*e,i,o,a,s)}});var Ze=function(t,e){return e-=t=+t,function(n){return t+e*n}},He=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Xe=new RegExp(He.source,"g");var Ye,Je,qe,Qe,Ke=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?Ne(e):("number"===r?Ze:"string"===r?(n=Qt(e))?(e=n,Ve):function(t,e){var n,r,i,o=He.lastIndex=Xe.lastIndex=0,a=-1,s=[],u=[];for(t+="",e+="";(n=He.exec(t))&&(r=Xe.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:Ze(n,r)})),o=Xe.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})}:e instanceof Qt?Ve:e instanceof Date?function(t,e){var n=new Date;return e-=t=+t,function(r){return n.setTime(t+e*r),n}}:Array.isArray(e)?function(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Ke(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Ke(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}:Ze)(t,e)},$e=function(t,e){return e-=t=+t,function(n){return Math.round(t+e*n)}},tn=180/Math.PI,en={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},nn=function(t,e,n,r,i,o){var a,s,u;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),t*r<e*n&&(t=-t,e=-e,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*tn,skewX:Math.atan(u)*tn,scaleX:a,scaleY:s}};function rn(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],u=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var u=a.push("translate(",null,e,null,n);s.push({i:u-4,x:Ze(t,i)},{i:u-2,x:Ze(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,u),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Ze(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,s,u),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Ze(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,s,u),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:Ze(t,n)},{i:s-2,x:Ze(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,u),o=a=null,function(t){for(var e,n=-1,r=u.length;++n<r;)s[(e=u[n]).i]=e.x(t);return s.join("")}}}rn(function(t){return"none"===t?en:(Ye||(Ye=document.createElement("DIV"),Je=document.documentElement,qe=document.defaultView),Ye.style.transform=t,t=qe.getComputedStyle(Je.appendChild(Ye),null).getPropertyValue("transform"),Je.removeChild(Ye),t=t.slice(7,-1).split(","),nn(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))},"px, ","px)","deg)"),rn(function(t){return null==t?en:(Qe||(Qe=document.createElementNS("http://www.w3.org/2000/svg","g")),Qe.setAttribute("transform",t),(t=Qe.transform.baseVal.consolidate())?(t=t.matrix,nn(t.a,t.b,t.c,t.d,t.e,t.f)):en)},", ",")",")"),Math.SQRT2;function on(t){return function(e,n){var r=t((e=oe(e)).h,(n=oe(n)).h),i=Ge(e.s,n.s),o=Ge(e.l,n.l),a=Ge(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=o(t),e.opacity=a(t),e+""}}}on(Ue),on(Ge);function an(t){return function(e,n){var r=t((e=Pe(e)).h,(n=Pe(n)).h),i=Ge(e.c,n.c),o=Ge(e.l,n.l),a=Ge(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=o(t),e.opacity=a(t),e+""}}}an(Ue),an(Ge);function sn(t){return function e(n){function r(e,r){var i=t((e=Ie(e)).h,(r=Ie(r)).h),o=Ge(e.s,r.s),a=Ge(e.l,r.l),s=Ge(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=a(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}sn(Ue),sn(Ge);var un=function(t){return function(){return t}},cn=function(t){return+t},ln=[0,1];function hn(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:un(e)}function fn(t,e,n,r){var i=t[0],o=t[1],a=e[0],s=e[1];return o<i?(i=n(o,i),a=r(s,a)):(i=n(i,o),a=r(a,s)),function(t){return a(i(t))}}function dn(t,e,n,r){var i=Math.min(t.length,e.length)-1,o=new Array(i),a=new Array(i),s=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<i;)o[s]=n(t[s],t[s+1]),a[s]=r(e[s],e[s+1]);return function(e){var n=Pt(t,e,1,i)-1;return a[n](o[n](e))}}function pn(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function vn(t,e){var n,r,i,o=ln,a=ln,s=Ke,u=!1;function c(){return n=Math.min(o.length,a.length)>2?dn:fn,r=i=null,l}function l(e){return(r||(r=n(o,a,u?function(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=e?0:t>=n?1:r(t)}}}(t):t,s)))(+e)}return l.invert=function(t){return(i||(i=n(a,o,hn,u?function(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=0?e:t>=1?n:r(t)}}}(e):e)))(+t)},l.domain=function(t){return arguments.length?(o=Lt.call(t,cn),c()):o.slice()},l.range=function(t){return arguments.length?(a=It.call(t),c()):a.slice()},l.rangeRound=function(t){return a=It.call(t),s=$e,c()},l.clamp=function(t){return arguments.length?(u=!!t,c()):u},l.interpolate=function(t){return arguments.length?(s=t,c()):s},c()}var gn=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},yn=function(t){return(t=gn(Math.abs(t)))?t[1]:NaN},mn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function _n(t){return new bn(t)}function bn(t){if(!(e=mn.exec(t)))throw new Error("invalid format: "+t);var e;this.fill=e[1]||" ",this.align=e[2]||">",this.sign=e[3]||"-",this.symbol=e[4]||"",this.zero=!!e[5],this.width=e[6]&&+e[6],this.comma=!!e[7],this.precision=e[8]&&+e[8].slice(1),this.trim=!!e[9],this.type=e[10]||""}_n.prototype=bn.prototype,bn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var wn,xn,En,On,Pn=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(i>0){if(!+t[r])break t;i=0}}return i>0?t.slice(0,i)+t.slice(e+1):t},Sn=function(t,e){var n=gn(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},Tn={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Sn(100*t,e)},r:Sn,s:function(t,e){var n=gn(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(wn=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+gn(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Cn=function(t){return t},An=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];xn=function(t){var e,n,r=t.grouping&&t.thousands?(e=t.grouping,n=t.thousands,function(t,r){for(var i=t.length,o=[],a=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(t.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}):Cn,i=t.currency,o=t.decimal,a=t.numerals?function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(t.numerals):Cn,s=t.percent||"%";function u(t){var e=(t=_n(t)).fill,n=t.align,u=t.sign,c=t.symbol,l=t.zero,h=t.width,f=t.comma,d=t.precision,p=t.trim,v=t.type;"n"===v?(f=!0,v="g"):Tn[v]||(null==d&&(d=12),p=!0,v="g"),(l||"0"===e&&"="===n)&&(l=!0,e="0",n="=");var g="$"===c?i[0]:"#"===c&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",y="$"===c?i[1]:/[%p]/.test(v)?s:"",m=Tn[v],_=/[defgprs%]/.test(v);function b(t){var i,s,c,b=g,w=y;if("c"===v)w=m(t)+w,t="";else{var x=(t=+t)<0;if(t=m(Math.abs(t),d),p&&(t=Pn(t)),x&&0==+t&&(x=!1),b=(x?"("===u?u:"-":"-"===u||"("===u?"":u)+b,w=("s"===v?An[8+wn/3]:"")+w+(x&&"("===u?")":""),_)for(i=-1,s=t.length;++i<s;)if(48>(c=t.charCodeAt(i))||c>57){w=(46===c?o+t.slice(i+1):t.slice(i))+w,t=t.slice(0,i);break}}f&&!l&&(t=r(t,1/0));var E=b.length+t.length+w.length,O=E<h?new Array(h-E+1).join(e):"";switch(f&&l&&(t=r(O+t,O.length?h-w.length:1/0),O=""),n){case"<":t=b+t+w+O;break;case"=":t=b+O+t+w;break;case"^":t=O.slice(0,E=O.length>>1)+b+t+w+O.slice(E);break;default:t=O+b+t+w}return a(t)}return d=null==d?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,d)):Math.max(0,Math.min(20,d)),b.toString=function(){return t+""},b}return{format:u,formatPrefix:function(t,e){var n=u(((t=_n(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(yn(e)/3))),i=Math.pow(10,-r),o=An[8+r/3];return function(t){return n(i*t)+o}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),En=xn.format,On=xn.formatPrefix;var Mn=function(t,e,n){var r,i=t[0],o=t[t.length-1],a=jt(i,o,null==e?10:e);switch((n=_n(null==n?",f":n)).type){case"s":var s=Math.max(Math.abs(i),Math.abs(o));return null!=n.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(yn(e)/3)))-yn(Math.abs(t)))}(a,s))||(n.precision=r),On(n,s);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,yn(e)-yn(t))+1}(a,Math.max(Math.abs(i),Math.abs(o))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=function(t){return Math.max(0,-yn(Math.abs(t)))}(a))||(n.precision=r-2*("%"===n.type))}return En(n)};function kn(t){var e=t.domain;return t.ticks=function(t){var n=e();return Mt(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){return Mn(e(),t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),o=0,a=i.length-1,s=i[o],u=i[a];return u<s&&(r=s,s=u,u=r,r=o,o=a,a=r),(r=kt(s,u,n))>0?r=kt(s=Math.floor(s/r)*r,u=Math.ceil(u/r)*r,n):r<0&&(r=kt(s=Math.ceil(s*r)/r,u=Math.floor(u*r)/r,n)),r>0?(i[o]=Math.floor(s/r)*r,i[a]=Math.ceil(u/r)*r,e(i)):r<0&&(i[o]=Math.ceil(s*r)/r,i[a]=Math.floor(u*r)/r,e(i)),t},t}function jn(){var t=vn(hn,Ze);return t.copy=function(){return pn(t,jn())},kn(t)}var Rn=new Date,Ln=new Date;function In(t,e,n,r){function i(e){return t(e=new Date(+e)),e}return i.floor=i,i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return s;do{s.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<r);return s},i.filter=function(n){return In(function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})},n&&(i.count=function(e,r){return Rn.setTime(+e),Ln.setTime(+r),t(Rn),t(Ln),Math.floor(n(Rn,Ln))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var Dn=In(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});Dn.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?In(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):Dn:null};Dn.range;var Fn=6e4,Nn=6048e5,Bn=In(function(t){t.setTime(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}),Un=(Bn.range,In(function(t){t.setTime(Math.floor(t/Fn)*Fn)},function(t,e){t.setTime(+t+e*Fn)},function(t,e){return(e-t)/Fn},function(t){return t.getMinutes()})),zn=(Un.range,In(function(t){var e=t.getTimezoneOffset()*Fn%36e5;e<0&&(e+=36e5),t.setTime(36e5*Math.floor((+t-e)/36e5)+e)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getHours()})),Gn=(zn.range,In(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Fn)/864e5},function(t){return t.getDate()-1})),Vn=Gn;Gn.range;function Wn(t){return In(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Fn)/Nn})}var Zn=Wn(0),Hn=Wn(1),Xn=Wn(2),Yn=Wn(3),Jn=Wn(4),qn=Wn(5),Qn=Wn(6),Kn=(Zn.range,Hn.range,Xn.range,Yn.range,Jn.range,qn.range,Qn.range,In(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()})),$n=(Kn.range,In(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()}));$n.every=function(t){return isFinite(t=Math.floor(t))&&t>0?In(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};var tr=$n,er=($n.range,In(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*Fn)},function(t,e){return(e-t)/Fn},function(t){return t.getUTCMinutes()})),nr=(er.range,In(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getUTCHours()})),rr=(nr.range,In(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1})),ir=rr;rr.range;function or(t){return In(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/Nn})}var ar=or(0),sr=or(1),ur=or(2),cr=or(3),lr=or(4),hr=or(5),fr=or(6),dr=(ar.range,sr.range,ur.range,cr.range,lr.range,hr.range,fr.range,In(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()})),pr=(dr.range,In(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()}));pr.every=function(t){return isFinite(t=Math.floor(t))&&t>0?In(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var vr=pr;pr.range;function gr(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function yr(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function mr(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}var _r,br,wr,xr={"-":"",_:" ",0:"0"},Er=/^\s*\d+/,Or=/^%/,Pr=/[\\^$*+?|[\]().{}]/g;function Sr(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Tr(t){return t.replace(Pr,"\\$&")}function Cr(t){return new RegExp("^(?:"+t.map(Tr).join("|")+")","i")}function Ar(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function Mr(t,e,n){var r=Er.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function kr(t,e,n){var r=Er.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function jr(t,e,n){var r=Er.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Rr(t,e,n){var r=Er.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Lr(t,e,n){var r=Er.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Ir(t,e,n){var r=Er.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Dr(t,e,n){var r=Er.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Fr(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Nr(t,e,n){var r=Er.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Br(t,e,n){var r=Er.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Ur(t,e,n){var r=Er.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function zr(t,e,n){var r=Er.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Gr(t,e,n){var r=Er.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Vr(t,e,n){var r=Er.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Wr(t,e,n){var r=Er.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Zr(t,e,n){var r=Er.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Hr(t,e,n){var r=Or.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Xr(t,e,n){var r=Er.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Yr(t,e,n){var r=Er.exec(e.slice(n));return r?(t.Q=1e3*+r[0],n+r[0].length):-1}function Jr(t,e){return Sr(t.getDate(),e,2)}function qr(t,e){return Sr(t.getHours(),e,2)}function Qr(t,e){return Sr(t.getHours()%12||12,e,2)}function Kr(t,e){return Sr(1+Vn.count(tr(t),t),e,3)}function $r(t,e){return Sr(t.getMilliseconds(),e,3)}function ti(t,e){return $r(t,e)+"000"}function ei(t,e){return Sr(t.getMonth()+1,e,2)}function ni(t,e){return Sr(t.getMinutes(),e,2)}function ri(t,e){return Sr(t.getSeconds(),e,2)}function ii(t){var e=t.getDay();return 0===e?7:e}function oi(t,e){return Sr(Zn.count(tr(t),t),e,2)}function ai(t,e){var n=t.getDay();return t=n>=4||0===n?Jn(t):Jn.ceil(t),Sr(Jn.count(tr(t),t)+(4===tr(t).getDay()),e,2)}function si(t){return t.getDay()}function ui(t,e){return Sr(Hn.count(tr(t),t),e,2)}function ci(t,e){return Sr(t.getFullYear()%100,e,2)}function li(t,e){return Sr(t.getFullYear()%1e4,e,4)}function hi(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Sr(e/60|0,"0",2)+Sr(e%60,"0",2)}function fi(t,e){return Sr(t.getUTCDate(),e,2)}function di(t,e){return Sr(t.getUTCHours(),e,2)}function pi(t,e){return Sr(t.getUTCHours()%12||12,e,2)}function vi(t,e){return Sr(1+ir.count(vr(t),t),e,3)}function gi(t,e){return Sr(t.getUTCMilliseconds(),e,3)}function yi(t,e){return gi(t,e)+"000"}function mi(t,e){return Sr(t.getUTCMonth()+1,e,2)}function _i(t,e){return Sr(t.getUTCMinutes(),e,2)}function bi(t,e){return Sr(t.getUTCSeconds(),e,2)}function wi(t){var e=t.getUTCDay();return 0===e?7:e}function xi(t,e){return Sr(ar.count(vr(t),t),e,2)}function Ei(t,e){var n=t.getUTCDay();return t=n>=4||0===n?lr(t):lr.ceil(t),Sr(lr.count(vr(t),t)+(4===vr(t).getUTCDay()),e,2)}function Oi(t){return t.getUTCDay()}function Pi(t,e){return Sr(sr.count(vr(t),t),e,2)}function Si(t,e){return Sr(t.getUTCFullYear()%100,e,2)}function Ti(t,e){return Sr(t.getUTCFullYear()%1e4,e,4)}function Ci(){return"+0000"}function Ai(){return"%"}function Mi(t){return+t}function ki(t){return Math.floor(+t/1e3)}!function(t){_r=function(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,u=t.shortMonths,c=Cr(i),l=Ar(i),h=Cr(o),f=Ar(o),d=Cr(a),p=Ar(a),v=Cr(s),g=Ar(s),y=Cr(u),m=Ar(u),_={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:Jr,e:Jr,f:ti,H:qr,I:Qr,j:Kr,L:$r,m:ei,M:ni,p:function(t){return i[+(t.getHours()>=12)]},Q:Mi,s:ki,S:ri,u:ii,U:oi,V:ai,w:si,W:ui,x:null,X:null,y:ci,Y:li,Z:hi,"%":Ai},b={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return u[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:fi,e:fi,f:yi,H:di,I:pi,j:vi,L:gi,m:mi,M:_i,p:function(t){return i[+(t.getUTCHours()>=12)]},Q:Mi,s:ki,S:bi,u:wi,U:xi,V:Ei,w:Oi,W:Pi,x:null,X:null,y:Si,Y:Ti,Z:Ci,"%":Ai},w={a:function(t,e,n){var r=d.exec(e.slice(n));return r?(t.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=f[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=m[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=v.exec(e.slice(n));return r?(t.m=g[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return O(t,e,n,r)},d:Br,e:Br,f:Zr,H:zr,I:zr,j:Ur,L:Wr,m:Nr,M:Gr,p:function(t,e,n){var r=c.exec(e.slice(n));return r?(t.p=l[r[0].toLowerCase()],n+r[0].length):-1},Q:Xr,s:Yr,S:Vr,u:kr,U:jr,V:Rr,w:Mr,W:Lr,x:function(t,e,r){return O(t,n,e,r)},X:function(t,e,n){return O(t,r,e,n)},y:Dr,Y:Ir,Z:Fr,"%":Hr};function x(t,e){return function(n){var r,i,o,a=[],s=-1,u=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===t.charCodeAt(s)&&(a.push(t.slice(u,s)),null!=(i=xr[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(t.slice(u,s)),a.join("")}}function E(t,e){return function(n){var r,i,o=mr(1900);if(O(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("p"in o&&(o.H=o.H%12+12*o.p),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=yr(mr(o.y))).getUTCDay(),r=i>4||0===i?sr.ceil(r):sr(r),r=ir.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=e(mr(o.y))).getDay(),r=i>4||0===i?Hn.ceil(r):Hn(r),r=Vn.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?yr(mr(o.y)).getUTCDay():e(mr(o.y)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,yr(o)):e(o)}}function O(t,e,n,r){for(var i,o,a=0,s=e.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=w[i in xr?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return _.x=x(n,_),_.X=x(r,_),_.c=x(e,_),b.x=x(n,b),b.X=x(r,b),b.c=x(e,b),{format:function(t){var e=x(t+="",_);return e.toString=function(){return t},e},parse:function(t){var e=E(t+="",gr);return e.toString=function(){return t},e},utcFormat:function(t){var e=x(t+="",b);return e.toString=function(){return t},e},utcParse:function(t){var e=E(t,yr);return e.toString=function(){return t},e}}}(t),_r.format,_r.parse,br=_r.utcFormat,wr=_r.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Date.prototype.toISOString||br("%Y-%m-%dT%H:%M:%S.%LZ");+new Date("2000-01-01T00:00:00.000Z")||wr("%Y-%m-%dT%H:%M:%S.%LZ");var ji=n("7GCR");const Ri=function(t,e={}){if(!t)return null;function n(t){console.log(t.statusMessage)}t.addEventListener("webglcontextcreationerror",n,!1);let r=t.getContext("webgl2",e);return(r=r||t.getContext("experimental-webgl2",e))||(r=(r=t.getContext("webgl",e))||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",n,!1),r},Li=(t,e,n,r)=>{if("undefined"!=typeof document){const r=document.createElement("canvas");return r.width=t*n,r.height=e*n,r.style.width=t+"px",r.style.height=e+"px",r}return new r(t,e)},Ii=ji.a.retina?2:1;var Di=class extends ji.e.CanvasLayerRenderer{draw(){this.prepareCanvas(),this.prepareDrawContext(),this._drawLayer()}needToRedraw(){const t=this.getMap();return!(t.isZooming()&&!t.getPitch())&&super.needToRedraw()}onCanvasCreate(){this.canvas&&this.layer.options.doubleBuffer&&(this.buffer=Li(this.canvas.width,this.canvas.height,Ii,this.getMap().CanvasClass),this.context=this.buffer.getContext("2d"))}createCanvas(){if(!this.canvas&&!this.canvas){const t=this.getMap(),e=t.getSize(),[n,r]=[Ii*e.width,Ii*e.height];this.canvas=Li(n,r,Ii,t.CanvasClass),this.gl=Ri(this.canvas,this.layer.options.glOptions),this.onCanvasCreate(),this.layer.fire("canvascreate",{context:this.context,gl:this.gl})}}resizeCanvas(t){if(!this.canvas)return;const e=t||this.getMap().getSize();this.canvas.height=Ii*e.height,this.canvas.width=Ii*e.width,this.gl.viewport(0,0,this.canvas.width,this.canvas.height)}clearCanvas(){this.canvas&&(this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.context&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height))}prepareCanvas(){this.canvas?this.clearCanvas():this.createCanvas();const t=super.prepareCanvas();return this.layer.fire("renderstart",{context:this.context,gl:this.gl}),t}onZoomStart(){super.onZoomStart.apply(this,arguments)}onZoomEnd(){super.onZoomEnd.apply(this,arguments)}remove(){delete this._drawContext,super.remove()}},Fi=n("TZTB"),Ni=n("Jh/b"),Bi="7.0.0-alpha.2";if(Fi.global.deck&&Fi.global.deck.VERSION!==Bi)throw new Error("deck.gl - multiple versions detected: ".concat(Fi.global.deck.VERSION," vs ").concat(Bi));Fi.global.deck||(Ni.a.log(0,"deck.gl ".concat(Bi," - ").concat("set deck.log.priority=1 (or higher) to trace attribute updates"))(),Fi.global.deck=Fi.global.deck||{VERSION:Bi,version:Bi,log:Ni.a}),console.table||(console.table=function(){}),n("nIko");n("nIko");var Ui=n("V3d6"),zi=n("VMBB"),Gi=n("L/7I"),Vi=n("kLp3"),Wi=n.n(Vi),Zi=n("r4zW"),Hi=n.n(Zi);function Xi(t){return(Xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ji(t,e){return!e||"object"!==Xi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qi(t){return(qi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qi(t,e){return(Qi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ki={isExternalBuffer:!1,needsUpdate:!0,needsRedraw:!1,allocedInstances:-1},$i=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=Ji(this,qi(e).call(this,t,r));var i=r.transition,o=void 0!==i&&i,a=r.noAlloc,s=void 0!==a&&a,u=r.update,c=void 0===u?null:u,l=r.accessor,h=void 0===l?null:l,f=r.bufferLayout,d=void 0===f?null:f,p=r.defaultValue,v=void 0===p?[0,0,0,0]:p;return v=Array.isArray(v)?v:[v],Object.assign(n.userData,Ki,r,{transition:o,noAlloc:s,update:c,accessor:h,defaultValue:v,bufferLayout:d}),Object.seal(n.userData),n._validateAttributeUpdaters(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qi(t,e)}(e,Gi["j"]),n=e,(r=[{key:"needsUpdate",value:function(){return this.userData.needsUpdate}},{key:"needsRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).clearChangedFlags,e=void 0!==t&&t,n=this.userData.needsRedraw;return this.userData.needsRedraw=this.userData.needsRedraw&&!e,n}},{key:"getInstanceCount",value:function(){return null!==this.value?this.value.length/this.size:0}},{key:"getUpdateTriggers",value:function(){var t=this.userData.accessor;return[this.id].concat(t||[])}},{key:"getAccessor",value:function(){return this.userData.accessor}},{key:"supportsTransition",value:function(){return this.userData.transition}},{key:"getTransitionSetting",value:function(t){var e=this.userData,n=e.transition,r=e.accessor;if(!n)return null;var i=Array.isArray(r)?t[r.find(function(e){return t[e]})]:t[r];return Number.isFinite(i)&&(i={duration:i}),i&&i.duration>0?Object.assign({},n,i):null}},{key:"setNeedsUpdate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.userData.needsUpdate=this.userData.needsUpdate||t}},{key:"setNeedsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.userData.needsRedraw=this.userData.needsRedraw||t}},{key:"allocate",value:function(t){var e=this.userData;if(e.isExternalBuffer||e.noAlloc)return!1;var n=this.getInstanceCount();if((0===n||n<t)&&(e.update||e.accessor)){Object(zi.a)(Number.isFinite(t));var r=Math.max(t,1),i=to(this.type||Hi.a.FLOAT);return this.constant=!1,this.value=new i(this.size*r),e.needsUpdate=!0,e.allocedInstances=r,!0}return!1}},{key:"updateBuffer",value:function(t){var e=t.numInstances,n=t.data,r=t.props,i=t.context;if(!this.needsUpdate())return!1;var o=this.userData,a=o.update,s=o.accessor,u=!0;return a?(a.call(i,this,{data:n,props:r,numInstances:e}),this.update({value:this.value,constant:this.constant}),this._checkAttributeArray()):s?(this._updateBufferViaStandardAccessor(n,r),this._checkAttributeArray()):u=!1,o.needsUpdate=!1,o.needsRedraw=!0,u}},{key:"setGenericValue",value:function(t){var e=this.userData;if(void 0===t||"function"==typeof t)return e.isExternalBuffer=!1,!1;t=this._normalizeValue(t);var n=!this.constant||!this._areValuesEqual(t,this.value);return n&&this.update({constant:!0,value:t}),e.needsRedraw=e.needsUpdate||n,e.needsUpdate=!1,e.isExternalBuffer=!0,!0}},{key:"setExternalBuffer",value:function(t,e){var n=this.userData;if(t){if(n.isExternalBuffer=!0,n.needsUpdate=!1,t instanceof Gi.b)this.externalBuffer!==t&&(this.update({constant:!1,buffer:t}),n.needsRedraw=!0);else{var r=to(this.type||Hi.a.FLOAT);if(!(t instanceof r))throw new Error("Attribute ".concat(this.id," must be of type ").concat(r.name));if(n.auto&&t.length<=e*this.size)throw new Error("Attribute prop array must match length and size");this.value!==t&&(this.update({constant:!1,value:t}),n.needsRedraw=!0)}return!0}return n.isExternalBuffer=!1,!1}},{key:"_normalizeValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.userData.defaultValue;if(!Array.isArray(t)&&!ArrayBuffer.isView(t))return e[n]=Number.isFinite(t)?t:r[0],e;switch(this.size){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:r[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:r[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:r[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:r[0]}return e}},{key:"_areValuesEqual",value:function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.size,r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}},{key:"_updateBufferViaStandardAccessor",value:function(t,e){var n=this.userData.accessor,r=this.value,i=this.size,o=e[n];Object(zi.a)("function"==typeof o,'accessor "'.concat(n,'" is not a function'));var a=0,s=!0,u=!1,c=void 0;try{for(var l,h=t[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=o(l.value);this._normalizeValue(f,r,a),a+=i}}catch(t){u=!0,c=t}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}this.update({value:r})}},{key:"_validateAttributeUpdaters",value:function(){var t=this.userData;if(!(t.noAlloc||"function"==typeof t.update||"string"==typeof t.accessor))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}},{key:"_checkAttributeArray",value:function(){var t=this.value;if(t&&t.length>=4&&!(Number.isFinite(t[0])&&Number.isFinite(t[1])&&Number.isFinite(t[2])&&Number.isFinite(t[3])))throw new Error("Illegal attribute generated for ".concat(this.id))}},{key:"bufferLayout",get:function(){return this.userData.bufferLayout},set:function(t){this.userData.bufferLayout=t}}])&&Yi(n.prototype,r),i&&Yi(n,i),e}();function to(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).clamped,n=void 0===e||e;switch(t){case Hi.a.FLOAT:return Float32Array;case Hi.a.UNSIGNED_SHORT:case Hi.a.UNSIGNED_SHORT_5_6_5:case Hi.a.UNSIGNED_SHORT_4_4_4_4:case Hi.a.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;case Hi.a.UNSIGNED_INT:return Uint32Array;case Hi.a.UNSIGNED_BYTE:return n?Uint8ClampedArray:Uint8Array;case Hi.a.BYTE:return Int8Array;case Hi.a.SHORT:return Int16Array;case Hi.a.INT:return Int32Array;default:throw new Error("Failed to deduce type from array")}}function eo(t){var e=t.source,n=t.target,r=t.start,i=void 0===r?0:r,o=t.end,a=t.getData;o=o||n.length;var s=e.length,u=o-i;if(s>u)n.set(e.subarray(0,u),i);else if(n.set(e,i),a)for(var c=s;c<u;)for(var l=a(c,e),h=0;h<l.length;h++)n[i+c]=l[h],c++}var no={1:"float",2:"vec2",3:"vec3",4:"vec4"};function ro(t){var e={},n={};for(var r in t){var i=t[r],o=i.fromState,a=i.toState,s=i.buffer;e["".concat(r,"From")]=o,e["".concat(r,"To")]=a,n["".concat(r)]=s}return{sourceBuffers:e,feedbackBuffers:n}}function io(t){var e=t.fromState,n=t.toState,r=t.fromLength,i=t.toLength,o=t.fromBufferLayout,a=t.toBufferLayout,s=t.getData,u=void 0===s?function(t){return t}:s;if((o&&a||!(r>=i))&&e instanceof Gi.b){var c=new Float32Array(i),l=e.getData({}),h=n.value,f=n.buffer,d=n.size,p=n.constant,v=h||f.getData({}),g=p?function(t,e){return u(h,e)}:function(t,e){return u(v.subarray(t,t+d),e)};!function(t){var e=t.source,n=t.target,r=t.size,i=t.getData,o=t.sourceLayout,a=t.targetLayout;if(!Array.isArray(a))return eo({source:e,target:n,getData:i}),n;for(var s=0,u=0,c=i&&function(t,e){return i(t+u,e)},l=Math.min(o.length,a.length),h=0;h<l;h++){var f=o[h]*r,d=a[h]*r;eo({source:e.subarray(s,s+f),target:n,start:u,end:u+d,getData:c}),s+=f,u+=d}u<n.length&&eo({source:[],target:n,start:u,getData:c})}({source:l,target:c,sourceLayout:o,targetLayout:a,size:n.size,getData:g}),e.setData({data:c})}}function oo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ao={NONE:"none",PENDING:"pending",IN_PROGRESS:"in_progress",ENDED:"ended"};function so(){}var uo=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._startTime=null,this._state=ao.NONE,this.duration=1,this.easing=function(t){return t},this.onStart=so,this.onUpdate=so,this.onInterrupt=so,this.onEnd=so,Object.assign(this,e)}var e,n,r;return e=t,(n=[{key:"start",value:function(t){this.inProgress&&this.onInterrupt(this),Object.assign(this,t),this._setState(ao.PENDING)}},{key:"cancel",value:function(){this.inProgress&&(this.onInterrupt(this),this._setState(ao.NONE))}},{key:"update",value:function(t){if(this.state===ao.PENDING&&(this._startTime=t,this._setState(ao.IN_PROGRESS)),this.state===ao.IN_PROGRESS){var e=!1,n=(t-this._startTime)/this.duration;return n>=1&&(n=1,e=!0),this.time=this.easing(n),this.onUpdate(this),e&&this._setState(ao.ENDED),!0}return!1}},{key:"_setState",value:function(t){if(this._state!==t)switch(this._state=t,t){case ao.PENDING:this.onStart(this);break;case ao.ENDED:this.onEnd(this)}}},{key:"state",get:function(){return this._state}},{key:"inProgress",get:function(){return this._state===ao.PENDING||this._state===ao.IN_PROGRESS}}])&&oo(e.prototype,n),r&&oo(e,r),t}();function co(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var lo=function(){},ho={duration:0,easing:function(t){return t},onStart:lo,onEnd:lo,onInterrupt:lo},fo=function(){function t(e,n){var r=n.id;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=r,this.gl=e,this.attributeTransitions={},this.needsRedraw=!1,this.transform=null,this.numInstances=0,Gi.i.isSupported(e)?this.isSupported=!0:Ni.a.warn("WebGL2 not supported by this browser. Transition animation is disabled.")()}var e,n,r;return e=t,(n=[{key:"finalize",value:function(){for(var t in this.transform&&this.transform.delete(),this.attributeTransitions)this._removeTransition(t)}},{key:"update",value:function(t){var e=t.attributes,n=t.transitions,r=void 0===n?{}:n,i=t.numInstances;if(this.opts=r,this.numInstances=i,this.isSupported){var o=this.attributeTransitions,a={};for(var s in e){this._updateAttribute(s,e[s])&&(a[s]=o[s])}for(var u in o){var c=e[u];c&&c.supportsTransition()||this._removeTransition(u)}if(this.transform){if(this.transform){var l=ro(a),h=l.sourceBuffers,f=l.feedbackBuffers;this.transform.update({elementCount:this.numInstances,sourceBuffers:h,feedbackBuffers:f})}}else this._createModel()}}},{key:"hasAttribute",value:function(t){return t in this.attributeTransitions}},{key:"getAttributes",value:function(){var t={};for(var e in this.attributeTransitions){var n=this.attributeTransitions[e];n.buffer&&(t[e]=n.attributeInTransition)}return t}},{key:"setCurrentTime",value:function(t){if(!this.transform||0===this.numInstances)return!1;var e={},n=this.needsRedraw;for(var r in this.needsRedraw=!1,this.attributeTransitions){var i=this.attributeTransitions[r];i.update(t)&&(e["".concat(r,"Time")]=i.time,n=!0)}return n&&this.transform.run({uniforms:e}),n}},{key:"_createTransition",value:function(t,e){var n=this.attributeTransitions[t];return n?null:(n=new uo({name:t,attribute:e,attributeInTransition:new $i(this.gl,e),bufferLayout:e.bufferLayout}),this.attributeTransitions[t]=n,this._invalidateModel(),n)}},{key:"_removeTransition",value:function(t){var e=this.attributeTransitions[t];e&&(e.buffer&&e.buffer.delete(),e._swapBuffer&&e._swapBuffer.delete(),delete this.attributeTransitions[t],this._invalidateModel())}},{key:"_updateAttribute",value:function(t,e){var n=e.getTransitionSetting(this.opts);if(n){var r,i=this.attributeTransitions[t];if(i?r=e.needsRedraw():(i=this._createTransition(t,e),r=!0),r)return this._triggerTransition(i,n),!0}return!1}},{key:"_invalidateModel",value:function(){this.transform&&(this.transform.delete(),this.transform=null)}},{key:"_createModel",value:function(){0!==Object.keys(this.attributeTransitions).length&&(this.transform=new Gi.i(this.gl,Object.assign({elementCount:this.numInstances},ro(this.attributeTransitions),function(t){var e=[],n=[],r=[],i=[],o=[];for(var a in t){var s=t[a],u=no[s.attribute.size];u&&(s.bufferIndex=e.length,e.push(a),n.push("attribute ".concat(u," ").concat(a,"From;")),n.push("attribute ".concat(u," ").concat(a,"To;")),r.push("uniform float ".concat(a,"Time;")),i.push("varying ".concat(u," ").concat(a,";")),o.push("".concat(a," = mix(").concat(a,"From, ").concat(a,"To,\n        ").concat(a,"Time);")))}return{vs:"\n#define SHADER_NAME feedback-vertex-shader\n".concat(n.join("\n"),"\n").concat(r.join("\n"),"\n").concat(i.join("\n"),"\n\nvoid main(void) {\n  ").concat(o.join("\n"),"\n  gl_Position = vec4(0.0);\n}\n"),fs:"#define SHADER_NAME feedback-fragment-shader\n\nprecision highp float;\n\n".concat(i.join("\n"),"\n\nvoid main(void) {\n  gl_FragColor = vec4(0.0);\n}\n"),varyings:e}}(this.attributeTransitions))))}},{key:"_getNextTransitionStates",value:function(t,e){var n,r=t.attribute,i=r.size;n=r.constant?{constant:!0,value:r.value,size:i}:{constant:!1,buffer:r.getBuffer(),size:i,value:r.externalBuffer?null:r.value};var o=t.buffer||n,a=this.numInstances*i,s=o instanceof Gi.b&&o.getElementCount()||a,u=t._swapBuffer;return t._swapBuffer=t.buffer,u?u.getElementCount()<a&&u.setData({data:new Float32Array(a)}):u=new Gi.b(this.gl,{data:new Float32Array(a),usage:Hi.a.DYNAMIC_COPY}),t.attributeInTransition.update({buffer:u}),io({fromState:o,toState:n,fromLength:s,toLength:a,fromBufferLayout:t.bufferLayout,toBufferLayout:r.bufferLayout,getData:e.enter}),t.bufferLayout=r.bufferLayout,{fromState:o,toState:n,buffer:u}}},{key:"_triggerTransition",value:function(t,e){Object(zi.a)(e&&e.duration>0),this.needsRedraw=!0;var n=Object.assign({},ho,e);t.start(Object.assign({},this._getNextTransitionStates(t,e),n))}}])&&co(e.prototype,n),r&&co(e,r),t}();function po(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vo(t,e,n){return e&&po(t.prototype,e),n&&po(t,n),t}function go(){}var yo={savedMessages:null,timeStart:null,onLog:function(t){var e=t.level,n=t.message;Ni.a.log(e,n)()},onUpdateStart:function(t){t.level,t.numInstances;yo.savedMessages=[],yo.timeStart=new Date},onUpdate:function(t){t.level;var e=t.message;yo.savedMessages&&yo.savedMessages.push(e)},onUpdateEnd:function(t){var e=t.level,n=t.id,r=t.numInstances,i=Math.round(new Date-yo.timeStart),o="".concat(i,"ms");Ni.a.group(e,"Updated attributes for ".concat(r," instances in ").concat(n," in ").concat(o),{collapsed:!0})();var a=!0,s=!1,u=void 0;try{for(var c,l=yo.savedMessages[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var h=c.value;Ni.a.log(e,h)()}}catch(t){s=!0,u=t}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}Ni.a.groupEnd(e,"Updated attributes for ".concat(r," instances in ").concat(n," in ").concat(o))(),yo.savedMessages=null}},mo=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.id,i=void 0===r?"attribute-manager":r,o=n.stats;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=i,this.gl=e,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=o,this.attributeTransitionManager=new fo(e,{id:"".concat(i,"-transitions")}),Object.seal(this)}return vo(t,null,[{key:"setDefaultLogFunctions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.onLog,n=t.onUpdateStart,r=t.onUpdate,i=t.onUpdateEnd;void 0!==e&&(yo.onLog=e||go),void 0!==n&&(yo.onUpdateStart=n||go),void 0!==r&&(yo.onUpdate=r||go),void 0!==i&&(yo.onUpdateEnd=i||go)}}]),vo(t,[{key:"finalize",value:function(){for(var t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}},{key:"getNeedsRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).clearRedrawFlags,e=void 0!==t&&t,n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e,n&&this.id}},{key:"setNeedsRedraw",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.needsRedraw=!0,this}},{key:"add",value:function(t,e){this._add(t,e)}},{key:"addInstanced",value:function(t,e){this._add(t,e,{instanced:1})}},{key:"remove",value:function(t){for(var e=0;e<t.length;e++){var n=t[e];void 0!==this.attributes[n]&&(this.attributes[n].delete(),delete this.attributes[n])}}},{key:"invalidate",value:function(t){var e=this._invalidateTrigger(t);yo.onLog({level:3,message:"invalidated attributes ".concat(e," (").concat(t,") for ").concat(this.id)})}},{key:"invalidateAll",value:function(){for(var t in this.attributes)this.attributes[t].setNeedsUpdate();yo.onLog({level:3,message:"invalidated all attributes for ".concat(this.id)})}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.data,n=t.numInstances,r=t.transitions,i=t.props,o=void 0===i?{}:i,a=t.buffers,s=void 0===a?{}:a,u=t.context,c=void 0===u?{}:u,l=!1;for(var h in yo.onUpdateStart({level:2,id:this.id,numInstances:n}),this.stats&&this.stats.timeStart("attribute updates",this.id),this.attributes){var f=this.attributes[h];f.setExternalBuffer(s[h],this.numInstances)||f.setGenericValue(o[f.getAccessor()])||f.needsUpdate()&&(l=!0,this._updateAttribute({attribute:f,numInstances:n,data:e,props:o,context:c})),this.needsRedraw|=f.needsRedraw()}l&&(this.stats&&this.stats.timeEnd("attribute updates",this.id),yo.onUpdateEnd({level:2,id:this.id,numInstances:n})),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:r})}},{key:"updateTransition",value:function(){var t=this.attributeTransitionManager.setCurrentTime(Date.now());return this.needsRedraw=this.needsRedraw||t,t}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getChangedAttributes",value:function(t){t.clearChangedFlags;var e=this.attributes,n=this.attributeTransitionManager,r=Object.assign({},n.getAttributes());for(var i in e){var o=e[i];o.needsRedraw({clearChangedFlags:!0})&&(n.hasAttribute(i)||(r[i]=o))}return r}},{key:"getAccessors",value:function(){return this.updateTriggers}},{key:"_add",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e&&Ni.a.warn("AttributeManager.add({updaters}) - updater map no longer supported")();var r={};for(var i in t){var o=t[i];r[i]=new $i(this.gl,Object.assign({},o,{id:i,constant:o.constant||!1,isIndexed:o.isIndexed||o.elements,size:o.elements?1:o.size,value:o.value||null,instanced:o.instanced||n.instanced}))}Object.assign(this.attributes,r),this._mapUpdateTriggersToAttributes()}},{key:"_mapUpdateTriggersToAttributes",value:function(){var t=this,e={},n=function(n){t.attributes[n].getUpdateTriggers().forEach(function(t){e[t]||(e[t]=[]),e[t].push(n)})};for(var r in this.attributes)n(r);this.updateTriggers=e}},{key:"_invalidateTrigger",value:function(t){var e=this.attributes,n=this.updateTriggers[t];if(n)n.forEach(function(t){var n=e[t];n&&n.setNeedsUpdate()});else{var r="invalidating non-existent trigger ".concat(t," for ").concat(this.id,"\n");r+="Valid triggers: ".concat(Object.keys(e).join(", ")),Ni.a.warn(r,n)()}return n}},{key:"_updateAttribute",value:function(t){var e=t.attribute,n=t.numInstances,r=t.data,i=t.props,o=t.context;e.allocate(n)&&yo.onUpdate({level:3,message:"".concat(e.id," allocated ").concat(n),id:this.id});var a=Date.now();if(e.updateBuffer({numInstances:n,data:r,props:i,context:o})){this.needsRedraw=!0;var s=Math.round(Date.now()-a);yo.onUpdate({level:3,message:"".concat(e.id," updated ").concat(n," in ").concat(s,"ms")})}}}]),t}();function _o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var bo=new Map,wo=function(t){if(Wi.a.isReady()&&t.id){var e=bo.get(t.id);e&&e.forEach(function(e,n){!function t(e,n,r){e&&(n.length>1?t(e[n[0]],n.slice(1),r):e[n[0]]=r)}(t,n,e),"data"===n[0]&&(t.data=_o(t.data))})}},xo=function(t){Wi.a.isReady()&&Wi.a.listenFor("deck.gl",t)},Eo=function(t){Wi.a.isReady()&&Wi.a.listenFor("init",t)},Oo=function(t){if(Wi.a.isReady()&&t){var e=[t.constructor.layerName];Wi.a.listItem("deck.gl",t.id,{badges:e,links:t.state&&t.state.model?["luma.gl:".concat(t.state.model.id)]:void 0,parent:t.parent?t.parent.id:void 0})}},Po=function(t){if(Wi.a.isReady()&&!Wi.a.throttle("deck.gl:".concat(t.id),1e3)){var e=function(t){var e=[{path:"objects.props",data:t.props}],n=[t.constructor.layerName];if(t.state){if(t.getAttributeManager()){var r=t.getAttributeManager().getAttributes();e.push({path:"objects.attributes",data:r}),n.push(t.getAttributeManager().stats.getTimeString())}if(t.state.model){t.state.model.setProps({timerQueryEnabled:!0});var i=t.state.model.stats.lastFrameTime;i&&n.push("".concat((1e3*i).toFixed(0),"s"))}}return e.push({path:"badges",data:n}),e}(t);Wi.a.multiUpdate("deck.gl",t.id,e)}};function So(t){return(So="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function To(t,e){var n=Co({newProps:t,oldProps:e,propTypes:Mo(t),ignoreProps:{data:null,updateTriggers:null}}),r=function(t,e){if(null===e)return"oldProps is null, initial diff";var n=t.dataComparator;if(n){if(!n(t.data,e.data))return"Data comparator detected a change"}else if(t.data!==e.data)return"A new data container was supplied";return null}(t,e),i=!1;return r||(i=function(t,e){if(null===e)return"oldProps is null, initial diff";if("all"in t.updateTriggers){var n=Ao(t,e,"all");if(n)return{all:!0}}var r={},i=!1;for(var o in t.updateTriggers)if("all"!==o){var a=Ao(t,e,o);a&&(r[o]=!0,i=r)}return i}(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i}}function Co(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.newProps,n=t.oldProps,r=t.ignoreProps,i=void 0===r?{}:r,o=t.propTypes,a=void 0===o?{}:o,s=t.triggerName,u=void 0===s?"props":s;if(Object(zi.a)(void 0!==n&&void 0!==e,"compareProps args"),n===e)return null;if("object"!==So(e)||null===e)return"".concat(u," changed shallowly");if("object"!==So(n)||null===n)return"".concat(u," changed shallowly");for(var c in n)if(!(c in i)){if(!(c in e))return"".concat(u,".").concat(c," dropped: ").concat(n[c]," -> undefined");var l=e[c],h=n[c],f=a[c],d=f&&f.equal;if(d&&!d(l,h,f))return"".concat(u,".").concat(c," changed deeply: ").concat(h," -> ").concat(l);if(!d&&(d=l&&h&&l.equals)&&!d.call(l,h))return"".concat(u,".").concat(c," changed deeply: ").concat(h," -> ").concat(l);if(!d&&h!==l)return"".concat(u,".").concat(c," changed shallowly: ").concat(h," -> ").concat(l)}for(var p in e)if(!(p in i||p in n))return"".concat(u,".").concat(p," added: undefined -> ").concat(e[p]);return null}function Ao(t,e,n){var r=t.updateTriggers[n];r=null==r?{}:r;var i=e.updateTriggers[n];return Co({oldProps:i=null==i?{}:i,newProps:r,triggerName:n})}function Mo(t){var e=t._component,n=e&&e.constructor;return n?n._propTypes:{}}function ko(t){return(ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var jo="count(): argument not an object",Ro="count(): argument not a container";function Lo(t){if(null===(e=t)||"object"!==ko(e))throw new Error(jo);var e;if("function"==typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"===ko(t)&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error(Ro)}var Io=n("5cL1"),Do={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"};function Fo(t){return(Fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function No(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Bo={boolean:{validate:function(t,e){return!0},equal:function(t,e,n){return Boolean(t)===Boolean(e)}},number:{validate:function(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate:function(t,e){return Vo(t)&&(3===t.length||4===t.length)},equal:function(t,e,n){return Uo(t,e)}},accessor:{validate:function(t,e){var n=Wo(t);return"function"===n||n===Wo(e.value)},equal:function(t,e,n){return"function"==typeof e||Uo(t,e)}},array:{validate:function(t,e){return e.optional&&!t||Vo(t)},equal:function(t,e,n){return n.compare?Uo(t,e):t===e}},function:{validate:function(t,e){return e.optional&&!t||"function"==typeof t},equal:function(t,e,n){return!n.compare||t===e}}};function Uo(t,e){if(t===e)return!0;if(!Vo(t)||!Vo(e))return!1;var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function zo(t,e){switch(Wo(e)){case"object":return Go(t,e);case"array":return Go(t,{type:"array",value:e,compare:!1});case"boolean":return Go(t,{type:"boolean",value:e});case"number":return Go(t,{type:"number",value:e});case"function":return Go(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Go(t,e){return"type"in e?Object.assign({name:t},Bo[e.type],e):"value"in e?Object.assign({name:t,type:Wo(e.value)},e):{name:t,type:"object",value:e}}function Vo(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Wo(t){return Vo(t)?"array":null===t?"null":Fo(t)}function Zo(t){var e=Xo(t,"_mergedDefaultProps");return e?{defaultProps:e,propTypes:Xo(t,"_propTypes")}:function(t){var e=t.prototype;if(!e)return{defaultProps:{}};var n=Object.getPrototypeOf(t),r=e&&Zo(n)||null,i=function(t){for(var e={},n={},r=Object.entries(t),i=0;i<r.length;i++){var o=No(r[i],2),a=o[0],s=zo(a,o[1]);e[a]=s,n[a]=s.value}return{propTypes:e,defaultProps:n}}(Xo(t,"defaultProps")||{}),o=Object.assign({},r&&r.propTypes,i.propTypes),a=function(t,e,n,r){var i=Object.create(null);Object.assign(i,e,t);var o=function(t){var e=Xo(t,"layerName")||Xo(t,"componentName");e||Ni.a.once(0,"".concat(t.name,".componentName not specified"))();return e||t.name}(r);return delete t.id,Object.defineProperties(i,{id:{configurable:!1,writable:!0,value:o}}),function(t,e){var n={},r={_asyncPropDefaultValues:{enumerable:!1,value:n},_asyncPropOriginalValues:{enumerable:!1,value:{}}};for(var i in e){var o=e[i],a=o.name,s=o.value;o.async&&(n[a]=s,r[a]=Ho(a))}Object.defineProperties(t,r)}(i,n),i}(i.defaultProps,r&&r.defaultProps,o,t);return t._mergedDefaultProps=a,t._propTypes=o,{propTypes:o,defaultProps:a}}(t)}function Ho(t){return{configurable:!1,enumerable:!0,set:function(e){"string"==typeof e||e instanceof Promise?this._asyncPropOriginalValues[t]=e:this._asyncPropResolvedValues[t]=e},get:function(){if(this._asyncPropResolvedValues){if(t in this._asyncPropResolvedValues){var e=this._asyncPropResolvedValues[t];return"data"===t?e||this._asyncPropDefaultValues[t]:e}if(t in this._asyncPropOriginalValues){var n=this._component&&this._component.internalState;if(n&&n.hasAsyncProp(t))return n.getAsyncProp(t)}}return this._asyncPropDefaultValues[t]}}}function Xo(t,e){return Object.prototype.hasOwnProperty.call(t,e)&&t[e]}function Yo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Jo=Object.freeze({}),qo=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=function(){},this.oldProps=Jo,this.oldAsyncProps=null}var e,n,r;return e=t,(n=[{key:"getOldProps",value:function(){return this.oldAsyncProps||this.oldProps}},{key:"resetOldProps",value:function(){this.oldAsyncProps=null,this.oldProps=this.component.props}},{key:"freezeAsyncOldProps",value:function(){if(!this.oldAsyncProps)for(var t in this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps={},this.oldProps)this.oldAsyncProps[t]=this.oldProps[t]}},{key:"hasAsyncProp",value:function(t){return t in this.asyncProps}},{key:"getAsyncProp",value:function(t){var e=this.asyncProps[t];return e&&e.resolvedValue}},{key:"isAsyncPropLoading",value:function(t){var e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}},{key:"setAsyncProps",value:function(t){var e=t._asyncPropResolvedValues||{},n=t._asyncPropOriginalValues||t,r=t._asyncPropDefaultValues||{};for(var i in e){var o=e[i];this._createAsyncPropData(i,o,r[i]),this._updateAsyncProp(i,o)}for(var a in n){var s=n[a];this._createAsyncPropData(a,s,r[a]),this._updateAsyncProp(a,s)}}},{key:"_updateAsyncProp",value:function(t,e){if(this._didAsyncInputValueChange(t,e)){if("string"==typeof e)e=(0,this.layer.props.fetch)(e);e instanceof Promise?this._watchPromise(t,e):this._setPropValue(t,e)}}},{key:"_didAsyncInputValueChange",value:function(t,e){var n=this.asyncProps[t];return e!==n.lastValue&&(n.lastValue=e,!0)}},{key:"_setPropValue",value:function(t,e){var n=this.asyncProps[t];n.value=e,n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount}},{key:"_setAsyncPropValue",value:function(t,e,n){var r=this.asyncProps[t];r&&n>=r.resolvedLoadCount&&(Object(zi.a)(void 0!==e),this.freezeAsyncOldProps(),e=this._postProcessValue(t,e),r.resolvedValue=e,r.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}},{key:"_watchPromise",value:function(t,e){var n=this,r=this.asyncProps[t];r.pendingLoadCount++;var i=r.pendingLoadCount;e.then(function(e){return n._setAsyncPropValue(t,e,i)}).catch(function(t){return Ni.a.error(t)()})}},{key:"_postProcessValue",value:function(t,e){var n=(this.component?this.component.props:{}).dataTransform;return"data"===t&&n&&(e=n(e)),e}},{key:"_createAsyncPropData",value:function(t,e,n){this.asyncProps[t]||(this.asyncProps[t]={lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0})}}])&&Yo(e.prototype,n),r&&Yo(e,r),t}();function Qo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ko=0,$o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.props=function(){for(var t=Zo(this.constructor).defaultProps,e=Object.create(t,{_component:{enumerable:!1,value:this},_asyncPropOriginalValues:{enumerable:!1,value:{}},_asyncPropResolvedValues:{enumerable:!1,value:{}}}),n=0;n<arguments.length;++n)Object.assign(e,arguments[n]);return wo(e),Object.freeze(e),e}.apply(this,arguments),this.id=this.props.id,this.count=Ko++,this.lifecycle=Do.NO_STATE,this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}var e,n,r;return e=t,(n=[{key:"clone",value:function(t){return new this.constructor(Object.assign({},this.props,t))}},{key:"_initState",value:function(){this.internalState=new qo({})}},{key:"stats",get:function(){return this.internalState.stats}}])&&Qo(e.prototype,n),r&&Qo(e,r),t}();function ta(t){return(ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ea(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function na(t,e){return!e||"object"!==ta(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ra(t){return(ra=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ia(t,e){return(ia=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}$o.defaultProps={};var oa=function(t){function e(t){var n,r=t.attributeManager,i=t.layer;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=na(this,ra(e).call(this,i))).attributeManager=r,n.model=null,n.needsRedraw=!0,n.subLayers=null,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ia(t,e)}(e,qo),n=e,(r=[{key:"layer",get:function(){return this.component},set:function(t){this.component=t}}])&&ea(n.prototype,r),i&&ea(n,i),e}(),aa=n("B7nP");function sa(t){return(sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ua(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ca(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function la(t,e){return!e||"object"!==sa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ha(t){return(ha=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fa(t,e){return(fa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var da={data:{type:"data",value:Object.freeze([]),async:!0},dataComparator:null,dataTransform:{type:"function",value:function(t){return t},compare:!1},fetch:{type:"function",value:function(t){return fetch(t).then(function(t){return t.json()})},compare:!1},updateTriggers:{},numInstances:void 0,visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:.8},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Ui.a.LNGLAT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,parameters:{},uniforms:{},framebuffer:null,animation:null,getPolygonOffset:{type:"function",value:function(t){return[0,100*-t.layerIndex]},compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"color",value:[0,0,128,128]}},pa=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),la(this,ha(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fa(t,e)}(e,$o),n=e,(r=[{key:"toString",value:function(){var t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}},{key:"setState",value:function(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}},{key:"setNeedsRedraw",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.internalState&&(this.internalState.needsRedraw=t)}},{key:"setLayerNeedsUpdate",value:function(){this.context.layerManager.setNeedsUpdate(String(this))}},{key:"getNeedsRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).clearRedrawFlags,e=void 0!==t&&t;return this._getNeedsRedraw(e)}},{key:"needsUpdate",value:function(){return this.shouldUpdateState(this._getUpdateParams())}},{key:"isPickable",value:function(){return this.props.pickable&&this.props.visible}},{key:"getModels",value:function(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}},{key:"getSingleModel",value:function(){return this.state&&this.state.model}},{key:"getAttributeManager",value:function(){return this.internalState&&this.internalState.attributeManager}},{key:"getCurrentLayer",value:function(){return this.internalState&&this.internalState.layer}},{key:"getFirstObject",value:function(){var t=this.props.data,e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){return i.value}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return null}},{key:"project",value:function(t){var e=this.context.viewport,n=Object(Io.a)(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),r=ua(Object(aa.k)(n,e.pixelProjectionMatrix),3),i=r[0],o=r[1],a=r[2];return 2===t.length?[i,o]:[i,o,a]}},{key:"unproject",value:function(t){var e=this.context.viewport;return Object(zi.a)(Array.isArray(t)),e.unproject(t)}},{key:"projectPosition",value:function(t){return Object(zi.a)(Array.isArray(t)),Object(Io.b)(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}},{key:"projectFlat",value:function(t){Ni.a.deprecated("layer.projectFlat","layer.projectPosition")();var e=this.context.viewport;return Object(zi.a)(Array.isArray(t)),e.projectFlat(t)}},{key:"unprojectFlat",value:function(t){Ni.a.deprecated("layer.unprojectFlat")();var e=this.context.viewport;return Object(zi.a)(Array.isArray(t)),e.unprojectFlat(t)}},{key:"use64bitProjection",value:function(){if(this.props.fp64){if(this.props.coordinateSystem===Ui.a.LNGLAT_DEPRECATED)return!0;Ni.a.once(0,"Legacy 64-bit mode only works with coordinateSystem set to\n        COORDINATE_SYSTEM.LNGLAT_DEPRECATED. Rendering in 32-bit mode instead")()}return!1}},{key:"use64bitPositions",value:function(){return this.props.fp64||this.props.coordinateSystem===Ui.a.LNGLAT}},{key:"screenToDevicePixels",value:function(t){return Ni.a.deprecated("screenToDevicePixels","DeckGL prop useDevicePixels for conversion")(),t*("undefined"!=typeof window?window.devicePixelRatio:1)}},{key:"onHover",value:function(t){this.props.onHover&&this.props.onHover(t,this.context.pickingEvent)}},{key:"onClick",value:function(t){this.props.onClick&&this.props.onClick(t,this.context.pickingEvent)}},{key:"nullPickingColor",value:function(){return[0,0,0]}},{key:"encodePickingColor",value:function(t){return Object(zi.a)(0==(t+1>>24&255),"index out of picking color range"),[t+1&255,t+1>>8&255,t+1>>8>>8&255]}},{key:"decodePickingColor",value:function(t){Object(zi.a)(t instanceof Uint8Array);var e=ua(t,3);return e[0]+256*e[1]+65536*e[2]-1}},{key:"initializeState",value:function(){throw new Error("Layer ".concat(this," has not defined initializeState"))}},{key:"shouldUpdateState",value:function(t){t.oldProps,t.props,t.context;return t.changeFlags.propsOrDataChanged}},{key:"updateState",value:function(t){t.oldProps,t.props,t.context;var e=t.changeFlags,n=this.getAttributeManager();e.dataChanged&&n&&n.invalidateAll()}},{key:"finalizeState",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.getModels()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){r.value.delete()}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}var o=this.getAttributeManager();o&&o.finalize()}},{key:"draw",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.getModels()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){i.value.draw(t)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"getPickingInfo",value:function(t){var e=t.info,n=(t.mode,e.index);return n>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[n]),e}},{key:"invalidateAttribute",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.getAttributeManager();n&&("all"===t?(Ni.a.log(1,"updateTriggers invalidating all attributes: ".concat(e))(),n.invalidateAll()):(Ni.a.log(1,"updateTriggers invalidating attribute ".concat(t,": ").concat(e))(),n.invalidate(t)))}},{key:"updateAttributes",value:function(t){var e=this.getAttributeManager();if(e){var n=this.getNumInstances(t);e.update({data:t.data,numInstances:n,props:t,transitions:t.transitions,buffers:t,context:this,ignoreUnknownAttributes:!0});var r=this.getSingleModel();if(r){var i=e.getChangedAttributes({clearChangedFlags:!0});r.setAttributes(i)}}}},{key:"updateTransition",value:function(){var t=this.getAttributeManager();t&&t.updateTransition()}},{key:"calculateInstancePickingColors",value:function(t,e){for(var n=e.numInstances,r=t.value,i=t.size,o=0;o<n;o++){var a=this.encodePickingColor(o);r[o*i+0]=a[0],r[o*i+1]=a[1],r[o*i+2]=a[2]}}},{key:"_clearInstancePickingColor",value:function(t){var e=this.getAttributeManager().attributes.instancePickingColors,n=e.value,r=e.size,i=this.decodePickingColor(t);n[i*r+0]=0,n[i*r+1]=0,n[i*r+2]=0,e.update({value:n})}},{key:"_clearPickingColor",value:function(t){for(var e=this.getAttributeManager().attributes.pickingColors,n=e.value,r=0;r<n.length;r+=3)n[r+0]===t[0]&&n[r+1]===t[1]&&n[r+2]===t[2]&&(n[r+0]=0,n[r+1]=0,n[r+2]=0);e.update({value:n})}},{key:"clearPickingColor",value:function(t){this.getAttributeManager().attributes.pickingColors?this._clearPickingColor(t):this._clearInstancePickingColor(t)}},{key:"copyPickingColors",value:function(){var t=this.getAttributeManager().attributes,e=t.pickingColors,n=t.instancePickingColors;return new Uint8ClampedArray((e||n).value)}},{key:"restorePickingColors",value:function(t){var e=this.getAttributeManager().attributes,n=e.pickingColors,r=e.instancePickingColors;(n||r).update({value:t})}},{key:"getNumInstances",value:function(t){return t=t||this.props,this.state&&void 0!==this.state.numInstances?this.state.numInstances:void 0!==t.numInstances?t.numInstances:Lo(this.props.data)}},{key:"_initialize",value:function(){Object(zi.a)(this.context.gl),this._initState(),this.initializeState(this.context),this.state.attributeManager=this.getAttributeManager(),this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0}),this._updateState();var t=this.getSingleModel();t&&(t.id=this.props.id,t.program.id="".concat(this.props.id,"-program"),t.geometry.id="".concat(this.props.id,"-geometry"))}},{key:"_update",value:function(){this.needsUpdate()&&this._updateState()}},{key:"_updateState",value:function(){var t=this._getUpdateParams();this.updateState(t),this.isComposite?this._renderLayers(t):(this.setNeedsRedraw(),this.updateAttributes(this.props),this._updateBaseUniforms(),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances())),this.clearChangeFlags(),this.internalState.resetOldProps()}},{key:"_finalize",value:function(){var t;Object(zi.a)(this.internalState&&this.state),this.finalizeState(this.context),t=this.id,Wi.a.isReady()&&t&&Wi.a.deleteItem("deck.gl",t)}},{key:"drawLayer",value:function(t){var e=this,n=t.moduleParameters,r=void 0===n?null:n,i=t.uniforms,o=void 0===i?{}:i,a=t.parameters,s=void 0===a?{}:a;o.picking_uActive||this.updateTransition(),r&&this.setModuleParameters(r);var u=this.context.animationProps;if(u){var c=!0,l=!1,h=void 0;try{for(var f,d=this.getModels()[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){f.value._setAnimationProps(u)}}catch(t){l=!0,h=t}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}}var p=this.props.getPolygonOffset,v=p&&p(o)||[0,0];s.polygonOffset=v,Object(Gi.B)(this.context.gl,s,function(){e.draw({moduleParameters:r,uniforms:o,parameters:s,context:e.context})})}},{key:"pickLayer",value:function(t){return this.getPickingInfo(t)}},{key:"getChangeFlags",value:function(){return this.internalState.changeFlags}},{key:"setChangeFlags",value:function(t){var e=this;this.internalState.changeFlags=this.internalState.changeFlags||{};var n=this.internalState.changeFlags;t.dataChanged&&!n.dataChanged&&(n.dataChanged=t.dataChanged,Ni.a.log(2,function(){return"dataChanged: ".concat(t.dataChanged," in ").concat(e.id)})()),t.updateTriggersChanged&&!n.updateTriggersChanged&&(n.updateTriggersChanged=n.updateTriggersChanged&&t.updateTriggersChanged?Object.assign({},t.updateTriggersChanged,n.updateTriggersChanged):t.updateTriggersChanged||n.updateTriggersChanged,Ni.a.log(2,function(){return"updateTriggersChanged: "+"".concat(Object.keys(t.updateTriggersChanged).join(", ")," in ").concat(e.id)})()),t.propsChanged&&!n.propsChanged&&(n.propsChanged=t.propsChanged,Ni.a.log(2,function(){return"propsChanged: ".concat(t.propsChanged," in ").concat(e.id)})()),t.viewportChanged&&!n.viewportChanged&&(n.viewportChanged=t.viewportChanged,Ni.a.log(3,function(){return"viewportChanged: ".concat(t.viewportChanged," in ").concat(e.id)})()),t.stateChanged&&!n.stateChanged&&(n.stateChanged=t.stateChanged,Ni.a.log(2,function(){return"stateChanged: ".concat(t.stateChanged," in ").concat(e.id)})());var r=t.dataChanged||t.updateTriggersChanged||t.propsChanged;n.propsOrDataChanged=n.propsOrDataChanged||r,n.somethingChanged=n.somethingChanged||r||t.viewportChanged||t.stateChanged}},{key:"clearChangeFlags",value:function(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}},{key:"printChangeFlags",value:function(){var t=this.internalState.changeFlags;return"".concat(t.dataChanged?"data ":"").concat(t.propsChanged?"props ":"").concat(t.updateTriggersChanged?"triggers ":"").concat(t.viewportChanged?"viewport":"")}},{key:"diffProps",value:function(t,e){var n=To(t,e);if(n.updateTriggersChanged)for(var r in n.updateTriggersChanged)n.updateTriggersChanged[r]&&this._activeUpdateTrigger(r);return this.setChangeFlags(n)}},{key:"validateProps",value:function(){!function(t){var e=Mo(t);for(var n in e){var r=e[n],i=r.validate;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}(this.props)}},{key:"setModuleParameters",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.getModels()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){i.value.updateModuleSettings(t)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"_getUpdateParams",value:function(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}},{key:"_getNeedsRedraw",value:function(t){if(!this.internalState)return!1;var e=!1;e=e||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t;var n=this.getAttributeManager(),r=n&&n.getNeedsRedraw({clearRedrawFlags:t}),i=this._modelNeedsRedraw(t);return e=e||r||i}},{key:"_modelNeedsRedraw",value:function(t){var e=!1,n=!0,r=!1,i=void 0;try{for(var o,a=this.getModels()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=s.getNeedsRedraw({clearRedrawFlags:t});u&&"string"!=typeof u&&(u="model ".concat(s.id)),e=e||u}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}},{key:"_getAttributeManager",value:function(){return new mo(this.context.gl,{id:this.props.id,stats:this.context.stats})}},{key:"_initState",value:function(){Object(zi.a)(!this.internalState&&!this.state);var t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:Hi.a.UNSIGNED_BYTE,size:3,update:this.calculateInstancePickingColors}}),this.internalState=new oa({attributeManager:t,layer:this}),this.state={},this.state.attributeManager=t,this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}},{key:"_transferState",value:function(t){var e=t.state,n=t.internalState;if(Object(zi.a)(e&&n),this!==t){this.internalState=n,this.internalState.component=this,this.state=e,e.layer=this,this.internalState.setAsyncProps(this.props);var r=!0,i=!1,o=void 0;try{for(var a,s=this.getModels()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){a.value.userData.layer=this}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}this.diffProps(this.props,this.internalState.getOldProps())}}},{key:"_onAsyncPropUpdated",value:function(){this.diffProps(this.props,this.internalState.getOldProps()),this.setLayerNeedsUpdate()}},{key:"_activeUpdateTrigger",value:function(t){this.invalidateAttribute(t)}},{key:"_updateBaseUniforms",value:function(){var t=this,e={opacity:"function"==typeof this.props.opacity?function(e){return Math.pow(t.props.opacity(e),1/2.2)}:Math.pow(this.props.opacity,1/2.2)},n=!0,r=!1,i=void 0;try{for(var o,a=this.getModels()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){o.value.setUniforms(e)}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}},{key:"setUniforms",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.getModels()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){i.value.setUniforms(t)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}this.setNeedsRedraw(),Ni.a.deprecated("layer.setUniforms","model.setUniforms")()}},{key:"is64bitEnabled",value:function(){return Ni.a.deprecated("is64bitEnabled","use64bitProjection")(),this.use64bitProjection()}}])&&ca(n.prototype,r),i&&ca(n,i),e}();pa.layerName="Layer",pa.defaultProps=da;var va=2,ga=0,ya=function(t){var e=t.useDevicePixels;return Object(zi.a)("boolean"==typeof e,"Invalid useDevicePixels"),e&&"undefined"!=typeof window?window.devicePixelRatio:1},ma=function(t,e){var n=e.viewport,r=e.pixelRatio,i=t.canvas?t.canvas.clientHeight||t.canvas.height:100,o=n;return[o.x*r,(i-o.y-o.height)*r,o.width*r,o.height*r]};function _a(t,e){var n=e.layers,r=e.viewports,i=e.views,o=e.onViewportActive,a=e.useDevicePixels,s=e.drawPickingColors,u=void 0!==s&&s,c=e.deviceRect,l=void 0===c?null:c,h=e.parameters,f=void 0===h?{}:h,d=e.layerFilter,p=void 0===d?null:d,v=e.pass,g=void 0===v?"draw":v,y=e.redrawReason,m=void 0===y?"":y,_=e.stats;e.customRender||function(t,e){e.useDevicePixels;var n=t.drawingBufferWidth,r=t.drawingBufferHeight;Object(Gi.B)(t,{viewport:[0,0,n,r]},function(){t.clear(Hi.a.COLOR_BUFFER_BIT|Hi.a.DEPTH_BUFFER_BIT)})}(t,{useDevicePixels:a}),r.forEach(function(e,r){var s=function(t){return t.viewport?t.viewport:t}(e),c=i&&i[s.id];o(s),function(t,e){var n=e.layers,r=e.viewport,i=e.view,o=e.useDevicePixels,a=e.drawPickingColors,s=void 0!==a&&a,u=(e.deviceRect,e.parameters),c=void 0===u?{}:u,l=e.layerFilter,h=e.pass,f=void 0===h?"draw":h,d=e.redrawReason,p=void 0===d?"":d,v=e.stats,g=ya({useDevicePixels:o}),y=ma(t,{viewport:r,pixelRatio:g});if(i&&i.props.clear){var m=!0===i.props.clear?{color:!0,depth:!0}:i.props.clear;Object(Gi.B)(t,{scissorTest:!0,scissor:y},function(){return Object(Gi.p)(t,m)})}var _={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};Object(Gi.z)(t,c||{}),n.forEach(function(e,n){var i=!e.isComposite&&e.props.visible;s&&(i=i&&e.props.pickable),i&&l&&(i=l({layer:e,viewport:r,isPicking:s})),i&&e.props.pickable&&_.pickableCount++,e.isComposite&&_.compositeCount++,i&&(_.visibleCount++,function(t){t.gl;var e=t.layer,n=t.layerIndex,r=t.drawPickingColors,i=t.pixelRatio,o=t.glViewport,a=t.parameters,s=Object.assign(Object.create(e.props),{viewport:e.context.viewport,pickingActive:r?1:0,devicePixelRatio:i}),u=Object.assign({},e.context.uniforms,{layerIndex:n}),c=Object.assign({},e.props.parameters||{},a);Object.assign(c,{viewport:o}),r?Object.assign(c,{blendColor:[0,0,0,(n+1)/255]}):Object.assign(s,function(t){var e=t.props,n=e.highlightedObjectIndex,r=e.highlightColor,i={pickingHighlightColor:[r[0],r[1],r[2],r[3]||255]};Number.isInteger(n)&&(i.pickingSelectedColor=n>=0?t.encodePickingColor(n):null);return i}(e));e.drawLayer({moduleParameters:s,uniforms:u,parameters:c})}({gl:t,layer:e,layerIndex:n,drawPickingColors:s,pixelRatio:g,glViewport:y,parameters:c}))}),ga++,function(t){var e=t.renderStats,n=t.pass,r=t.redrawReason,i=t.stats;if(Ni.a.priority>=va){var o=e.totalCount,a=e.visibleCount,s=e.compositeCount,u=e.pickableCount,c=o-s,l=c-a,h="";h+="RENDER #".concat(ga," ").concat(a," (of ").concat(o," layers) to ").concat(n," because ").concat(r," "),Ni.a.priority>va&&(h+="(".concat(l," hidden, ").concat(s," composite ").concat(u," pickable)")),Ni.a.log(va,h)(),i&&i.increment("redraw layers",a)}}({renderStats:_,pass:f,redrawReason:p,stats:v})}(t,{layers:n,viewport:s,view:c,useDevicePixels:a,drawPickingColors:u,deviceRect:l,parameters:f,layerFilter:p,pass:g,redrawReason:m,stats:_})})}var ba={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function wa(t,e){for(var n=e.layers,r=e.viewports,i=e.x,o=e.y,a=e.radius,s=e.layerFilter,u=e.depth,c=void 0===u?1:u,l=e.mode,h=e.onViewportActive,f=e.pickingFBO,d=e.lastPickedInfo,p=e.useDevicePixels,v=ya({useDevicePixels:p}),g=Math.round(i*v),y=Math.round(t.canvas.height-o*v),m=Math.round(a*v),_=function(t){var e=t.deviceX,n=t.deviceY,r=t.deviceRadius,i=t.deviceWidth,o=t.deviceHeight;if(!(e>=0&&n>=0&&e<i&&n<o))return null;var a=Math.max(0,e-r),s=Math.max(0,n-r),u=Math.min(i,e+r)-a+1,c=Math.min(o,n+r)-s+1;return{x:a,y:s,width:u,height:c}}({deviceX:g,deviceY:y,deviceRadius:m,deviceWidth:f.width,deviceHeight:f.height}),b=[],w={},x=0;x<c;x++){var E=_&&Ea(t,{layers:n,viewports:r,onViewportActive:h,useDevicePixels:p,pickingFBO:f,deviceRect:_,layerFilter:s,redrawReason:l}),O=E&&Pa(t,{pickedColors:E,layers:n,deviceX:g,deviceY:y,deviceRadius:m,deviceRect:_})||ba;if(O.pickedColor&&x+1<c){var P=O.pickedColor[3]-1;w[P]||(w[P]=n[P].copyPickingColors()),n[P].clearPickingColor(O.pickedColor)}var S=Oa({pickInfo:O,lastPickedInfo:d,mode:l,layers:n,viewports:r,x:i,y:o,deviceX:g,deviceY:y,pixelRatio:v});if(S&&S.forEach(function(t){return b.push(t)}),!O.pickedColor)break}return Object.keys(w).forEach(function(t){return n[t].restorePickingColors(w[t])}),b}function xa(t,e){var n=e.layers,r=e.viewports,i=e.x,o=e.y,a=e.width,s=e.height,u=e.mode,c=e.layerFilter,l=e.onViewportActive,h=e.pickingFBO,f=e.useDevicePixels,d=ya({useDevicePixels:f}),p=Math.round(i*d),v=Math.round(t.canvas.height-o*d),g=Math.round((i+a)*d),y=Math.round(t.canvas.height-(o+s)*d),m=function(t,e){var n=e.pickedColors,r=e.layers,i=new Map;if(n)for(var o=0;o<n.length;o+=4){var a=n[o+3]-1;if(a>=0){var s=n.slice(o,o+4),u=s.join(",");if(!i.has(u)){var c=r[a];c?i.set(u,{pickedColor:s,pickedLayer:c,pickedObjectIndex:c.decodePickingColor(s)}):Ni.a.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(i.values())}(0,{pickedColors:Ea(t,{layers:n,viewports:r,onViewportActive:l,pickingFBO:h,useDevicePixels:f,deviceRect:{x:p,y:y,width:g-p,height:v-y},layerFilter:c,redrawReason:u}),layers:n}),_=new Map;return m.forEach(function(t){var e={color:t.pickedColor,layer:null,index:t.pickedObjectIndex,picked:!0,x:i,y:o,width:a,height:s,pixelRatio:d};e=Sa({layer:t.pickedLayer,info:e,mode:u}),_.has(e.object)||_.set(e.object,e)}),Array.from(_.values())}function Ea(t,e){var n=e.layers,r=e.viewports,i=e.onViewportActive,o=e.useDevicePixels,a=e.pickingFBO,s=e.deviceRect,u=e.layerFilter,c=e.redrawReason;if(Object(zi.a)(s),Object(zi.a)(Number.isFinite(s.width)&&s.width>0,"`width` must be > 0"),Object(zi.a)(Number.isFinite(s.height)&&s.height>0,"`height` must be > 0"),n.filter(function(t){return t.isPickable()}).length<1)return null;!function(t,e){var n=e.layers,r=e.viewports,i=e.onViewportActive,o=e.useDevicePixels,a=e.pickingFBO,s=e.deviceRect,u=s.x,c=s.y,l=s.width,h=s.height,f=e.layerFilter,d=void 0===f?null:f,p=e.redrawReason,v=void 0===p?"":p;Object(Gi.B)(t,{framebuffer:a,scissorTest:!0,scissor:[u,c,l,h],clearColor:[0,0,0,0]},function(){_a(t,{layers:n,viewports:r,onViewportActive:i,useDevicePixels:o,drawPickingColors:!0,layerFilter:d,pass:"picking",redrawReason:v,parameters:{blend:!0,blendFunc:[t.ONE,t.ZERO,t.CONSTANT_ALPHA,t.ZERO],blendEquation:t.FUNC_ADD,blendColor:[0,0,0,0]}})})}(t,{layers:n,viewports:r,onViewportActive:i,useDevicePixels:o,pickingFBO:a,deviceRect:s,layerFilter:u,redrawReason:c});var l=s.x,h=s.y,f=s.width,d=s.height,p=new Uint8Array(f*d*4);return a.readPixels({x:l,y:h,width:f,height:d,pixelArray:p}),p}function Oa(t){var e=t.pickInfo,n=t.lastPickedInfo,r=t.mode,i=t.layers,o=t.viewports,a=t.x,s=t.y,u=t.deviceX,c=t.deviceY,l=t.pixelRatio,h=e.pickedColor,f=e.pickedLayer,d=e.pickedObjectIndex,p=f?[f]:[];if("hover"===r){var v=n.index,g=n.layerId,y=f&&f.props.id;if(y!==g||d!==v){if(y!==g){var m=i.find(function(t){return t.props.id===g});m&&p.unshift(m)}n.layerId=y,n.index=d,n.info=null}}var _={viewports:o}.viewports[0],b=_&&_.unproject([a,s]),w={color:null,layer:null,index:-1,picked:!1,x:a,y:s,pixel:[a,s],coordinate:b,lngLat:b,devicePixel:[u,c],pixelRatio:l},x=new Map;return p.forEach(function(t){var e=Object.assign({},w);t===f&&(e.color=h,e.index=d,e.picked=!0),e=Sa({layer:t,info:e,mode:r}),t===f&&"hover"===r&&(n.info=e),e&&x.set(e.layer.id,e);var i=t.props.autoHighlight&&f===t?h:null;t.setModuleParameters({pickingSelectedColor:i})}),function(t,e){var n=[];return t.forEach(function(t){var r=!1;switch(e){case"click":r=t.layer.onClick(t);break;case"hover":r=t.layer.onHover(t);break;case"query":break;default:throw new Error("unknown pick type")}r||n.push(t)}),n}(x,r)}function Pa(t,e){var n=e.pickedColors,r=e.layers,i=e.deviceX,o=e.deviceY,a=e.deviceRadius,s=e.deviceRect;Object(zi.a)(n);for(var u=s.x,c=s.y,l=s.width,h=s.height,f=a*a,d=-1,p=0,v=0;v<h;v++){var g=v+c-o,y=g*g;if(y>f)p+=4*l;else for(var m=0;m<l;m++){if(n[p+3]-1>=0){var _=m+u-i,b=_*_+y;b<=f&&(f=b,d=p)}p+=4}}if(d>=0){var w=n[d+3]-1,x=n.slice(d,d+4),E=r[w];if(E){var O=E.decodePickingColor(x);return{pickedColor:x,pickedLayer:E,pickedObjectIndex:O}}Ni.a.error("Picked non-existent layer. Is picking buffer corrupt?")()}return ba}function Sa(t){for(var e=t.layer,n=t.info,r=t.mode;e&&n;){var i=n.layer||e;n.layer=e,n=e.pickLayer({info:n,mode:r,sourceLayer:i}),e=e.parent}return n}function Ta(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.filter,r=void 0===n?function(){return!0}:n,i=e.map,o=void 0===i?function(t){return t}:i,a=e.result,s=void 0===a?[]:a;return Array.isArray(t)?function t(e,n,r,i){var o=-1;for(;++o<e.length;){var a=e[o];Array.isArray(a)?t(a,n,r,i):n(a)&&i.push(r(a))}return i}(t,r,o,s):r(t)?[o(t)]:[]}function Ca(t){for(var e=t.target,n=t.source,r=t.start,i=void 0===r?0:r,o=t.count,a=void 0===o?1:o,s=n.length,u=a*s,c=0,l=i;c<s;c++)e[l++]=n[c];for(;c<u;)c<u-c?(e.copyWithin(i+c,i,i+c),c*=2):(e.copyWithin(i+c,i,i+u-c),c=u);return e}var Aa=n("1OyB"),Ma=n("vuIU"),ka=n("LtGd"),ja=n("wh/4"),Ra=function(){function t(e){var n=e.id;Object(Aa.a)(this,t),this.id=n,this.time=Object(ka.a)(),this.counters={},Object.seal(this)}return Object(Ma.a)(t,[{key:"addCounter",value:function(t){return this._getCounter(t),this}},{key:"bump",value:function(t){var e=this._getCounter(t);return e.call++,e.count++,this}},{key:"increment",value:function(t,e){var n=this._getCounter(t);return n.call++,n.count+=e,this}},{key:"addTimer",value:function(t){return this._getCounter(t).time=0,this}},{key:"addTime",value:function(t,e){var n=this._getCounter(t);return n.time+=e,n.count++,this}},{key:"timeStart",value:function(t,e){this._getCounter(t)._startTime=Object(ka.a)()}},{key:"timeEnd",value:function(t,e){var n=this._getCounter(t);this.addTime(t,Object(ka.a)()-n._startTime)}},{key:"reset",value:function(){for(var t in this.time=Object(ka.a)(),this.counters){var e=this.counters[t];e.count=0,e.time=0}return this}},{key:"hasTimeElapsed",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(ka.a)()-this.time>1e3}},{key:"getStats",value:function(){var t=(Object(ka.a)()-this.time)/1e3,e={};for(var n in this.counters){var r=this.counters[n];e[r.title]={total:r.count,fps:Math.round(r.count/t)},r.time&&(e[r.title].totalTime=Object(ja.b)(r.time),e[r.title].avgTime=Object(ja.b)(r.time/r.count))}return e}},{key:"getStatsTable",value:function(){var t=this.getStats();for(var e in t)0===t[e].total&&delete t[e];return t}},{key:"getStatNames",value:function(){return Object.keys(this.counters)}},{key:"get",value:function(t){return this._getCounter(t).count}},{key:"getCount",value:function(t){return this._getCounter(t).count}},{key:"getFPS",value:function(t){var e=this._getCounter(t),n=(Object(ka.a)()-this.time)/1e3;return Math.round(e.count/n)}},{key:"getTimeString",value:function(){return"".concat(this.id,":").concat(Object(ja.b)(this.time),"(").concat(this.count,")")}},{key:"oneSecondPassed",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return this.hasTimeElapsed(t)}},{key:"_getCounter",value:function(t){var e=this.counters[t];return e||(e={title:t,unit:"",timer:!1,count:0,time:0,totalTime:0,averageTime:0},this.counters[t]=e),e}},{key:"_incrementTimer",value:function(t,e,n){t.count+=n,t.totalTime+=e,t.averageTime=t.totalTime/n}}]),t}(),La=n("bl9R");function Ia(t,e){if(!t)return null;var n=La.b([0,0,0,0],e,t),r=1/n[3];return La.a(n,n,[r,r,r,r]),n}var Da=n("qjXE"),Fa=n("zGma"),Na=n("dByZ"),Ba=n("ZaHm");function Ua(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function za(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ga=Math.PI/180,Va=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Wa=[0,0,0],Za={pixelsPerMeter:[1,1,1],metersPerPixel:[1,1,1],pixelsPerDegree:[1,1,1],degreesPerPixel:[1,1,1]},Ha=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=e.id,r=void 0===n?null:n,i=e.x,o=void 0===i?0:i,a=e.y,s=void 0===a?0:a,u=e.width,c=void 0===u?1:u,l=e.height,h=void 0===l?1:l;this.id=r||this.constructor.displayName||"viewport",this.x=o,this.y=s,this.width=c||1,this.height=h||1,this._initViewMatrix(e),this._initProjectionMatrix(e),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this),this.getMatrices=this.getMatrices.bind(this)}var e,n,r;return e=t,(n=[{key:"equals",value:function(e){return e instanceof t&&(e.width===this.width&&e.height===this.height&&Object(Da.e)(e.projectionMatrix,this.projectionMatrix)&&Object(Da.e)(e.viewMatrix,this.viewMatrix))}},{key:"project",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).topLeft,n=void 0===e||e,r=this.projectPosition(t),i=Object(aa.k)(r,this.pixelProjectionMatrix),o=Ua(i,2),a=o[0],s=o[1],u=n?s:this.height-s;return 2===t.length?[a,u]:[a,u,i[2]]}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=e.targetZ,o=Ua(t,3),a=o[0],s=o[1],u=o[2],c=r?s:this.height-s,l=i&&i*this.distanceScales.pixelsPerMeter[2],h=Object(aa.h)([a,c,u],this.pixelUnprojectionMatrix,l),f=Ua(this.unprojectPosition(h),3),d=f[0],p=f[1],v=f[2];return Number.isFinite(u)?[d,p,v]:Number.isFinite(i)?[d,p,i]:[d,p]}},{key:"projectPosition",value:function(t){var e=Ua(this.projectFlat(t),2);return[e[0],e[1],(t[2]||0)*this.distanceScales.pixelsPerMeter[2]]}},{key:"unprojectPosition",value:function(t){var e=Ua(this.unprojectFlat(t),2);return[e[0],e[1],(t[2]||0)*this.distanceScales.metersPerPixel[2]]}},{key:"projectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return this.isGeospatial?Object(aa.g)(t,e):t}},{key:"unprojectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return this.isGeospatial?Object(aa.j)(t,e):t}},{key:"getDistanceScales",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?Object(aa.b)({longitude:t[0],latitude:t[1],scale:this.scale,highPrecision:!0}):this.distanceScales}},{key:"getMatrices",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).modelMatrix,e=void 0===t?null:t,n=this.viewProjectionMatrix,r=this.pixelProjectionMatrix,i=this.pixelUnprojectionMatrix;return e&&(n=Ba.c([],this.viewProjectionMatrix,e),r=Ba.c([],this.pixelProjectionMatrix,e),i=Ba.a([],r)),Object.assign({modelViewProjectionMatrix:n,viewProjectionMatrix:this.viewProjectionMatrix,viewMatrix:this.viewMatrix,projectionMatrix:this.projectionMatrix,pixelProjectionMatrix:r,pixelUnprojectionMatrix:i,width:this.width,height:this.height,scale:this.scale})}},{key:"containsPixel",value:function(t){var e=t.x,n=t.y,r=t.width,i=void 0===r?1:r,o=t.height,a=void 0===o?1:o;return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+a}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"getCameraDirection",value:function(){return this.cameraDirection}},{key:"getCameraUp",value:function(){return this.cameraUp}},{key:"_addMetersToLngLat",value:function(t,e){var n=Ua(t,3),r=n[0],i=n[1],o=n[2],a=void 0===o?0:o,s=Ua(this._metersToLngLatDelta(e),3),u=s[0],c=s[1],l=s[2],h=void 0===l?0:l;return 2===t.length?[r+u,i+c]:[r+u,i+c,a+h]}},{key:"_metersToLngLatDelta",value:function(t){var e=Ua(t,3),n=e[0],r=e[1],i=e[2],o=void 0===i?0:i;Object(zi.a)(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(o),"Illegal argument to Viewport");var a=this.distanceScales,s=a.pixelsPerMeter,u=a.degreesPerPixel,c=n*s[0]*u[0],l=r*s[1]*u[1];return 2===t.length?[c,l]:[c,l,o]}},{key:"_createProjectionMatrix",value:function(t){var e=t.orthographic,n=t.fovyRadians,r=t.aspect,i=t.focalDistance,o=t.near,a=t.far;return Object(zi.a)(Number.isFinite(n)),e?(new Fa.a).orthographic({fovy:n,aspect:r,focalDistance:i,near:o,far:a}):(new Fa.a).perspective({fovy:n,aspect:r,near:o,far:a})}},{key:"_initViewMatrix",value:function(t){var e=t.viewMatrix,n=void 0===e?Va:e,r=t.longitude,i=void 0===r?null:r,o=t.latitude,a=void 0===o?null:o,s=t.zoom,u=void 0===s?null:s,c=t.position,l=void 0===c?null:c,h=t.modelMatrix,f=void 0===h?null:h,d=t.focalDistance,p=void 0===d?1:d,v=t.distanceScales,g=void 0===v?null:v;this.isGeospatial=Number.isFinite(a)&&Number.isFinite(i),this.zoom=u,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?Object(aa.c)({latitude:a})+Math.log2(p):0),this.scale=Math.pow(2,this.zoom),this.distanceScales=this.isGeospatial?Object(aa.b)({latitude:a,longitude:i,scale:this.scale}):g||Za,this.focalDistance=p,this.distanceScales.metersPerPixel=new Na.a(this.distanceScales.metersPerPixel),this.distanceScales.pixelsPerMeter=new Na.a(this.distanceScales.pixelsPerMeter),this.position=Wa,this.meterOffset=Wa,l&&(this.position=l,this.modelMatrix=f,this.meterOffset=f?f.transformVector(l):l),this.isGeospatial?(this.longitude=i,this.latitude=a,this.center=this._getCenterInWorld({longitude:i,latitude:a}),this.viewMatrixUncentered=Ba.h([],n,[1,-1,1]),this.viewMatrix=(new Fa.a).multiplyRight(this.viewMatrixUncentered).translate(new Na.a(this.center||Wa).negate())):(this.center=l,this.viewMatrixUncentered=n,this.viewMatrix=n)}},{key:"_getCenterInWorld",value:function(t){var e=t.longitude,n=t.latitude,r=this.meterOffset,i=this.scale,o=this.distanceScales,a=this.projectFlat([e,n],i),s=new Na.a(a[0],a[1],0);if(r){var u=new Na.a(r).scale(o.pixelsPerMeter);s.add(u)}return s}},{key:"_initProjectionMatrix",value:function(t){var e=t.projectionMatrix,n=void 0===e?null:e,r=t.orthographic,i=void 0!==r&&r,o=t.fovyRadians,a=t.fovyDegrees,s=t.fovy,u=t.near,c=void 0===u?.1:u,l=t.far,h=void 0===l?1e3:l,f=t.focalDistance,d=void 0===f?1:f,p=t.orthographicFocalDistance,v=o||(a||s||75)*Ga;this.projectionMatrix=n||this._createProjectionMatrix({orthographic:i,fovyRadians:v,aspect:this.width/this.height,focalDistance:p||d,near:c,far:h})}},{key:"_initPixelMatrices",value:function(){var t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Ba.c(t,t,this.projectionMatrix),Ba.c(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=Ba.a([],this.viewMatrix)||this.viewMatrix;var e,n,r,i=(e={viewMatrix:this.viewMatrix,viewMatrixInverse:this.viewMatrixInverse},n=e.viewMatrix,{eye:[(r=e.viewMatrixInverse)[12],r[13],r[14]],direction:[n[2],n[6],n[10]],up:[n[1],n[5],n[9]]}),o=i.eye,a=i.direction,s=i.up;this.cameraPosition=o,this.cameraDirection=a,this.cameraUp=s;var u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Ba.h(u,u,[this.width/2,-this.height/2,1]),Ba.i(u,u,[1,-1,0]),Ba.c(c,u,this.viewProjectionMatrix),this.pixelProjectionMatrix=c,this.viewportMatrix=u,this.pixelUnprojectionMatrix=Ba.a([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Ni.a.warn("Pixel project matrix not invertible")()}}])&&za(e.prototype,n),r&&za(e,r),t}();function Xa(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ya(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Ha.displayName="Viewport";var Ja=Object.seal({layerManager:null,gl:null,useDevicePixels:!0,stats:null,shaderCache:null,pickingFBO:null,pickingEvent:null,lastPickedInfo:null,animationProps:null,userData:{}}),qa=function(t){return t instanceof pa?"".concat(t):t?"invalid":"null"},Qa=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.stats,i=n.viewport,o=void 0===i?null:i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.lastRenderedLayers=[],this.layers=[],this.context=Object.assign({},Ja,{layerManager:this,gl:e,shaderCache:new Gi.n({gl:e,_cachePrograms:!0}),stats:r||new Ra({id:"deck.gl"}),lastPickedInfo:{index:-1,layerId:null,info:null},viewport:o||new Ha({id:"DEFAULT-INITIAL-VIEWPORT"})}),this.layerFilter=null,this.drawPickingColors=!1,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this._activateViewport=this._activateViewport.bind(this),this._initSeer=this._initSeer.bind(this),this._editSeer=this._editSeer.bind(this),Object.seal(this),Eo(this._initSeer),xo(this._editSeer)}var e,n,r;return e=t,(n=[{key:"finalize",value:function(){Wi.a.removeListener(this._initSeer),Wi.a.removeListener(this._editSeer)}},{key:"needsRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).clearRedrawFlags,e=void 0===t||t;return this._checkIfNeedsRedraw(e)}},{key:"needsUpdate",value:function(){return this._needsUpdate}},{key:"setNeedsRedraw",value:function(t){this._needsRedraw=this._needsRedraw||t}},{key:"setNeedsUpdate",value:function(t){this._needsUpdate=this._needsUpdate||t}},{key:"getLayers",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).layerIds,e=void 0===t?null:t;return e?this.layers.filter(function(t){return e.find(function(e){return 0===t.id.indexOf(e)})}):this.layers}},{key:"setProps",value:function(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"useDevicePixels"in t&&(this.context.useDevicePixels=t.useDevicePixels),"layers"in t&&this.setLayers(t.layers),"layerFilter"in t&&this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this.setNeedsRedraw("layerFilter changed")),"drawPickingColors"in t&&t.drawPickingColors!==this.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this.setNeedsRedraw("drawPickingColors changed"))}},{key:"setLayers",value:function(t){if(t===this.lastRenderedLayers)return Ni.a.log(3,"Ignoring layer update due to layer array not changed")(),this;this.lastRenderedLayers=t,t=Ta(t,{filter:Boolean});var e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){i.value.context=this.context}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}var a=this._updateLayers({oldLayers:this.layers,newLayers:t}),s=a.error,u=a.generatedLayers;if(this.layers=u,s)throw s;return this}},{key:"updateLayers",value:function(){var t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(Xa(this.lastRenderedLayers)))}},{key:"drawLayers",value:function(t){var e=t.pass,n=void 0===e?"render to screen":e,r=t.viewports,i=t.views,o=t.redrawReason,a=void 0===o?"unknown reason":o,s=t.customRender,u=void 0!==s&&s,c=this.drawPickingColors,l=this.context,h=l.gl,f=l.useDevicePixels;_a(h,{layers:this.layers,viewports:r,views:i,onViewportActive:this._activateViewport,useDevicePixels:f,drawPickingColors:c,pass:n,layerFilter:this.layerFilter,redrawReason:a,customRender:u})}},{key:"getLastPickedObject",value:function(t){var e=t.x,n=t.y,r=t.viewports,i=this.context.lastPickedInfo.info,o=i&&i.layer&&i.layer.id,a=o?this.layers.find(function(t){return t.id===o}):null,s=r[0]&&r[0].unproject([e,n]),u={x:e,y:n,coordinate:s,lngLat:s,layer:a};return a?Object.assign({},i,u):Object.assign(u,{color:null,object:null,index:-1})}},{key:"pickObject",value:function(t){var e=t.x,n=t.y,r=t.mode,i=t.radius,o=void 0===i?0:i,a=t.layerIds,s=t.viewports,u=t.depth,c=void 0===u?1:u,l=t.event,h=void 0===l?null:l,f=this.context,d=f.gl,p=f.useDevicePixels;this.context.pickingEvent=h;var v=wa(d,{x:e,y:n,radius:o,layers:this.getLayers({layerIds:a}),mode:r,layerFilter:this.layerFilter,depth:c,viewports:s,onViewportActive:this._activateViewport,pickingFBO:this._getPickingBuffer(),lastPickedInfo:this.context.lastPickedInfo,useDevicePixels:p});return this.context.pickingEvent=null,v}},{key:"pickObjects",value:function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=t.layerIds,a=t.viewports,s=this.context,u=s.gl,c=s.useDevicePixels;return xa(u,{x:e,y:n,width:r,height:i,layers:this.getLayers({layerIds:o}),layerFilter:this.layerFilter,mode:"pickObjects",viewports:a,onViewportActive:this._activateViewport,pickingFBO:this._getPickingBuffer(),useDevicePixels:c})}},{key:"_checkIfNeedsRedraw",value:function(t){var e=this._needsRedraw;t&&(this._needsRedraw=!1);var n=!0,r=!1,i=void 0;try{for(var o,a=this.layers[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value.getNeedsRedraw({clearRedrawFlags:t});e=e||s}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}},{key:"_activateViewport",value:function(t){var e=this.context.viewport;if(!e||!t.equals(e)){Ni.a.log(4,"Viewport changed",t)(),this.context.viewport=t;var n=!0,r=!1,i=void 0;try{for(var o,a=this.layers[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.setChangeFlags({viewportChanged:"Viewport changed"}),this._updateLayer(s)}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}return Object(zi.a)(this.context.viewport,"LayerManager: viewport not set"),this}},{key:"_getPickingBuffer",value:function(){var t=this.context.gl;return this.context.pickingFBO=this.context.pickingFBO||new Gi.e(t),this.context.pickingFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.context.pickingFBO}},{key:"_updateLayers",value:function(t){var e=t.oldLayers,n=t.newLayers,r={},i=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r[c.id]?Ni.a.warn("Multiple old layers with same id ".concat(qa(c)))():r[c.id]=c}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}var l=[],h=this._updateSublayersRecursively({newLayers:n,oldLayerMap:r,generatedLayers:l}),f=this._finalizeOldLayers(r);return this._needsUpdate=!1,{error:h||f,generatedLayers:l}}},{key:"_updateSublayersRecursively",value:function(t){var e=t.newLayers,n=t.oldLayerMap,r=t.generatedLayers,i=null,o=!0,a=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;l.context=this.context;var h=n[l.id];null===h&&Ni.a.warn("Multiple new layers with same id ".concat(qa(l)))(),n[l.id]=null;var f=null;try{this._debug&&h!==l&&l.validateProps(),h?(this._transferLayerState(h,l),this._updateLayer(l),Po(l)):(this._initializeLayer(l),Oo(l)),r.push(l),f=l.isComposite&&l.getSubLayers()}catch(t){Ni.a.warn("error during matching of ".concat(qa(l)),t)(),i=i||t}f&&this._updateSublayersRecursively({newLayers:f,oldLayerMap:n,generatedLayers:r})}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return i}},{key:"_finalizeOldLayers",value:function(t){var e=null;for(var n in t){var r=t[n];r&&(e=e||this._finalizeLayer(r))}return e}},{key:"_initializeLayer",value:function(t){Ni.a.log(2,"initializing ".concat(qa(t)))();var e=null;try{t._initialize(),t.lifecycle=Do.INITIALIZED}catch(n){Ni.a.warn("error while initializing ".concat(qa(t),"\n"),n)(),e=e||n}t.internalState.layer=t;var n=!0,r=!1,i=void 0;try{for(var o,a=t.getModels()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){o.value.userData.layer=t}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}},{key:"_transferLayerState",value:function(t,e){e._transferState(t),e.lifecycle=Do.MATCHED,e!==t?(Ni.a.log(4,"matched ".concat(qa(e)),t,"->",e)(),t.lifecycle=Do.AWAITING_GC):Ni.a.log(4,"Matching layer is unchanged ".concat(e.id))()}},{key:"_updateLayer",value:function(t){Ni.a.log(4,"updating ".concat(t," because: ").concat(t.printChangeFlags()))();var e=null;try{t._update()}catch(n){Ni.a.warn("error during update of ".concat(qa(t)),n)(),e=n}return e}},{key:"_finalizeLayer",value:function(t){Object(zi.a)(t.lifecycle!==Do.AWAITING_FINALIZATION),t.lifecycle=Do.AWAITING_FINALIZATION;var e=null;this.setNeedsRedraw("finalized ".concat(qa(t)));try{t._finalize()}catch(n){Ni.a.warn("error during finalization of ".concat(qa(t)),n)(),e=n}return t.lifecycle=Do.FINALIZED,Ni.a.log(2,"finalizing ".concat(qa(t)))(),e}},{key:"_initSeer",value:function(){this.layers.forEach(function(t){Oo(t),Po(t)})}},{key:"_editSeer",value:function(t){if("edit"===t.type&&"props"===t.valuePath[0]){var e,n,r;e=t.itemKey,n=t.valuePath.slice(1),r=t.value,Wi.a.isReady()&&(bo.has(e)||bo.set(e,new Map),bo.get(e).set(n,r));var i=this.layers.map(function(t){return new t.constructor(t.props)});this.updateLayers({newLayers:i})}}}])&&Ya(e.prototype,n),r&&Ya(e,r),t}();function Ka(t,e){return t===e||Object.keys(t).every(function(n){return Array.isArray(t[n])&&Array.isArray(e[n])?Ka(t[n],e[n]):t[n]===e[n]})}function $a(t){return($a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var ts=/([0-9]+\.?[0-9]*)(%|px)/;function es(t){switch($a(t)){case"number":return{position:t,relative:!1};case"string":var e=t.match(ts);if(e&&e.length>=3){var n="%"===e[2],r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function ns(t,e){return t.relative?Math.round(t.position*e):t.position}function rs(t){return(rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function is(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var os=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=e.id,r=void 0===n?null:n,i=e.x,o=void 0===i?0:i,a=e.y,s=void 0===a?0:a,u=e.width,c=void 0===u?"100%":u,l=e.height,h=void 0===l?"100%":l,f=e.projectionMatrix,d=void 0===f?null:f,p=e.fovy,v=void 0===p?75:p,g=e.near,y=void 0===g?.1:g,m=e.far,_=void 0===m?1e3:m,b=e.modelMatrix,w=void 0===b?null:b,x=e.viewportInstance,E=void 0===x?null:x,O=e.type,P=void 0===O?Ha:O;Object(zi.a)(!E||E instanceof Ha),this.viewportInstance=E,this.id=r||this.constructor.displayName||"view",this.type=P,this.props=Object.assign({},e,{projectionMatrix:d,fovy:v,near:y,far:_,modelMatrix:w}),this._parseDimensions({x:o,y:s,width:c,height:h}),this.equals=this.equals.bind(this),Object.seal(this)}var e,n,r;return e=t,(n=[{key:"equals",value:function(t){return this===t||(this.viewportInstance?t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance):Ka(this.props,t.props))}},{key:"makeViewport",value:function(t){var e=t.width,n=t.height,r=t.viewState;if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);var i=this.getDimensions({width:e,height:n}),o=Object.assign({viewState:r},r,this.props,i);return this._getViewport(o)}},{key:"getViewStateId",value:function(){switch(rs(this.props.viewState)){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}},{key:"filterViewState",value:function(t){if(this.props.viewState&&"object"===rs(this.props.viewState)){if(!this.props.viewState.id)return this.props.viewState;var e=Object.assign({},t);for(var n in this.props.viewState)"id"!==n&&(e[n]=this.props.viewState[n]);return e}return t}},{key:"getDimensions",value:function(t){var e=t.width,n=t.height;return{x:ns(this._x,e),y:ns(this._y,n),width:ns(this._width,e),height:ns(this._height,n)}}},{key:"_getControllerProps",value:function(t){var e=this.props.controller;return e?!0===e?t:("function"==typeof e&&(e={type:e}),Object.assign({},t,e)):null}},{key:"_getViewport",value:function(t){return new(0,this.type)(t)}},{key:"_parseDimensions",value:function(t){var e=t.x,n=t.y,r=t.width,i=t.height;this._x=es(e),this._y=es(n),this._width=es(r),this._height=es(i)}}])&&is(e.prototype,n),r&&is(e,r),t}();function as(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ss=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractiveStateChange:e.onInteractiveStateChange},Object.seal(this),this.setProps(e)}var e,n,r;return e=t,(n=[{key:"finalize",value:function(){for(var t in this.controllers)this.controllers[t]&&this.controllers[t].finalize();this.controllers={}}},{key:"needsRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).clearRedrawFlags,e=void 0===t||t,n=this._needsRedraw;return e&&(this._needsRedraw=!1),n}},{key:"setNeedsRedraw",value:function(t){this._needsRedraw=this._needsRedraw||t}},{key:"setNeedsUpdate",value:function(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}},{key:"getViewports",value:function(t){return t?this._viewports.filter(function(e){return e.containsPixel(t)}):this._viewports}},{key:"getViews",value:function(){var t={};return this.views.forEach(function(e){t[e.id]=e}),t}},{key:"getView",value:function(t){return"string"==typeof t?this.views.find(function(e){return e.id===t}):t}},{key:"getViewState",value:function(t){var e=this.getView(t),n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}},{key:"getViewport",value:function(t){return this._viewportMap[t]}},{key:"project",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{topLeft:!0},n=this.getViewports(),r=n.length-1;r>=0;--r){var i=n[r];if(i.contains(t,e))return i.project(t,e)}return null}},{key:"unproject",value:function(t,e){for(var n=this.getViewports(),r=n.length-1;r>=0;--r){var i=n[r];if(i.containsPixel(t,e))return i.unproject(t)}return null}},{key:"setProps",value:function(t){"views"in t&&this._setViews(t.views),"viewState"in t&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}},{key:"_update",value:function(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}},{key:"_setSize",value:function(t,e){Object(zi.a)(Number.isFinite(t)&&Number.isFinite(e)),t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}},{key:"_setViews",value:function(t){t=Ta(t,{filter:Boolean}).map(function(t){return t instanceof Ha?new os({viewportInstance:t}):t}),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}},{key:"_setViewState",value:function(t){t?(!Ka(t,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):Ni.a.warn("setting null viewState")()}},{key:"_onViewStateChange",value:function(t,e){e.viewId=t,this._eventCallbacks.onViewStateChange(e)}},{key:"_createController",value:function(t){return new(0,t.type)(Object.assign({eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractiveStateChange},t))}},{key:"_updateController",value:function(t,e,n,r){if(t.controller){var i=Object.assign({},t.controller,t.defaultState,e,{id:t.id,x:n.x,y:n.y,width:n.width,height:n.height});return r?r.setProps(i):r=this._createController(i),r}return null}},{key:"_rebuildViewports",value:function(){var t=this,e=this.width,n=this.height,r=this.views,i=this.controllers;for(var o in this.controllers={},this._viewports=r.map(function(r){var o=t.getViewState(r),a=r.makeViewport({width:e,height:n,viewState:o});return t.controllers[r.id]=t._updateController(r,o,a,i[r.id]),a}),i)i[o]&&!this.controllers[o]&&i[o].finalize();this._buildViewportMap()}},{key:"_buildViewportMap",value:function(){var t=this;this._viewportMap={},this._viewports.forEach(function(e){e.id&&(t._viewportMap[e.id]=t._viewportMap[e.id]||e)})}},{key:"_diffViews",value:function(t,e){return t.length!==e.length||t.some(function(n,r){return!t[r].equals(e[r])})}}])&&as(e.prototype,n),r&&as(e,r),t}(),us=n("ODXe"),cs=n("md7G"),ls=n("foSv"),hs=n("Ji7U"),fs=n("JX7q"),ds=n("ahXh"),ps=n("VKpO"),vs=n("nKJB"),gs=n.n(vs),ys=n("b1F2"),ms=n.n(ys),_s=n("FBcx"),bs=n.n(_s),ws=n("k0P+"),xs=n.n(ws),Es=Object(ps.a)(),Os=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.width,r=e.height,i=e.viewMatrix,o=void 0===i?Es:i,a=e.projectionMatrix,s=void 0===a?Es:a;Object(Aa.a)(this,t),this.width=n||1,this.height=r||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=o,this.projectionMatrix=s;var u=Object(ps.a)();bs()(u,u,this.projectionMatrix),bs()(u,u,this.viewMatrix),this.viewProjectionMatrix=u;var c=Object(ps.a)();gs()(c,c,[this.width/2,-this.height/2,1]),ms()(c,c,[1,-1,0]),bs()(c,c,this.viewProjectionMatrix);var l=xs()(Object(ps.a)(),c);if(!l)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=c,this.pixelUnprojectionMatrix=l,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(Ma.a)(t,[{key:"equals",value:function(e){return e instanceof t&&(e.width===this.width&&e.height===this.height&&Object(ds.c)(e.projectionMatrix,this.projectionMatrix)&&Object(ds.c)(e.viewMatrix,this.viewMatrix))}},{key:"project",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).topLeft,n=void 0===e||e,r=this.projectPosition(t),i=Object(aa.k)(r,this.pixelProjectionMatrix),o=Object(us.a)(i,2),a=o[0],s=o[1],u=n?s:this.height-s;return 2===t.length?[a,u]:[a,u,i[2]]}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=e.targetZ,o=Object(us.a)(t,3),a=o[0],s=o[1],u=o[2],c=r?s:this.height-s,l=i&&i*this.pixelsPerMeter,h=Object(aa.h)([a,c,u],this.pixelUnprojectionMatrix,l),f=this.unprojectPosition(h),d=Object(us.a)(f,3),p=d[0],v=d[1],g=d[2];return Number.isFinite(u)?[p,v,g]:Number.isFinite(i)?[p,v,i]:[p,v]}},{key:"projectPosition",value:function(t){var e=this.projectFlat(t),n=Object(us.a)(e,2);return[n[0],n[1],(t[2]||0)*this.pixelsPerMeter]}},{key:"unprojectPosition",value:function(t){var e=this.unprojectFlat(t),n=Object(us.a)(e,2);return[n[0],n[1],(t[2]||0)/this.pixelsPerMeter]}},{key:"projectFlat",value:function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return t}},{key:"unprojectFlat",value:function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return t}}]),t}(),Ps=n("+sJh"),Ss=n.n(Ps),Ts=n("AzzA"),Cs=n.n(Ts),As=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.width,i=n.height,o=n.latitude,a=void 0===o?0:o,s=n.longitude,u=void 0===s?0:s,c=n.zoom,l=void 0===c?0:c,h=n.pitch,f=void 0===h?0:h,d=n.bearing,p=void 0===d?0:d,v=n.altitude,g=void 0===v?1.5:v,y=n.nearZMultiplier,m=n.farZMultiplier;Object(Aa.a)(this,e),r=r||1,i=i||1;var _=Object(aa.l)(l);g=Math.max(.75,g);var b=Object(aa.g)([u,a],_);b[2]=0;var w=Object(aa.d)({width:r,height:i,pitch:f,bearing:p,altitude:g,nearZMultiplier:y||1/i,farZMultiplier:m||1.01}),x=Object(aa.f)({height:i,center:b,pitch:f,bearing:p,altitude:g,flipY:!0});return(t=Object(cs.a)(this,Object(ls.a)(e).call(this,{width:r,height:i,viewMatrix:x,projectionMatrix:w}))).latitude=a,t.longitude=u,t.zoom=l,t.pitch=f,t.bearing=p,t.altitude=g,t.scale=_,t.center=b,t.pixelsPerMeter=Object(aa.b)(Object(fs.a)(Object(fs.a)(t))).pixelsPerMeter[2],Object.freeze(Object(fs.a)(Object(fs.a)(t))),t}return Object(hs.a)(e,t),Object(Ma.a)(e,[{key:"projectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return Object(aa.g)(t,e)}},{key:"unprojectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return Object(aa.j)(t,e)}},{key:"getMapCenterByLngLatPosition",value:function(t){var e=t.lngLat,n=t.pos,r=Object(aa.h)(n,this.pixelUnprojectionMatrix),i=Object(aa.g)(e,this.scale),o=Ss()([],i,Cs()([],r)),a=Ss()([],this.center,o);return Object(aa.j)(a,this.scale)}},{key:"getLocationAtPoint",value:function(t){var e=t.lngLat,n=t.pos;return this.getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"fitBounds",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.width,i=this.height,o=ks(Object.assign({width:r,height:i,bounds:t},n));return new e({width:r,height:i,longitude:o.longitude,latitude:o.latitude,zoom:o.zoom})}}]),e}(Os),Ms=n("54ZI");function ks(t){var e=t.width,n=t.height,r=t.bounds,i=t.padding,o=void 0===i?0:i,a=t.offset,s=void 0===a?[0,0]:a,u=Object(us.a)(r,2),c=Object(us.a)(u[0],2),l=c[0],h=c[1],f=Object(us.a)(u[1],2),d=f[0],p=f[1];if(Number.isFinite(o)){o={top:o,bottom:o,left:o,right:o}}else Object(Ms.a)(Number.isFinite(o.top)&&Number.isFinite(o.bottom)&&Number.isFinite(o.left)&&Number.isFinite(o.right));var v=new As({width:e,height:n,longitude:0,latitude:0,zoom:0}),g=v.project([l,p]),y=v.project([d,h]),m=[Math.abs(y[0]-g[0]),Math.abs(y[1]-g[1])],_=[e-o.left-o.right-2*Math.abs(s[0]),n-o.top-o.bottom-2*Math.abs(s[1])];Object(Ms.a)(_[0]>0&&_[1]>0);var b=_[0]/m[0],w=_[1]/m[1],x=(o.right-o.left)/2/b,E=(o.bottom-o.top)/2/w,O=[(y[0]+g[0])/2+x,(y[1]+g[1])/2+E],P=v.unproject(O),S=v.zoom+Math.log2(Math.abs(Math.min(b,w)));return{longitude:P[0],latitude:P[1],zoom:S}}var js=n("yU0y");function Rs(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}var Ls,Is;Ls=new js.a(2),js.a!=Float32Array&&(Ls[0]=0,Ls[1]=0),Is=Ls;function Ds(t){return(Ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fs(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ns(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Bs(t){return(Bs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Us(t,e){return(Us=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function zs(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Gs=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=n.latitude,i=void 0===r?0:r,o=n.longitude,a=void 0===o?0:o,s=n.zoom,u=void 0===s?11:s,c=n.pitch,l=void 0===c?0:c,h=n.bearing,f=void 0===h?0:h,d=n.nearZMultiplier,p=void 0===d?.1:d,v=n.farZMultiplier,g=void 0===v?10:v,y=n.orthographic,m=void 0!==y&&y,_=n.width,b=n.height,w=n.altitude,x=void 0===w?1.5:w;_=_||1,b=b||1,x=Math.max(.75,x);var E,O,P=Object(aa.e)({width:_,height:b,pitch:l,altitude:x,nearZMultiplier:p,farZMultiplier:g}),S=P.fov,T=P.aspect,C=P.focalDistance,A=P.near,M=P.far,k=Object(aa.f)({height:b,pitch:l,bearing:f,altitude:x}),j=n.position&&[n.position[0],n.position[1],0],R=Object.assign({},n,{width:_,height:b,viewMatrix:k,longitude:a,latitude:i,zoom:u,position:j,orthographic:m,fovyRadians:S,aspect:T,orthographicFocalDistance:C,near:A,far:M});return E=this,(t=!(O=Bs(e).call(this,R))||"object"!==Ds(O)&&"function"!=typeof O?zs(E):O).latitude=i,t.longitude=a,t.zoom=u,t.pitch=l,t.bearing=f,t.altitude=x,t.orthographic=m,t.metersToLngLatDelta=t.metersToLngLatDelta.bind(zs(zs(t))),t.lngLatDeltaToMeters=t.lngLatDeltaToMeters.bind(zs(zs(t))),t.addMetersToLngLat=t.addMetersToLngLat.bind(zs(zs(t))),Object.freeze(zs(zs(t))),t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Us(t,e)}(e,Ha),n=e,(r=[{key:"metersToLngLatDelta",value:function(t){var e=Fs(t,3),n=e[0],r=e[1],i=e[2],o=void 0===i?0:i;Object(zi.a)(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(o),"Illegal argument to WebMercatorViewport");var a=this.distanceScales,s=a.pixelsPerMeter,u=a.degreesPerPixel,c=n*s[0]*u[0],l=r*s[1]*u[1];return 2===t.length?[c,l]:[c,l,o]}},{key:"lngLatDeltaToMeters",value:function(t){var e=Fs(t,3),n=e[0],r=e[1],i=e[2],o=void 0===i?0:i;Object(zi.a)(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(o),"Illegal argument to WebMercatorViewport");var a=this.distanceScales,s=a.pixelsPerDegree,u=a.metersPerPixel,c=n*s[0]*u[0],l=r*s[1]*u[1];return 2===t.length?[c,l]:[c,l,o]}},{key:"addMetersToLngLat",value:function(t,e){return Object(aa.a)(t,e)}},{key:"getMapCenterByLngLatPosition",value:function(t){var e,n,r=t.lngLat,i=t.pos,o=Object(aa.h)(i,this.pixelUnprojectionMatrix),a=Rs([],this.projectFlat(r),((e=[])[0]=-(n=o)[0],e[1]=-n[1],e)),s=Rs([],this.center,a);return this.unprojectFlat(s)}},{key:"getLocationAtPoint",value:function(t){var e=t.lngLat,n=t.pos;return this.getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"fitBounds",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.width,i=this.height,o=ks(Object.assign({width:r,height:i,bounds:t},n));return new e({width:r,height:i,longitude:o.longitude,latitude:o.latitude,zoom:o.zoom})}}])&&Ns(n.prototype,r),i&&Ns(n,i),e}();function Vs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Gs.displayName="WebMercatorViewport";var Ws=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Array.isArray(e)&&(e={compare:e,extract:e,required:e});var n=e,r=n.compare,i=n.extract,o=n.required;this._propsToCompare=r,this._propsToExtract=i,this._requiredProps=o}var e,n,r;return e=t,(n=[{key:"arePropsEqual",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=(this._propsToCompare||Object.keys(e))[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(!Object(Da.e)(t[s],e[s]))return!1}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return!0}},{key:"initializeProps",value:function(t,e){var n;if(this._propsToExtract){var r={},i={},o=!0,a=!1,s=void 0;try{for(var u,c=this._propsToExtract[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;r[l]=t[l],i[l]=e[l]}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}n={start:r,end:i}}else n={start:t,end:e};return this._checkRequiredProps(n.start),this._checkRequiredProps(n.end),n}},{key:"interpolateProps",value:function(t,e,n){Object(zi.a)(!1,"interpolateProps is not implemented")}},{key:"_checkRequiredProps",value:function(t){this._requiredProps&&this._requiredProps.forEach(function(e){var n=t[e];Object(zi.a)(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))})}}])&&Vs(e.prototype,n),r&&Vs(e,r),t}();function Zs(t){return(Zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xs(t,e){return!e||"object"!==Zs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ys(t){return(Ys=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Js(t,e){return(Js=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qs=["longitude","latitude","zoom","bearing","pitch"],Qs=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qs;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Xs(this,Ys(e).call(this,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Js(t,e)}(e,Ws),n=e,(r=[{key:"interpolateProps",value:function(t,e,n){var r={};for(var i in e)r[i]=Object(Da.g)(t[i],e[i],n);return r}}])&&Hs(n.prototype,r),i&&Hs(n,i),e}();function Ks(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $s=function(){},tu=1,eu=2,nu=3,ru={transitionDuration:0,transitionEasing:function(t){return t},transitionInterpolator:new Qs,transitionInterruption:tu,onTransitionStart:$s,onTransitionInterrupt:$s,onTransitionEnd:$s},iu=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object(zi.a)(e),this.ControllerState=e,this.props=Object.assign({},ru,n),this.animation=null,this.propsInTransition=null,this.transition=new uo,this.onViewStateChange=n.onViewStateChange,this._onTransitionFrame=this._onTransitionFrame.bind(this),this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}var e,n,r;return e=t,(n=[{key:"finalize",value:function(){cancelAnimationFrame(this.animation)}},{key:"getViewportInTransition",value:function(){return this.propsInTransition}},{key:"processViewStateChange",value:function(t){var e=!1,n=this.props;if(t=Object.assign({},ru,t),this.props=t,this._shouldIgnoreViewportChange(n,t))return e;if(this._isTransitionEnabled(t)){var r=Object.assign({},n,this.transition.interruption===eu?this.transition.endProps:this.propsInTransition||n);this._triggerTransition(r,t),e=!0}else this.transition.cancel();return e}},{key:"_isTransitionEnabled",value:function(t){return t.transitionDuration>0&&t.transitionInterpolator}},{key:"_isUpdateDueToCurrentTransition",value:function(t){return!!this.transition.inProgress&&this.transition.interpolator.arePropsEqual(t,this.propsInTransition)}},{key:"_shouldIgnoreViewportChange",value:function(t,e){return this.transition.inProgress?this.transition.interruption===nu||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}},{key:"_triggerTransition",value:function(t,e){Object(zi.a)(this._isTransitionEnabled(e),"Transition is not enabled"),cancelAnimationFrame(this.animation);var n=new this.ControllerState(t),r=new this.ControllerState(e).shortestPathFrom(n),i=e.transitionInterpolator.initializeProps(t,r);this.propsInTransition={},this.transition.start({duration:e.transitionDuration,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startProps:i.start,endProps:i.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)}),this._onTransitionFrame()}},{key:"_onTransitionFrame",value:function(){this.animation=requestAnimationFrame(this._onTransitionFrame),this.transition.update(Date.now())}},{key:"_onTransitionEnd",value:function(t){var e=this;return function(n){cancelAnimationFrame(e.animation),e.propsInTransition=null,t(n)}}},{key:"_onTransitionUpdate",value:function(t){var e=t.interpolator,n=t.startProps,r=t.endProps,i=t.time,o=e.interpolateProps(n,r,i);this.propsInTransition=new this.ControllerState(Object.assign({},this.props,o)).getViewportProps(),this.onViewStateChange&&this.onViewStateChange({viewState:this.propsInTransition,interactionState:{inTransition:!0}})}}])&&Ks(e.prototype,n),r&&Ks(e,r),t}();function ou(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function au(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}iu.defaultProps=ru;var su={transitionDuration:0},uu=["wheel"],cu=["panstart","panmove","panend"],lu=["pinchstart","pinchmove","pinchend"],hu=["doubletap"],fu=["keydown"],du=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object(zi.a)(e),this.ControllerState=e,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new iu(e,n),this._events=null,this._state={isDragging:!1},this.events=[],this.onViewStateChange=null,this.onStateChange=null,this.invertPan=!1,this.handleEvent=this.handleEvent.bind(this),this.setProps(n)}var e,n,r;return e=t,(n=[{key:"finalize",value:function(){for(var t in this._events)this._events[t]&&this.eventManager.off(t,this.handleEvent);this.transitionManager.finalize()}},{key:"handleEvent",value:function(t){var e=this.ControllerState;switch(this.controllerState=new e(Object.assign({},this.controllerStateProps,this._state)),t.type){case"panstart":return this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}},{key:"getCenter",value:function(t){var e=this.controllerStateProps,n=e.x,r=e.y,i=t.offsetCenter;return[i.x-n,i.y-r]}},{key:"isPointInBounds",value:function(t){var e=this.controllerStateProps,n=e.width,r=e.height;return t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=r}},{key:"isFunctionKeyPressed",value:function(t){var e=t.srcEvent;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}},{key:"isDragging",value:function(){return this._state.isDragging}},{key:"setProps",value:function(t){"onViewportChange"in t&&Ni.a.removed("onViewportChange")(),"onViewStateChange"in t&&(this.onViewStateChange=t.onViewStateChange),"onStateChange"in t&&(this.onStateChange=t.onStateChange),this.controllerStateProps=t,"eventManager"in t&&this.eventManager!==t.eventManager&&(this.eventManager=t.eventManager,this._events={},this.toggleEvents(this.events,!0)),this.transitionManager.processViewStateChange(this.controllerStateProps);var e=t.scrollZoom,n=void 0===e||e,r=t.dragPan,i=void 0===r||r,o=t.dragRotate,a=void 0===o||o,s=t.doubleClickZoom,u=void 0===s||s,c=t.touchZoom,l=void 0===c||c,h=t.touchRotate,f=void 0!==h&&h,d=t.keyboard,p=void 0===d||d,v=Boolean(this.onViewStateChange);this.toggleEvents(uu,v&&n),this.toggleEvents(cu,v&&(i||a)),this.toggleEvents(lu,v&&(l||f)),this.toggleEvents(hu,v&&u),this.toggleEvents(fu,v&&p),this.scrollZoom=n,this.dragPan=i,this.dragRotate=a,this.doubleClickZoom=u,this.touchZoom=l,this.touchRotate=f,this.keyboard=p}},{key:"toggleEvents",value:function(t,e){var n=this;this.eventManager&&t.forEach(function(t){n._events[t]!==e&&(n._events[t]=e,e?n.eventManager.on(t,n.handleEvent):n.eventManager.off(t,n.handleEvent))})}},{key:"setOptions",value:function(t){return this.setProps(t)}},{key:"updateViewport",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},t.getViewportProps(),e);if(this.controllerState!==t){var i=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:n,oldViewState:i})}Object.assign(this._state,Object.assign({},t.getInteractiveState(),n)),this.onStateChange&&this.onStateChange(this._state)}},{key:"_onPanStart",value:function(t){var e=this.getCenter(t);if(!this.isPointInBounds(e))return!1;var n=this.controllerState.panStart({pos:e}).rotateStart({pos:e});return this.updateViewport(n,su,{isDragging:!0})}},{key:"_onPan",value:function(t){var e=this.isFunctionKeyPressed(t)||t.rightButton;return(e=this.invertPan?!e:e)?this._onPanMove(t):this._onPanRotate(t)}},{key:"_onPanEnd",value:function(t){var e=this.controllerState.panEnd().rotateEnd();return this.updateViewport(e,null,{isDragging:!1})}},{key:"_onPanMove",value:function(t){if(!this.dragPan)return!1;var e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,su,{isDragging:!0})}},{key:"_onPanRotate",value:function(t){return!!this.dragRotate&&(this.invertPan?this._onPanRotateMap(t):this._onPanRotateStandard(t))}},{key:"_onPanRotateStandard",value:function(t){var e=t.deltaX,n=t.deltaY,r=this.controllerState.getViewportProps(),i=e/r.width,o=n/r.height,a=this.controllerState.rotate({deltaScaleX:i,deltaScaleY:o});return this.updateViewport(a,su,{isDragging:!0})}},{key:"_onPanRotateMap",value:function(t){var e=t.deltaX,n=t.deltaY,r=ou(this.getCenter(t),2)[1],i=r-n,o=this.controllerState.getViewportProps(),a=o.width,s=o.height,u=e/a,c=0;n>0?Math.abs(s-i)>5&&(c=n/(i-s)*1.2):n<0&&i>5&&(c=1-r/i),c=Math.min(1,Math.max(-1,c));var l=this.controllerState.rotate({deltaScaleX:u,deltaScaleY:c});return this.updateViewport(l,su,{isDragging:!0})}},{key:"_onWheel",value:function(t){if(!this.scrollZoom)return!1;t.preventDefault();var e=this.getCenter(t);if(!this.isPointInBounds(e))return!1;var n=t.delta,r=2/(1+Math.exp(-Math.abs(.01*n)));n<0&&0!==r&&(r=1/r);var i=this.controllerState.zoom({pos:e,scale:r});return this.updateViewport(i,su)}},{key:"_onPinchStart",value:function(t){var e=this.getCenter(t);if(!this.isPointInBounds(e))return!1;var n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return this._state.startPinchRotation=t.rotation,this.updateViewport(n,su,{isDragging:!0})}},{key:"_onPinch",value:function(t){if(!this.touchZoom&&!this.touchRotate)return!1;var e=this.controllerState;if(this.touchZoom){var n=t.scale,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){var i=t.rotation,o=this._state.startPinchRotation;e=e.rotate({deltaScaleX:-(i-o)/180})}return this.updateViewport(e,su,{isDragging:!0})}},{key:"_onPinchEnd",value:function(t){var e=this.controllerState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(e,null,{isDragging:!1})}},{key:"_onDoubleTap",value:function(t){if(!this.doubleClickZoom)return!1;var e=this.getCenter(t);if(!this.isPointInBounds(e))return!1;var n=this.isFunctionKeyPressed(t),r=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps())}},{key:"_onKeyDown",value:function(t){if(!this.keyboard)return!1;var e,n=this.isFunctionKeyPressed(t),r=this.controllerState;switch(t.srcEvent.keyCode){case 189:e=n?r.zoomOut().zoomOut():r.zoomOut();break;case 187:e=n?r.zoomIn().zoomIn():r.zoomIn();break;case 37:e=n?r.rotateLeft():r.moveLeft();break;case 39:e=n?r.rotateRight():r.moveRight();break;case 38:e=n?r.rotateUp():r.moveUp();break;case 40:e=n?r.rotateDown():r.moveDown();break;default:return!1}return this.updateViewport(e,this._getTransitionProps())}},{key:"_getTransitionProps",value:function(){return su}}])&&au(e.prototype,n),r&&au(e,r),t}(),pu=n("i+ZN"),vu=n.n(pu),gu=6371e3,yu=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.phi,r=e.theta,i=e.radius,o=e.bearing,a=e.pitch,s=(e.altitude,e.radiusScale),u=void 0===s?gu:s;Object(Aa.a)(this,t),0===arguments.length?(this.phi=0,this.theta=0,this.radius=1):Number.isFinite(n)||Number.isFinite(r)?(this.phi=n||0,this.theta=r||0):(Number.isFinite(o)||Number.isFinite(a))&&(this.bearing=o||0,this.pitch=a||0),this.radius=i||1,this.radiusScale=u||1,this.check()}return Object(Ma.a)(t,[{key:"toString",value:function(){return this.formatString(Da.c)}},{key:"formatString",value:function(t){var e=t.printTypes,n=(t.printDegrees,Da.f);return"".concat(e?"Spherical":"","[rho:").concat(n(this.radius),",theta:").concat(n(this.theta),",phi:").concat(n(this.phi),"]")}},{key:"equals",value:function(t){return Object(Da.e)(this.radius,t.radius)&&Object(Da.e)(this.theta,t.theta)&&Object(Da.e)(this.phi,t.phi)}},{key:"exactEquals",value:function(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}},{key:"set",value:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this.check()}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}},{key:"fromLngLatZ",value:function(t){var e=Object(us.a)(t,3),n=e[0],r=e[1],i=e[2];this.radius=1+i/this.radiusScale,this.phi=Object(Da.h)(r),this.theta=Object(Da.h)(n)}},{key:"fromVector3",value:function(t){return this.radius=vu()(t),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos(Object(Da.b)(t[2]/this.radius,-1,1))),this.check()}},{key:"toVector3",value:function(){return new Na.a(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}},{key:"makeSafe",value:function(){this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi))}},{key:"check",value:function(){if(!(Number.isFinite(this.phi)&&Number.isFinite(this.theta)&&this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}},{key:"bearing",get:function(){return 180-Object(Da.d)(this.phi)},set:function(t){this.phi=Math.PI-Object(Da.h)(t)}},{key:"pitch",get:function(){return Object(Da.d)(this.theta)},set:function(t){this.theta=Object(Da.h)(t)}},{key:"longitude",get:function(){return Object(Da.d)(this.phi)}},{key:"latitude",get:function(){return Object(Da.d)(this.theta)}},{key:"lng",get:function(){return Object(Da.d)(this.phi)}},{key:"lat",get:function(){return Object(Da.d)(this.theta)}},{key:"z",get:function(){return(this.radius-1)*this.radiusScale}}]),t}();function mu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _u={position:[0,0,0],lookAt:[0,0,0],up:[0,0,1],rotationX:0,rotationY:0,fov:50,near:1,far:100},bu=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=e.width,r=e.height,i=e.position,o=void 0===i?_u.position:i;Object(zi.a)(Number.isFinite(n),"`width` must be supplied"),Object(zi.a)(Number.isFinite(r),"`height` must be supplied"),this._viewportProps=this._applyConstraints(Object.assign({},e,{position:new Na.a(o)}))}var e,n,r;return e=t,(n=[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getDirection",value:function(){return new yu({bearing:this._viewportProps.bearing,pitch:this._viewportProps.pitch}).toVector3().normalize()}},{key:"getDirectionFromBearing",value:function(t){return new yu({bearing:t,pitch:90}).toVector3().normalize()}},{key:"shortestPathFrom",value:function(t){return this._viewportProps}},{key:"_applyConstraints",value:function(t){return t}}])&&mu(e.prototype,n),r&&mu(e,r),t}(),wu=85.05113,xu=-85.05113;function Eu(t){return(Eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ou(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Pu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Su(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Tu(t,e,n){return e&&Su(t.prototype,e),n&&Su(t,n),t}function Cu(t,e){return!e||"object"!==Eu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Au(t){return(Au=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mu(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ku(t,e)}function ku(t,e){return(ku=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ju={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new Qs,transitionInterruption:tu},Ru={minZoom:0,maxZoom:20,minPitch:0,maxPitch:60},Lu={pitch:0,bearing:0,altitude:1.5},Iu=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.width,i=n.height,o=n.latitude,a=n.longitude,s=n.zoom,u=n.bearing,c=void 0===u?Lu.bearing:u,l=n.pitch,h=void 0===l?Lu.pitch:l,f=n.altitude,d=void 0===f?Lu.altitude:f,p=n.maxZoom,v=void 0===p?Ru.maxZoom:p,g=n.minZoom,y=void 0===g?Ru.minZoom:g,m=n.maxPitch,_=void 0===m?Ru.maxPitch:m,b=n.minPitch,w=void 0===b?Ru.minPitch:b,x=n.startPanLngLat,E=n.startZoomLngLat,O=n.startBearing,P=n.startPitch,S=n.startZoom;return Pu(this,e),Object(zi.a)(Number.isFinite(a),"`longitude` must be supplied"),Object(zi.a)(Number.isFinite(o),"`latitude` must be supplied"),Object(zi.a)(Number.isFinite(s),"`zoom` must be supplied"),(t=Cu(this,Au(e).call(this,{width:r,height:i,latitude:o,longitude:a,zoom:s,bearing:c,pitch:h,altitude:d,maxZoom:v,minZoom:y,maxPitch:_,minPitch:w})))._interactiveState={startPanLngLat:x,startZoomLngLat:E,startBearing:O,startPitch:P,startZoom:S},t}return Mu(e,bu),Tu(e,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(t){var e=t.pos;return this._getUpdatedState({startPanLngLat:this._unproject(e)})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos,r=this._interactiveState.startPanLngLat||this._unproject(n);if(!r)return this;var i=Ou(this._calculateNewLngLat({startPanLngLat:r,pos:e}),2),o=i[0],a=i[1];return this._getUpdatedState({longitude:o,latitude:a})}},{key:"panEnd",value:function(){return this._getUpdatedState({startPanLngLat:null})}},{key:"rotateStart",value:function(t){t.pos;return this._getUpdatedState({startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(t){var e=t.deltaScaleX,n=void 0===e?0:e,r=t.deltaScaleY,i=void 0===r?0:r,o=this._interactiveState,a=o.startBearing,s=o.startPitch;if(!Number.isFinite(a)||!Number.isFinite(s))return this;var u=this._calculateNewPitchAndBearing({deltaScaleX:n,deltaScaleY:i,startBearing:a,startPitch:s}),c=u.pitch,l=u.bearing;return this._getUpdatedState({bearing:l,pitch:c})}},{key:"rotateEnd",value:function(){return this._getUpdatedState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale;Object(zi.a)(r>0,"`scale` must be a positive number");var i=this._interactiveState,o=i.startZoom,a=i.startZoomLngLat;Number.isFinite(o)||(o=this._viewportProps.zoom,a=this._unproject(n)||this._unproject(e)),Object(zi.a)(a,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var s=this._calculateNewZoom({scale:r,startZoom:o}),u=Ou(new As(Object.assign({},this._viewportProps,{zoom:s})).getLocationAtPoint({lngLat:a,pos:e}),2),c=u[0],l=u[1];return this._getUpdatedState({zoom:s,longitude:c,latitude:l})}},{key:"zoomEnd",value:function(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}},{key:"zoomIn",value:function(){return this._zoomFromCenter(2)}},{key:"zoomOut",value:function(){return this._zoomFromCenter(.5)}},{key:"moveLeft",value:function(){return this._panFromCenter([100,0])}},{key:"moveRight",value:function(){return this._panFromCenter([-100,0])}},{key:"moveUp",value:function(){return this._panFromCenter([0,100])}},{key:"moveDown",value:function(){return this._panFromCenter([0,-100])}},{key:"rotateLeft",value:function(){return this._getUpdatedState({bearing:this._viewportProps.bearing-15})}},{key:"rotateRight",value:function(){return this._getUpdatedState({bearing:this._viewportProps.bearing+15})}},{key:"rotateUp",value:function(){return this._getUpdatedState({pitch:this._viewportProps.pitch+10})}},{key:"rotateDown",value:function(){return this._getUpdatedState({pitch:this._viewportProps.pitch-10})}},{key:"shortestPathFrom",value:function(t){var e=t.getViewportProps(),n=Object.assign({},this._viewportProps),r=n.bearing,i=n.longitude;return Math.abs(r-e.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-e.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}},{key:"_zoomFromCenter",value:function(t){var e=this._viewportProps,n=e.width,r=e.height;return this.zoom({pos:[n/2,r/2],scale:t})}},{key:"_panFromCenter",value:function(t){var e=this._viewportProps,n=e.width,r=e.height;return this.pan({startPos:[n/2,r/2],pos:[n/2+t[0],r/2+t[1]]})}},{key:"_getUpdatedState",value:function(t){return new e(Object.assign({},this._viewportProps,this._interactiveState,t))}},{key:"_applyConstraints",value:function(t){var e=t.maxZoom,n=t.minZoom,r=t.zoom;t.zoom=Object(Da.b)(r,n,e);var i=t.maxPitch,o=t.minPitch,a=t.pitch;return t.pitch=Object(Da.b)(a,o,i),Object.assign(t,function(t){var e=t.width,n=t.height,r=t.longitude,i=t.latitude,o=t.zoom,a=t.pitch,s=void 0===a?0:a,u=t.bearing,c=void 0===u?0:u;(r<-180||r>180)&&(r=Object(ps.c)(r+180,360)-180),(c<-180||c>180)&&(c=Object(ps.c)(c+180,360)-180);var l=new As({width:e,height:n,longitude:r,latitude:i,zoom:o}),h=l.project([r,wu])[1],f=l.project([r,xu])[1],d=0;return f-h<n&&(o+=Math.log2(n/(f-h)),h=(l=new As({width:e,height:n,longitude:r,latitude:i,zoom:o})).project([r,wu])[1],f=l.project([r,xu])[1]),h>0?d=h:f<n&&(d=f-n),d&&(i=l.unproject([e/2,n/2+d])[1]),{width:e,height:n,longitude:r,latitude:i,zoom:o,pitch:s,bearing:c}}(t)),t}},{key:"_unproject",value:function(t){var e=new As(this._viewportProps);return t&&e.unproject(t)}},{key:"_calculateNewLngLat",value:function(t){var e=t.startPanLngLat,n=t.pos;return new As(this._viewportProps).getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"_calculateNewZoom",value:function(t){var e=t.scale,n=t.startZoom,r=this._viewportProps,i=r.maxZoom,o=r.minZoom,a=n+Math.log2(e);return Object(Da.b)(a,o,i)}},{key:"_calculateNewPitchAndBearing",value:function(t){var e=t.deltaScaleX,n=t.deltaScaleY,r=t.startBearing,i=t.startPitch;n=Object(Da.b)(n,-1,1);var o=this._viewportProps,a=o.minPitch,s=o.maxPitch,u=i;return n>0?u=i+n*(s-i):n<0&&(u=i-n*(a-i)),{pitch:u,bearing:r+180*e}}}]),e}(),Du=function(t){function e(t){var n;return Pu(this,e),(n=Cu(this,Au(e).call(this,Iu,t))).invertPan=!0,n}return Mu(e,du),Tu(e,[{key:"_getTransitionProps",value:function(){return ju}}]),e}();function Fu(t){return(Fu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Bu(t,e){return!e||"object"!==Fu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Uu(t){return(Uu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zu(t,e){return(zu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gu=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Bu(this,Uu(e).call(this,Object.assign({},t,{type:Gs})))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zu(t,e)}(e,os),n=e,(r=[{key:"controller",get:function(){return this._getControllerProps({type:Du})}}])&&Nu(n.prototype,r),i&&Nu(n,i),e}();function Vu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Gu.displayName="MapView";var Wu=function(){function t(e){var n=e.gl,r=e.layerManager;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=n,this.layerManager=r,this._effects=[]}var e,n,r;return e=t,(n=[{key:"addEffect",value:function(t){this._effects.push(t),this._sortEffects(),t.initialize({gl:this.gl,layerManager:this.layerManager})}},{key:"removeEffect",value:function(t){var e=this._effects.indexOf(t);return e>=0&&(t.finalize({gl:this.gl,layerManager:this.layerManager}),this._effects.splice(e,1),!0)}},{key:"preDraw",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this._effects[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.needsRedraw&&o.preDraw({gl:this.gl,layerManager:this.layerManager})}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"draw",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this._effects[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.needsRedraw&&o.draw({gl:this.gl,layerManager:this.layerManager})}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"_sortEffects",value:function(){this._effects.sort(function(t,e){return t.priority>e.priority?-1:t.priority<e.priority?1:t.count-e.count})}}])&&Vu(e.prototype,n),r&&Vu(e,r),t}();function Zu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Hu=0,Xu=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id="effect",this.count=Hu++,this.visible=!0,this.priority=0,this.needsRedraw=!1}var e,n,r;return e=t,(n=[{key:"initialize",value:function(t){t.gl,t.layerManager}},{key:"finalize",value:function(t){t.gl,t.layerManager}},{key:"preDraw",value:function(t){t.gl,t.layerManager}},{key:"draw",value:function(t){t.gl,t.layerManager}},{key:"setNeedsRedraw",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.needsRedraw=t}}])&&Zu(e.prototype,n),r&&Zu(e,r),t}(),Yu=1,Ju=2,qu=4,Qu={mousedown:Yu,mousemove:Ju,mouseup:qu};var Ku,$u,tc=null;"undefined"!=typeof document&&(tc=n("yLV6"),Ku=tc.PointerEventInput,$u=Ku.prototype.handler,Ku.prototype.handler=function(t){var e=this.store;t.button>0&&(function(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}(e,function(e){return e.pointerId===t.pointerId})||e.push(t)),$u.call(this,t)},tc.MouseInput.prototype.handler=function(t){var e=Qu[t.type];e&Yu&&t.button>=0&&(this.pressed=!0),e&Ju&&0===t.which&&(e=qu),this.pressed&&(e&qu&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))});var ec=tc;var nc=ec?[[ec.Rotate,{enable:!1}],[ec.Pinch,{enable:!1}],[ec.Swipe,{enable:!1}],[ec.Pan,{threshold:0,enable:!1}],[ec.Press,{enable:!1}],[ec.Tap,{event:"doubletap",taps:2,enable:!1}],[ec.Tap,{enable:!1}]]:null,rc={rotate:["pinch"]},ic={doubletap:["tap"]},oc={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},ac=["keydown","keyup"],sc=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],uc=["wheel","mousewheel","DOMMouseScroll"],cc={tap:"tap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},lc={click:"tap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},hc=n("Vame"),fc=-1!==hc.a.indexOf("firefox"),dc=uc,pc=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(Aa.a)(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},i),this.events=dc.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(function(t){return e.addEventListener(t,r.handleEvent)})}return Object(Ma.a)(t,[{key:"destroy",value:function(){var t=this;this.events.forEach(function(e){return t.element.removeEventListener(e,t.handleEvent)})}},{key:"enableEventType",value:function(t,e){"wheel"===t&&(this.options.enable=e)}},{key:"handleEvent",value:function(t){if(this.options.enable){var e=t.deltaY;hc.b.WheelEvent&&(fc&&t.deltaMode===hc.b.WheelEvent.DOM_DELTA_PIXEL&&(e/=hc.b.devicePixelRatio),t.deltaMode===hc.b.WheelEvent.DOM_DELTA_LINE&&(e*=40));var n={x:t.clientX,y:t.clientY};0!==e&&e%4.000244140625==0&&(e=Math.floor(e/4.000244140625)),t.shiftKey&&e&&(e*=.25),this._onWheel(t,-e,n)}}},{key:"_onWheel",value:function(t,e,n){this.callback({type:"wheel",center:n,delta:e,srcEvent:t,pointerType:"mouse",target:t.target})}}]),t}(),vc=sc,gc=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(Aa.a)(this,t),this.element=e,this.callback=n,this.pressed=!1,this.options=Object.assign({enable:!0},i),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=vc.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(function(t){return e.addEventListener(t,r.handleEvent)})}return Object(Ma.a)(t,[{key:"destroy",value:function(){var t=this;this.events.forEach(function(e){return t.element.removeEventListener(e,t.handleEvent)})}},{key:"enableEventType",value:function(t,e){"pointermove"===t&&(this.enableMoveEvent=e),"pointerover"===t&&(this.enableOverEvent=e),"pointerout"===t&&(this.enableOutEvent=e),"pointerleave"===t&&(this.enableLeaveEvent=e)}},{key:"handleEvent",value:function(t){this.handleOverEvent(t),this.handleOutEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)}},{key:"handleOverEvent",value:function(t){this.enableOverEvent&&"mouseover"===t.type&&this.callback({type:"pointerover",srcEvent:t,pointerType:"mouse",target:t.target})}},{key:"handleOutEvent",value:function(t){this.enableOutEvent&&"mouseout"===t.type&&this.callback({type:"pointerout",srcEvent:t,pointerType:"mouse",target:t.target})}},{key:"handleLeaveEvent",value:function(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this.callback({type:"pointerleave",srcEvent:t,pointerType:"mouse",target:t.target})}},{key:"handleMoveEvent",value:function(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this.callback({type:"pointermove",srcEvent:t,pointerType:"mouse",target:t.target});break;case"mouseup":this.pressed=!1}}}]),t}(),yc=ac,mc=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(Aa.a)(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},i),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=yc.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=1,e.style.outline="none",this.events.forEach(function(t){return e.addEventListener(t,r.handleEvent)})}return Object(Ma.a)(t,[{key:"destroy",value:function(){var t=this;this.events.forEach(function(e){return t.element.removeEventListener(e,t.handleEvent)})}},{key:"enableEventType",value:function(t,e){"keydown"===t&&(this.enableDownEvent=e),"keyup"===t&&(this.enableUpEvent=e)}},{key:"handleEvent",value:function(t){var e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:"keydown",srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:"keyup",srcEvent:t,key:t.key,target:t.target}))}}]),t}(),_c=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(Aa.a)(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},r),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}return Object(Ma.a)(t,[{key:"destroy",value:function(){this.element.removeEventListener("contextmenu",this.handleEvent)}},{key:"enableEventType",value:function(t,e){"contextmenu"===t&&(this.options.enable=e)}},{key:"handleEvent",value:function(t){this.options.enable&&this.callback({type:"contextmenu",center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}]),t}(),bc=1,wc=2,xc=4,Ec={pointerdown:bc,pointermove:wc,pointerup:xc,mousedown:bc,mousemove:wc,mouseup:xc},Oc=1,Pc=2,Sc=3,Tc=0,Cc=1,Ac=2,Mc=1,kc=2,jc=4;var Rc=function(){function t(e){Object(Aa.a)(this,t),this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this)}return Object(Ma.a)(t,[{key:"isEmpty",value:function(){return 0===this.handlers.length}},{key:"add",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"root",r=this.handlers,i=this.handlersByElement;i.has(n)||i.set(n,[]);var o={type:t,handler:e,srcElement:n};r.push(o),i.get(n).push(o)}},{key:"remove",value:function(t,e){for(var n=this.handlers,r=this.handlersByElement,i=n.length-1;i>=0;i--){var o=n[i];if(o.type===t&&o.handler===e){n.splice(i,1);var a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}}},{key:"handleEvent",value:function(t){if(!this.isEmpty()){for(var e=this._normalizeEvent(t),n=t.srcEvent.target;n&&n!==e.rootElement;){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")}}},{key:"_emit",value:function(t,e){var n=this.handlersByElement.get(e);if(n)for(var r=!1,i=function(){t.handled=!0},o=function(){t.handled=!0,r=!0},a=0;a<n.length;a++){var s=n[a],u=s.type;if((0,s.handler)(Object.assign({},t,{type:u,stopPropagation:i,stopImmediatePropagation:o})),r)break}}},{key:"_normalizeEvent",value:function(t){var e=this.eventManager.element;return Object.assign({},t,function(t){var e=Ec[t.srcEvent.type];if(!e)return null;var n=t.srcEvent,r=n.buttons,i=n.button,o=n.which,a=!1,s=!1,u=!1;return e===xc||e===wc&&!Number.isFinite(r)?(a=o===Oc,s=o===Pc,u=o===Sc):e===wc?(a=Boolean(r&Mc),s=Boolean(r&jc),u=Boolean(r&kc)):e===bc&&(a=i===Tc,s=i===Cc,u=i===Ac),{leftButton:a,middleButton:s,rightButton:u}}(t),function(t,e){var n=t.srcEvent;if(!t.center&&!Number.isFinite(n.clientX))return null;var r=t.center||{x:n.clientX,y:n.clientY},i=e.getBoundingClientRect(),o=i.width/e.offsetWidth,a=i.height/e.offsetHeight;return{center:r,offsetCenter:{x:(r.x-i.left-e.clientLeft)/o,y:(r.y-i.top-e.clientTop)/a}}}(t,e),{handled:!1,rootElement:e})}}]),t}(),Lc={events:null,recognizers:null,Manager:ec?ec.Manager:function(t){var e={},n=function(){return e};return e.get=function(){return null},e.set=n,e.on=n,e.off=n,e.destroy=n,e.emit=n,e},touchAction:"none"},Ic=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(Aa.a)(this,t),this.options=Object.assign({},Lc,n),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);var r=n.events;r&&this.on(r)}return Object(Ma.a)(t,[{key:"setElement",value:function(t){var e=this;if(this.element&&this.destroy(),this.element=t,t){var n=this.options,r=n.Manager;this.manager=new r(t,{touchAction:n.touchAction,recognizers:n.recognizers||nc}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(rc).forEach(function(t){var n=e.manager.get(t);n&&rc[t].forEach(function(t){n.recognizeWith(t)})}),this.wheelInput=new pc(t,this._onOtherEvent,{enable:!1}),this.moveInput=new gc(t,this._onOtherEvent,{enable:!1}),this.keyInput=new mc(t,this._onOtherEvent,{enable:!1}),this.contextmenuInput=new _c(t,this._onOtherEvent,{enable:!1});var i=!0,o=!1,a=void 0;try{for(var s,u=this.events[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=Object(us.a)(s.value,2),l=c[0],h=c[1];h.isEmpty()||(this._toggleRecognizer(h.recognizerName,!0),this.manager.on(l,h.handleEvent))}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}}},{key:"destroy",value:function(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}},{key:"on",value:function(t,e,n){if("string"==typeof t)this._addEventHandler(t,e,n);else for(var r in n=e,t)this._addEventHandler(r,t[r],n)}},{key:"off",value:function(t,e){if("string"==typeof t)this._removeEventHandler(t,e);else for(var n in t)this._removeEventHandler(n,t[n])}},{key:"_toggleRecognizer",value:function(t,e){var n=this.manager;if(n){var r=n.get(t);if(r&&r.options.enable!==e){r.set({enable:e});var i=ic[t];i&&!this.options.recognizers&&i.forEach(function(i){var o=n.get(i);e?(o.requireFailure(t),r.dropRequireFailure(i)):o.dropRequireFailure(t)})}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}}},{key:"_addEventHandler",value:function(t,e,n){var r=this.manager,i=this.events,o=lc[t]||t,a=i.get(o);a||(a=new Rc(this),i.set(o,a),a.recognizerName=cc[o]||o,r&&r.on(o,a.handleEvent)),this._toggleRecognizer(a.recognizerName,!0),a.add(t,e,n)}},{key:"_removeEventHandler",value:function(t,e){var n=this.events,r=lc[t]||t,i=n.get(r);if(i&&(i.remove(t,e),i.isEmpty())){var o=i.recognizerName,a=!1,s=!0,u=!1,c=void 0;try{for(var l,h=n.values()[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value;if(f.recognizerName===o&&!f.isEmpty()){a=!0;break}}}catch(t){u=!0,c=t}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}a||this._toggleRecognizer(o,!1)}}},{key:"_onBasicInput",value:function(t){var e=t.srcEvent,n=oc[e.type];n&&this.manager.emit(n,t)}},{key:"_onOtherEvent",value:function(t){this.manager.emit(t.type,t)}}]),t}(),Dc="";try{var Fc=document.createElement("div").style,Nc=/^(webkit|moz|ms|o)(?=[A-Z])/;for(var Bc in Fc)if(Nc.test(Bc)){Dc="-".concat(Bc.match(Nc)[0],"-");break}}catch(t){}function Uc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zc(){}var Gc="-webkit-"===Dc?Dc:"",Vc={GRABBING:"".concat(Gc,"grabbing"),GRAB:"".concat(Gc,"grab"),POINTER:"pointer"};var Wc={id:"deckgl-overlay",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,_animate:!1,onWebGLInitialized:zc,onResize:zc,onViewStateChange:zc,onBeforeRender:zc,onAfterRender:zc,onLayerClick:null,onLayerHover:null,onLoad:zc,getCursor:function(t){return t.isDragging?Vc.GRABBING:Vc.GRAB},debug:!1,drawPickingColors:!1},Zc=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=Object.assign({},Wc,e),this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.stats=new Ra({id:"deck.gl"}),this._needsRedraw=!0,this.viewState=e.initialViewState||null,this.interactiveState={isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onClick=this._onClick.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerLeave=this._onPointerLeave.bind(this),this._pickAndCallback=this._pickAndCallback.bind(this),this._onRendererInitialized=this._onRendererInitialized.bind(this),this._onRenderFrame=this._onRenderFrame.bind(this),this._onViewStateChange=this._onViewStateChange.bind(this),this._onInteractiveStateChange=this._onInteractiveStateChange.bind(this),e.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.setProps(e),this.animationLoop.start()}var e,n,r;return e=t,(n=[{key:"finalize",value:function(){this.animationLoop.stop(),this.animationLoop=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null),this.viewManager&&(this.viewManager.finalize(),this.viewManager=null),this.eventManager&&this.eventManager.destroy()}},{key:"setProps",value:function(t){this.stats.timeStart("deck.setProps"),t=Object.assign({},this.props,t),this.props=t,this._setCanvasSize(t);var e=Object.assign({},t,{views:this._getViews(t),width:this.width,height:this.height}),n=this._getViewState(t);n&&(e.viewState=n),this.viewManager&&this.viewManager.setProps(e),this.layerManager&&this.layerManager.setProps(e),this.animationLoop&&this.animationLoop.setProps(e),this.stats.timeEnd("deck.setProps")}},{key:"needsRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).clearRedrawFlags,e=void 0===t||t;if(this.props._animate)return"Deck._animate";var n=this._needsRedraw;e&&(this._needsRedraw=!1);var r=this.viewManager.needsRedraw({clearRedrawFlags:e}),i=this.layerManager.needsRedraw({clearRedrawFlags:e});return n=n||r||i}},{key:"getViews",value:function(){return this.viewManager.views}},{key:"getViewports",value:function(t){return this.viewManager.getViewports(t)}},{key:"pickObject",value:function(t){var e=t.x,n=t.y,r=t.radius,i=void 0===r?0:r,o=t.layerIds,a=void 0===o?null:o;this.stats.timeStart("deck.pickObject");var s=this.layerManager.pickObject({x:e,y:n,radius:i,layerIds:a,viewports:this.getViewports({x:e,y:n}),mode:"query",depth:1});return this.stats.timeEnd("deck.pickObject"),s.length?s[0]:null}},{key:"pickMultipleObjects",value:function(t){var e=t.x,n=t.y,r=t.radius,i=void 0===r?0:r,o=t.layerIds,a=void 0===o?null:o,s=t.depth,u=void 0===s?10:s;this.stats.timeStart("deck.pickMultipleObjects");var c=this.layerManager.pickObject({x:e,y:n,radius:i,layerIds:a,viewports:this.getViewports({x:e,y:n}),mode:"query",depth:u});return this.stats.timeEnd("deck.pickMultipleObjects"),c}},{key:"pickObjects",value:function(t){var e=t.x,n=t.y,r=t.width,i=void 0===r?1:r,o=t.height,a=void 0===o?1:o,s=t.layerIds,u=void 0===s?null:s;this.stats.timeStart("deck.pickObjects");var c=this.layerManager.pickObjects({x:e,y:n,width:i,height:a,layerIds:u,viewports:this.getViewports({x:e,y:n,width:i,height:a})});return this.stats.timeEnd("deck.pickObjects"),c}},{key:"_createCanvas",value:function(t){var e=t.canvas;("string"==typeof e&&(e=document.getElementById(e),Object(zi.a)(e)),e)||(e=document.createElement("canvas"),(t.parent||document.body).appendChild(e));var n=t.id,r=t.style;return e.id=n,Object.assign(e.style,r),e}},{key:"_setCanvasSize",value:function(t){if(this.canvas){var e=t.width,n=t.height;(e||0===e)&&(e=Number.isFinite(e)?"".concat(e,"px"):e,this.canvas.style.width=e),(n||0===n)&&(n=Number.isFinite(n)?"".concat(n,"px"):n,this.canvas.style.position="absolute",this.canvas.style.height=n)}}},{key:"_updateCanvasSize",value:function(){if(this._checkForCanvasSizeChange()){var t=this.width,e=this.height;this.viewManager.setProps({width:t,height:e}),this.props.onResize({width:this.width,height:this.height})}}},{key:"_checkForCanvasSizeChange",value:function(){var t=this.canvas;if(!t)return!1;var e=t.clientWidth||t.width,n=t.clientHeight||t.height;return(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,!0)}},{key:"_createAnimationLoop",value:function(t){var e=this,n=t.width,r=t.height,i=t.gl,o=t.glOptions,a=t.debug,s=t.useDevicePixels,u=t.autoResizeDrawingBuffer;return new Gi.a({width:n,height:r,useDevicePixels:s,autoResizeDrawingBuffer:u,onCreateContext:function(t){return i||Object(Gi.q)(Object.assign({},o,t,{canvas:e.canvas,debug:a}))},onInitialize:this._onRendererInitialized,onRender:this._onRenderFrame,onBeforeRender:t.onBeforeRender,onAfterRender:t.onAfterRender})}},{key:"_getViewState",value:function(t){return t.viewState||this.viewState}},{key:"_getViews",value:function(t){var e=t.views||[new Gu({id:"default-view"})];return(e=Array.isArray(e)?e:[e]).length&&t.controller&&(e[0].props.controller=t.controller),e}},{key:"_pickAndCallback",value:function(t){var e=t.event.offsetCenter;if(e){var n=this.props.pickingRadius,r=this.layerManager.pickObject({x:e.x,y:e.y,radius:n,viewports:this.getViewports(e),mode:t.mode,depth:1,event:t.event});if(t.callback&&r){var i=r.find(function(t){return t.index>=0})||null;t.callback(i,r,t.event.srcEvent)}}}},{key:"_updateCursor",value:function(){this.canvas&&(this.canvas.style.cursor=this.props.getCursor(this.interactiveState))}},{key:"_updateAnimationProps",value:function(t){this.layerManager.context.animationProps=t}},{key:"_setGLContext",value:function(t){if(!this.layerManager){if(this.canvas||(this.canvas=t.canvas,Object(Gi.A)(t,{enable:!0,copyState:!0})),Object(Gi.z)(t,{blend:!0,blendFunc:[Hi.a.SRC_ALPHA,Hi.a.ONE_MINUS_SRC_ALPHA,Hi.a.ONE,Hi.a.ONE_MINUS_SRC_ALPHA],polygonOffsetFill:!0,depthTest:!0,depthFunc:Hi.a.LEQUAL}),this.props.onWebGLInitialized(t),!this.props._customRender)for(var e in this.eventManager=new Ic(t.canvas,{events:{click:this._onClick,pointermove:this._onPointerMove,pointerleave:this._onPointerLeave}}),Ui.b)this.eventManager.on(e,this._onEvent);this.viewManager=new ss({eventManager:this.eventManager,onViewStateChange:this._onViewStateChange,onInteractiveStateChange:this._onInteractiveStateChange,views:this._getViews(this.props),viewState:this._getViewState(this.props),width:this.width,height:this.height}),Object(zi.a)(this.viewManager);var n=this.viewManager.getViewports()[0];this.layerManager=new Qa(t,{stats:this.stats,viewport:n}),this.effectManager=new Wu({gl:t,layerManager:this.layerManager});var r=!0,i=!1,o=void 0;try{for(var a,s=this.props.effects[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;this.effectManager.addEffect(u)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}}},{key:"_drawLayers",value:function(t){var e=this.layerManager.context.gl;Object(Gi.z)(e,this.props.parameters),this.props.onBeforeRender({gl:e}),this.layerManager.drawLayers({pass:"screen",viewports:this.viewManager.getViewports(),views:this.viewManager.getViews(),redrawReason:t,drawPickingColors:this.props.drawPickingColors,customRender:Boolean(this.props._customRender)}),this.props.onAfterRender({gl:e})}},{key:"_onRendererInitialized",value:function(t){var e=t.gl;this._setGLContext(e)}},{key:"_onRenderFrame",value:function(t){if(this.stats.oneSecondPassed()){var e=this.stats.getStatsTable();this.stats.reset(),Ni.a.table(3,e)()}this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this.stats.bump("fps"),this._updateAnimationProps(t);var n=this.needsRedraw({clearRedrawFlags:!0});n&&(this.stats.bump("render-fps"),this.props._customRender?this.props._customRender():this._drawLayers(n))}},{key:"_onViewStateChange",value:function(t){var e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState[t.viewId]=e,this.viewManager.setProps({viewState:e}))}},{key:"_onInteractiveStateChange",value:function(t){var e=t.isDragging,n=void 0!==e&&e;n!==this.interactiveState.isDragging&&(this.interactiveState.isDragging=n)}},{key:"_onClick",value:function(t){this._pickAndCallback({callback:this.props.onLayerClick,event:t,mode:"click"})}},{key:"_onEvent",value:function(t){var e=Ui.b[t.type],n=t.offsetCenter;if(e&&n){var r=this.layerManager.getLastPickedObject({x:n.x,y:n.y,viewports:this.getViewports(n)}),i=r.layer,o=i&&(i[e.handler]||i.props[e.handler]),a=this.props[e.handler],s=!1;o&&(s=o.call(i,r,t)),!s&&a&&a(r,t)}}},{key:"_onPointerMove",value:function(t){t.leftButton||t.rightButton||this._pickAndCallback({callback:this.props.onLayerHover,event:t,mode:"hover"})}},{key:"_onPointerLeave",value:function(t){this.layerManager.pickObject({x:-1,y:-1,viewports:[],radius:1,mode:"hover"}),this.props.onLayerHover&&this.props.onLayerHover(null,[],t.srcEvent)}}])&&Uc(e.prototype,n),r&&Uc(e,r),t}();function Hc(t){return(Hc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yc(t,e){return!e||"object"!==Hc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jc(t,e,n){return(Jc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qc(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function qc(t){return(qc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qc(t,e){return(Qc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Zc.getPropTypes=function(t){return{id:t.string,width:t.oneOfType([t.number,t.string]),height:t.oneOfType([t.number,t.string]),layers:t.oneOfType([t.object,t.array]),layerFilter:t.func,views:t.oneOfType([t.object,t.array]),viewState:t.object,effects:t.arrayOf(t.instanceOf(Xu)),controller:t.oneOfType([t.func,t.bool,t.object]),gl:t.object,glOptions:t.object,parameters:t.object,pickingRadius:t.number,useDevicePixels:t.bool,onWebGLInitialized:t.func,onResize:t.func,onViewStateChange:t.func,onBeforeRender:t.func,onAfterRender:t.func,onLayerClick:t.func,onLayerHover:t.func,onLoad:t.func,debug:t.bool,drawPickingColors:t.bool,_animate:t.bool}},Zc.defaultProps=Wc;var Kc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Yc(this,qc(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qc(t,e)}(e,pa),n=e,(r=[{key:"getSubLayers",value:function(){return this.internalState&&this.internalState.subLayers||[]}},{key:"initializeState",value:function(){}},{key:"setState",value:function(t){Jc(qc(e.prototype),"setState",this).call(this,t),this.setLayerNeedsUpdate()}},{key:"getPickingInfo",value:function(t){return t.info}},{key:"renderLayers",value:function(){return null}},{key:"getSubLayerProps",value:function(t){var e=this.props,n={opacity:e.opacity,pickable:e.pickable,visible:e.visible,parameters:e.parameters,getPolygonOffset:e.getPolygonOffset,highlightedObjectIndex:e.highlightedObjectIndex,autoHighlight:e.autoHighlight,highlightColor:e.highlightColor,coordinateSystem:e.coordinateSystem,coordinateOrigin:e.coordinateOrigin,wrapLongitude:e.wrapLongitude,modelMatrix:e.modelMatrix};return t&&Object.assign(n,t,{id:"".concat(this.props.id,"-").concat(t.id),updateTriggers:Object.assign({all:this.props.updateTriggers.all},t.updateTriggers)}),n}},{key:"_getAttributeManager",value:function(){return null}},{key:"_renderLayers",value:function(){var t=this.internalState.subLayers;t&&!this.needsUpdate()?Ni.a.log(3,"Composite layer reused subLayers ".concat(this),this.internalState.subLayers)():(t=Ta(t=this.renderLayers(),{filter:Boolean}),this.internalState.subLayers=t,Ni.a.log(2,"Composite layer rendered new subLayers ".concat(this),t)());var e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){i.value.parent=this}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"isComposite",get:function(){return!0}}])&&Xc(n.prototype,r),i&&Xc(n,i),e}();Kc.layerName="CompositeLayer";n("hJkN"),n("mJ0t"),n("oNJQ");function $c(t){return($c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function el(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rl(t,e){return!e||"object"!==$c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function il(t){return(il=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ol(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&al(t,e)}function al(t,e){return(al=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function sl(t,e){return Number.isFinite(t)?t:e}var ul=function(t){function e(t){var n,r=t.width,i=t.height,o=t.position,a=t.bearing,s=t.pitch,u=t.longitude,c=t.latitude,l=t.zoom,h=(t.syncBearing,t.bounds,t.startPanEventPosition),f=t.startPanPosition,d=t.startRotateCenter,p=t.startRotateViewport,v=t.startZoomPos,g=t.startZoom;return el(this,e),(n=rl(this,il(e).call(this,{width:r,height:i,position:o,bearing:a,pitch:s,longitude:u,latitude:c,zoom:l})))._interactiveState={startPanEventPosition:h,startPanPosition:f,startRotateCenter:d,startRotateViewport:p,startZoomPos:v,startZoom:g},n}var n,r,i;return ol(e,bu),n=e,(r=[{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(t){var e=t.pos,n=this._viewportProps,r=n.translationX,i=n.translationY;return this._getUpdatedState({startPanPosition:[r,i],startPanEventPosition:e})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos,r=this._interactiveState.startPanEventPosition||n;if(!r)return this;var i=tl(this._interactiveState.startPanPosition||[],2),o=i[0],a=i[1];o=sl(o,this._viewportProps.translationX),a=sl(a,this._viewportProps.translationY);var s=e[0]-r[0],u=e[1]-r[1];return this._getUpdatedState({translationX:o+s,translationY:a-u})}},{key:"panEnd",value:function(){return this._getUpdatedState({startPanPosition:null,startPanPos:null})}},{key:"rotateStart",value:function(t){t.pos;return this._getUpdatedState({startRotateCenter:this._viewportProps.position,startRotateViewport:this._viewportProps})}},{key:"rotate",value:function(t){var e=t.deltaScaleX,n=t.deltaScaleY;if(!this._interactiveState.startRotateCenter)return this;var r=this._viewportProps,i=r.bearing,o=r.pitch;return this._getUpdatedState({bearing:i+10*e,pitch:o-10*n})}},{key:"rotateEnd",value:function(){return this._getUpdatedState({startRotateCenter:null,startRotateViewport:null})}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedState({startZoomPos:e,startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale,i=this._viewportProps,o=i.zoom,a=i.minZoom,s=i.maxZoom,u=i.width,c=i.height,l=(i.translationX,i.translationY,this._interactiveState.startZoomPos||n||e),h=Object(Da.b)(o*r,a,s);e[0],l[0],e[1],l[1],l[0],l[1];return h/o<1?this.moveBackward():this.moveForward()}},{key:"zoomEnd",value:function(){return this._getUpdatedState({startZoomPos:null,startZoom:null})}},{key:"moveLeft",value:function(){var t=this._viewportProps.bearing-2;return this._getUpdatedState({bearing:t})}},{key:"moveRight",value:function(){var t=this._viewportProps.bearing+2;return this._getUpdatedState({bearing:t})}},{key:"moveForward",value:function(){var t=this._viewportProps.position,e=this.getDirection(),n=new Na.a(e).normalize().scale(1);return this._getUpdatedState({position:new Na.a(t).add(n)})}},{key:"moveBackward",value:function(){var t=this._viewportProps.position,e=this.getDirection(),n=new Na.a(e).normalize().scale(-1);return this._getUpdatedState({position:new Na.a(t).add(n)})}},{key:"moveUp",value:function(){var t=this._viewportProps.position;return this._getUpdatedState({position:new Na.a(t).add([0,0,1])})}},{key:"moveDown",value:function(){var t=this._viewportProps.position,e=t[2]>=1?[0,0,-1]:[0,0,0];return this._getUpdatedState({position:new Na.a(t).add(e)})}},{key:"zoomIn",value:function(){return this._getUpdatedState({zoom:this._viewportProps.zoom+.2})}},{key:"zoomOut",value:function(){return this._getUpdatedState({zoom:this._viewportProps.zoom-.2})}},{key:"_getUpdatedState",value:function(t){return new e(Object.assign({},this._viewportProps,this._interactiveState,t))}}])&&nl(n.prototype,r),i&&nl(n,i),e}(),cl=function(t){function e(t){return el(this,e),rl(this,il(e).call(this,ul,t))}return ol(e,du),e}();function ll(t){return(ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fl(t,e){return!e||"object"!==ll(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dl(t){return(dl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pl(t,e){return(pl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vl(t){return(vl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yl(t,e){return!e||"object"!==vl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ml(t){return(ml=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _l(t,e){return(_l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bl(t){return(bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function xl(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function El(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ol(t,e){return!e||"object"!==bl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pl(t){return(Pl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sl(t,e){return(Sl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),fl(this,dl(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pl(t,e)}(e,os),n=e,(r=[{key:"_getViewport",value:function(t){var e=t.viewState,n=e.modelMatrix,r=void 0===n?null:n,i=e.bearing,o=e.up,a=void 0===o?[0,0,1]:o,s=function(t){var e=t.bearing,n=t.pitch;return new yu({bearing:e,pitch:n}).toVector3().normalize()}({bearing:i,pitch:89}),u=r?r.transformDirection(s):s,c=(new Fa.a).lookAt({eye:[0,0,0],center:u,up:a});return new Ha(Object.assign({},t,{zoom:null,viewMatrix:c}))}},{key:"controller",get:function(){return this._getControllerProps({type:cl})}}])&&hl(n.prototype,r),i&&hl(n,i),e}()).displayName="FirstPersonView",(function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),yl(this,ml(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_l(t,e)}(e,os),n=e,(r=[{key:"_getViewport",value:function(t){var e=t.viewState,n=e.bearing,r=e.pitch,i=e.position,o=e.up,a=50*e.zoom,s=function(t){var e=t.bearing,n=t.pitch;return new yu({bearing:e,pitch:n}).toVector3().normalize()}({bearing:n,pitch:r}).scale(-a).multiply(new Na.a(1,1,-1)),u=(new Fa.a).multiplyRight((new Fa.a).lookAt({eye:s,center:i,up:o}));return new Ha(Object.assign({},t,{id:this.id,zoom:null,viewMatrix:u}))}}])&&gl(n.prototype,r),i&&gl(n,i),e}()).displayName="ThirdPersonView";var Tl=Math.PI/180,Cl=function(t){function e(t){var n,r=t.id,i=void 0===r?"orbit-viewport":r,o=t.width,a=t.height,s=t.distance,u=t.rotationX,c=void 0===u?0:u,l=t.rotationOrbit,h=void 0===l?0:l,f=t.orbitAxis,d=void 0===f?"Z":f,p=t.lookAt,v=void 0===p?[0,0,0]:p,g=t.up,y=void 0===g?[0,1,0]:g,m=t.fov,_=void 0===m?75:m,b=t.near,w=void 0===b?1:b,x=t.far,E=void 0===x?100:x,O=t.zoom,P=void 0===O?1:O;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var S=Ba.e([],[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],-c/180*Math.PI);"Z"===d?Ba.g(S,S,-h/180*Math.PI):Ba.f(S,S,-h/180*Math.PI);var T=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Ba.h(T,T,[P,P,P]),Ba.i(T,T,[-v[0],-v[1],-v[2]]);var C=Ba.b([],[0,0,s],[0,0,0],y),A=_*Tl,M=o/a,k=Ba.d([],A,M,w,E);return(n=Ol(this,Pl(e).call(this,{id:i,viewMatrix:Ba.c(C,C,Ba.c(S,S,T)),projectionMatrix:k,width:o,height:a}))).width=o,n.height=a,n.distance=s,n.rotationX=c,n.rotationOrbit=h,n.orbitAxis=d,n.lookAt=v,n.up=y,n.fov=_,n.near=w,n.far=E,n.zoom=P,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sl(t,e)}(e,Ha),n=e,(r=[{key:"project",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).topLeft,n=void 0!==e&&e,r=wl(Ia(this.pixelProjectionMatrix,xl(t).concat([1])),3),i=r[0],o=r[1],a=r[2];return[i,n?this.height-o:o,a]}},{key:"unproject",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).topLeft,n=void 0!==e&&e,r=wl(t,3),i=r[0],o=r[1],a=r[2],s=n?this.height-o:o;return Ia(this.pixelUnprojectionMatrix,[i,s,a,1])}},{key:"getDistance",value:function(t){var e=t.boundingBox,n=t.fov;return Math.max(e[0],e[1],e[2])/2/Math.tan(n/180*Math.PI/2)}},{key:"fitBounds",value:function(t){var n=this.width,r=this.height,i=this.rotationX,o=this.rotationOrbit,a=this.orbitAxis,s=this.lookAt,u=this.up,c=this.fov;return new e({width:n,height:r,rotationX:i,rotationOrbit:o,orbitAxis:a,up:u,fov:c,near:this.near,far:this.far,zoom:this.zoom,lookAt:s,distance:this.getDistance({boundingBox:t,fov:c})})}}])&&El(n.prototype,r),i&&El(n,i),e}();function Al(t){return(Al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ml(t,e){return!e||"object"!==Al(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kl(t){return(kl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jl(t,e){return(jl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Rl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ll(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Il(t,e,n){return e&&Ll(t.prototype,e),n&&Ll(t,n),t}Cl.displayName="OrbitViewport";var Dl={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new Qs(["zoom"]),transitionInterruption:tu},Fl={lookAt:[0,0,0],rotationX:0,rotationOrbit:0,fov:50,near:1,far:100,translationX:0,translationY:0,zoom:1},Nl={minZoom:0,maxZoom:1/0};function Bl(t,e){return Number.isFinite(t)?t:e}var Ul=function(){function t(e){var n=e.width,r=e.height,i=e.distance,o=e.rotationX,a=e.rotationOrbit,s=e.orbitAxis,u=e.bounds,c=e.lookAt,l=e.fov,h=e.near,f=e.far,d=e.translationX,p=e.translationY,v=e.zoom,g=e.minZoom,y=e.maxZoom,m=e.startPanViewport,_=e.startPanPos,b=e.isPanning,w=e.startRotateViewport,x=e.isRotating,E=e.startZoomViewport,O=e.startZoomPos;Rl(this,t),Object(zi.a)(Number.isFinite(n),"`width` must be supplied"),Object(zi.a)(Number.isFinite(r),"`height` must be supplied"),Object(zi.a)(Number.isFinite(i),"`distance` must be supplied"),this._viewportProps=this._applyConstraints({width:n,height:r,distance:i,rotationX:Bl(o,Fl.rotationX),rotationOrbit:Bl(a,Fl.rotationOrbit),orbitAxis:s,bounds:u,lookAt:c||Fl.lookAt,fov:Bl(l,Fl.fov),near:Bl(h,Fl.near),far:Bl(f,Fl.far),translationX:Bl(d,Fl.translationX),translationY:Bl(p,Fl.translationY),zoom:Bl(v,Fl.zoom),minZoom:Bl(g,Nl.minZoom),maxZoom:Bl(y,Nl.maxZoom)}),this._interactiveState={startPanViewport:m,startPanPos:_,isPanning:b,startRotateViewport:w,isRotating:x,startZoomViewport:E,startZoomPos:O}}return Il(t,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(t){var e=t.pos,n=new Cl(this._viewportProps);return this._getUpdatedOrbitState({startPanPos:e,startPanViewport:n})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos;if(this._interactiveState.isRotating)return this._getUpdatedOrbitState();var r=this._interactiveState.startPanPos||n;Object(zi.a)(r,"`startPanPos` props is required");var i=this._interactiveState.startPanViewport||new Cl(this._viewportProps),o=e[0]-r[0],a=e[1]-r[1],s=i.project(i.lookAt),u=i.unproject([s[0]-o,s[1]-a,s[2]]);return this._getUpdatedOrbitState({lookAt:u,isPanning:!0})}},{key:"panEnd",value:function(){return this._getUpdatedOrbitState({startPanViewport:null,startPanPos:null,isPanning:null})}},{key:"rotateStart",value:function(t){t.pos;var e=new Cl(this._viewportProps);return this._getUpdatedOrbitState({startRotateViewport:e})}},{key:"rotate",value:function(t){var e=t.deltaScaleX,n=t.deltaScaleY;if(this._interactiveState.isPanning)return this._getUpdatedOrbitState();var r=this._interactiveState.startRotateViewport||{},i=r.rotationX,o=r.rotationOrbit;i=Bl(i,this._viewportProps.rotationX),o=Bl(o,this._viewportProps.rotationOrbit);var a=Object(Da.b)(i-180*n,-89.999,89.999),s=(o-180*e)%360;return this._getUpdatedOrbitState({rotationX:a,rotationOrbit:s,isRotating:!0})}},{key:"rotateEnd",value:function(){return this._getUpdatedOrbitState({startRotateViewport:null,isRotating:null})}},{key:"shortestPathFrom",value:function(t){return Object.assign({},this._viewportProps)}},{key:"zoomStart",value:function(t){var e=t.pos,n=new Cl(this._viewportProps);return this._getUpdatedOrbitState({startZoomViewport:n,startZoomPos:e})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale,i=this._viewportProps,o=i.zoom,a=i.minZoom,s=i.maxZoom,u=i.width,c=i.height,l=this._interactiveState.startZoomPos||n||e,h=this._interactiveState.startZoomViewport||new Cl(this._viewportProps),f=Object(Da.b)(o*r,a,s),d=e[0]-l[0],p=e[1]-l[1],v=l[0]-u/2,g=c/2-l[1],y=h.project(h.lookAt),m=y[0]-v+v*f/o+d,_=y[1]+g-g*f/o-p,b=h.unproject([m,_,y[2]]);return this._getUpdatedOrbitState({lookAt:b,zoom:f})}},{key:"zoomEnd",value:function(){return this._getUpdatedOrbitState({startZoomPos:null})}},{key:"_getUpdatedOrbitState",value:function(e){return new t(Object.assign({},this._viewportProps,this._interactiveState,e))}},{key:"_applyConstraints",value:function(t){var e=t.maxZoom,n=t.minZoom,r=t.zoom;return t.zoom=r>e?e:r,t.zoom=r<n?n:r,t}}]),t}(),zl=function(t){function e(t){return Rl(this,e),Ml(this,kl(e).call(this,Ul,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jl(t,e)}(e,du),Il(e,[{key:"_getTransitionProps",value:function(){return Dl}}]),e}();function Gl(t){return(Gl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Wl(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Zl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xl(t,e,n){return e&&Hl(t.prototype,e),n&&Hl(t,n),t}function Yl(t,e){return!e||"object"!==Gl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jl(t){return(Jl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ql(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ql(t,e)}function Ql(t,e){return(Ql=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Kl=Math.PI/180,$l=function(t){function e(){return Zl(this,e),Yl(this,Jl(e).apply(this,arguments))}return ql(e,Ha),Xl(e,[{key:"project",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).topLeft,n=void 0!==e&&e,r=Vl(Ia(this.pixelProjectionMatrix,Wl(t).concat([1])),3),i=r[0],o=r[1],a=r[2];return[i,n?this.height-o:o,a]}},{key:"unproject",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).topLeft,n=void 0!==e&&e,r=Vl(t,3),i=r[0],o=r[1],a=r[2],s=n?this.height-o:o;return Ia(this.pixelUnprojectionMatrix,[i,s,a,1])}}]),e}();function th(t){return(th="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nh(t,e){return!e||"object"!==th(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function rh(t){return(rh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ih(t,e){return(ih=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(function(t){function e(){return Zl(this,e),Yl(this,Jl(e).apply(this,arguments))}return ql(e,os),Xl(e,[{key:"_getViewport",value:function(t){var e=t.viewState,n=t.width||1,r=t.height||1,i=t.fov||t.fovy||e.fovy||75,o=t.near||e.near||1,a=t.far||e.far||100,s=Number.isFinite(e.aspect)?e.aspect:n/r,u=i*Kl;return new $l({id:this.id,viewMatrix:this._getViewMatrix(t.viewState),projectionMatrix:Ba.d([],u,s,o,a),x:t.x,y:t.y,width:n,height:r})}},{key:"_getViewMatrix",value:function(t){var e=t.distance,n=t.rotationX,r=void 0===n?0:n,i=t.rotationOrbit,o=void 0===i?0:i,a=t.orbitAxis,s=void 0===a?"Z":a,u=t.lookAt,c=void 0===u?[0,0,0]:u,l=t.up,h=void 0===l?[0,1,0]:l,f=t.zoom,d=void 0===f?1:f,p=Ba.e([],[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],-r/180*Math.PI);"Z"===s?Ba.g(p,p,-o/180*Math.PI):Ba.f(p,p,-o/180*Math.PI);var v=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Ba.h(v,v,[d,d,d]),Ba.i(v,v,[-c[0],-c[1],-c[2]]);var g=Ba.b([],[0,0,e],[0,0,0],h);return Ba.c(g,g,Ba.c(p,p,v)),g}},{key:"fitBounds",value:function(t,e){var n=this.width,r=this.height,i=this.fov,o=this.near,a=this.far;return this._getViewport({width:n,height:r,fov:i,near:o,far:a})}},{key:"controller",get:function(){return this._getControllerProps({type:zl})}}],[{key:"getDistance",value:function(t){var e=t.boundingBox,n=t.fov;return Math.max(e[0],e[1],e[2])/2/Math.tan(n/180*Math.PI/2)}}]),e}()).displayName="OrbitView";var oh=Math.PI/180;(function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),nh(this,rh(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ih(t,e)}(e,os),n=e,(r=[{key:"_getViewport",value:function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=t.viewState,a=o.eye,s=o.lookAt,u=void 0===s?[0,0,0]:s,c=o.up,l=void 0===c?[0,1,0]:c,h=t.fovy||o.fovy||75,f=t.near||o.near||1,d=t.far||o.far||100,p=Number.isFinite(o.aspect)?o.aspect:r/i,v=h*oh;return new Ha({id:this.id,x:e,y:n,width:r,height:i,viewMatrix:Ba.b([],a,u,l),projectionMatrix:Ba.d([],v,p,f,d)})}}])&&eh(n.prototype,r),i&&eh(n,i),e}()).displayName="PerspectiveView";var ah=n("S4Ro");function sh(t){return(sh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ch(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function lh(t,e){return!e||"object"!==sh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hh(t){return(hh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fh(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dh(t,e)}function dh(t,e){return(dh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ph=0,vh=10,gh=function(t){return Math.pow(2,t)},yh=function(t){function e(t){var n,r=t.width,i=t.height,o=t.offset,a=t.zoom,s=t.minZoom,u=void 0===s?ph:s,c=t.maxZoom,l=void 0===c?vh:c,h=t.startPanPosition,f=t.startPanOffset,d=(t.startZoomPosition,t.startZoom);return uh(this,e),(n=lh(this,hh(e).call(this,{width:r,height:i,offset:o,zoom:a,minZoom:u,maxZoom:l})))._interactiveState={startPanPosition:h,startPanOffset:f,startZoom:d},n}var n,r,i;return fh(e,bu),n=e,(r=[{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(t){var e=t.pos,n=this._viewportProps.offset;return this._getUpdatedState({startPanPosition:e,startPanOffset:n})}},{key:"pan",value:function(t){var e=t.pos,n=this._interactiveState,r=n.startPanPosition,i=n.startPanOffset,o=new ah.a(e).subtract(r);return this._getUpdatedState({offset:new ah.a(i).subtract(o)})}},{key:"panEnd",value:function(){return this._getUpdatedState({startPanPosition:null,startPanOffset:null})}},{key:"rotateStart",value:function(t){t.pos;return this}},{key:"rotate",value:function(t){t.deltaScaleX,t.deltaScaleY;return this}},{key:"rotateEnd",value:function(){return this}},{key:"_calculateNewZoom",value:function(t){var e=t.scale,n=t.startZoom,r=this._viewportProps,i=r.maxZoom,o=r.minZoom,a=n+Math.log2(e);return Object(Da.b)(a,o,i)}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedState({startZoomPosition:e,startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale,i=this._viewportProps,o=i.zoom,a=i.width,s=i.height,u=i.offset,c=this._interactiveState,l=c.startZoom,h=c.startZoomPosition;Number.isFinite(l)||(l=o,h=n||e);var f=this._calculateNewZoom({scale:r,startZoom:l}),d=gh(l),p=gh(f),v=a/2-u[0],g=s/2-u[1],y=(h[0]-v)*(d/p-1),m=(h[1]-g)*(d/p-1);return this._getUpdatedState({zoom:f,offset:[u[0]-y,u[1]-m]})}},{key:"zoomEnd",value:function(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}},{key:"_zoomFromCenter",value:function(t){var e=this._viewportProps,n=e.width,r=e.height,i=e.offset;return this.zoom({pos:[n/2-i[0],r/2-i[1]],scale:t})}},{key:"zoomIn",value:function(){return this._zoomFromCenter(2)}},{key:"zoomOut",value:function(){return this._zoomFromCenter(.5)}},{key:"moveLeft",value:function(){var t=this._viewportProps.offset,e=[10,0];return this._getUpdatedState({offset:new ah.a(t).add(e)})}},{key:"moveRight",value:function(){var t=this._viewportProps.offset,e=[-10,0];return this._getUpdatedState({offset:new ah.a(t).add(e)})}},{key:"moveUp",value:function(){var t=this._viewportProps.offset,e=[0,10];return this._getUpdatedState({offset:new ah.a(t).add(e)})}},{key:"moveDown",value:function(){var t=this._viewportProps.offset,e=[0,-10];return this._getUpdatedState({offset:new ah.a(t).add(e)})}},{key:"_getUpdatedState",value:function(t){return new e(Object.assign({},this._viewportProps,this._interactiveState,t))}}])&&ch(n.prototype,r),i&&ch(n,i),e}(),mh=function(t){function e(t){var n;return uh(this,e),(n=lh(this,hh(e).call(this,yh,t))).invertPan=!0,n}return fh(e,du),e}();function _h(t){return(_h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wh(t,e){return!e||"object"!==_h(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xh(t){return(xh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Eh(t,e){return(Eh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),wh(this,xh(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Eh(t,e)}(e,os),n=e,(r=[{key:"_getViewport",value:function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=t.viewState,a=o.eye,s=void 0===a?[0,0,1]:a,u=o.lookAt,c=void 0===u?[0,0,0]:u,l=o.up,h=void 0===l?[0,1,0]:l,f=o.offset,d=void 0===f?[0,1]:f,p=o.zoom,v=void 0===p?1:p;r=r||1,i=i||1;var g=Math.pow(2,v),y=this.props,m=y.left,_=void 0===m?(-r/2+d[0])/g:m,b=y.top,w=void 0===b?(-i/2+d[1])/g:b,x=y.right,E=void 0===x?(r/2+d[0])/g:x,O=y.bottom,P=void 0===O?(i/2+d[1])/g:O,S=y.near,T=void 0===S?1:S,C=y.far,A=void 0===C?100:C;return new Ha({id:this.id,x:e,y:n,width:r,height:i,viewMatrix:(new Fa.a).lookAt({eye:s,lookAt:c,up:h}),projectionMatrix:(new Fa.a).ortho({left:_,right:E,bottom:P,top:w,near:T,far:A}),zoom:v})}},{key:"controller",get:function(){return this._getControllerProps({type:mh})}}])&&bh(n.prototype,r),i&&bh(n,i),e}()).displayName="OrthographicView";var Oh=n("dcnC"),Ph=n("N2HP"),Sh=n.n(Ph);function Th(t){return(Th="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ch(t,e){if(n=t,!(null!=(r=e)&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?r[Symbol.hasInstance](n):n instanceof r))throw new TypeError("Cannot call a class as a function");var n,r}function Ah(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mh(t,e){return!e||"object"!==Th(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}!function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Ch(this,e),t=Mh(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,r),t}var n,r,i;(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)})(e,Oh["a"]),n=e,(r=[{key:"cross",value:function(t){return Sh()(this,this,t),this.check()}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"operation",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.apply(void 0,[this,this].concat(n)),this.check()}},{key:"ELEMENTS",get:function(){return 2}}])&&Ah(n.prototype,r),i&&Ah(n,i)}();function kh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function jh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Rh=function(t){return t.length},Lh=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rh;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sortedBins=this.getSortedBins(e,n),this.maxCount=this.getMaxCount(),this.binMap=this.getBinMap()}var e,n,r;return e=t,(n=[{key:"getSortedBins",value:function(t,e){return t.reduce(function(t,n,r){var i=e(n.points);return null!=i&&t.push({i:Number.isFinite(n.index)?n.index:r,value:i,counts:n.points.length}),t},[]).sort(function(t,e){return t.value-e.value})}},{key:"getValueRange",value:function(t){var e=kh(t,2),n=e[0],r=e[1],i=this.sortedBins.length;if(!i)return[0,0];var o=Math.ceil(n/100*(i-1)),a=Math.floor(r/100*(i-1));return[this.sortedBins[o].value,this.sortedBins[a].value]}},{key:"getMaxCount",value:function(){var t=0;return this.sortedBins.forEach(function(e){return t=t>e.counts?t:e.counts}),t}},{key:"getBinMap",value:function(){return this.sortedBins.reduce(function(t,e){return Object.assign(t,(n={},r=e.i,i=e,r in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,n));var n,r,i},{})}}])&&jh(e.prototype,n),r&&jh(e,r),t}();function Ih(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Fh(t,e,n){return e&&Dh(t.prototype,e),n&&Dh(t,n),t}var Nh,Bh=function(){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).overAlloc,n=void 0===e?1:e;Ih(this,t),this.overAlloc=n}return Fh(t,[{key:"allocate",value:function(t,e,n){var r=n.size,i=n.type,o=n.copy,a=void 0!==o&&o,s=e*r;if(t&&s<=t.length)return t;var u=Math.max(Math.ceil(s*this.overAlloc),1),c=this._allocate(i,u);return t&&a&&c.set(t),this._release(t),c}},{key:"_allocate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Float32Array,e=arguments.length>1?arguments[1]:void 0;if(t===Uint16Array&&e>65535)throw new Error("Vertex count exceeds browser index limit");return new t(e)}},{key:"_release",value:function(t){}}]),t}(),Uh=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ih(this,t);var n=e.attributes,r=void 0===n?{}:n;this.typedArrayManager=new Bh,this.indexLayout=null,this.bufferLayout=null,this.vertexCount=0,this.instanceCount=0,this.attributes={},this._attributeDefs=r,this.updateGeometry(e),Object.seal(this)}return Fh(t,[{key:"updateGeometry",value:function(t){var e=t.data,n=t.getGeometry,r=t.fp64;this.data=e,this.getGeometry=n,this.fp64=r,this._rebuildGeometry()}},{key:"updatePartialGeometry",value:function(t){t.start,t.count,t.objects}},{key:"updateGeometryAttributes",value:function(t,e,n){throw new Error("Not implemented")}},{key:"getGeometrySize",value:function(t){throw new Error("Not implemented")}},{key:"_forEachGeometry",value:function(t){var e=this.data,n=this.getGeometry,r=0,i=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){t(n(s.value),r++)}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}},{key:"_updateAttribute",value:function(t){var e=t.target,n=t.size,r=t.getValue,i=this.data,o=this.bufferLayout,a=0,s=0,u=!0,c=!1,l=void 0;try{for(var h,f=i[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var d=r(h.value,s),p=o[s++];Ca({target:e,source:d,start:a,count:p}),a+=p*n}}catch(t){c=!0,l=t}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}return e}},{key:"_rebuildGeometry",value:function(){var t=this;if(this.data&&this.getGeometry){var e=[],n=[],r=0;this._forEachGeometry(function(e,i){var o=t.getGeometrySize(e);r+=o,n[i]=o});var i=this.attributes,o=this._attributeDefs,a=this.typedArrayManager,s=this.fp64;for(var u in o){var c=o[u];c.fp64Only&&!s||(i[u]=a.allocate(i[u],r,c))}this.indexLayout=e,this.bufferLayout=n,this.instanceCount=r;var l={vertexStart:0,indexStart:0};this._forEachGeometry(function(r,i){var o=n[i];l.geometryIndex=i,l.geometrySize=o,t.updateGeometryAttributes(r,l),l.vertexStart+=o,l.indexStart+=e[i]||0}),this.vertexCount=l.indexStart}}}]),t}();function zh(t,e,n){var r=t[1]-t[0];if(r<=0)return Ni.a.warn("quantizeScale: invalid domain, returning range[0]")(),e[0];var i=r/e.length,o=Math.floor((n-t[0])/i);return e[Math.max(Math.min(o,e.length-1),0)]}function Gh(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Vh={SUM:1,MEAN:2,MIN:3,MAX:4},Wh=[Hi.a.MIN,Hi.a.FUNC_ADD],Zh=[Hi.a.MAX,Hi.a.FUNC_ADD];Hi.a.MAX,Hi.a.MIN,Gh(Nh={},Vh.SUM,Hi.a.FUNC_ADD),Gh(Nh,Vh.MEAN,Hi.a.FUNC_ADD),Gh(Nh,Vh.MIN,Wh),Gh(Nh,Vh.MAX,Zh),Vh.SUM;Gi.s.fp64ifyMatrix4;Gi.s.fp64LowPart;var Hh={BinSorter:Lh,Tesselator:Uh,linearScale:function(t,e,n){return(n-t[0])/(t[1]-t[0])*(e[1]-e[0])+e[0]},getLinearScale:function(t,e){return function(n){return(n-t[0])/(t[1]-t[0])*(e[1]-e[0])+e[0]}},quantizeScale:zh,getQuantizeScale:function(t,e){return function(n){return zh(t,e,n)}},defaultColorRange:[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]],flattenVertices:function t(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.result,i=void 0===r?[]:r,o=n.dimensions,a=void 0===o?3:o,s=-1,u=0;++s<e.length;){var c=e[s];Array.isArray(c)||ArrayBuffer.isView(c)?t(c,{result:i,dimensions:a}):u<a&&(i.push(c),u++)}return u>0&&u<a&&i.push(0),i},fillArray:Ca};const Xh={renderer:"webgl",doubleBuffer:!0,glOptions:{alpha:!0,antialias:!0,preserveDrawingBuffer:!0}},Yh=12756274*Math.PI/(256*Math.pow(2,20));function Jh(t){return 19-Math.log(t/Yh)/Math.LN2}class qh extends ji.b{static getTargetZoom(t){return t.getMaxNativeZoom()}constructor(t,e,n={}){super(t,Object.assign(Xh,n)),this.props=e}setProps(t){return this.props=Object.assign(this.props,t),this}getProps(){return this.props}draw(){this.renderScene()}drawOnInteracting(){this.renderScene()}_getViewState(){const t=this.getMap(),e=t.getResolution(),n=qh.getTargetZoom(t),r=t.getCenter(),i=t.getPitch(),o=t.getBearing();return{latitude:r.y,longitude:r.x,zoom:Jh(e),bearing:o,pitch:i,maxZoom:n}}renderScene(){const t=this.getMap(),e=this._getRenderer(),n=this._getViewState(),{layers:r}=this.props;if(this.deck)this.deck.setProps({viewState:n,layers:r,targetMap:t}),this.deck._drawLayers();else{if(!e.gl)return;this.deck=new Zc({width:"100%",height:"100%",autoResizeDrawingBuffer:!1,_customRender:()=>{},parameters:{depthMask:!0,depthTest:!0},viewState:n,glOptions:{alpha:!0,antialias:!0,preserveDrawingBuffer:!0}}),this.deck._setGLContext(e.gl),this.deck.setProps({layers:r,targetMap:t}),this.initEvents(t,this.deck)}e.completeRender()}initEvents(t,e){const n=t=>(function(t,e){let n;switch(t.layerManager.layerFilter=null,e.type){case"click":n=t._onClick;break;case"mousemove":case"pointermove":n=t._onPointerMove;break;case"mouseleave":case"pointerleave":n=t._onPointerLeave;break;default:return}e.offsetCenter||(e={offsetCenter:e.point,srcEvent:e.originalEvent}),n(e)})(e,t);e.eventManager?(e.eventManager.off({click:e._onClick,pointermove:e._onPointerMove,pointerleave:e._onPointerLeave}),e.eventManager.on({click:n,pointermove:n,pointerleave:n})):(t.on("click",n),t.on("mousemove",n),t.on("mouseleave",n))}remove(){this.deck.finalize(),super.remove()}}qh.registerRenderer("webgl",Di);var Qh=qh,Kh="#define SHADER_NAME arc-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n";function $h(t){return($h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ef(t,e){return!e||"object"!==$h(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nf(t,e,n){return(nf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=rf(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function rf(t){return(rf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function of(t,e){return(of=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var af=Gi.s.fp64LowPart,sf=[0,0,0,255],uf={fp64:!1,getSourcePosition:{type:"accessor",value:function(t){return t.sourcePosition}},getTargetPosition:{type:"accessor",value:function(t){return t.targetPosition}},getSourceColor:{type:"accessor",value:sf},getTargetColor:{type:"accessor",value:sf},getStrokeWidth:{type:"accessor",value:1},widthScale:{type:"number",value:1,min:0}},cf=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=null;return Number.isFinite(t.strokeWidth)&&(Ni.a.deprecated("ArcLayer: `strokeWidth`","`getStrokeWidth`")(),n={getStrokeWidth:t.strokeWidth}),ef(this,rf(e).call(this,t,n))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&of(t,e)}(e,pa),n=e,(r=[{key:"getShaders",value:function(){return this.use64bitProjection()?{vs:"#define SHADER_NAME arc-layer-vertex-shader-64\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\n\nattribute vec4 instancePositions;\nattribute vec4 instancePositions64Low;\n\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\n\nvarying vec4 vColor;\n\nvec2 paraboloid_fp64(vec2 source[2], vec2 target[2], float ratio) {\n\n  vec2 x[2];\n  vec2_mix_fp64(source, target, ratio, x);\n  vec2 center[2];\n  vec2_mix_fp64(source, target, 0.5, center);\n\n  vec2 dSourceCenter = vec2_distance_fp64(source, center);\n  vec2 dXCenter = vec2_distance_fp64(x, center);\n  return mul_fp64(sum_fp64(dSourceCenter, dXCenter), sub_fp64(dSourceCenter, dXCenter));\n}\n\n// offset vector by strokeWidth pixels\n// offset_direction is -1 (left) or 1 (right)\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset_screenspace = dir_screenspace * offset_direction * instanceWidths * widthScale / 2.0;\n  vec2 offset_clipspace = project_pixel_to_clipspace(offset_screenspace).xy;\n\n  return offset_clipspace;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvoid get_pos_fp64(vec2 source[2], vec2 target[2], float segmentRatio, out vec2 position[4]) {\n\n  vec2 vertex_height = paraboloid_fp64(source, target, segmentRatio);\n\n  vec2 position_temp[2];\n\n  vec2_mix_fp64(source, target, segmentRatio, position_temp);\n\n  position[0] = position_temp[0];\n  position[1] = position_temp[1];\n\n  if (vertex_height.x < 0.0 || (vertex_height.x == 0.0 && vertex_height.y <= 0.0)) {\n    vertex_height = vec2(0.0, 0.0);\n  }\n\n  position[2] = sqrt_fp64(vertex_height);\n  position[3] = vec2(1.0, 0.0);\n}\n\nvoid main(void) {\n  vec2 projected_source_coord[2];\n  vec2 projected_target_coord[2];\n\n  project_position_fp64(instancePositions.xy, instancePositions64Low.xy, projected_source_coord);\n  project_position_fp64(instancePositions.zw, instancePositions64Low.zw, projected_target_coord);\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n\n  // if it's the first point, use next - current as direction\n  // otherwise use current - prev\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n\n  vec2 curr_pos_modelspace[4];\n\n  get_pos_fp64(projected_source_coord, projected_target_coord, segmentRatio,\n    curr_pos_modelspace);\n\n  vec2 next_pos_modelspace[4];\n\n  get_pos_fp64(projected_source_coord, projected_target_coord, nextSegmentRatio,\n    next_pos_modelspace);\n\n  vec4 curr_pos_clipspace = project_to_clipspace_fp64(curr_pos_modelspace);\n  vec4 next_pos_clipspace = project_to_clipspace_fp64(next_pos_modelspace);\n\n  vec2 offset = getExtrusionOffset(next_pos_clipspace.xy - curr_pos_clipspace.xy, positions.y);\n\n  gl_Position = curr_pos_clipspace + vec4(offset, 0.0, 0.0);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio) / 255.;\n  vColor = vec4(color.rgb, color.a * opacity);\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:Kh,modules:["project64","picking"]}:{vs:"#define SHADER_NAME arc-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\nattribute vec4 instancePositions;\nattribute vec4 instancePositions64Low;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\n\nvarying vec4 vColor;\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n\n  vec2 x = mix(source, target, ratio);\n  vec2 center = mix(source, target, 0.5);\n\n  float dSourceCenter = distance(source, center);\n  float dXCenter = distance(x, center);\n  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\n// offset vector by strokeWidth pixels\n// offset_direction is -1 (left) or 1 (right)\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset_screenspace = dir_screenspace * offset_direction * instanceWidths * widthScale / 2.0;\n  vec2 offset_clipspace = project_pixel_to_clipspace(offset_screenspace).xy;\n\n  return offset_clipspace;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n  float vertex_height = paraboloid(source, target, segmentRatio);\n\n  return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n  );\n}\n\nvoid main(void) {\n  vec2 source = project_position(vec3(instancePositions.xy, 0.0), instancePositions64Low.xy).xy;\n  vec2 target = project_position(vec3(instancePositions.zw, 0.0), instancePositions64Low.zw).xy;\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  // if it's the first point, use next - current as direction\n  // otherwise use current - prev\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n\n  vec3 currPos = getPos(source, target, segmentRatio);\n  vec3 nextPos = getPos(source, target, nextSegmentRatio);\n  vec4 curr = project_to_clipspace(vec4(currPos, 1.0));\n  vec4 next = project_to_clipspace(vec4(nextPos, 1.0));\n\n  // extrude\n  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y);\n  gl_Position = curr + vec4(offset, 0.0, 0.0);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio) / 255.;\n  vColor = vec4(color.rgb, color.a * opacity);\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:Kh,modules:["picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:4,transition:!0,accessor:["getSourcePosition","getTargetPosition"],update:this.calculateInstancePositions},instancePositions64Low:{size:4,accessor:["getSourcePosition","getTargetPosition"],update:this.calculateInstancePositions64Low},instanceSourceColors:{size:4,type:Hi.a.UNSIGNED_BYTE,transition:!0,accessor:"getSourceColor",defaultValue:sf},instanceTargetColors:{size:4,type:Hi.a.UNSIGNED_BYTE,transition:!0,accessor:"getTargetColor",defaultValue:sf},instanceWidths:{size:1,transition:!0,accessor:"getStrokeWidth",defaultValue:1}})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(nf(rf(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}this.state.model.setUniforms({widthScale:n.widthScale})}},{key:"_getModel",value:function(t){for(var e=[],n=0;n<50;n++)e=e.concat([n,-1,0,n,1,0]);var r=new Gi.g(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new Gi.f({drawMode:Hi.a.TRIANGLE_STRIP,attributes:{positions:new Float32Array(e)}}),isInstanced:!0,shaderCache:this.context.shaderCache}));return r.setUniforms({numSegments:50}),r}},{key:"calculateInstancePositions",value:function(t){var e=this.props,n=e.data,r=e.getSourcePosition,i=e.getTargetPosition,o=t.value,a=t.size,s=0,u=!0,c=!1,l=void 0;try{for(var h,f=n[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var d=h.value,p=r(d),v=i(d);o[s+0]=p[0],o[s+1]=p[1],o[s+2]=v[0],o[s+3]=v[1],s+=a}}catch(t){c=!0,l=t}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}}},{key:"calculateInstancePositions64Low",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getSourcePosition,o=n.getTargetPosition,a=t.value,s=t.size,u=0,c=!0,l=!1,h=void 0;try{for(var f,d=r[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var p=f.value,v=i(p),g=o(p);a[u+0]=af(v[0]),a[u+1]=af(v[1]),a[u+2]=af(g[0]),a[u+3]=af(g[1]),u+=s}}catch(t){l=!0,h=t}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}}else t.value=new Float32Array(4)}}])&&tf(n.prototype,r),i&&tf(n,i),e}();cf.layerName="ArcLayer",cf.defaultProps=uf;function lf(){return(lf=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var hf=lf({},cf.defaultProps,{brushSource:!0,brushTarget:!0,enableBrushing:!0,getStrokeWidth:function(t){return t.strokeWidth},brushRadius:1e5,mousePosition:[0,0]}),ff=function(t){var e,n;function r(){return t.apply(this,arguments)||this}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var i=r.prototype;return i.getShaders=function(){return Object.assign({},t.prototype.getShaders.call(this),{vs:"#define SHADER_NAME arc-brushing-layer-vertex-shader\n\nconst float R_EARTH = 6371000.0; // earth radius in km\nconst float N = 49.0;\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\nattribute vec4 instancePositions;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float numSegments;\nuniform float opacity;\n\n// uniform for brushing\nuniform vec2 mousePos;\nuniform float brushRadius;\nuniform bool enableBrushing;\nuniform float brushSource;\nuniform float brushTarget;\n\nvarying vec4 vColor;\n\n// approximate distance between lng lat in meters\nfloat distanceBetweenLatLng(vec2 source, vec2 target) {\n\n  vec2 delta = (source - target) * PI / 180.0;\n\n  float a =\n    sin(delta.y / 2.0) * sin(delta.y / 2.0) +\n    cos(source.y * PI / 180.0) * cos(target.y * PI / 180.0) *\n    sin(delta.x / 2.0) * sin(delta.x / 2.0);\n\n  float c = 2.0 * atan(sqrt(a), sqrt(1.0 - a));\n\n  return R_EARTH * c;\n}\n\n// range is km\nfloat isPointInRange(vec2 ptLatLng, vec2 mouseLatLng, float range, float enabled) {\n\n  return float(enabled <= 0.0 || distanceBetweenLatLng(ptLatLng, mouseLatLng) <= range);\n}\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n\n  vec2 x = mix(source, target, ratio);\n  vec2 center = mix(source, target, 0.5);\n\n  float dSourceCenter = distance(source, center);\n  float dXCenter = distance(x, center);\n  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\n// offset vector by instanceWidths pixels\n// offset_direction is -1 (left) or 1 (right)\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float strokeWidth) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset_screenspace = dir_screenspace * offset_direction * strokeWidth / 2.0;\n  vec2 offset_clipspace = project_pixel_to_clipspace(offset_screenspace).xy;\n\n  return offset_clipspace;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n  float vertex_height = paraboloid(source, target, segmentRatio);\n\n  return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n  );\n}\n\nvoid main(void) {\n  vec2 source = project_position(instancePositions.xy);\n  vec2 target = project_position(instancePositions.zw);\n\n  // if not enabled isPointInRange will always return true\n  float isSourceInBrush = isPointInRange(instancePositions.xy, mousePos, brushRadius, brushSource);\n  float isTargetInBrush = isPointInRange(instancePositions.zw, mousePos, brushRadius, brushTarget);\n\n  float isInBrush = float(!enableBrushing ||\n  (brushSource * isSourceInBrush > 0. || brushTarget * isTargetInBrush > 0.));\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n\n  // if it's the first point, use next - current as direction\n  // otherwise use current - prev\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n\n  vec3 currPos = getPos(source, target, segmentRatio);\n  vec3 nextPos = getPos(source, target, nextSegmentRatio);\n  vec4 curr = project_to_clipspace(vec4(currPos, 1.0));\n  vec4 next = project_to_clipspace(vec4(nextPos, 1.0));\n\n  // mix instanceWidths with brush, if not in brush, return 0\n  float finalWidth = mix(0.0, instanceWidths, isInBrush);\n\n  // extrude\n  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, finalWidth);\n  gl_Position = curr + vec4(offset, 0.0, 0.0);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio) / 255.;\n\n  picking_setPickingColor(instancePickingColors);\n  vColor = vec4(color.rgb, color.a * opacity);\n}\n",fs:"#define SHADER_NAME arc-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n"})},i.draw=function(e){var n=Object.assign({},e.uniforms,{brushSource:this.props.brushSource,brushTarget:this.props.brushTarget,brushRadius:this.props.brushRadius,mousePos:this.props.mousePosition?new Float32Array(this.unproject(this.props.mousePosition)):hf.mousePosition,enableBrushing:this.props.enableBrushing}),r=Object.assign({},e,{uniforms:n});t.prototype.draw.call(this,r)},r}(cf);ff.layerName="ArcBrushingLayer",ff.defaultProps=hf;function df(t){return(df="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vf(t,e){return!e||"object"!==df(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gf(t,e,n){return(gf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=yf(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function yf(t){return(yf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mf(t,e){return(mf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _f=Gi.s.fp64LowPart,bf={radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},strokeWidth:{type:"number",min:0,value:1},outline:!1,fp64:!1,getPosition:{type:"accessor",value:function(t){return t.position}},getRadius:{type:"accessor",value:1},getColor:{type:"accessor",value:[0,0,0,255]}},wf=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),vf(this,yf(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mf(t,e)}(e,pa),n=e,(r=[{key:"getShaders",value:function(t){return{vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec2 instancePositions64xyLow;\nattribute float instanceRadius;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float outline;\nuniform float strokeWidth;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\n\nvoid main(void) {\n  // Multiply out radius and clamp to limits\n  float outerRadiusPixels = clamp(\n    project_scale(radiusScale * instanceRadius),\n    radiusMinPixels, radiusMaxPixels\n  );\n\n  // outline is centered at the radius\n  // outer radius needs to offset by half stroke width\n  outerRadiusPixels += outline * strokeWidth / 2.0;\n\n  // position on the containing square in [-1, 1] space\n  unitPosition = positions.xy;\n  // 0 - solid circle, 1 - stroke with lineWidth=0\n  innerUnitRadius = outline * (1.0 - strokeWidth / outerRadiusPixels);\n\n  vec3 offset = positions * outerRadiusPixels;\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64xyLow, offset);\n\n  // Apply opacity to instance color, or return instance picking color\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\n\nvoid main(void) {\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0 || distToCenter < innerUnitRadius) {\n    discard;\n  }\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,transition:!0,accessor:"getPosition"},instancePositions64xyLow:{size:2,accessor:"getPosition",update:this.calculateInstancePositions64xyLow},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceColors:{size:4,transition:!0,type:Hi.a.UNSIGNED_BYTE,accessor:"getColor",defaultValue:[0,0,0,255]}})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(gf(yf(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.radiusScale,i=n.radiusMinPixels,o=n.radiusMaxPixels,a=n.outline,s=n.strokeWidth;this.state.model.render(Object.assign({},e,{outline:a?1:0,strokeWidth:s,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:o}))}},{key:"_getModel",value:function(t){return new Gi.g(t,Object.assign(this.getShaders(),{id:this.props.id,geometry:new Gi.f({drawMode:Hi.a.TRIANGLE_FAN,attributes:{positions:new Float32Array([-1,-1,0,-1,1,0,1,1,0,1,-1,0])}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"calculateInstancePositions64xyLow",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getPosition,o=t.value,a=0,s=!0,u=!1,c=void 0;try{for(var l,h=r[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=i(l.value);o[a++]=_f(f[0]),o[a++]=_f(f[1])}}catch(t){u=!0,c=t}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}}else t.value=new Float32Array(2)}}])&&pf(n.prototype,r),i&&pf(n,i),e}();wf.layerName="ScatterplotLayer",wf.defaultProps=bf;function xf(){return(xf=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var Ef=xf({},wf.defaultProps,{enableBrushing:!0,brushTarget:!1,brushRadius:1e5,mousePosition:[0,0],getTargetPosition:function(t){return t.target}}),Of=function(t){var e,n;function r(){return t.apply(this,arguments)||this}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var i=r.prototype;return i.getShaders=function(){return Object.assign({},t.prototype.getShaders.call(this),{vs:"#define SHADER_NAME scatterplot-brushing-ayer-vertex-shader\nconst float R_EARTH = 6371000.; // earth radius in km\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instanceTargetPositions;\nattribute float instanceRadius;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float outline;\nuniform float strokeWidth;\n\n// uniform for brushing\nuniform vec2 mousePos;\nuniform float brushRadius;\nuniform bool enableBrushing;\nuniform float brushTarget;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\n\n// approximate distance between lng lat in meters\nfloat distanceBetweenLatLng(vec2 source, vec2 target) {\n\n  vec2 delta = (source - target) * PI / 180.;\n\n  float a =\n    sin(delta.y / 2.) * sin(delta.y / 2.) +\n    cos(source.y * PI / 180.) * cos(target.y * PI / 180.) *\n    sin(delta.x / 2.) * sin(delta.x / 2.);\n\n  float c = 2. * atan(sqrt(a), sqrt(1. - a));\n\n  return R_EARTH * c;\n}\n\n// range is km\nfloat isPointInRange(vec2 ptLatLng, vec2 mouseLatLng, float range, bool enabled) {\n\n  return float(!enabled || distanceBetweenLatLng(ptLatLng, mouseLatLng) <= range);\n}\n\nvoid main(void) {\n\n  // if enableBrushing is truthy calculate whether instancePosition is in range\n  float isPtInBrush = isPointInRange(instancePositions.xy, mousePos, brushRadius, enableBrushing);\n\n  // for use with arc layer, if brushTarget is truthy\n  // calculate whether instanceTargetPositions is in range\n  float isTargetInBrush = isPointInRange(instanceTargetPositions.xy, mousePos, brushRadius, true);\n\n  // if brushTarget is falsy, when pt is in brush return true\n  // if brushTarget is truthy and target is in brush return true\n  // if brushTarget is truthy and pt is in brush return false\n  float isInBrush = float(float(isPtInBrush > 0. && brushTarget <= 0.) > 0. ||\n  float(brushTarget > 0. && isTargetInBrush > 0.) > 0.);\n\n  float finalRadius = mix(0., instanceRadius, isInBrush);\n\n  // Multiply out radius and clamp to limits\n  float outerRadiusPixels = clamp(\n    project_scale(radiusScale * finalRadius),\n    radiusMinPixels, radiusMaxPixels\n  );\n  // outline is centered at the radius\n  // outer radius needs to offset by half stroke width\n  outerRadiusPixels += outline * mix(0., strokeWidth, isInBrush) / 2.;\n\n  // position on the containing square in [-1, 1] space\n  unitPosition = positions.xy;\n  // 0 - solid circle, 1 - stroke with lineWidth=0\n  innerUnitRadius = outline * (1. - strokeWidth / outerRadiusPixels);\n\n  // Find the center of the point and add the current vertex\n  vec3 center = project_position(instancePositions);\n  vec3 vertex = positions * outerRadiusPixels;\n  gl_Position = project_to_clipspace(vec4(center + vertex, 1.));\n\n  // Apply opacity to instance color\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\n\n  // Set picking color\n  picking_setPickingColor(instancePickingColors);\n\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\n\nvoid main(void) {\n\n  float distToCenter = length(unitPosition);\n  if (distToCenter > 1.0 || distToCenter < innerUnitRadius) {\n    discard;\n  }\n  gl_FragColor = vColor;\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n"})},i.initializeState=function(){t.prototype.initializeState.call(this),this.state.attributeManager.addInstanced({instanceTargetPositions:{size:3,accessor:"getTargetPosition",update:this.calculateInstanceTargetPositions}})},i.draw=function(e){var n=Object.assign({},e.uniforms,{brushTarget:this.props.brushTarget,brushRadius:this.props.brushRadius,mousePos:this.props.mousePosition?new Float32Array(this.unproject(this.props.mousePosition)):Ef.mousePosition,enableBrushing:Boolean(this.props.enableBrushing)}),r=Object.assign({},e,{uniforms:n});t.prototype.draw.call(this,r)},i.calculateInstanceTargetPositions=function(t){for(var e=this.props,n=e.data,r=e.getTargetPosition,i=t.value,o=t.size,a=0;a<n.length;a++){var s=r(n[a])||[0,0,0];i[a*o+0]=s[0],i[a*o+1]=s[1],i[a*o+2]=s[2]}},r}(wf);function Pf(){return(Pf=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Sf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Tf(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Of.layerName="ScatterplotBrushingLayer",Of.defaultProps=Ef;var Cf=[166,3,3],Af=[35,181,184],Mf=function(t){var e,n;function i(e,n){var r;return Tf(Sf(Sf(r=t.call(this,e,n)||this)),"_animate",function(t){var e=Sf(Sf(r)).mousePosition,n=r._getLayerData(t),i=n.arcs,o=n.targets,a=n.sources,s={layers:[new Of({id:"sources",data:a,brushRadius:1e5,brushTarget:!0,mousePosition:e,opacity:1,enableBrushing:!1,pickable:!1,radiusScale:0,getColor:function(t){return t.gain>0?Af:Cf},getTargetPosition:function(t){return[t.position[0],t.position[1],0]}}),new Of({id:"targets-ring",data:o,brushRadius:1e5,mousePosition:e,strokeWidth:2,outline:!0,opacity:1,enableBrushing:!1,radiusScale:0,getColor:function(t){return t.net>0?Af:Cf}}),new Of({id:"targets",data:o,brushRadius:1e5,mousePosition:e,opacity:1,enableBrushing:!1,pickable:!0,radiusScale:3e3,getColor:function(t){return t.net>0?Af:Cf}}),new ff({id:"arc",data:i,strokeWidth:2,opacity:.7,brushRadius:1e5,enableBrushing:!1,mousePosition:e,getSourcePosition:function(t){return t.source},getTargetPosition:function(t){return t.target},getSourceColor:function(t){return Cf},getTargetColor:function(t){return Af}})]};r.inited?r.deckLayer&&r.deckLayer.setProps(s):(r.inited=!0,r.deckLayer=new Qh("deck",s,{animation:!0,renderer:"webgl"}),r.map.addLayer(r.deckLayer))}),Tf(Sf(Sf(r)),"_getLayerData",function(t){if(!t)return null;var e=[],n=[],r=[],i={};t.forEach(function(o,a){var s=o.properties,u=s.flows,c=s.centroid,l={gain:0,loss:0};Object.keys(u).forEach(function(n){if(l[u[n]>0?"gain":"loss"]+=u[n],!(Math.abs(u[n])<50)){var o=[a,Number(n)].sort(function(t,e){return t-e}).join("-"),s=t[n].properties.centroid,h=Math.sign(u[n]);r.push({position:s,target:c,name:t[n].properties.name,radius:3,gain:-h}),i[o]||(i[o]=!0,e.push({target:h>0?c:s,source:h>0?s:c,value:u[n]}))}}),n.push(Pf({},l,{position:[c[0],c[1],10],net:l.gain+l.loss,name:o.properties.name}))}),n.sort(function(t,e){return Math.abs(e.net)-Math.abs(t.net)});var o=jn().domain([0,Math.abs(n[0].net)]).range([36,400]);return n.forEach(function(t){t.radius=Math.sqrt(o(Math.abs(t.net)))}),{arcs:e,targets:n,sources:r}}),Tf(Sf(Sf(r)),"setRef",function(t){void 0===t&&(t=null),r.container=t}),r.state={zoom:14,fov:0,pitch:0,bearing:0},r.container=null,r.map=null,r.deckLayer=null,r.inited=!1,r.mousePosition=null,r}n=t,(e=i).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var o=i.prototype;return o.componentDidMount=function(){var t=this;this.map=new ji.c(this.container,{center:[-100,40.7],zoom:3,pitch:40.5,bearing:0,centerCross:!0,baseLayer:new ji.d("tile",{urlTemplate:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png",subdomains:["a","b","c","d"]})}),fetch("https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/arc/counties.json").then(function(t){return t.json()}).then(function(e){var n=e.features;t._animate(n)})},o.componentWillUnmount=function(){this.deckLayer&&this.deckLayer.remove()},o.render=function(){return r.createElement("div",{ref:this.setRef,className:"map-content"})},i}(r.Component),kf=n("VmRL"),jf=n.n(kf),Rf=Hh.flattenVertices;function Lf(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function If(t){var e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function Df(t){return If(t)?t:t.concat([t[0]])}function Ff(t){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).dimensions;return Lf(t)?[Df(t)]:t.map(Df)}function Nf(t){return(If(t)?0:1)+t.length}function Bf(t){return(Bf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zf(t,e){return!e||"object"!==Bf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gf(t){return(Gf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vf(t,e){return(Vf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wf=Hh.Tesselator,Zf=Gi.s.fp64LowPart,Hf=function(t){function e(t){var n=t.data,r=t.getGeometry,i=t.fp64,o=t.IndexType,a=void 0===o?Uint32Array:o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),zf(this,Gf(e).call(this,{data:n,getGeometry:r,fp64:i,attributes:{positions:{size:3},positions64xyLow:{size:2,fp64Only:!0},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:a,size:1}}}))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vf(t,e)}(e,Wf),n=e,(r=[{key:"get",value:function(t,e,n){if("indices"===t)return this.attributes.indices.subarray(0,this.vertexCount);if(this.attributes[t])return this.attributes[t];switch(t){case"elevations":return this._updateAttribute({target:e,size:1,getValue:function(t){return[n(t)]}});case"colors":return this._updateAttribute({target:e,size:4,getValue:function(t){var e=n(t);return isNaN(e[3])&&(e[3]=255),e}});case"pickingColors":return this._updateAttribute({target:e,size:3,getValue:function(t,e){return n(e)}});default:return null}}},{key:"getGeometrySize",value:function(t){return function(t){return Lf(t)?Nf(t):t.reduce(function(t,e){return t+Nf(e)},0)}(t)}},{key:"updateGeometryAttributes",value:function(t,e){t=Ff(t),this._updateIndices(t,e),this._updatePositions(t,e)}},{key:"_updateIndices",value:function(t,e){var n,r,i,o=e.geometryIndex,a=e.vertexStart,s=e.indexStart,u=this.attributes,c=this.indexLayout,l=this.typedArrayManager,h=u.indices,f=h.length,d=s,p=(r=function(t){var e=null;if(t.length>1){var n=0;e=[],t.forEach(function(t){n+=t.length,e.push(n)}),e.pop()}return e}(n=t),i=Rf(n,{dimensions:2,result:[]}),jf()(i,r,2));f<d+p.length&&(f*=2,h=l.allocate(h,f,{type:h.constructor,size:1,copy:!0}));for(var v=0;v<p.length;v++)h[d++]=p[v]+a;c[o]=p.length,u.indices=h}},{key:"_updatePositions",value:function(t,e){var n=e.vertexStart,r=this.attributes,i=r.positions,o=r.positions64xyLow,a=r.vertexValid,s=this.fp64,u=n;t.forEach(function(t){t.forEach(function(t){var e=t[0],n=t[1],r=t[2]||0;i[3*u]=e,i[3*u+1]=n,i[3*u+2]=r,s&&(o[2*u]=Zf(e),o[2*u+1]=Zf(n)),a[u]=1,u++}),a[u-1]=0})}}])&&Uf(n.prototype,r),i&&Uf(n,i),e}();function Xf(t){return(Xf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Jf(t,e){return!e||"object"!==Xf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qf(t,e,n){return(qf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Qf(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Qf(t){return(Qf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kf(t,e){return(Kf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $f=[0,0,0,255],td={filled:!0,extruded:!1,wireframe:!1,fp64:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:function(t){return t.polygon}},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:$f},getLineColor:{type:"accessor",value:$f},lightSettings:{}},ed={enter:function(t,e){return e.length?e.subarray(e.length-t.length):t}},nd=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Jf(this,Qf(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kf(t,e)}(e,pa),n=e,(r=[{key:"getShaders",value:function(){return{vs:"#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec2 vertexPositions;\nattribute float vertexValid;\nattribute vec3 positions;\nattribute vec2 positions64xyLow;\nattribute vec3 nextPositions;\nattribute vec2 nextPositions64xyLow;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\nuniform bool isSideVertex;\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying float isValid;\n\nvoid main(void) {\n  vec3 pos;\n  vec2 pos64xyLow;\n  vec3 normal;\n  vec4 colors = isWireframe ? lineColors : fillColors;\n\n  if (isSideVertex) {\n    pos = mix(positions, nextPositions, vertexPositions.x);\n    pos64xyLow = mix(positions64xyLow, nextPositions64xyLow, vertexPositions.x);\n    isValid = vertexValid;\n  } else {\n    pos = positions;\n    pos64xyLow = positions64xyLow;\n    isValid = 1.0;\n  }\n  if (extruded) {\n    pos.z += elevations * vertexPositions.y;\n  }\n  pos.z *= elevationScale;\n\n  vec4 position_worldspace;\n  gl_Position = project_position_to_clipspace(pos, pos64xyLow, vec3(0.), position_worldspace);\n\n  float lightWeight = 1.0;\n  \n  if (extruded) {\n    if (isSideVertex) {\n      normal = vec3(positions.y - nextPositions.y, nextPositions.x - positions.x, 0.0);\n      normal = project_normal(normal);\n    } else {\n      normal = vec3(0.0, 0.0, 1.0);\n    }\n\n    lightWeight = lighting_getLightWeight(position_worldspace.xyz, normal);\n  }\n\n  vec3 lightWeightedColor = lightWeight * colors.rgb;\n  vColor = vec4(lightWeightedColor, colors.a * opacity) / 255.0;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(pickingColors);\n}\n",fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying float isValid;\n\nvoid main(void) {\n  if (isValid < 0.5) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","lighting","picking"]}}},{key:"initializeState",value:function(){var t=this.context.gl;this.setState({numInstances:0,polygonTesselator:new Hf({IndexType:Object(Gi.t)(t,Gi.d.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});var e=this.getAttributeManager();e.remove(["instancePickingColors"]),e.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:!0},positions:{size:3,transition:ed,accessor:"getPolygon",update:this.calculatePositions,noAlloc:!0},positions64xyLow:{size:2,update:this.calculatePositionsLow,noAlloc:!0},vertexValid:{size:1,type:Hi.a.UNSIGNED_BYTE,update:this.calculateVertexValid,noAlloc:!0},elevations:{size:1,transition:ed,accessor:"getElevation",update:this.calculateElevations},fillColors:{alias:"colors",size:4,type:Hi.a.UNSIGNED_BYTE,transition:ed,accessor:"getFillColor",update:this.calculateFillColors,defaultValue:$f},lineColors:{alias:"colors",size:4,type:Hi.a.UNSIGNED_BYTE,transition:ed,accessor:"getLineColor",update:this.calculateLineColors,defaultValue:$f},pickingColors:{size:3,type:Hi.a.UNSIGNED_BYTE,update:this.calculatePickingColors}})}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.extruded,i=n.filled,o=n.wireframe,a=n.elevationScale,s=this.state,u=s.topModel,c=s.sideModel,l=Object.assign({},e,{extruded:Boolean(r),elevationScale:a});c&&(c.setUniforms(l),o&&(c.setDrawMode(Hi.a.LINE_STRIP),c.render({isWireframe:!0})),i&&(c.setDrawMode(Hi.a.TRIANGLE_FAN),c.render({isWireframe:!1}))),u&&u.render(l)}},{key:"updateState",value:function(t){qf(Qf(e.prototype),"updateState",this).call(this,t),this.updateGeometry(t);var n=t.props,r=t.oldProps,i=this.getAttributeManager();(n.fp64!==r.fp64||n.filled!==r.filled||n.extruded!==r.extruded)&&(this.state.models&&this.state.models.forEach(function(t){return t.delete()}),this.setState(this._getModels(this.context.gl)),i.invalidateAll())}},{key:"updateGeometry",value:function(t){var e=t.props,n=t.oldProps,r=t.changeFlags;if(r.dataChanged||e.fp64!==n.fp64||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){var i=this.state.polygonTesselator;i.updateGeometry({data:e.data,getGeometry:e.getPolygon,fp64:this.use64bitPositions()}),this.setState({vertexCount:i.vertexCount,numInstances:i.instanceCount}),this.getAttributeManager().invalidateAll()}}},{key:"updateAttributes",value:function(t){qf(Qf(e.prototype),"updateAttributes",this).call(this,t);var n=this.getAttributeManager().getChangedAttributes({clearChangedFlags:!0}),r=this.state,i=r.topModel,o=r.sideModel,a=r.vertexCount,s=r.numInstances;if(i&&(i.setVertexCount(a),i.setAttributes(n)),o){o.setInstanceCount(s-1);var u={};for(var c in n){var l=n[c];"indices"!==c&&(u[c]=Object.assign({},l,{isInstanced:!0,buffer:l.getBuffer()}))}u.positions&&(u.nextPositions=Object.assign({},u.positions,{id:"nextPositions",offset:12})),u.positions64xyLow&&(u.nextPositions64xyLow=Object.assign({},u.positions64xyLow,{id:"nextPositions64xyLow",offset:8})),o.setAttributes(u)}}},{key:"_getModels",value:function(t){var e,n,r=this.props,i=r.id,o=r.filled,a=r.extruded;return o&&(e=new Gi.g(t,Object.assign({},this.getShaders(),{id:"".concat(i,"-top"),geometry:new Gi.f({drawMode:Hi.a.TRIANGLES,attributes:{vertexPositions:{size:2,constant:!0,value:new Float32Array([0,1])},nextPositions:{size:3,constant:!0,value:new Float32Array(3)},nextPositions64xyLow:{size:2,constant:!0,value:new Float32Array(2)}}}),uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0,shaderCache:this.context.shaderCache}))),a&&(n=new Gi.g(t,Object.assign({},this.getShaders(),{id:"".concat(i,"-side"),geometry:new Gi.f({drawMode:Hi.a.LINES,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,1,0,1,0,0,1,0])}}}),uniforms:{isSideVertex:!0},isInstanced:1,shaderCache:this.context.shaderCache}))),{models:[n,e].filter(Boolean),topModel:e,sideModel:n}}},{key:"calculateIndices",value:function(t){var e=this.state.polygonTesselator;t.bufferLayout=e.indexLayout,t.value=e.get("indices")}},{key:"calculatePositions",value:function(t){var e=this.state.polygonTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get("positions")}},{key:"calculatePositionsLow",value:function(t){var e=this.use64bitPositions();t.constant=!e,t.value=e?this.state.polygonTesselator.get("positions64xyLow"):new Float32Array(2)}},{key:"calculateVertexValid",value:function(t){t.value=this.state.polygonTesselator.get("vertexValid")}},{key:"calculateElevations",value:function(t){var e=this.state.polygonTesselator;t.bufferLayout=e.bufferLayout;var n=this.props,r=n.extruded,i=n.getElevation;r?(t.constant=!1,t.value=e.get("elevations",t.value,i)):(t.constant=!0,t.value=new Float32Array(1))}},{key:"calculateFillColors",value:function(t){var e=this.state.polygonTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get("colors",t.value,this.props.getFillColor)}},{key:"calculateLineColors",value:function(t){var e=this.state.polygonTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get("colors",t.value,this.props.getLineColor)}},{key:"calculatePickingColors",value:function(t){t.value=this.state.polygonTesselator.get("pickingColors",t.value,this.encodePickingColor)}}])&&Yf(n.prototype,r),i&&Yf(n,i),e}();function rd(t){return(rd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function id(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function od(t,e){return!e||"object"!==rd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ad(t){return(ad=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sd(t,e){return(sd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}nd.layerName="SolidPolygonLayer",nd.defaultProps=td;var ud=Hh.Tesselator,cd=Gi.s.fp64LowPart,ld=function(t){function e(t){var n=t.data,r=t.getGeometry,i=t.fp64;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),od(this,ad(e).call(this,{data:n,getGeometry:r,fp64:i,attributes:{startPositions:{size:3},endPositions:{size:3},leftDeltas:{size:3},rightDeltas:{size:3},startEndPositions64XyLow:{size:4,fp64Only:!0}}}))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sd(t,e)}(e,ud),n=e,(r=[{key:"get",value:function(t,e,n){if(this.attributes[t])return this.attributes[t];switch(t){case"strokeWidths":return this._updateAttribute({target:e,size:1,getValue:function(t){return[n(t)]}});case"dashArrays":return this._updateAttribute({target:e,size:2,getValue:n});case"colors":return this._updateAttribute({target:e,size:4,getValue:function(t){var e=n(t);return isNaN(e[3])&&(e[3]=255),e}});case"pickingColors":return this._updateAttribute({target:e,size:3,getValue:function(t,e){return n(e)}});default:return null}}},{key:"getGeometrySize",value:function(t){return Math.max(0,this.getPathLength(t)-1)}},{key:"updateGeometryAttributes",value:function(t,e){var n=this.attributes,r=n.startPositions,i=n.endPositions,o=n.leftDeltas,a=n.rightDeltas,s=n.startEndPositions64XyLow,u=this.fp64,c=e.geometrySize+1;if(!(c<2))for(var l,h=this.isClosed(t),f=this.getPointOnPath(t,0),d=this.getPointOnPath(t,1),p=h?this.getPointOnPath(t,c-2):f,v=e.vertexStart,g=1;g<c;v++,g++)(l=this.getPointOnPath(t,g+1))||(l=h?this.getPointOnPath(t,1):d),r[3*v]=f[0],r[3*v+1]=f[1],r[3*v+2]=f[2]||0,i[3*v]=d[0],i[3*v+1]=d[1],i[3*v+2]=d[2]||0,o[3*v]=f[0]-p[0],o[3*v+1]=f[1]-p[1],o[3*v+2]=f[2]-p[2]||0,a[3*v]=l[0]-d[0],a[3*v+1]=l[1]-d[1],a[3*v+2]=l[2]-d[2]||0,u&&(s[4*v]=cd(f[0]),s[4*v+1]=cd(f[1]),s[4*v+2]=cd(d[0]),s[4*v+3]=cd(d[1])),p=f,f=d,d=l}},{key:"getPathLength",value:function(t){return t.length}},{key:"getPointOnPath",value:function(t,e){return t[e]}},{key:"isClosed",value:function(t){var e=this.getPathLength(t),n=this.getPointOnPath(t,0),r=this.getPointOnPath(t,e-1);return n[0]===r[0]&&n[1]===r[1]&&n[2]===r[2]}}])&&id(n.prototype,r),i&&id(n,i),e}(),hd="#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float jointType;\nuniform float miterLimit;\nuniform float alignMode;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vDashArray;\nvarying float vPathPosition;\nvarying float vPathLength;\n\n// mod doesn't work correctly for negative numbers\nfloat mod2(float a, float b) {\n  return a - floor(a / b) * b;\n}\n\nfloat round(float x) {\n  return floor(x + 0.5);\n}\n\n// if given position is in the gap part of the dashed line\n// dashArray.x: solid stroke length, relative to width\n// dashArray.y: gap length, relative to width\n// alignMode:\n// 0 - no adjustment\n// o----     ----     ----     ---- o----     -o----     ----     o\n// 1 - stretch to fit, draw half dash at each end for nicer joints\n// o--    ----    ----    ----    --o--      --o--     ----     --o\nbool dash_isFragInGap() {\n  float solidLength = vDashArray.x;\n  float gapLength = vDashArray.y;\n\n  float unitLength = solidLength + gapLength;\n\n  if (unitLength == 0.0) {\n    return false;\n  }\n\n  unitLength = mix(\n    unitLength,\n    vPathLength / round(vPathLength / unitLength),\n    alignMode\n  );\n\n  float offset = alignMode * solidLength / 2.0;\n\n  return gapLength > 0.0 &&\n    vPathPosition >= 0.0 &&\n    vPathPosition <= vPathLength &&\n    mod2(vPathPosition + offset, unitLength) > solidLength;\n}\n\nvoid main(void) {\n  // if joint is rounded, test distance from the corner\n  if (jointType > 0.0 && vMiterLength > 0.0 && length(vCornerOffset) > 1.0) {\n    // Enable to debug joints\n    // gl_FragColor = vec4(0., 1., 0., 1.);\n    // return;\n    discard;\n  }\n  if (jointType == 0.0 && vMiterLength > miterLimit) {\n    // Enable to debug joints\n    // gl_FragColor = vec4(0., 0., 1., 1.);\n    // return;\n    discard;\n  }\n  if (vColor.a == 0.0 || dash_isFragInGap()) {\n    // Enable to debug joints\n    // gl_FragColor = vec4(0., 1., 1., 1.);\n    // return;\n    discard;\n  }\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n";function fd(t){return(fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pd(t,e){return!e||"object"!==fd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vd(t,e,n){return(vd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=gd(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function gd(t){return(gd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yd(t,e){return(yd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var md=[0,0,0,255],_d={widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},rounded:!1,miterLimit:{type:"number",min:0,value:4},fp64:!1,dashJustified:!1,getPath:{type:"accessor",value:function(t){return t.path}},getColor:{type:"accessor",value:md},getWidth:{type:"accessor",value:1},getDashArray:{type:"accessor",value:[0,0]}},bd={enter:function(t,e){return e.length?e.subarray(e.length-t.length):t}},wd=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),pd(this,gd(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yd(t,e)}(e,pa),n=e,(r=[{key:"getShaders",value:function(){return this.use64bitProjection()?{vs:"\n#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec4 instanceStartEndPositions64xyLow;\nattribute vec3 instanceLeftDeltas;\nattribute vec3 instanceRightDeltas;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec2 instanceDashArrays;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float miterLimit;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vDashArray;\nvarying float vPathPosition;\nvarying float vPathLength;\n\nconst float EPSILON = 0.001;\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\n\nvec3 lineJoin(vec2 prevPoint64[2], vec2 currPoint64[2], vec2 nextPoint64[2]) {\n\n  float width = clamp(project_scale(instanceStrokeWidths * widthScale),\n    widthMinPixels, widthMaxPixels) / 2.0;\n\n  vec2 deltaA64[2];\n  vec2 deltaB64[2];\n\n  vec2_sub_fp64(currPoint64, prevPoint64, deltaA64);\n  vec2_sub_fp64(nextPoint64, currPoint64, deltaB64);\n\n  vec2 lengthA64 = vec2_length_fp64(deltaA64);\n  vec2 lengthB64 = vec2_length_fp64(deltaB64);\n\n  vec2 deltaA = vec2(deltaA64[0].x, deltaA64[1].x);\n  vec2 deltaB = vec2(deltaB64[0].x, deltaB64[1].x);\n\n  float lenA = lengthA64.x;\n  float lenB = lengthB64.x;\n\n  vec2 offsetVec;\n  float offsetScale;\n  float offsetDirection;\n\n  // when two points are closer than PIXEL_EPSILON in pixels,\n  // assume they are the same point to avoid precision issue\n  lenA = lenA / width > EPSILON ? lenA : 0.0;\n  lenB = lenB / width > EPSILON ? lenB : 0.0;\n  vec2 dirA = lenA > 0. ? deltaA / lenA : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? deltaB / lenB : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n\n  // tangent of the corner\n  vec2 tangent = vec2(dirA + dirB);\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  // direction of the corner\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  // width offset from current position\n  vec2 perp = mix(perpB, perpA, positions.x);\n  float L = mix(lenB, lenA, positions.x);\n\n  // cap super sharp angles\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  bool turnsRight = dirA.x * dirB.y > dirA.y * dirB.x;\n\n  // relative position to the corner:\n  // -1: inside (smaller side of the angle)\n  // 0: center\n  // 1: outside (bigger side of the angle)\n  float cornerPosition = mix(\n    flipIfTrue(turnsRight == (positions.y > 0.0)),\n    0.0,\n    positions.z\n  );\n\n  offsetScale = 1.0 / max(sinHalfA, EPSILON);\n\n  // do not bevel if line segment is too short\n  cornerPosition *= float(cornerPosition <= 0.0 || sinHalfA < min(lenA, lenB) / width * cosHalfA);\n  // trim if inside corner extends further than the line segment\n  offsetScale = mix(\n    offsetScale,\n    min(offsetScale, L / width / max(cosHalfA, EPSILON)),\n    float(cornerPosition < 0.0)\n  );\n\n  vMiterLength = mix(\n    offsetScale * cornerPosition,\n    mix(offsetScale, 0.0, cornerPosition),\n    step(0.0, cornerPosition)\n  ) - sinHalfA * jointType;\n  offsetDirection = mix(\n    positions.y,\n    mix(\n      flipIfTrue(turnsRight),\n      positions.y * flipIfTrue(turnsRight == (positions.x == 1.)),\n      cornerPosition\n    ),\n    step(0.0, cornerPosition)\n  );\n  offsetVec = mix(miterVec, -tangent, step(0.5, cornerPosition));\n  offsetScale = mix(offsetScale, 1.0 / max(cosHalfA, 0.001), step(0.5, cornerPosition));\n\n  // special treatment for start cap and end cap\n  // using a small number as the limit for determining if the lenA or lenB is 0\n  float isStartCap = step(lenA, 1.0e-5);\n  float isEndCap = step(lenB, 1.0e-5);\n  float isCap = max(isStartCap, isEndCap);\n\n  // 0: center, 1: side\n  cornerPosition = isCap * (1.0 - positions.z);\n\n  // start of path: use next - curr\n  offsetVec = mix(offsetVec, mix(dirB, perpB, cornerPosition), isStartCap);\n  // end of path: use curr - prev\n  offsetVec = mix(offsetVec, mix(dirA, perpA, cornerPosition), isEndCap);\n\n  // extend out a triangle to envelope the round cap\n  offsetScale = mix(\n    offsetScale,\n    mix(4.0 * jointType, 1.0, cornerPosition),\n    isCap\n  );\n  vMiterLength = mix(vMiterLength, 1.0 - cornerPosition, isCap);\n\n  offsetDirection = mix(\n    offsetDirection,\n    mix(flipIfTrue(isStartCap > 0.), positions.y, cornerPosition),\n    isCap\n  );\n\n  vCornerOffset = offsetVec * offsetDirection * offsetScale;\n\n  // Generate variables for dash calculation\n  vDashArray = instanceDashArrays;\n  vPathLength = L / width;\n  float isEnd = positions.x;\n  vec2 offsetFromStartOfPath = mix(vCornerOffset, vCornerOffset + deltaA / width, isEnd);\n  vec2 dir = mix(dirB, dirA, isEnd);\n  vPathPosition = dot(offsetFromStartOfPath, dir);\n\n  return vec3(vCornerOffset * width, 0.0);\n}\n\nvoid main() {\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n\n  float isEnd = positions.x;\n\n  // Calculate current position 64bit\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec2 currPosition64xyLow = mix(instanceStartEndPositions64xyLow.xy, instanceStartEndPositions64xyLow.zw, isEnd);\n  vec2 projected_curr_position[2];\n  project_position_fp64(currPosition.xy, currPosition64xyLow, projected_curr_position);\n  float projected_curr_position_z = project_scale(currPosition.z);\n\n  // Calculate previous position\n\n  vec3 prevPosition = mix(-instanceLeftDeltas, vec3(0.0), isEnd) + instanceStartPositions;\n\n  // Calculate prev position 64bit\n\n  vec2 projected_prev_position[2];\n  project_position_fp64(prevPosition.xy, instanceStartEndPositions64xyLow.xy, projected_prev_position);\n\n  // Calculate next positions\n  vec3 nextPosition = mix(vec3(0.0), instanceRightDeltas, isEnd) + instanceEndPositions;\n\n  // Calculate next position 64bit\n\n  vec2 projected_next_position[2];\n  project_position_fp64(nextPosition.xy, instanceStartEndPositions64xyLow.zw, projected_next_position);\n\n  vec3 pos = lineJoin(projected_prev_position, projected_curr_position, projected_next_position);\n  vec2 vertex_pos_modelspace[4];\n\n  vertex_pos_modelspace[0] = sum_fp64(vec2(pos.x, 0.0), projected_curr_position[0]);\n  vertex_pos_modelspace[1] = sum_fp64(vec2(pos.y, 0.0), projected_curr_position[1]);\n  vertex_pos_modelspace[2] = vec2(pos.z + projected_curr_position_z, 0.0);\n  vertex_pos_modelspace[3] = vec2(1.0, 0.0);\n\n  gl_Position = project_to_clipspace_fp64(vertex_pos_modelspace);\n}\n",fs:hd,modules:["project64","picking"]}:{vs:"#define SHADER_NAME path-layer-vertex-shader-64\n\nattribute vec3 positions;\n\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec4 instanceStartEndPositions64xyLow;\nattribute vec3 instanceLeftDeltas;\nattribute vec3 instanceRightDeltas;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec2 instanceDashArrays;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float miterLimit;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vDashArray;\nvarying float vPathPosition;\nvarying float vPathLength;\n\nconst float EPSILON = 0.001;\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\n\n// calculate line join positions\nvec3 lineJoin(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  float relativePosition, bool isEnd, bool isJoint,\n  float width\n) {\n  vec2 deltaA = currPoint.xy - prevPoint.xy;\n  vec2 deltaB = nextPoint.xy - currPoint.xy;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  // when two points are closer than PIXEL_EPSILON in pixels,\n  // assume they are the same point to avoid precision issue\n  lenA = lenA / width > EPSILON ? lenA : 0.0;\n  lenB = lenB / width > EPSILON ? lenB : 0.0;\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n\n  // tangent of the corner\n  vec2 tangent = vec2(dirA + dirB);\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  // direction of the corner\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  // width offset from current position\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n\n  // cap super sharp angles\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n\n  bool turnsRight = dirA.x * dirB.y > dirA.y * dirB.x;\n\n  float offsetScale = 1.0 / max(sinHalfA, EPSILON);\n\n  float cornerPosition = isJoint ?\n    0.0 :\n    flipIfTrue(turnsRight == (relativePosition > 0.0));\n\n  // do not bevel if line segment is too short\n  cornerPosition *=\n    float(cornerPosition <= 0.0 || sinHalfA < min(lenA, lenB) / width * cosHalfA);\n\n  // trim if inside corner extends further than the line segment\n  if (cornerPosition < 0.0) {\n    offsetScale = min(offsetScale, L / width / max(cosHalfA, EPSILON));\n  }\n\n  vMiterLength = cornerPosition >= 0.0 ?\n    mix(offsetScale, 0.0, cornerPosition) :\n    offsetScale * cornerPosition;\n  vMiterLength -= sinHalfA * jointType;\n\n  float offsetDirection = mix(\n    positions.y,\n    mix(\n      flipIfTrue(turnsRight),\n      positions.y * flipIfTrue(turnsRight == (positions.x == 1.)),\n      cornerPosition\n    ),\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec, -tangent, step(0.5, cornerPosition));\n  offsetScale = mix(offsetScale, 1.0 / max(cosHalfA, 0.001), step(0.5, cornerPosition));\n\n  // special treatment for start cap and end cap\n  // TODO - This has an issue. len is always positive because it is length.\n  // Step returns zero if -lenA<0, so practically this is a comparison of\n  // lenA with zero, with lots of problems because of the -lenA. Can we use EPSILON?\n  bool isStartCap = step(0.0, -lenA) > 0.5;\n  bool isEndCap = step(0.0, -lenB) > 0.5;\n  bool isCap = isStartCap || isEndCap;\n\n  // 0: center, 1: side\n  cornerPosition = isCap ? (1.0 - positions.z) : 0.;\n\n  // start of path: use next - curr\n  if (isStartCap) {\n    offsetVec = mix(dirB, perpB, cornerPosition);\n  }\n\n  // end of path: use curr - prev\n  if (isEndCap) {\n    offsetVec = mix(dirA, perpA, cornerPosition);\n  }\n\n  // extend out a triangle to envelope the round cap\n  if (isCap) {\n    offsetScale = mix(4.0 * jointType, 1.0, cornerPosition);\n    vMiterLength = 1.0 - cornerPosition;\n    offsetDirection = mix(flipIfTrue(isStartCap), positions.y, cornerPosition);\n  }\n\n  vCornerOffset = offsetVec * offsetDirection * offsetScale;\n\n  // Generate variables for dash calculation\n  vDashArray = instanceDashArrays;\n  vPathLength = L / width;\n  // vec2 offsetFromStartOfPath = isEnd ? vCornerOffset + deltaA / width : vCornerOffset;\n  vec2 offsetFromStartOfPath = vCornerOffset;\n  if (isEnd) {\n    offsetFromStartOfPath += deltaA / width;\n  }\n  vec2 dir = isEnd ? dirA : dirB;\n  vPathPosition = dot(offsetFromStartOfPath, dir);\n\n  return currPoint + vec3(vCornerOffset * width, 0.0);\n}\n\n// calculate line join positions\n// extract params from attributes and uniforms\nvec3 lineJoin(vec3 prevPoint, vec3 currPoint, vec3 nextPoint) {\n\n  // relative position to the corner:\n  // -1: inside (smaller side of the angle)\n  // 0: center\n  // 1: outside (bigger side of the angle)\n\n  float relativePosition = positions.y;\n  bool isEnd = positions.x > EPSILON;\n  bool isJoint = positions.z > EPSILON;\n\n  float width = clamp(project_scale(instanceStrokeWidths * widthScale),\n    widthMinPixels, widthMaxPixels) / 2.0;\n\n  return lineJoin(\n    prevPoint, currPoint, nextPoint,\n    relativePosition, isEnd, isJoint,\n    width\n  );\n}\n\nvoid main() {\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = instanceStartPositions;\n  vec2 prevPosition64xyLow = instanceStartEndPositions64xyLow.xy;\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_AUTO_OFFSET) {\n    // In auto offset mode, add delta to low part of the positions for better precision\n    prevPosition64xyLow += mix(-instanceLeftDeltas, vec3(0.0), isEnd).xy;\n  } else {\n    prevPosition += mix(-instanceLeftDeltas, vec3(0.0), isEnd);\n  }\n  prevPosition = project_position(prevPosition, prevPosition64xyLow);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec2 currPosition64xyLow = mix(instanceStartEndPositions64xyLow.xy, instanceStartEndPositions64xyLow.zw, isEnd);\n  currPosition = project_position(currPosition, currPosition64xyLow);\n\n  vec3 nextPosition = instanceEndPositions;\n  vec2 nextPosition64xyLow = instanceStartEndPositions64xyLow.zw;\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_AUTO_OFFSET) {\n    // In auto offset mode, add delta to low part of the positions for better precision\n    nextPosition64xyLow += mix(vec3(0.0), instanceRightDeltas, isEnd).xy;\n  } else {\n    nextPosition += mix(vec3(0.0), instanceRightDeltas, isEnd);\n  }\n  nextPosition = project_position(nextPosition, nextPosition64xyLow);\n\n  vec3 pos = lineJoin(prevPosition, currPosition, nextPosition);\n\n  gl_Position = project_to_clipspace(vec4(pos, 1.0));\n}\n",fs:hd,modules:["picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instanceStartPositions:{size:3,transition:bd,accessor:"getPath",update:this.calculateStartPositions,noAlloc:!0},instanceEndPositions:{size:3,transition:bd,accessor:"getPath",update:this.calculateEndPositions,noAlloc:!0},instanceStartEndPositions64xyLow:{size:4,update:this.calculateInstanceStartEndPositions64xyLow,noAlloc:!0},instanceLeftDeltas:{size:3,update:this.calculateLeftDeltas,noAlloc:!0},instanceRightDeltas:{size:3,update:this.calculateRightDeltas,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:bd,update:this.calculateStrokeWidths,defaultValue:1},instanceDashArrays:{size:2,accessor:"getDashArray",update:this.calculateDashArrays},instanceColors:{size:4,type:Hi.a.UNSIGNED_BYTE,accessor:"getColor",transition:bd,update:this.calculateColors,defaultValue:md},instancePickingColors:{size:3,type:Hi.a.UNSIGNED_BYTE,update:this.calculatePickingColors}}),this.setState({pathTesselator:new ld({})})}},{key:"updateState",value:function(t){var n=t.oldProps,r=t.props,i=t.changeFlags;vd(gd(e.prototype),"updateState",this).call(this,{props:r,oldProps:n,changeFlags:i});var o=this.getAttributeManager();if(r.fp64!==n.fp64){var a=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(a)}),o.invalidateAll()}(i.dataChanged||r.fp64!==n.fp64||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath))&&(this.state.pathTesselator.updateGeometry({data:r.data,getGeometry:r.getPath,fp64:this.use64bitPositions()}),this.setState({numInstances:this.state.pathTesselator.instanceCount}),o.invalidateAll())}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.rounded,i=n.miterLimit,o=n.widthScale,a=n.widthMinPixels,s=n.widthMaxPixels,u=n.dashJustified;this.state.model.render(Object.assign({},e,{jointType:Number(r),alignMode:Number(u),widthScale:o,miterLimit:i,widthMinPixels:a,widthMaxPixels:s}))}},{key:"_getModel",value:function(t){return new Gi.g(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new Gi.f({drawMode:Hi.a.TRIANGLES,attributes:{indices:new Uint16Array([0,2,1,1,2,4,1,4,3,3,4,5]),positions:new Float32Array([0,0,1,0,-1,0,0,1,0,1,-1,0,1,1,0,1,0,1])}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"calculateStartPositions",value:function(t){var e=this.state.pathTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get("startPositions")}},{key:"calculateEndPositions",value:function(t){var e=this.state.pathTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get("endPositions")}},{key:"calculateInstanceStartEndPositions64xyLow",value:function(t){var e=this.use64bitPositions();t.constant=!e,t.value=e?this.state.pathTesselator.get("startEndPositions64XyLow"):new Float32Array(4)}},{key:"calculateLeftDeltas",value:function(t){var e=this.state.pathTesselator;t.value=e.get("leftDeltas")}},{key:"calculateRightDeltas",value:function(t){var e=this.state.pathTesselator;t.value=e.get("rightDeltas")}},{key:"calculateStrokeWidths",value:function(t){var e=this.props.getWidth,n=this.state.pathTesselator;t.bufferLayout=n.bufferLayout,t.value=n.get("strokeWidths",t.value,e)}},{key:"calculateDashArrays",value:function(t){var e=this.props.getDashArray,n=this.state.pathTesselator;t.value=n.get("dashArrays",t.value,e)}},{key:"calculateColors",value:function(t){var e=this.props.getColor,n=this.state.pathTesselator;t.bufferLayout=n.bufferLayout,t.value=n.get("colors",t.value,e)}},{key:"calculatePickingColors",value:function(t){var e=this.state.pathTesselator;t.value=e.get("pickingColors",t.value,this.encodePickingColor)}}])&&dd(n.prototype,r),i&&dd(n,i),e}();function xd(t){return(xd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ed(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Od(t,e){return!e||"object"!==xd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pd(t){return(Pd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sd(t,e){return(Sd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}wd.layerName="PathLayer",wd.defaultProps=_d;var Td={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,lineDashJustified:!1,fp64:!1,getPolygon:{type:"accessor",value:function(t){return t.polygon}},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1},getLineDashArray:{type:"accessor",value:[0,0]},getElevation:{type:"accessor",value:1e3},lightSettings:{}},Cd=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Od(this,Pd(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sd(t,e)}(e,Kc),n=e,(r=[{key:"initializeState",value:function(){this.state={paths:[]}}},{key:"updateState",value:function(t){var e=this,n=(t.oldProps,t.props,t.changeFlags);if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){var r=this.props,i=r.data,o=r.getPolygon;this.state.paths=[];var a=!0,s=!1,u=void 0;try{for(var c,l=function(){var t=c.value;Ff(o(t)).forEach(function(n){return e.state.paths.push({path:n,object:t})})},h=i[Symbol.iterator]();!(a=(c=h.next()).done);a=!0)l()}catch(t){s=!0,u=t}finally{try{a||null==h.return||h.return()}finally{if(s)throw u}}}}},{key:"getPickingInfo",value:function(t){var e=t.info;return Object.assign(e,{object:e.object&&e.object.object||e.object})}},{key:"_getAccessor",value:function(t){return"function"==typeof t?function(e){return t(e.object)}:t}},{key:"renderLayers",value:function(){var t=this.props,e=t.data,n=t.stroked,r=t.filled,i=t.extruded,o=t.wireframe,a=t.elevationScale,s=t.transitions,u=this.props,c=u.lineWidthScale,l=u.lineWidthMinPixels,h=u.lineWidthMaxPixels,f=u.lineJointRounded,d=u.lineMiterLimit,p=u.lineDashJustified,v=u.fp64,g=this.props,y=g.getFillColor,m=g.getLineColor,_=g.getLineWidth,b=g.getLineDashArray,w=g.getElevation,x=g.getPolygon,E=g.updateTriggers,O=g.lightSettings,P=this.state.paths,S=P.length>0,T=S&&new nd(this.getSubLayerProps({id:"fill",updateTriggers:{getPolygon:E.getPolygon,getElevation:E.getElevation,getFillColor:E.getFillColor,getLineColor:E.getLineColor}}),{data:e,extruded:i,elevationScale:a,fp64:v,filled:r,wireframe:o,getPolygon:x,getElevation:w,getFillColor:y,getLineColor:m,lightSettings:O,transitions:s});return[!i&&T,!i&&n&&S&&new wd(this.getSubLayerProps({id:"stroke",updateTriggers:{getWidth:E.getLineWidth,getColor:E.getLineColor,getDashArray:E.getLineDashArray}}),{data:P,fp64:v,widthScale:c,widthMinPixels:l,widthMaxPixels:h,rounded:f,miterLimit:d,dashJustified:p,transitions:s&&{getWidth:s.getLineWidth,getColor:s.getLineColor,getPath:s.getPolygon},getPath:function(t){return t.path},getColor:this._getAccessor(m),getWidth:this._getAccessor(_),getDashArray:this._getAccessor(b)}),i&&T]}}])&&Ed(n.prototype,r),i&&Ed(n,i),e}();Cd.layerName="PolygonLayer",Cd.defaultProps=Td;function Ad(t){return(Ad="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Md(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function kd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jd(t,e){return!e||"object"!==Ad(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rd(t){return(Rd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ld(t,e){return(Ld=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Id=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),jd(this,Rd(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ld(t,e)}(e,pa),n=e,(r=[{key:"initializeState",value:function(){var t=this.context.gl,e=this.getAttributeManager(),n=this.getModel(t);e.add({indices:{size:1,update:this.calculateIndices,isIndexed:!0},positions:{size:3,update:this.calculatePositions},colors:{size:3,accessor:"getColor",update:this.calculateColors}}),t.getExtension("OES_element_index_uint"),this.setState({model:n})}},{key:"updateState",value:function(t){var e=t.props;t.changeFlags.dataChanged&&(this.countVertices(e.data),this.state.attributeManager.invalidateAll())}},{key:"getModel",value:function(t){return new Gi.g(t,{id:this.props.id,vs:"#define SHADER_NAME trips-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 colors;\n\nuniform float opacity;\nuniform float currentTime;\nuniform float trailLength;\n\nvarying float vTime;\nvarying vec4 vColor;\n\nvoid main(void) {\n  vec2 p = project_position(positions.xy);\n  // the magic de-flickering factor\n  vec4 shift = vec4(0., 0., mod(positions.z, trailLength) * 1e-4, 0.);\n\n  gl_Position = project_to_clipspace(vec4(p, 1., 1.)) + shift;\n\n  vColor = vec4(colors / 255.0, opacity);\n  vTime = 1.0 - (currentTime - positions.z) / trailLength;\n}\n",fs:"#define SHADER_NAME trips-layer-fragment-shader\n\nprecision highp float;\n\nvarying float vTime;\nvarying vec4 vColor;\n\nvoid main(void) {\n  if (vTime > 1.0 || vTime < 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(vColor.rgb, vColor.a * vTime);\n}\n",geometry:new Gi.f({id:this.props.id,drawMode:"LINES"}),vertexCount:0,isIndexed:!0,onBeforeRender:function(){t.enable(t.BLEND),t.enable(t.POLYGON_OFFSET_FILL),t.polygonOffset(2,1),t.blendFunc(t.SRC_ALPHA,t.ONE),t.blendEquation(t.FUNC_ADD)},onAfterRender:function(){t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.disable(t.POLYGON_OFFSET_FILL)}})}},{key:"countVertices",value:function(t){if(t){var e=this.props.getPath,n=0,r=t.reduce(function(t,r){var i=e(r).length;return n+=i,Md(t).concat([i])},[]);this.setState({pathLengths:r,vertexCount:n})}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.trailLength,i=n.currentTime;this.state.model.render(Object.assign({},e,{trailLength:r,currentTime:i}))}},{key:"calculateIndices",value:function(t){for(var e=this.state,n=e.pathLengths,r=2*(e.vertexCount-n.length),i=new Uint32Array(r),o=0,a=0,s=0;s<n.length;s++){var u=n[s];i[a++]=o;for(var c=1;c<u-1;c++)i[a++]=c+o,i[a++]=c+o;i[a++]=o+u-1,o+=u}t.value=i,this.state.model.setVertexCount(r)}},{key:"calculatePositions",value:function(t){for(var e=this.props,n=e.data,r=e.getPath,i=this.state.vertexCount,o=new Float32Array(3*i),a=0,s=0;s<n.length;s++)for(var u=r(n[s]),c=0;c<u.length;c++){var l=u[c];o[a++]=l[0],o[a++]=l[1],o[a++]=l[2]}t.value=o}},{key:"calculateColors",value:function(t){for(var e=this.props,n=e.data,r=e.getColor,i=this.state,o=i.pathLengths,a=i.vertexCount,s=new Float32Array(3*a),u=0,c=0;c<n.length;c++)for(var l=r(n[c]),h=o[c],f=0;f<h;f++)s[u++]=l[0],s[u++]=l[1],s[u++]=l[2];t.value=s}}])&&kd(n.prototype,r),i&&kd(n,i),e}();function Dd(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fd(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Id.layerName="TripsLayer",Id.defaultProps={trailLength:120,currentTime:0,getPath:function(t){return t.path},getColor:function(t){return t.color}};var Nd=function(t){var e,n;function i(e,n){var r;return Fd(Dd(Dd(r=t.call(this,e,n)||this)),"_animate",function(){var t=Date.now()/1e3,e={layers:[new Id({id:"trips",data:"https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/trips/trips.json",getPath:function(t){return t.segments},getColor:function(t){return 0===t.vendor?[253,128,93]:[23,184,190]},opacity:.3,strokeWidth:2,trailLength:180,currentTime:t%60/60*1800}),new Cd({id:"buildings",data:"https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/trips/buildings.json",extruded:!0,wireframe:!1,fp64:!0,opacity:.5,getPolygon:function(t){return t.polygon},getElevation:function(t){return t.height},getFillColor:[74,80,87],lightSettings:{lightsPosition:[-74.05,40.7,8e3,-73.5,41,5e3],ambientRatio:.05,diffuseRatio:.6,specularRatio:.8,lightsStrength:[2,0,0,0],numberOfLights:2}})]};r.inited?r.deckLayer&&r.deckLayer.setProps(e):(r.inited=!0,r.deckLayer=new Qh("deck",e,{animation:!0,renderer:"webgl"}),r.map.addLayer(r.deckLayer)),window.requestAnimationFrame(r._animate)}),Fd(Dd(Dd(r)),"setRef",function(t){void 0===t&&(t=null),r.container=t}),r.state={zoom:14,fov:0,pitch:0,bearing:0},r.container=null,r.map=null,r.inited=!1,r.deckLayer=null,r}n=t,(e=i).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var o=i.prototype;return o.componentDidMount=function(){this.map=new ji.c(this.container,{center:[-74,40.72],zoom:13,pitch:40.5,bearing:0,centerCross:!0,baseLayer:new ji.d("tile",{urlTemplate:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png",subdomains:["a","b","c","d"]})}),this._animate()},o.componentWillUnmount=function(){this.deckLayer&&this.deckLayer.remove()},o.render=function(){return r.createElement("div",{ref:this.setRef,className:"map-content"})},i}(r.Component);function Bd(t,e){if(!t)throw new Error("deck.gl: ".concat(e))}function Ud(t,e,n){var r=t.type,i=t.coordinates,o=e.pointFeatures,a=e.lineFeatures,s=e.polygonFeatures,u=e.polygonOutlineFeatures;switch(function(t,e){var n=Gd[t];Bd(n,"Unknown GeoJSON type ".concat(t));for(;e&&--n>0;)e=e[0];Bd(e&&Number.isFinite(e[0]),"".concat(t," coordinates are malformed"))}(r,i),r){case"Point":o.push({geometry:t,sourceFeature:n});break;case"MultiPoint":i.forEach(function(t){o.push({geometry:{type:"Point",coordinates:t},sourceFeature:n})});break;case"LineString":a.push({geometry:t,sourceFeature:n});break;case"MultiLineString":i.forEach(function(t){a.push({geometry:{type:"LineString",coordinates:t},sourceFeature:n})});break;case"Polygon":s.push({geometry:t,sourceFeature:n}),i.forEach(function(t){u.push({geometry:{type:"LineString",coordinates:t},sourceFeature:n})});break;case"MultiPolygon":i.forEach(function(t){s.push({geometry:{type:"Polygon",coordinates:t},sourceFeature:n}),t.forEach(function(t){u.push({geometry:{type:"LineString",coordinates:t},sourceFeature:n})})})}}function zd(t){return t.sourceFeature.feature}var Gd={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function Vd(t){return(Vd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zd(t,e){return!e||"object"!==Vd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hd(t){return(Hd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xd(t,e){return(Xd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yd={stroked:!0,filled:!0,extruded:!1,wireframe:!1,lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,elevationScale:1,pointRadiusScale:1,pointRadiusMinPixels:0,pointRadiusMaxPixels:Number.MAX_SAFE_INTEGER,lineDashJustified:!1,fp64:!1,getLineColor:{type:"accessor",value:[0,0,0,255]},getFillColor:{type:"accessor",value:[0,0,0,255]},getRadius:{type:"accessor",value:1},getLineWidth:{type:"accessor",value:1},getLineDashArray:{type:"accessor",value:[0,0]},getElevation:{type:"accessor",value:1e3},subLayers:{PointLayer:wf,LineLayer:wd,PolygonLayer:nd},lightSettings:{}};function Jd(t){return t.geometry.coordinates}function qd(t){return"function"!=typeof t?t:function(e){return t(zd(e))}}var Qd=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Zd(this,Hd(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xd(t,e)}(e,Kc),n=e,(r=[{key:"initializeState",value:function(){this.state={features:{}}}},{key:"updateState",value:function(t){t.oldProps;var e=t.props;if(t.changeFlags.dataChanged){var n=function(t){if(Array.isArray(t))return t;switch(Bd(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return Bd(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}(e.data);this.state.features=function(t){for(var e={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},n=0;n<t.length;n++){var r=t[n];Bd(r&&r.geometry,"GeoJSON does not have geometry");var i=r.geometry,o={feature:r,index:n};if("GeometryCollection"===i.type){Bd(Array.isArray(i.geometries),"GeoJSON does not have geometries array");for(var a=i.geometries,s=0;s<a.length;s++)Ud(a[s],e,o)}else Ud(i,e,o)}return e}(n)}}},{key:"getPickingInfo",value:function(t){var e,n=t.info;t.sourceLayer;return Object.assign(n,{object:n.object?zd(n.object):n.object,index:n.object?(e=n.object,e.sourceFeature.index):n.index})}},{key:"renderLayers",value:function(){var t=this.state.features,e=t.pointFeatures,n=t.lineFeatures,r=t.polygonFeatures,i=t.polygonOutlineFeatures,o=this.props,a=o.stroked,s=o.filled,u=o.extruded,c=o.wireframe,l=o.subLayers,h=o.lightSettings,f=o.transitions,d=this.props,p=d.lineWidthScale,v=d.lineWidthMinPixels,g=d.lineWidthMaxPixels,y=d.lineJointRounded,m=d.lineMiterLimit,_=d.pointRadiusScale,b=d.pointRadiusMinPixels,w=d.pointRadiusMaxPixels,x=d.elevationScale,E=d.lineDashJustified,O=d.fp64,P=this.props,S=P.getLineColor,T=P.getFillColor,C=P.getRadius,A=P.getLineWidth,M=P.getLineDashArray,k=P.getElevation,j=P.updateTriggers,R=e&&e.length>0,L=n&&n.length>0,I=i&&i.length>0,D=r&&r.length>0&&new l.PolygonLayer(this.getSubLayerProps({id:"polygon-fill",updateTriggers:{getElevation:j.getElevation,getFillColor:j.getFillColor,getLineColor:j.getLineColor}}),{data:r,fp64:O,extruded:u,elevationScale:x,filled:s,wireframe:c,lightSettings:h,getPolygon:Jd,getElevation:qd(k),getFillColor:qd(T),getLineColor:qd(S),transitions:f&&{getPolygon:f.geometry,getElevation:f.getElevation,getFillColor:f.getFillColor,getLineColor:f.getLineColor}});return[!u&&D,!u&&a&&I&&new l.LineLayer(this.getSubLayerProps({id:"polygon-outline",updateTriggers:{getColor:j.getLineColor,getWidth:j.getLineWidth,getDashArray:j.getLineDashArray}}),{data:i,fp64:O,widthScale:p,widthMinPixels:v,widthMaxPixels:g,rounded:y,miterLimit:m,dashJustified:E,getPath:Jd,getColor:qd(S),getWidth:qd(A),getDashArray:qd(M),transitions:f&&{getPath:f.geometry,getColor:f.getLineColor,getWidth:f.getLineWidth}}),L&&new l.LineLayer(this.getSubLayerProps({id:"line-paths",updateTriggers:{getColor:j.getLineColor,getWidth:j.getLineWidth,getDashArray:j.getLineDashArray}}),{data:n,fp64:O,widthScale:p,widthMinPixels:v,widthMaxPixels:g,rounded:y,miterLimit:m,dashJustified:E,getPath:Jd,getColor:qd(S),getWidth:qd(A),getDashArray:qd(M),transitions:f&&{getPath:f.geometry,getColor:f.getLineColor,getWidth:f.getLineWidth}}),R&&new l.PointLayer(this.getSubLayerProps({id:"points",updateTriggers:{getColor:j.getFillColor,getRadius:j.getRadius}}),{data:e,fp64:O,radiusScale:_,radiusMinPixels:b,radiusMaxPixels:w,getPosition:Jd,getColor:qd(T),getRadius:qd(C),transitions:f&&{getPosition:f.geometry,getColor:f.getFillColor,getRadius:f.getRadius}}),u&&D]}}])&&Wd(n.prototype,r),i&&Wd(n,i),e}();function Kd(){return(Kd=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function $d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tp(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Qd.layerName="GeoJsonLayer",Qd.defaultProps=Yd;var ep=function t(){var e=[.5],n=[0,1],r=1;function i(t){if(t<=t)return n[Pt(e,t,0,r)]}return i.domain=function(t){return arguments.length?(e=It.call(t),r=Math.min(e.length,n.length-1),i):e.slice()},i.range=function(t){return arguments.length?(n=It.call(t),r=Math.min(e.length,n.length-1),i):n.slice()},i.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},i.copy=function(){return t().domain(e).range(n)},i}().domain([0,4,8,12,20,32,52,84,136,220]).range([[26,152,80],[102,189,99],[166,217,106],[217,239,139],[255,255,191],[254,224,139],[253,174,97],[244,109,67],[215,48,39],[168,0,0]]),np=jn().clamp(!0).domain([0,200]).range([10,2e3]),rp=function(t){var e,i;function o(e,n){var r;return tp($d($d(r=t.call(this,e,n)||this)),"_aggregateAccidents",function(t){var e={},n={};return t&&t.forEach(function(t){var i=e[t.year]=e[t.year]||{},o=n[t.year]=n[t.year]||{},a=r.getKey(t);i[a]=t.incidents,o[a]=t.fatalities}),{incidents:e,fatalities:n}}),tp($d($d(r)),"_getLineColor",function(t,e){if(!e)return[200,200,200];var n=(e[r.getKey(t.properties)]||0)/t.properties.length*1e3;return ep(n)}),tp($d($d(r)),"_getLineWidth",function(t,e){if(!e)return 10;var n=(e[r.getKey(t.properties)]||0)/t.properties.length*1e3;return np(n)}),tp($d($d(r)),"formatRow",function(t){return Kd({},t,{incidents:Number(t.incidents),fatalities:Number(t.fatalities)})}),tp($d($d(r)),"setRef",function(t){void 0===t&&(t=null),r.container=t}),r.state={zoom:14,fov:0,pitch:0,bearing:0},r.container=null,r.map=null,r.inited=!1,r.deckLayer=null,r}i=t,(e=o).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var a=o.prototype;return a.componentDidMount=function(){var t=this;this.map=new ji.c(this.container,{center:[-100,38],zoom:6.6,pitch:40.5,bearing:-27.396674584323023,centerCross:!0,spatialReference:{projection:"EPSG:3857"},baseLayer:new ji.d("tile",{urlTemplate:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png",subdomains:["a","b","c","d"],spatialReference:{projection:"EPSG:3857"}})}),n("DRYM").csv("https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/highway/accidents.csv",this.formatRow,function(e,n){var r=n[0].year,i=n;if(!e){var o=t._aggregateAccidents(i),a=o.fatalities,s=o.incidents;t.deckLayer=new Qh("deck",{layers:[new Qd({id:"geojson",data:"https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/highway/roads.json",opacity:1,stroked:!1,filled:!1,lineWidthMinPixels:.5,parameters:{depthTest:!1},getLineColor:function(e){return t._getLineColor(e,a[r])},getLineWidth:function(e){return t._getLineWidth(e,s[r])},pickable:!0,updateTriggers:{getLineColor:{year:r},getLineWidth:{year:r}},transitions:{getLineColor:1e3,getLineWidth:1e3}})]},{animation:!0,renderer:"webgl"}),t.map.addLayer(t.deckLayer)}})},a.componentWillUnmount=function(){this.deckLayer&&this.deckLayer.remove()},a.getKey=function(t){return t.state+"-"+t.type+"-"+t.id},a.render=function(){return r.createElement("div",{ref:this.setRef,className:"map-content"})},o}(r.Component);function ip(t){return(ip="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function op(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ap(t,e){return!e||"object"!==ip(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sp(t,e,n){return(sp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=up(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function up(t){return(up=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cp(t,e){return(cp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lp=Gi.s.fp64LowPart,hp=[255,0,255,255],fp={hexagonVertices:null,radius:null,angle:null,coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},extruded:!0,fp64:!1,getCentroid:{type:"accessor",value:function(t){return t.centroid}},getColor:{type:"accessor",value:hp},getElevation:{type:"accessor",value:1e3},lightSettings:{}},dp=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=!1;return t.hexagonVertices||t.radius&&Number.isFinite(t.angle)?t.hexagonVertices&&(!Array.isArray(t.hexagonVertices)||t.hexagonVertices.length<6)&&(Ni.a.once(0,"HexagonCellLayer: hexagonVertices needs to be an array of 6 points")(),n=!0):(Ni.a.once(0,"HexagonCellLayer: Either hexagonVertices or radius and angle are needed to calculate primitive hexagon.")(),n=!0),n&&(Ni.a.once(0,"Now using 1000 meter as default radius, 0 as default angle")(),t.radius=1e3,t.angle=0),ap(this,up(e).call(this,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cp(t,e)}(e,pa),n=e,(r=[{key:"getShaders",value:function(){return{vs:"\n#define SHADER_NAME hexagon-cell-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 normals;\n\nattribute vec2 instancePositions;\nattribute float instanceElevations;\nattribute vec2 instancePositions64xyLow;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\n// Custom uniforms\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform float extruded;\nuniform float coverage;\nuniform float elevationScale;\n\n// Result\nvarying vec4 vColor;\n\n// A magic number to scale elevation so that 1 unit approximate to 1 meter.\n#define ELEVATION_SCALE 0.8\n\nvoid main(void) {\n\n  // rotate primitive position and normal\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n\n  // calculate elevation, if 3d not enabled set to 0\n  // cylindar gemoetry height are between -0.5 to 0.5, transform it to between 0, 1\n  float elevation = 0.0;\n\n  if (extruded > 0.5) {\n    elevation = instanceElevations * (positions.z + 0.5) *\n      ELEVATION_SCALE * elevationScale;\n  }\n\n  // if ahpha == 0.0 or z < 0.0, do not render element\n  float noRender = float(instanceColors.a == 0.0 || instanceElevations < 0.0);\n  float dotRadius = project_scale(radius) * mix(coverage, 0.0, noRender);\n\n  // project center of hexagon\n  vec3 centroidPosition = vec3(instancePositions, elevation);\n  vec2 centroidPosition64xyLow = instancePositions64xyLow;\n  vec3 offset = vec3(rotationMatrix * positions.xy * dotRadius, 0.);\n\n  vec4 position_worldspace;\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64xyLow, offset, position_worldspace);\n\n  // Light calculations\n  // Worldspace is the linear space after Mercator projection\n\n  vec3 normals_worldspace = vec3(rotationMatrix * normals.xy, normals.z);\n\n  float lightWeight = 1.0;\n\n  if (extruded > 0.5) {\n    lightWeight = lighting_getLightWeight(\n      position_worldspace.xyz, // the w component is always 1.0\n      normals_worldspace\n    );\n  }\n\n  vec3 lightWeightedColor = lightWeight * instanceColors.rgb;\n\n  // opacity-multiplied instance color\n  vColor = vec4(lightWeightedColor, opacity * instanceColors.a) / 255.0;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:"#define SHADER_NAME hexagon-cell-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","lighting","picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:2,transition:!0,accessor:"getCentroid"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instancePositions64xyLow:{size:2,accessor:"getCentroid",update:this.calculateInstancePositions64xyLow},instanceColors:{size:4,type:Hi.a.UNSIGNED_BYTE,transition:!0,accessor:"getColor",defaultValue:hp}})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(sp(up(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}n.hexagonVertices===r.hexagonVertices&&n.radius===r.radius&&n.angle===r.angle||this.updateRadiusAngle()}},{key:"updateRadiusAngle",value:function(){var t=this.props,e=t.angle,n=t.radius,r=this.props.hexagonVertices;if(Array.isArray(r)&&r.length>=6){var i=this.props.hexagonVertices,o=i[0],a=i[3],s=this.context.viewport.getDistanceScales().pixelsPerMeter,u=this.projectFlat(o),c=this.projectFlat(a),l=u[0]-c[0],h=u[1]-c[1],f=Math.sqrt(l*l+h*h);e=Math.acos(l/f)*-Math.sign(h)+Math.PI/2,n=f/2/s[0]}this.setState({angle:e,radius:n})}},{key:"getCylinderGeometry",value:function(t){return new Gi.c({radius:t,topRadius:t,bottomRadius:t,topCap:!0,bottomCap:!0,height:1,verticalAxis:"z",nradial:6,nvertical:1})}},{key:"_getModel",value:function(t){return new Gi.g(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:this.getCylinderGeometry(1),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.elevationScale,i=n.extruded,o=n.coverage,a=this.state,s=a.radius,u=a.angle;this.state.model.render(Object.assign({},e,{radius:s,angle:u,extruded:i,coverage:o,elevationScale:r}))}},{key:"calculateInstancePositions64xyLow",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getCentroid,o=t.value,a=0,s=!0,u=!1,c=void 0;try{for(var l,h=r[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=i(l.value);o[a++]=lp(f[0]),o[a++]=lp(f[1])}}catch(t){u=!0,c=t}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}}else t.value=new Float32Array(2)}}])&&op(n.prototype,r),i&&op(n,i),e}();dp.layerName="HexagonCellLayer",dp.defaultProps=fp;var pp=Math.PI/3,vp=[0,pp,2*pp,3*pp,4*pp,5*pp];function gp(t){return t[0]}function yp(t){return t[1]}var mp=function(){var t,e,n,r=0,i=0,o=1,a=1,s=gp,u=yp;function c(t){var r,i={},o=[],a=t.length;for(r=0;r<a;++r)if(!isNaN(l=+s.call(null,c=t[r],r,t))&&!isNaN(h=+u.call(null,c,r,t))){var c,l,h,f=Math.round(h/=n),d=Math.round(l=l/e-(1&f)/2),p=h-f;if(3*Math.abs(p)>1){var v=l-d,g=d+(l<d?-1:1)/2,y=f+(h<f?-1:1),m=l-g,_=h-y;v*v+p*p>m*m+_*_&&(d=g+(1&f?1:-1)/2,f=y)}var b=d+"-"+f,w=i[b];w?w.push(c):(o.push(w=i[b]=[c]),w.x=(d+(1&f)/2)*e,w.y=f*n)}return o}function l(t){var e=0,n=0;return vp.map(function(r){var i=Math.sin(r)*t,o=-Math.cos(r)*t,a=i-e,s=o-n;return e=i,n=o,[a,s]})}return c.hexagon=function(e){return"m"+l(null==e?t:+e).join("l")+"z"},c.centers=function(){for(var s=[],u=Math.round(i/n),c=Math.round(r/e),l=u*n;l<a+t;l+=n,++u)for(var h=c*e+(1&u)*e/2;h<o+e/2;h+=e)s.push([h,l]);return s},c.mesh=function(){var e=l(t).slice(0,4).join("l");return c.centers().map(function(t){return"M"+t+"m"+e}).join("")},c.x=function(t){return arguments.length?(s=t,c):s},c.y=function(t){return arguments.length?(u=t,c):u},c.radius=function(r){return arguments.length?(e=2*(t=+r)*Math.sin(pp),n=1.5*t,c):t},c.size=function(t){return arguments.length?(r=i=0,o=+t[0],a=+t[1],c):[o-r,a-i]},c.extent=function(t){return arguments.length?(r=+t[0][0],i=+t[0][1],o=+t[1][0],a=+t[1][1],c):[[r,i],[o,a]]},c.radius(1)};function _p(t){return(_p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wp(t,e){return!e||"object"!==_p(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xp(t,e,n){return(xp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ep(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Ep(t){return(Ep=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Op(t,e){return(Op=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pp=Hh.BinSorter,Sp=Hh.getQuantizeScale,Tp=Hh.getLinearScale;function Cp(){}var Ap={colorDomain:null,colorRange:Hh.defaultColorRange,getColorValue:{type:"accessor",value:function(t){return t.length}},lowerPercentile:{type:"number",value:0,min:0,max:100},upperPercentile:{type:"number",value:100,min:0,max:100},onSetColorDomain:Cp,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:function(t){return t.length}},elevationLowerPercentile:{type:"number",value:0,min:0,max:100},elevationUpperPercentile:{type:"number",value:100,min:0,max:100},elevationScale:{type:"number",min:0,value:1},onSetElevationDomain:Cp,radius:{type:"number",value:1e3,min:1},coverage:{type:"number",min:0,max:1,value:1},extruded:!1,hexagonAggregator:function(t,e){var n=t.data,r=t.radius,i=t.getPosition,o=function(t,e){var n=e.getDistanceScales().pixelsPerMeter;return t*n[0]}(r,e),a=[],s=!0,u=!1,c=void 0;try{for(var l,h=n[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value;a.push(Object.assign({screenCoord:e.projectFlat(i(f))},f))}}catch(t){u=!0,c=t}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}return{hexagons:mp().radius(o).x(function(t){return t.screenCoord[0]}).y(function(t){return t.screenCoord[1]})(a).map(function(t,n){return{centroid:e.unprojectFlat([t.x,t.y]),points:t,index:n}})}},getPosition:{type:"accessor",value:function(t){return t.position}},fp64:!1,lightSettings:{}},Mp=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.hexagonAggregator||t.radius||(Ni.a.once(0,"HexagonLayer: Default hexagonAggregator requires radius prop to be set, Now using 1000 meter as default")(),t.radius=Ap.radius.value),Number.isFinite(t.upperPercentile)&&(t.upperPercentile>100||t.upperPercentile<0)&&(Ni.a.once(0,"HexagonLayer: upperPercentile should be between 0 and 100. Assign to 100 by default")(),t.upperPercentile=Ap.upperPercentile.value),Number.isFinite(t.lowerPercentile)&&(t.lowerPercentile>100||t.lowerPercentile<0)&&(Ni.a.once(0,"HexagonLayer: lowerPercentile should be between 0 and 100. Assign to 0 by default")(),t.lowerPercentile=Ap.upperPercentile.value),t.lowerPercentile>=t.upperPercentile&&(Ni.a.once(0,"HexagonLayer: lowerPercentile should not be bigger than upperPercentile. Assign to 0 by default")(),t.lowerPercentile=Ap.lowerPercentile.value),wp(this,Ep(e).call(this,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Op(t,e)}(e,Kc),n=e,(r=[{key:"initializeState",value:function(){this.state={hexagons:[],hexagonVertices:null,sortedColorBins:null,sortedElevationBins:null,colorValueDomain:null,elevationValueDomain:null,colorScaleFunc:Cp,elevationScaleFunc:Cp,dimensionUpdaters:this.getDimensionUpdaters()}}},{key:"updateState",value:function(t){var e=this,n=t.oldProps,r=t.props,i=t.changeFlags,o=this.getDimensionChanges(n,r);i.dataChanged||this.needsReProjectPoints(n,r)?this.getHexagons():o&&o.forEach(function(t){return"function"==typeof t&&t.apply(e)})}},{key:"needsReProjectPoints",value:function(t,e){return t.radius!==e.radius||t.hexagonAggregator!==e.hexagonAggregator}},{key:"getDimensionUpdaters",value:function(){return{getColor:[{id:"value",triggers:["getColorValue"],updater:this.getSortedColorBins},{id:"domain",triggers:["lowerPercentile","upperPercentile"],updater:this.getColorValueDomain},{id:"scaleFunc",triggers:["colorDomain","colorRange"],updater:this.getColorScale}],getElevation:[{id:"value",triggers:["getElevationValue"],updater:this.getSortedElevationBins},{id:"domain",triggers:["elevationLowerPercentile","elevationUpperPercentile"],updater:this.getElevationValueDomain},{id:"scaleFunc",triggers:["elevationDomain","elevationRange"],updater:this.getElevationScale}]}}},{key:"getDimensionChanges",value:function(t,e){var n=this.state.dimensionUpdaters,r=[];for(var i in n){var o=n[i].find(function(n){return n.triggers.some(function(n){return t[n]!==e[n]})});o&&r.push(o.updater)}return r.length?r:null}},{key:"getHexagons",value:function(){var t=this.props.hexagonAggregator,e=this.context.viewport,n=t(this.props,e),r=n.hexagons,i=n.hexagonVertices;this.setState({hexagons:r,hexagonVertices:i}),this.getSortedBins()}},{key:"getPickingInfo",value:function(t){var e=t.info,n=this.state,r=n.sortedColorBins,i=n.sortedElevationBins,o=null;if(e.picked&&e.index>-1){var a=this.state.hexagons[e.index],s=r.binMap[a.index]&&r.binMap[a.index].value,u=i.binMap[a.index]&&i.binMap[a.index].value;o=Object.assign({colorValue:s,elevationValue:u},a)}return Object.assign(e,{picked:Boolean(o),object:o})}},{key:"getUpdateTriggers",value:function(){var t=this,e=this.state.dimensionUpdaters,n={},r=function(r){n[r]={};var i=!0,o=!1,a=void 0;try{for(var s,u=e[r][Symbol.iterator]();!(i=(s=u.next()).done);i=!0){s.value.triggers.forEach(function(e){n[r][e]=t.props[e]})}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}};for(var i in e)r(i);return n}},{key:"getValueDomain",value:function(){this.getColorValueDomain(),this.getElevationValueDomain()}},{key:"getSortedBins",value:function(){this.getSortedColorBins(),this.getSortedElevationBins()}},{key:"getSortedColorBins",value:function(){var t=this.props.getColorValue,e=new Pp(this.state.hexagons||[],t);this.setState({sortedColorBins:e}),this.getColorValueDomain()}},{key:"getSortedElevationBins",value:function(){var t=this.props.getElevationValue,e=new Pp(this.state.hexagons||[],t);this.setState({sortedElevationBins:e}),this.getElevationValueDomain()}},{key:"getColorValueDomain",value:function(){var t=this.props,e=t.lowerPercentile,n=t.upperPercentile,r=t.onSetColorDomain;this.state.colorValueDomain=this.state.sortedColorBins.getValueRange([e,n]),"function"==typeof r&&r(this.state.colorValueDomain),this.getColorScale()}},{key:"getElevationValueDomain",value:function(){var t=this.props,e=t.elevationLowerPercentile,n=t.elevationUpperPercentile,r=t.onSetElevationDomain;this.state.elevationValueDomain=this.state.sortedElevationBins.getValueRange([e,n]),"function"==typeof r&&r(this.state.elevationValueDomain),this.getElevationScale()}},{key:"getColorScale",value:function(){var t=this.props.colorRange,e=this.props.colorDomain||this.state.colorValueDomain;this.state.colorScaleFunc=Sp(e,t)}},{key:"getElevationScale",value:function(){var t=this.props.elevationRange,e=this.props.elevationDomain||this.state.elevationValueDomain;this.state.elevationScaleFunc=Tp(e,t)}},{key:"_onGetSublayerColor",value:function(t){var e=this.state,n=e.sortedColorBins,r=e.colorScaleFunc,i=e.colorValueDomain,o=n.binMap[t.index]&&n.binMap[t.index].value,a=this.props.colorDomain||i,s=o>=a[0]&&o<=a[a.length-1]?r(o):[0,0,0,0];return s[3]=Number.isFinite(s[3])?s[3]:255,s}},{key:"_onGetSublayerElevation",value:function(t){var e=this.state,n=e.sortedElevationBins,r=e.elevationScaleFunc,i=e.elevationValueDomain,o=n.binMap[t.index]&&n.binMap[t.index].value,a=this.props.elevationDomain||i;return o>=a[0]&&o<=a[a.length-1]?r(o):-1}},{key:"getSubLayerProps",value:function(){var t=this.props,n=t.radius,r=t.elevationScale,i=t.extruded,o=t.coverage,a=t.lightSettings,s=t.fp64,u=t.transitions;return xp(Ep(e.prototype),"getSubLayerProps",this).call(this,{id:"hexagon-cell",data:this.state.hexagons,fp64:s,hexagonVertices:this.state.hexagonVertices,radius:n,elevationScale:r,angle:Math.PI/2,extruded:i,coverage:o,lightSettings:a,getColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:u&&{getColor:u.getColorValue,getElevation:u.getElevationValue},updateTriggers:this.getUpdateTriggers()})}},{key:"getSubLayerClass",value:function(){return dp}},{key:"renderLayers",value:function(){return new(this.getSubLayerClass())(this.getSubLayerProps())}}])&&bp(n.prototype,r),i&&bp(n,i),e}();function kp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}Mp.layerName="HexagonLayer",Mp.defaultProps=Ap;var jp={lightsPosition:[-.144528,49.739968,8e3,-3.807751,54.104682,8e3],ambientRatio:.4,diffuseRatio:.6,specularRatio:.2,lightsStrength:[.8,0,.8,0],numberOfLights:2},Rp=[[1,152,189],[73,227,206],[216,254,181],[254,237,177],[254,173,84],[209,55,78]],Lp={min:1,max:50},Ip=function(t){var e,i;function o(e,n){var r,i,o,a;return r=t.call(this,e,n)||this,i=kp(kp(r)),a=function(t){void 0===t&&(t=null),r.container=t},(o="setRef")in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,r.state={zoom:14,fov:0,pitch:0,bearing:0},r.container=null,r.map=null,r.deckLayer=null,r.state={elevationScale:Lp.min},r.startAnimationTimer=null,r.intervalTimer=null,r._startAnimate=r._startAnimate.bind(kp(kp(r))),r._animateHeight=r._animateHeight.bind(kp(kp(r))),r}i=t,(e=o).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var a=o.prototype;return a.componentDidMount=function(){var t=this;this.map=new ji.c(this.container,{center:[-1.4157267858730052,52.232395363869415],zoom:7,pitch:40.5,bearing:-27.396674584323023,centerCross:!0,baseLayer:new ji.d("tile",{urlTemplate:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png",subdomains:["a","b","c","d"]})}),n("DRYM").csv("https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/3d-heatmap/heatmap-data.csv",function(e,n){if(!e){var r=n.map(function(t){return[Number(t.lng),Number(t.lat)]});t._animate(r)}})},a._animate=function(t){this.setState({data:t}),this._stopAnimate(),this.startAnimationTimer=window.setTimeout(this._startAnimate,1500)},a._startAnimate=function(){this.intervalTimer=window.setInterval(this._animateHeight,20)},a._stopAnimate=function(){window.clearTimeout(this.startAnimationTimer),window.clearTimeout(this.intervalTimer)},a._animateHeight=function(){this.state.elevationScale===Lp.max?this._stopAnimate():this.setState({elevationScale:this.state.elevationScale+1})},a._renderLayers=function(){var t=this.state,e=t.data,n=t.radius,r=void 0===n?1e3:n,i=t.upperPercentile,o=void 0===i?100:i,a=t.coverage;if(e){var s={layers:[new Mp({id:"heatmap",colorRange:Rp,coverage:void 0===a?1:a,data:e,elevationRange:[0,3e3],elevationScale:this.state.elevationScale,extruded:!0,getPosition:function(t){return t},lightSettings:jp,onHover:this.props.onHover,opacity:1,pickable:Boolean(this.props.onHover),radius:r,upperPercentile:o})]};this.inited?this.deckLayer&&this.deckLayer.setProps(s):(this.inited=!0,this.deckLayer=new Qh("deck",s,{animation:!0,renderer:"webgl"}),this.map.addLayer(this.deckLayer))}},a.componentWillUnmount=function(){this.deckLayer&&this.deckLayer.remove()},a.render=function(){return this._renderLayers(),r.createElement("div",{ref:this.setRef,className:"map-content"})},o}(r.Component),Dp=Hh.BinSorter,Fp=Hh.linearScale,Np=Hh.getLinearScale,Bp=Hh.quantizeScale,Up=Hh.getQuantizeScale,zp=Hh.defaultColorRange,Gp=Hh.flattenVertices,Vp=Hh.fillArray;function Wp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.assign({},{BinSorter:Dp,linearScale:Fp,getLinearScale:Np,quantizeScale:Bp,getQuantizeScale:Up,defaultColorRange:zp,flattenVertices:Gp,fillArray:Vp});var Zp=function(){function t(e){var n=e.getTileData,r=e.x,i=e.y,o=e.z,a=e.onGetTileDataError;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=r,this.y=i,this.z=o,this.isVisible=!0,this.getTileData=n,this._data=null,this._isLoaded=!1,this._loader=this._loadData(),this.onGetTileDataError=a}var e,n,r;return e=t,(n=[{key:"_loadData",value:function(){var t=this,e=this.x,n=this.y,r=this.z;return this.getTileData?this.getTileData({x:e,y:n,z:r}).then(function(e){return t._data=e,t._isLoaded=!0,e}).catch(function(e){t._isLoaded=!0,t.onGetTileDataError(e)}):null}},{key:"isOverlapped",value:function(t){var e=this.x,n=this.y,r=this.z,i=Math.pow(2,t.z-r);return Math.floor(t.x/i)===e&&Math.floor(t.y/i)===n}},{key:"data",get:function(){return this._data?Promise.resolve(this._data):this._loader}},{key:"isLoaded",get:function(){return this._isLoaded}}])&&Wp(e.prototype,n),r&&Wp(e,r),t}();function Hp(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Xp(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Yp=512;function Jp(t){return Math.floor(t/Yp)}function qp(t,e,n){var r=Math.floor(t.zoom);if(n&&r<n)return[];for(var i=function(t){var e=[t.unproject([0,0]),t.unproject([t.width,0]),t.unproject([0,t.height]),t.unproject([t.width,t.height])];return[e.reduce(function(t,e){return t<e[0]?t:e[0]},180),e.reduce(function(t,e){return t<e[1]?t:e[1]},90),e.reduce(function(t,e){return t>e[0]?t:e[0]},-180),e.reduce(function(t,e){return t>e[1]?t:e[1]},-90)]}(t=new t.constructor(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){Xp(t,e,n[e])})}return t}({},t,{zoom:r}))),o=Hp(Object(aa.g)([i[0],i[3]],t.scale).map(Jp),2),a=o[0],s=o[1],u=Hp(Object(aa.g)([i[2],i[1]],t.scale).map(Jp),2),c=u[0],l=u[1],h=[],f=a;f<=c;f++)for(var d=s;d<=l;d++)e&&r>e?h.push(Qp({x:f,y:d,z:r},e)):h.push({x:f,y:d,z:r});return h}function Qp(t,e){var n=t.x,r=t.y,i=t.z,o=Math.pow(2,i-e);return{x:Math.floor(n/o),y:Math.floor(r/o),z:e}}function Kp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $p=function(){function t(e){var n=e.getTileData,r=e.maxSize,i=e.maxZoom,o=e.minZoom,a=e.onGetTileDataError;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._getTileData=n,this._maxSize=r,this.onGetTileDataError=a,this._cache=new Map,i&&parseInt(i,10)===i&&(this._maxZoom=i),o&&parseInt(o,10)===o&&(this._minZoom=o)}var e,n,r;return e=t,(n=[{key:"finalize",value:function(){this._cache.clear()}},{key:"update",value:function(t,e){var n=this._cache,r=this._getTileData,i=this._maxSize,o=this._maxZoom,a=this._minZoom;this._markOldTiles();var s=qp(t,o,a);if(s&&0!==s.length){var u=new Set;n.forEach(function(t){s.some(function(e){return t.isOverlapped(e)})&&(t.isVisible=!0,u.add(t))});for(var c=0;c<s.length;c++){var l=s[c],h=l.x,f=l.y,d=l.z,p=this._getTile(h,f,d);p||(p=new Zp({getTileData:r,x:h,y:f,z:d,onGetTileDataError:this.onGetTileDataError}));var v=this._getTileId(h,f,d);n.set(v,p),u.add(p)}this._resizeCache(i||5*s.length),e(Array.from(u).sort(function(t,e){return t.z-e.z}))}else e(s)}},{key:"_resizeCache",value:function(t){var e=this._cache;if(e.size>t){var n=e[Symbol.iterator](),r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(e.size<=t)break;var c=u[0];u[1].isVisible||e.delete(c)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}}},{key:"_markOldTiles",value:function(){this._cache.forEach(function(t){t.isVisible=!1})}},{key:"_getTile",value:function(t,e,n){var r=this._getTileId(t,e,n);return this._cache.get(r)}},{key:"_getTileId",value:function(t,e,n){return"".concat(n,"-").concat(t,"-").concat(e)}}])&&Kp(e.prototype,n),r&&Kp(e,r),t}();function tv(t){return(tv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ev(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nv(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function rv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function iv(t,e){return!e||"object"!==tv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ov(t){return(ov=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function av(t,e){return(av=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sv={renderSubLayers:function(t){return new Qd(t)},getTileData:function(t){t.x,t.y,t.z;return Promise.resolve(null)},onDataLoaded:function(){},onGetTileDataError:function(t){return console.error(t)},maxZoom:null,minZoom:null,maxCacheSize:null},uv=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),iv(this,ov(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&av(t,e)}(e,Kc),n=e,(r=[{key:"initializeState",value:function(){var t=this.props,e=t.maxZoom,n=t.minZoom,r=t.getTileData,i=t.onGetTileDataError;this.state={tiles:[],tileCache:new $p({getTileData:r,maxZoom:e,minZoom:n,onGetTileDataError:i}),isLoaded:!1}}},{key:"shouldUpdateState",value:function(t){return t.changeFlags.somethingChanged}},{key:"updateState",value:function(t){var e=this,n=t.props,r=(t.oldProps,t.context),i=t.changeFlags,o=n.onDataLoaded,a=n.onGetTileDataError;if(i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getTileData)){var s=n.getTileData,u=n.maxZoom,c=n.minZoom,l=n.maxCacheSize;this.state.tileCache.finalize(),this.setState({tileCache:new $p({getTileData:s,maxSize:l,maxZoom:u,minZoom:c,onGetTileDataError:a})})}if(i.viewportChanged){var h=r.viewport,f=this.getLayerZoomLevel();"DEFAULT-INITIAL-VIEWPORT"!==h.id&&this.state.tileCache.update(h,function(t){var n=t.filter(function(t){return t.z===f}),r=n.every(function(t){return t.isLoaded});e.setState({tiles:t,isLoaded:r}),r?o(n.filter(function(t){return t._data}).map(function(t){return t._data})):Promise.all(n.map(function(t){return t.data})).then(function(){e.setState({isLoaded:!0}),o(n.filter(function(t){return t._data}).map(function(t){return t._data}))})})}}},{key:"getPickingInfo",value:function(t){var e=t.info,n=t.sourceLayer;return e.sourceLayer=n,e.tile=n.props.tile,e}},{key:"getLayerZoomLevel",value:function(){var t=Math.floor(this.context.viewport.zoom),e=this.props,n=e.maxZoom,r=e.minZoom;return n&&parseInt(n,10)===n&&t>n?n:r&&parseInt(r,10)===r&&t<r?r:t}},{key:"renderLayers",value:function(){var t=this,e=this.props,n=(e.getTileData,e.renderSubLayers),r=nv(e,["getTileData","renderSubLayers"]),i=this.getLayerZoomLevel();return this.state.tiles.map(function(e){return n(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){ev(t,e,n[e])})}return t}({},r,{id:"".concat(t.id,"-").concat(e.x,"-").concat(e.y,"-").concat(e.z),data:e.data,visible:!t.state.isLoaded||e.z===i,tile:e}))})}}])&&rv(n.prototype,r),i&&rv(n,i),e}();uv.layerName="TileLayer",uv.defaultProps=sv;var cv=n("dA7e"),lv=n("eRUA"),hv=n.n(lv);function fv(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var dv="pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4M29iazA2Z2gycXA4N2pmbDZmangifQ.-g_vE53SD2WrJ6tFX7QHmA";function pv(t){var e=t.x,n=t.y,r=t.z;return fetch("https://a.tiles.mapbox.com/v4/mapbox.mapbox-streets-v7/"+r+"/"+e+"/"+n+".vector.pbf?access_token="+dv).then(function(t){return t.arrayBuffer()}).then(function(t){return function(t,e,n,r){var i=new cv.VectorTile(new hv.a(t)),o=[];for(var a in i.layers)for(var s=i.layers[a],u=0;u<s.length;u++){var c=s.feature(u),l=c.toGeoJSON(e,n,r);o.push(l)}return o}(t,e,n,r)})}var vv=function(t){var e,n;function i(e,n){var r,i,o,a;return r=t.call(this,e,n)||this,i=fv(fv(r)),a=function(t){void 0===t&&(t=null),r.container=t},(o="setRef")in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,r.state={zoom:14,fov:0,pitch:0,bearing:0},r.container=null,r.map=null,r.inited=!1,r.deckLayer=null,r}n=t,(e=i).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var o=i.prototype;return o.componentDidMount=function(){this.map=new ji.c(this.container,{center:[-74,40.72],zoom:13,pitch:40.5,bearing:0,centerCross:!0,baseLayer:new ji.d("tile",{urlTemplate:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png",subdomains:["a","b","c","d"]})});var t=new uv({stroked:!1,getLineColor:[192,192,192],getFillColor:function(t){switch(t.properties.layer){case"water":return[140,170,180];case"landcover":return[120,190,100];default:return[218,218,218]}},getTileData:pv});this.deckLayer=new Qh("deck",{layers:[t]},{animation:!0,renderer:"webgl"}),this.map.addLayer(this.deckLayer)},o.componentWillUnmount=function(){this.deckLayer&&this.deckLayer.remove()},o.render=function(){return r.createElement("div",{ref:this.setRef,className:"map-content"})},i}(r.Component);function gv(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var yv=function(t){var e,n;function i(e,n){var r,i,o,a;return r=t.call(this,e,n)||this,i=gv(gv(r)),a=function(t){void 0===t&&(t=null),r.container=t},(o="setRef")in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,r.state={zoom:14,fov:0,pitch:0,bearing:0},r.container=null,r.map=null,r.inited=!1,r.deckLayer=null,r}n=t,(e=i).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var o=i.prototype;return o.componentDidMount=function(){this.map=new ji.c(this.container,{center:[-74.01194070150844,40.70708981756565],zoom:5,pitch:0,bearing:0,centerCross:!0,baseLayer:new ji.d("tile",{urlTemplate:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png",subdomains:["a","b","c","d"]})}),this.deckLayer=new Qh("deck",{layers:[new Qd({data:"http://58.87.95.84:7300/mock/5b974eaa51241d6b41b178aa/learn-gis/building",stroked:!0,filled:!0,lineWidthMinPixels:2,opacity:1,getLineColor:function(){return[255,100,100]},getFillColor:function(){return[200,160,0,180]}})]},{animation:!0,renderer:"webgl"}),this.map.addLayer(this.deckLayer)},o.componentWillUnmount=function(){this.deckLayer&&this.deckLayer.remove()},o.render=function(){return r.createElement("div",{ref:this.setRef,className:"map-content"})},i}(r.Component);function mv(t){return(mv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bv(t,e){return!e||"object"!==mv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wv(t,e,n){return(wv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=xv(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function xv(t){return(xv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ev(t,e){return(Ev=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ov=Gi.s.fp64LowPart,Pv={fp64:!1,getSourcePosition:{type:"accessor",value:function(t){return t.sourcePosition}},getTargetPosition:{type:"accessor",value:function(t){return t.targetPosition}},getColor:{type:"accessor",value:[0,0,0,255]},getStrokeWidth:{type:"accessor",value:1}},Sv=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=null;return Number.isFinite(t.strokeWidth)&&(Ni.a.deprecated("LineLayer: `strokeWidth`","`getStrokeWidth`")(),n={getStrokeWidth:t.strokeWidth}),bv(this,xv(e).call(this,t,n))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ev(t,e)}(e,pa),n=e,(r=[{key:"getShaders",value:function(){return{vs:"#define SHADER_NAME line-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceTargetPositions;\nattribute vec4 instanceSourceTargetPositions64xyLow;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float opacity;\n\nvarying vec4 vColor;\n\n// offset vector by strokeWidth pixels\n// offset_direction is -1 (left) or 1 (right)\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset_screenspace = dir_screenspace * offset_direction * instanceWidths / 2.0;\n  vec2 offset_clipspace = project_pixel_to_clipspace(offset_screenspace).xy;\n\n  return offset_clipspace;\n}\n\nvoid main(void) {\n  // Position\n  vec4 source = project_position_to_clipspace(instanceSourcePositions, instanceSourceTargetPositions64xyLow.xy, vec3(0.));\n  vec4 target = project_position_to_clipspace(instanceTargetPositions, instanceSourceTargetPositions64xyLow.zw, vec3(0.));\n\n  // linear interpolation of source & target to pick right coord\n  float segmentIndex = positions.x;\n  vec4 p = mix(source, target, segmentIndex);\n\n  // extrude\n  vec2 offset = getExtrusionOffset(target.xy - source.xy, positions.y);\n  gl_Position = p + vec4(offset, 0.0, 0.0);\n\n  // Color\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:"#define SHADER_NAME line-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,transition:!0,accessor:"getTargetPosition"},instanceSourceTargetPositions64xyLow:{size:4,accessor:["getSourcePosition","getTargetPosition"],update:this.calculateInstanceSourceTargetPositions64xyLow},instanceColors:{size:4,type:Hi.a.UNSIGNED_BYTE,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getStrokeWidth",defaultValue:1}})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(wv(xv(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}}},{key:"_getModel",value:function(t){return new Gi.g(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new Gi.f({drawMode:Hi.a.TRIANGLE_STRIP,attributes:{positions:new Float32Array([0,-1,0,0,1,0,1,-1,0,1,1,0])}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"calculateInstanceSourceTargetPositions64xyLow",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getSourcePosition,o=n.getTargetPosition,a=t.value,s=t.size,u=0,c=!0,l=!1,h=void 0;try{for(var f,d=r[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var p=f.value,v=i(p),g=o(p);a[u+0]=Ov(v[0]),a[u+1]=Ov(v[1]),a[u+2]=Ov(g[0]),a[u+3]=Ov(g[1]),u+=s}}catch(t){l=!0,h=t}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}}else t.value=new Float32Array(4)}}])&&_v(n.prototype,r),i&&_v(n,i),e}();function Tv(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}Sv.layerName="LineLayer",Sv.defaultProps=Pv;var Cv="https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/line/airports.json",Av="https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/line/heathrow-flights.json";function Mv(t){var e=t.start[2]/1e4;return[255*(1-2*e),128*e,255*e,255*(1-e)]}function kv(){return(kv=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var jv=[{name:"index",key:"index",route:{path:"/index",component:bt}},{name:"building",key:"building",route:{path:"/building",component:Nd}},{name:"highway",key:"highway",route:{path:"/highway",component:rp}},{name:"hexagon",key:"hexagon",route:{path:"/hexagon",component:Ip}},{name:"brushing",key:"brushing",route:{path:"/brushing",component:Mf}},{name:"vector",key:"vector",route:{path:"/vector",component:vv}},{name:"polygon",key:"polygon",route:{path:"/polygon",component:yv}},{name:"linelayer",key:"linelayer",route:{path:"/linelayer",component:function(t){var e,n;function i(e,n){var r,i,o,a;return r=t.call(this,e,n)||this,i=Tv(Tv(r)),a=function(t){void 0===t&&(t=null),r.container=t},(o="setRef")in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,r.state={},r.container=null,r.map=null,r.inited=!1,r.deckLayer=null,r}n=t,(e=i).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var o=i.prototype;return o.componentDidMount=function(){var t=this.props,e=t.airports,n=void 0===e?Cv:e,r=t.flightPaths,i=void 0===r?Av:r,o=t.getStrokeWidth,a=void 0===o?3.7:o;this.map=new ji.c(this.container,{center:[7,47.65],zoom:5,pitch:45,bearing:0,centerCross:!0,baseLayer:new ji.d("tile",{urlTemplate:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png",subdomains:["a","b","c","d"]})}),this.deckLayer=new Qh("deck",{layers:[new wf({id:"airports",data:n,radiusScale:20,getPosition:function(t){return t.coordinates},getColor:[255,140,0],getRadius:function(t){return(e=t.type).search("major")>=0?100:e.search("small")>=0?30:60;var e},pickable:!0}),new Sv({id:"flight-paths",data:i,fp64:!1,getSourcePosition:function(t){return t.start},getTargetPosition:function(t){return t.end},getColor:Mv,getStrokeWidth:a,pickable:!0})]},{animation:!0,renderer:"webgl"}),this.map.addLayer(this.deckLayer)},o.componentWillUnmount=function(){this.deckLayer&&this.deckLayer.remove()},o.render=function(){return r.createElement("div",{ref:this.setRef,className:"map-content"})},i}(r.Component)}}],Rv=i.a.createElement(Q,null,jv.map(function(t){return i.a.createElement(nt,kv({key:t.key},t.route))}),i.a.createElement(ut,{to:"./index"})),Lv=function(){return r.createElement(W,null,Rv)};window.onload=function(){o.render(r.createElement(Lv,null),document.getElementById("app"))}},b1F2:function(t,e){t.exports=function(t,e,n){var r,i,o,a,s,u,c,l,h,f,d,p,v=n[0],g=n[1],y=n[2];e===t?(t[12]=e[0]*v+e[4]*g+e[8]*y+e[12],t[13]=e[1]*v+e[5]*g+e[9]*y+e[13],t[14]=e[2]*v+e[6]*g+e[10]*y+e[14],t[15]=e[3]*v+e[7]*g+e[11]*y+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=f,t[10]=d,t[11]=p,t[12]=r*v+s*g+h*y+e[12],t[13]=i*v+u*g+f*y+e[13],t[14]=o*v+c*g+d*y+e[14],t[15]=a*v+l*g+p*y+e[15]);return t}},bl9R:function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o});var r=n("yU0y");function i(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function o(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}var a,s;a=new r.a(4),r.a!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0,a[3]=0),s=a},bwSX:function(t,e,n){"use strict";function r(){}function i(t,e){var n=new r;if(t instanceof r)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var i,o=-1,a=t.length;if(null==e)for(;++o<a;)n.set(o,t[o]);else for(;++o<a;)n.set(e(i=t[o],o,t),i)}else if(t)for(var s in t)n.set(s,t[s]);return n}r.prototype=i.prototype={constructor:r,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var o=i;function a(){}var s=o.prototype;function u(t,e){var n=new a;if(t instanceof a)t.each(function(t){n.add(t)});else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}a.prototype=u.prototype={constructor:a,has:s.has,add:function(t){return this["$"+(t+="")]=t,this},remove:s.remove,clear:s.clear,values:s.keys,size:s.size,empty:s.empty,each:s.each};n.d(e,"a",function(){return o})},c8wm:function(t,e,n){"use strict";n.r(e);var r=n("r9/M"),i=n("oWct"),o=n("0vGO");n("0z1g");n.d(e,"global",function(){return i.a});var a="7.0.0-alpha.2";if(i.a.luma&&i.a.luma.VERSION!==a)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(i.a.luma.VERSION," vs ").concat(a));i.a.luma||(r.a&&o.a.log(0,"luma.gl ".concat(a," - ").concat("set luma.log.priority=1 (or higher) to trace rendering"))(),i.a.luma=i.a.luma||{VERSION:a,version:a,log:o.a,stats:{},globals:{modules:{},nodeIO:{}}});e.default=i.a.luma},cTfP:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MzlFQkFERkU4NkJCMTFFM0FBNTJFRTMzNTJEMUJDNDYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MzlFQkFERkQ4NkJCMTFFM0FBNTJFRTMzNTJEMUJDNDYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTJFOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTJGOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Kk5lQwAABYxJREFUeNrkm29oVXUYx3+7bM3V1FnbqlltrtXWtYRa1nqxooY5E7EhKWGuaTDBagol9SIMDCKICASj+cISw/DPi16ZBakrUBnoC7nNoTMWy6I1c+LmVq6t78N9jpyu555znt855+536IHPi939/jzP95zznN+/kzc1NaUitirwJJgPasF94DZQDG7hMqNgBFwEZ5kU+AH0R+lcXgQCJMBT4EXwLKgM2N7P4FvwJegCk6YKUA5eB23grogu2C/gc7AN/GGKABTsZtAOZqjc2DjYAT5kUfSNBNCkAGwGo1PTZ6PsQ4FuHLp3QD3YDR5QZtgZsAac1ElYokcGbATHDApesS/kUwf7GEkOKAK7wAvKbNsPXgZjYQowG3wNnlDxsONgCbgchgAU/GHwiIqXUT5o8hLBKwfcDA7FMHgrUR/iGLQEoGTyBWhQ8bUGjiFPR4A3QIuKv7VwLKIcQMnue5Dv0fjT/IwtAM3g+RyMBmkU+BXf3qc5Rx3xqDPBE7LjfkaCheCcj1HYKYe6JeBt8GcEo75L3HaJQ7+nfNQ/x7H9p67TFX4L1Pi4EocdfhsGH4BPwVbwqu0xGwI/8vT2N/77Gv+vAJSCO3n6PJ//Vjz72w62cPtORnfAwx7+1nBsW93ugGow7vOKtPkYa9eDl0Clxji9kuvW+yjb5tPncY7xet3MhjoFt2RzgIlU2DQL/O6017W/Be4BawXJqMCgTH+ToOxajvWG1+AmYVBlBglQKrxwmzIFoB9XCzt91CABpL6sti62JcBiXtKS2GMGCSD1pZxjvi7AKmED9PraYJAAG2yvVL+2yi7AImHl90C3QQJ03/B+97ZF1lCYVlN6BBV/BffykNQkoyF4H5grqJOkO6BR2NF2A4O35gifCOs0JjTW9vYaPPPbJ11LJAFqBRVoDf68wQLQI3BBUL424XPiY1lvDOb/ZwRla0iAOYIKv8dAgEFB2VtJgJmCChMxEEAyHigmAQoFFWbFQIDZgrKF0p2hmTEQQOQjCTAmKD8vBgJUCcqOkQBXBBXosEORwcEXKdmBjCskwICgQr5h0+BMW6i8V7LtNkAC9As7WWqwAM8Jy/cnhBMhspVKvq2eC0uwbxLrSWhMa+dpdJQLW6mRpLtpOlyuMcL7CTwErhoSPG2ApjQEuD3BQ0fp0ZJqlT6pZYpt0wieYh60nuWDGp2+At4xIPgt7IvU0jHzBkFdgD27HWDGNGyGFHHfulaXuTN0IkBjZ8EykJeDwKmPFtAXwN8TTltjrVkKfwcawXJW3G3v8DTYCKoiCLwGvAl6QthpbnU6J5jP2f1uh1Wgxbbxwv0qvT/vtZRGA6wuzs50+Pkb8JdgQtPMq1VJld7bnxtSzhjgJD5hzwEW611OZK6xlSvzeYbAsl3Cx4PK7ozodOl6t93hfJByqbzOVnYh+MdHhxfBLI1bnuoMhRx8imPMKgDR5LG/nrSVfddHpx8HeO4/ClmApsw+snXsdk7gYMat+r5Hp0sDCLAkxOA7nfrI1nGxx2tmQUb5x8FuzgvD4Dw4wNm2MIAA1SEF38cx+RaAeBCMZGlwb44GOyUhBD/CsTj24TatpddXq3L+RIVmXnE4QzjJMaSylvBxFdqzKHsVrDD8Dmj36sOvIx0unewHDRENg4MI0BH2FyP0RcZOlzW3Ib7VLvPqDK0z1PEq7bDmLVwCLgnr0AhvnUp/0eJp0k9m6HO4fUp2nGZODgUY5PzUJVlHkxg1TEfnjxqY8I6yb12SSjqLm7T9/Ax4TaW/+JxuIx862KcL4toBk1QFT1omXZLRHQHaL3Npl/r8jH3QjiGsbJ3kGd/fDo6WBWi31KG9a9xXMgzfw35tVfCR9l52dk8Ibe7htnq57YowfY7i4+lYWUL9z+1fAQYACqstE4NCc18AAAAASUVORK5CYII="},d3wX:function(t,e,n){"use strict";var r=n("U8pU"),i=n("KQm4"),o=n("1OyB"),a=n("vuIU"),s=n("so2h");var u=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";Object(o.a)(this,t),this.storage=function(t){try{var e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(t){return null}}(r),this.id=e,this.config={},Object.assign(this.config,n),this._loadConfiguration()}return Object(a.a)(t,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(t){return this.config={},this.updateConfiguration(t)}},{key:"updateConfiguration",value:function(t){if(Object.assign(this.config,t),this.storage){var e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}return this}},{key:"_loadConfiguration",value:function(){var t={};if(this.storage){var e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}]),t}(),c=n("LtGd"),l=n("wh/4"),h={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function f(t){return"string"==typeof t?h[t.toUpperCase()]||h.WHITE:t}function d(t,e){if(!t)throw new Error("Assertion failed. ".concat(e))}n.d(e,"a",function(){return m});var p={debug:s.b&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},v={enabled:!1,priority:0};function g(){}var y={};var m=function(){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id;Object(o.a)(this,t),this.id=e,this.VERSION=s.a,this._startTs=Object(c.a)(),this._deltaTs=Object(c.a)(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new u("__probe-".concat(this.id,"__"),v),this.userData={},this.timeStamp("".concat(this.id," started")),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"],n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=!0,o=!1,a=void 0;try{for(var s,u=function(){var n=s.value;"function"==typeof t[n]&&(e.find(function(t){return n===t})||(t[n]=t[n].bind(t)))},c=r[Symbol.iterator]();!(i=(s=c.next()).done);i=!0)u()}catch(t){o=!0,a=t}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}}(this),Object.seal(this)}return Object(a.a)(t,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getPriority",value:function(){return this._storage.config.priority}},{key:"getLevel",value:function(){return this._storage.config.priority}},{key:"getTotal",value:function(){return Number((Object(c.a)()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((Object(c.a)()-this._deltaTs).toPrecision(10))}},{key:"enable",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:t}),this}},{key:"setLevel",value:function(t){return this._storage.updateConfiguration({priority:t}),this}},{key:"warn",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this._getLogFunction({message:t,args:n,method:p.warn,once:!0})}},{key:"error",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this._getLogFunction({message:t,args:n,method:p.error})}},{key:"deprecated",value:function(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}},{key:"removed",value:function(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}},{key:"probe",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction({priority:t,message:e,args:r,method:p.log,time:!0,once:!0})}},{key:"log",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction({priority:t,message:e,args:r,method:p.debug})}},{key:"info",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction({priority:t,message:e,args:r,method:console.info})}},{key:"once",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction({priority:t,message:e,args:r,method:p.debug||p.info,once:!0})}},{key:"table",value:function(t,e,n){if(e){var r=function(t){for(var e in t)for(var n in t[e])return n||"untitled";return"empty"}(e);return this._getLogFunction({priority:t,message:e,args:n&&[n],tag:r,method:console.table||g})}return g}},{key:"image",value:function(t){var e=t.priority,n=t.image,r=t.message,i=void 0===r?"":r,o=t.scale,a=void 0===o?1:o;return e>this.getPriority()?g:s.b?this._logImageInBrowser({image:n,message:i,scale:a}):this._logImageInNode({image:n,message:i,scale:a})}},{key:"_logImageInNode",value:function(t){var e=t.image,r=(t.message,t.scale),i=void 0===r?1:r,o=null;try{o=n(0)}catch(t){}return o?function(){return o(e,{fit:"box",width:"".concat(Math.round(80*i),"%")}).then(function(t){return console.log(t)})}:g}},{key:"_logImageInBrowser",value:function(t){var e=t.image,n=t.message,r=void 0===n?"":n,o=t.scale,a=void 0===o?1:o;if("string"==typeof e){var s=new Image;return s.onload=function(){var t,e=Object(l.a)(s,r,a);(t=console).log.apply(t,Object(i.a)(e))},s.src=e,g}var u,c=e.nodeName||"";if("img"===c.toLowerCase())return(u=console).log.apply(u,Object(i.a)(Object(l.a)(e,r,a))),g;if("canvas"===c.toLowerCase()){var h=new Image;return h.onload=function(){var t;return(t=console).log.apply(t,Object(i.a)(Object(l.a)(h,r,a)))},h.src=e.toDataURL(),g}return g}},{key:"time",value:function(t,e){return this._getLogFunction({priority:t,message:e,method:console.time?console.time:console.info})}},{key:"timeEnd",value:function(t,e){return this._getLogFunction({priority:t,message:e,method:console.timeEnd?console.timeEnd:console.info})}},{key:"timeStamp",value:function(t,e){return this._getLogFunction({priority:t,message:e,method:console.timeStamp||g})}},{key:"group",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1},r=(n=this._normalizeArguments({priority:t,message:e,opts:n})).collapsed;return this._getLogFunction({priority:t,message:e,opts:n,method:(r?console.groupCollapsed:console.group)||console.info})}},{key:"groupCollapsed",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}},{key:"groupEnd",value:function(t){return this._getLogFunction({priority:t,message:"",method:console.groupEnd||g})}},{key:"withGroup",value:function(t,e,n){var r=this._normalizeArguments({priority:t,message:e});this.group(r);try{n()}finally{this.groupEnd(r.message)}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(t){return 0===(t=this._normalizePriority(t))||this.isEnabled()&&this.getPriority()>=t}},{key:"_getElapsedTime",value:function(){var t=this.getTotal(),e=this.getDelta();return this._deltaTs=Object(c.a)(),{total:t,delta:e}}},{key:"_getLogFunction",value:function(t){if(this._shouldLog(t.priority)){var e=t.method;t=this._parseArguments(t),d(e);var n=t.message,r=t.tag||t.message;if(t.once){if(y[r])return g;y[r]=Object(c.a)()}return n=this._decorateMessage(n,t),e.bind.apply(e,[console,n].concat(Object(i.a)(t.args)))}return g}},{key:"_parseArguments",value:function(t){var e=this._normalizeArguments(t),n=this._getElapsedTime(),r=n.delta,i=n.total;return Object.assign(t,e,{delta:r,total:i})}},{key:"_normalizePriority",value:function(t){var e;switch(Object(r.a)(t)){case"number":e=t;break;case"object":e=t.priority||0;break;default:e=0}return d(Number.isFinite(e)&&e>=0),e}},{key:"_normalizeArguments",value:function(t){var e=t.priority,n=t.message,i=t.args,o=void 0===i?[]:i,a=t.opts,s={priority:this._normalizePriority(e),message:n,args:o};switch(Object(r.a)(e)){case"string":case"function":void 0!==n&&o.unshift(n),Object.assign(s,{message:e});break;case"object":Object.assign(s,e)}return"function"==typeof s.message&&(s.message=this._shouldLog(s.priority)?s.message():""),d("string"==typeof s.message||"object"===Object(r.a)(s.message)),Object.assign(s,a)}},{key:"_decorateMessage",value:function(t,e){if("string"==typeof t){var n="";if(e.time){var r=this._getElapsedTime().total;n=Object(l.c)(Object(l.b)(r))}t=e.time?"".concat(this.id,": ").concat(n,"  ").concat(t):"".concat(this.id,": ").concat(t),i=t,o=e.color,a=e.background,s.b||"string"!=typeof i||(o&&(o=f(o),i="[".concat(o,"m").concat(i,"[39m")),a&&(o=f(a),i="[".concat(a+10,"m").concat(i,"[49m"))),t=i}var i,o,a;return t}},{key:"priority",set:function(t){return this._storage.updateConfiguration({priority:t}),this},get:function(){return this._storage.config.priority}}]),t}();m.VERSION=s.a},dA7e:function(t,e,n){t.exports.VectorTile=n("B93f"),t.exports.VectorTileFeature=n("HfwV"),t.exports.VectorTileLayer=n("DiGy")},dByZ:function(t,e,n){"use strict";n.d(e,"a",function(){return w});var r=n("1OyB"),i=n("vuIU"),o=n("md7G"),a=n("foSv"),s=n("Ji7U"),u=n("h6m0"),c=n("qjXE"),l=n("IyWr"),h=n.n(l),f=n("J6RW"),d=n.n(f),p=n("Qizj"),v=n.n(p),g=n("T2Xe"),y=n.n(g),m=n("tz+0"),_=n.n(m),b=[0,0,0],w=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(r.a)(this,e),t=Object(o.a)(this,Object(a.a)(e).call(this)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,i,s),t}return Object(s.a)(e,t),Object(i.a)(e,[{key:"angle",value:function(t){return h()(this,t)}},{key:"cross",value:function(t){return d()(this,this,t),this.check()}},{key:"rotateX",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?b:n;return v()(this,this,r,e),this.check()}},{key:"rotateY",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?b:n;return y()(this,this,r,e),this.check()}},{key:"rotateZ",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?b:n;return _()(this,this,r,e),this.check()}},{key:"operation",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.apply(void 0,[this,this].concat(n)),this.check()}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(t){return this[2]=Object(c.a)(t)}}]),e}(u.a)},dcnC:function(t,e,n){"use strict";var r=n("ahXh");function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(n=t,!(null!=(r=e)&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?r[Symbol.hasInstance](n):n instanceof r))throw new TypeError("Cannot call a class as a function");var n,r}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}var c=function(t){function e(){return o(this,e),s(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}var n,i,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,u(Array)),n=e,(i=[{key:"clone",value:function(){return(new this.constructor).copy(this).check()}},{key:"copy",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t[e];return this.check()}},{key:"set",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=(t<0||arguments.length<=t?void 0:arguments[t])||0;return this.check()}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}},{key:"toString",value:function(){return this.formatString(r.b)}},{key:"formatString",value:function(t){for(var e="",n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+Object(r.d)(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}},{key:"toArray",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"equals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(!Object(r.c)(this[e],t[e]))return!1;return!0}},{key:"exactEquals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}},{key:"negate",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}},{key:"inverse",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=1/this[t];return this.check()}},{key:"lerp",value:function(t,e,n){void 0===n&&(n=e,e=t,t=this);for(var r=0;r<this.ELEMENTS;++r){var i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}},{key:"min",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}},{key:"max",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}},{key:"clamp",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}},{key:"validate",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,e=t&&t.length===this.ELEMENTS,n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(t[n]);return e}},{key:"check",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;if(r.b.debug&&!this.validate(t))throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"sub",value:function(t){return this.subtract(t)}},{key:"setScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}},{key:"addScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}},{key:"subScalar",value:function(t){return this.addScalar(-t)}},{key:"multiplyScalar",value:function(t){return this.scale(t)}},{key:"divideScalar",value:function(t){return this.scale(1/t)}},{key:"clampScalar",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}}])&&a(n.prototype,i),c&&a(n,c),e}();function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){if(n=t,!(null!=(r=e)&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?r[Symbol.hasInstance](n):n instanceof r))throw new TypeError("Cannot call a class as a function");var n,r}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}n.d(e,"a",function(){return v});var p=function(t,e){if(!t)throw new Error(e)},v=function(t){function e(){return h(this,e),d(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,c),n=e,(i=[{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"lengthSquared",value:function(){for(var t=0,e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSquared(t))}},{key:"distanceSquared",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n){var i=this[n]-t[n];e+=i*i}return Object(r.a)(e)}},{key:"dot",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Object(r.a)(e)}},{key:"normalize",value:function(){var t=this.magnitude();if(0!==t)for(var e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]+=i[o];return this.check()}},{key:"subtract",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]-=i[o];return this.check()}},{key:"multiply",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]*=i[o];return this.check()}},{key:"divide",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]/=i[o];return this.check()}},{key:"scale",value:function(t){if(Array.isArray(t))return this.multiply(t);for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"scaleAndAdd",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=this[n]*e+t[n];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(t){return this.distance(t)}},{key:"distanceToSquared",value:function(t){return this.distanceSquared(t)}},{key:"getComponent",value:function(t){return p(t>=0&&t<this.ELEMENTS,"index is out of range"),Object(r.a)(this[t])}},{key:"setComponent",value:function(t,e){return p(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}},{key:"addVectors",value:function(t,e){return this.copy(t).add(e)}},{key:"subVectors",value:function(t,e){return this.copy(t).subtract(e)}},{key:"multiplyVectors",value:function(t,e){return this.copy(t).multiply(e)}},{key:"addScaledVector",value:function(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}},{key:"x",get:function(){return this[0]},set:function(t){return this[0]=Object(r.a)(t)}},{key:"y",get:function(){return this[1]},set:function(t){return this[1]=Object(r.a)(t)}}])&&f(n.prototype,i),o&&f(n,o),e}()},eRUA:function(t,e,n){"use strict";t.exports=i;var r=n("kVK+");function i(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;function o(t){return t.type===i.Bytes?t.readVarint()+t.pos:t.pos+1}function a(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function s(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function u(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function c(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function l(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function h(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function f(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function d(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function p(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function v(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function g(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function y(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function m(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function _(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}i.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=y(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=_(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=y(this.buf,this.pos)+4294967296*y(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=y(this.buf,this.pos)+4294967296*_(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,o=n.buf;if(i=o[n.pos++],r=(112&i)>>4,i<128)return a(t,r,e);if(i=o[n.pos++],r|=(127&i)<<3,i<128)return a(t,r,e);if(i=o[n.pos++],r|=(127&i)<<10,i<128)return a(t,r,e);if(i=o[n.pos++],r|=(127&i)<<17,i<128)return a(t,r,e);if(i=o[n.pos++],r|=(127&i)<<24,i<128)return a(t,r,e);if(i=o[n.pos++],r|=(1&i)<<31,i<128)return a(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,n){var r="",i=e;for(;i<n;){var o,a,s,u=t[i],c=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l>n)break;1===l?u<128&&(c=u):2===l?128==(192&(o=t[i+1]))&&(c=(31&u)<<6|63&o)<=127&&(c=null):3===l?(o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&((c=(15&u)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===l&&(o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,l=1):c>65535&&(c-=65536,r+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),r+=String.fromCharCode(c),i+=l}return r}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var n=o(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===i.Varint)for(;this.buf[this.pos++]>127;);else if(e===i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i.Fixed32)this.pos+=4;else{if(e!==i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),m(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),m(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),m(this.buf,-1&t,this.pos),m(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),m(this.buf,-1&t,this.pos),m(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;if(e.buf[e.pos++]|=n|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&s(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),r.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),r.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&s(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,i.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){this.writeMessage(t,u,e)},writePackedSVarint:function(t,e){this.writeMessage(t,c,e)},writePackedBoolean:function(t,e){this.writeMessage(t,f,e)},writePackedFloat:function(t,e){this.writeMessage(t,l,e)},writePackedDouble:function(t,e){this.writeMessage(t,h,e)},writePackedFixed32:function(t,e){this.writeMessage(t,d,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,p,e)},writePackedFixed64:function(t,e){this.writeMessage(t,v,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,g,e)},writeBytesField:function(t,e){this.writeTag(t,i.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,i.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,i.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,i.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},etCb:function(t,e){t.exports=function(t,e,n,r,i){var o=1/Math.tan(e/2),a=1/(r-i);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+r)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*r*a,t[15]=0,t}},foSv:function(t,e,n){"use strict";function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.d(e,"a",function(){return r})},g8bd:function(t,e,n){"use strict";t.exports=function(){}},g9fj:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n("1OyB"),i=n("vuIU"),o=n("md7G"),a=n("foSv"),s=n("Ji7U"),u=n("qjXE");var c=function(t){function e(){return Object(r.a)(this,e),Object(o.a)(this,Object(a.a)(e).apply(this,arguments))}return Object(s.a)(e,t),Object(i.a)(e,[{key:"clone",value:function(){return(new this.constructor).copy(this).check()}},{key:"copy",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t[e];return this.check()}},{key:"set",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=(t<0||arguments.length<=t?void 0:arguments[t])||0;return this.check()}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}},{key:"toString",value:function(){return this.formatString(u.c)}},{key:"formatString",value:function(t){for(var e="",n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+Object(u.f)(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}},{key:"toArray",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"equals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(!Object(u.e)(this[e],t[e]))return!1;return!0}},{key:"exactEquals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}},{key:"negate",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}},{key:"inverse",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=1/this[t];return this.check()}},{key:"lerp",value:function(t,e,n){void 0===n&&(n=e,e=t,t=this);for(var r=0;r<this.ELEMENTS;++r){var i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}},{key:"min",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}},{key:"max",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}},{key:"clamp",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}},{key:"validate",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,e=t&&t.length===this.ELEMENTS,n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(t[n]);return e}},{key:"check",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;if(u.c.debug&&!this.validate(t))throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"sub",value:function(t){return this.subtract(t)}},{key:"setScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}},{key:"addScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}},{key:"subScalar",value:function(t){return this.addScalar(-t)}},{key:"multiplyScalar",value:function(t){return this.scale(t)}},{key:"divideScalar",value:function(t){return this.scale(1/t)}},{key:"clampScalar",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}}]),e}(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array))},gBGw:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n("SR+o"),i=n("A2OQ"),o=n("Nx27"),a=n("9lTW"),s=n.n(a);function u(t,e){s()(t instanceof r.a||t instanceof i.a||t instanceof o.a);var n=t.constructor,a=t.gl,u=t.width,c=t.height,l=t.format,h=t.type,f=t.dataFormat,d=t.border,p=t.mipmaps;return new n(a,Object.assign({width:u,height:c,format:l,type:h,dataFormat:f,border:d,mipmaps:p},e))}},ggbK:function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return a}),n.d(e,"c",function(){return s});var r=n("lvHR"),i=n("0vGO");function o(t,e){if("string"!=typeof e)return e;var n=Number(e);if(!isNaN(n))return n;var i=t[e=e.replace(/^.*\./,"")];return Object(r.a)(void 0!==i,"Accessing undefined constant GL.".concat(e)),i}function a(t,e){for(var n in e=Number(e),t)if(t[n]===e)return"GL.".concat(n);return String(e)}function s(t,e){return void 0===e&&i.a.removed("glKey(value)","glKey(gl, value)","6.0")(),a(t,e)}},h6m0:function(t,e,n){"use strict";n.d(e,"a",function(){return h});var r=n("1OyB"),i=n("vuIU"),o=n("md7G"),a=n("foSv"),s=n("Ji7U"),u=n("g9fj"),c=n("qjXE"),l=function(t,e){if(!t)throw new Error(e)},h=function(t){function e(){return Object(r.a)(this,e),Object(o.a)(this,Object(a.a)(e).apply(this,arguments))}return Object(s.a)(e,t),Object(i.a)(e,[{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"lengthSquared",value:function(){for(var t=0,e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSquared(t))}},{key:"distanceSquared",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n){var r=this[n]-t[n];e+=r*r}return Object(c.a)(e)}},{key:"dot",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Object(c.a)(e)}},{key:"normalize",value:function(){var t=this.magnitude();if(0!==t)for(var e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]+=i[o];return this.check()}},{key:"subtract",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]-=i[o];return this.check()}},{key:"multiply",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]*=i[o];return this.check()}},{key:"divide",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]/=i[o];return this.check()}},{key:"scale",value:function(t){if(Array.isArray(t))return this.multiply(t);for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"scaleAndAdd",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=this[n]*e+t[n];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(t){return this.distance(t)}},{key:"distanceToSquared",value:function(t){return this.distanceSquared(t)}},{key:"getComponent",value:function(t){return l(t>=0&&t<this.ELEMENTS,"index is out of range"),Object(c.a)(this[t])}},{key:"setComponent",value:function(t,e){return l(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}},{key:"addVectors",value:function(t,e){return this.copy(t).add(e)}},{key:"subVectors",value:function(t,e){return this.copy(t).subtract(e)}},{key:"multiplyVectors",value:function(t,e){return this.copy(t).multiply(e)}},{key:"addScaledVector",value:function(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}},{key:"x",get:function(){return this[0]},set:function(t){return this[0]=Object(c.a)(t)}},{key:"y",get:function(){return this[1]},set:function(t){return this[1]=Object(c.a)(t)}}]),e}(u.a)},hJkN:function(t,e,n){"use strict";var r=n("L/7I"),i=n("puIE"),o=Object.keys(i.a).map(function(t){return"const float COORDINATE_SYSTEM_".concat(t," = ").concat(i.a[t],".;")}).join(""),a="".concat(o,'\n\nuniform float project_uCoordinateSystem;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform float project_uAntimeridian;\nuniform vec3 project_uPixelsPerMeter;\nuniform vec3 project_uPixelsPerDegree;\nuniform vec3 project_uPixelsPerUnit;\nuniform vec3 project_uPixelsPerUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec2 project_coordinate_origin;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec2 ZERO_64_XY_LOW = vec2(0.0, 0.0);\n\n//\n// Scaling offsets - scales meters to "pixels"\n// Note the scalar version of project_scale is for scaling the z component only\n//\nfloat project_scale(float meters) {\n  return meters * project_uPixelsPerMeter.z;\n}\n\nvec2 project_scale(vec2 meters) {\n  return meters * project_uPixelsPerMeter.xy;\n}\n\nvec3 project_scale(vec3 meters) {\n  return meters * project_uPixelsPerMeter;\n}\n\nvec4 project_scale(vec4 meters) {\n  return vec4(meters.xyz * project_uPixelsPerMeter, meters.w);\n}\n\n//\n// Projecting normal - transform deltas from current coordinate system to\n// normals in the worldspace\n//\nvec3 project_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNG_LAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uPixelsPerDegree);\n  }\n  // Apply model matrix\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uPixelsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_AUTO_OFFSET) {\n    dy = clamp(dy, -1., 1.);\n  }\n  vec3 pixelsPerUnit = project_uPixelsPerUnit + project_uPixelsPerUnit2 * dy;\n  return vec4(offset.xyz * pixelsPerUnit, offset.w);\n}\n\n//\n// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]\n//\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x - project_uAntimeridian, 360.0) + project_uAntimeridian;\n  }\n  return vec2(\n    radians(x) + PI,\n    PI - log(tan_fp32(PI * 0.25 + radians(lnglat.y) * 0.5))\n  );\n}\n\n//\n// Projects lnglats (or meter offsets, depending on mode) to pixels\n//\nvec4 project_position(vec4 position, vec2 position64xyLow) {\n  // TODO - why not simply subtract center and fall through?\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNG_LAT) {\n    return project_uModelMatrix * vec4(\n      project_mercator_(position.xy) * WORLD_SCALE * project_uScale,\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_AUTO_OFFSET) {\n    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.\n    float X = position.x - project_coordinate_origin.x;\n    float Y = position.y - project_coordinate_origin.y;\n    return project_offset_(vec4(X + position64xyLow.x, Y + position64xyLow.y, position.z, position.w));\n  }\n\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return project_offset_(position);\n  }\n\n  // METER_OFFSETS or IDENTITY\n  // Apply model matrix\n  vec4 position_modelspace = project_uModelMatrix * position;\n  return project_offset_(position_modelspace);\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_XY_LOW);\n}\n\nvec3 project_position(vec3 position, vec2 position64xyLow) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64xyLow);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_XY_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_XY_LOW);\n  return projected_position.xy;\n}\n\n//\n// Projects from "world" coordinates to clip space.\n// Uses project_uViewProjectionMatrix\n//\nvec4 project_to_clipspace(vec4 position) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_METER_OFFSETS ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    // Needs to be divided with project_uPixelsPerMeter\n    position.w *= project_uPixelsPerMeter.z;\n  }\n  return project_uViewProjectionMatrix * position + project_uCenter;\n}\n\n// Returns a clip space offset that corresponds to a given number of **non-device** pixels\nvec4 project_pixel_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return vec4(offset * project_uFocalDistance, 0.0, 0.0);\n}\n'),s=n("V8ep"),u={};e.a={name:"project",dependencies:[r.r],vs:a,getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u;return t.viewport?Object(s.b)(t):{}},deprecations:[{type:"uniform vec3",old:"selectedPickingColor",new:"luma.gl's picking module"},{type:"uniform float",old:"renderPickingBuffer",new:"luma.gl's picking module"},{type:"uniform float",old:"pickingEnabled",new:"luma.gl's picking module"},{type:"uniform float",old:"projectionMode",new:"project_uCoordinateSystem"},{type:"uniform vec4",old:"projectionCenter",new:"project_uCenter"},{type:"uniform vec2",old:"projectionOrigin"},{type:"uniform mat4",old:"modelMatrix",new:"project_uModelMatrix"},{type:"uniform mat4",old:"viewMatrix"},{type:"uniform mat4",old:"projectionMatrix",new:"project_uViewProjectionMatrix"},{type:"uniform vec3",old:"projectionPixelsPerUnit",new:"project_uPixelsPerUnit"},{type:"uniform float",old:"projectionScale",new:"project_uScale"},{type:"uniform vec2",old:"viewportSize",new:"project_uViewportSize"},{type:"uniform float",old:"devicePixelRatio",new:"project_uDevicePixelRatio"},{type:"uniform vec3",old:"cameraPos",new:"project_uCameraPosition"},{type:"function",old:"scale",new:"project_scale"},{type:"function",old:"preproject",new:"project_position"},{type:"function",old:"project",new:"project_to_clipspace"}]}},hMOY:function(t,e,n){"use strict";t.exports={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,FUNC_ADD:32774,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,BLEND_COLOR:32773,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,VENDOR:7936,RENDERER:7937,VERSION:7938,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,BROWSER_DEFAULT_WEBGL:37444,STATIC_DRAW:35044,STREAM_DRAW:35040,DYNAMIC_DRAW:35048,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,CULL_FACE:2884,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,BLEND:3042,DEPTH_TEST:2929,DITHER:3024,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,SCISSOR_TEST:3089,STENCIL_TEST:2960,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CONTEXT_LOST_WEBGL:37442,CW:2304,CCW:2305,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,COMPILE_STATUS:35713,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_ATTRIBUTES:35721,ACTIVE_UNIFORMS:35718,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,ALWAYS:519,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,GEQUAL:518,NOTEQUAL:517,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,TEXTURE_WIDTH:4096,TEXTURE_HEIGHT:4097,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,MAX_3D_TEXTURE_SIZE:32883,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,MAX_TEXTURE_LOD_BIAS:34045,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,RASTERIZER_DISCARD:35977,VERTEX_ARRAY_BINDING:34229,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,MAX_ELEMENT_INDEX:36203,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,RGB9_E5:35901,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2UI:36975,TEXTURE_IMMUTABLE_FORMAT:37167,TEXTURE_IMMUTABLE_LEVELS:33503,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,UNSIGNED_INT_24_8:34042,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,INT_2_10_10_10_REV:36255,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,MAX_SAMPLES:36183,SAMPLER_BINDING:35097,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,UNSIGNED_NORMALIZED:35863,SIGNED_NORMALIZED:36764,VERTEX_ATTRIB_ARRAY_INTEGER:35069,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,DEPTH24_STENCIL8:35056,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,COLOR:6144,DEPTH:6145,STENCIL:6146,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,INVALID_INDEX:4294967295,TIMEOUT_IGNORED:-1,MAX_CLIENT_WAIT_TIMEOUT_WEBGL:37447,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,UNMASKED_VENDOR_WEBGL:37445,UNMASKED_RENDERER_WEBGL:37446,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,TEXTURE_MAX_ANISOTROPY_EXT:34046,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35986,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,UNSIGNED_INT_24_8_WEBGL:34042,HALF_FLOAT_OES:36193,RGBA32F_EXT:34836,RGB32F_EXT:34837,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863,MIN_EXT:32775,MAX_EXT:32776,SRGB_EXT:35904,SRGB_ALPHA_EXT:35906,SRGB8_ALPHA8_EXT:35907,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067,COLOR_ATTACHMENT4_WEBGL:36068,COLOR_ATTACHMENT5_WEBGL:36069,COLOR_ATTACHMENT6_WEBGL:36070,COLOR_ATTACHMENT7_WEBGL:36071,COLOR_ATTACHMENT8_WEBGL:36072,COLOR_ATTACHMENT9_WEBGL:36073,COLOR_ATTACHMENT10_WEBGL:36074,COLOR_ATTACHMENT11_WEBGL:36075,COLOR_ATTACHMENT12_WEBGL:36076,COLOR_ATTACHMENT13_WEBGL:36077,COLOR_ATTACHMENT14_WEBGL:36078,COLOR_ATTACHMENT15_WEBGL:36079,DRAW_BUFFER0_WEBGL:34853,DRAW_BUFFER1_WEBGL:34854,DRAW_BUFFER2_WEBGL:34855,DRAW_BUFFER3_WEBGL:34856,DRAW_BUFFER4_WEBGL:34857,DRAW_BUFFER5_WEBGL:34858,DRAW_BUFFER6_WEBGL:34859,DRAW_BUFFER7_WEBGL:34860,DRAW_BUFFER8_WEBGL:34861,DRAW_BUFFER9_WEBGL:34862,DRAW_BUFFER10_WEBGL:34863,DRAW_BUFFER11_WEBGL:34864,DRAW_BUFFER12_WEBGL:34865,DRAW_BUFFER13_WEBGL:34866,DRAW_BUFFER14_WEBGL:34867,DRAW_BUFFER15_WEBGL:34868,MAX_COLOR_ATTACHMENTS_WEBGL:36063,MAX_DRAW_BUFFERS_WEBGL:34852,VERTEX_ARRAY_BINDING_OES:34229,QUERY_COUNTER_BITS_EXT:34916,CURRENT_QUERY_EXT:34917,QUERY_RESULT_EXT:34918,QUERY_RESULT_AVAILABLE_EXT:34919,TIME_ELAPSED_EXT:35007,TIMESTAMP_EXT:36392,GPU_DISJOINT_EXT:36795}},"hf/P":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){(0,r.installParameterDefinitions)(),console.log("luma.gl: WebGL debug support installed")};var r=n("NhK1"),i=n("t/Hr");(void 0!==t?t:window).WebGLDebug=i,console.log("luma.gl: WebGL debug support imported")}).call(this,n("yLpj"))},"i+ZN":function(t,e){t.exports=function(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}},i8i4:function(t,e,n){"use strict";!function t(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(t){console.error(t)}}(),t.exports=n("yl30")},"k0P+":function(t,e){t.exports=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],p=e[12],v=e[13],g=e[14],y=e[15],m=n*s-r*a,_=n*u-i*a,b=n*c-o*a,w=r*u-i*s,x=r*c-o*s,E=i*c-o*u,O=l*v-h*p,P=l*g-f*p,S=l*y-d*p,T=h*g-f*v,C=h*y-d*v,A=f*y-d*g,M=m*A-_*C+b*T+w*S-x*P+E*O;if(!M)return null;return M=1/M,t[0]=(s*A-u*C+c*T)*M,t[1]=(i*C-r*A-o*T)*M,t[2]=(v*E-g*x+y*w)*M,t[3]=(f*x-h*E-d*w)*M,t[4]=(u*S-a*A-c*P)*M,t[5]=(n*A-i*S+o*P)*M,t[6]=(g*b-p*E-y*_)*M,t[7]=(l*E-f*b+d*_)*M,t[8]=(a*C-s*S+c*O)*M,t[9]=(r*S-n*C-o*O)*M,t[10]=(p*x-v*b+y*m)*M,t[11]=(h*b-l*x-d*m)*M,t[12]=(s*P-a*T-u*O)*M,t[13]=(n*T-r*P+i*O)*M,t[14]=(v*_-p*w-g*m)*M,t[15]=(l*w-h*_+f*m)*M,t}},kLp3:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i="undefined"!=typeof window&&window.addEventListener,o=new Map,a=function(){return i&&window.__SEER_INITIALIZED__},s=function(t,e){var n=o.get(t),r=Date.now();return!!(n&&r-n<e)||(o.set(t,r),!1)},u=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(i&&a()){var n=new Set,o=JSON.stringify(e,function(t){return function(e,n){if(!n||"object"!==(void 0===n?"undefined":r(n))||!t.has(n))return t.add(n),Object.prototype.toString.call(n).slice(8,-1).includes("Array")?Array.prototype.slice.call(n,0,20):n}}(n));try{window.postMessage({type:t,payload:o,source:"seer-agent"},"*")}catch(t){if(s("seer-log",2e3))return;console.log(t)}}},c=new Map,l=function(t){if(t&&t.data&&"seer-core"===t.data.source){var e=t.data,n=e.type,r=e.payload,i=c.get(n);i&&i.forEach(function(t){return t(r)})}},h=function(){i&&!window.__SEER_LISTENER__&&(window.addEventListener("message",l),window.__SEER_LISTENER__=!0)};e.default={send:u,throttle:s,isReady:a,list:function(t,e){return u("LIST",{key:t,data:e})},listItem:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return u("LIST_ITEM",{key:t,itemKey:e,data:n})},updateItem:function(t,e,n,r){return u("UPDATE_ITEM",{key:t,itemKey:e,path:n,data:r})},multiUpdate:function(t,e,n){return u("MULTI_UPDATE_ITEM",{key:t,itemKey:e,array:n})},deleteItem:function(t,e){return u("DELETE_ITEM",{key:t,itemKey:e})},addLog:function(t,e,n){return u("ADD_LOG",{key:t,itemKey:e,msg:n})},listeners:c,listenFor:function(t,e){if(i){if(!t||!e)throw new Error("Please provide a type and callback");c.has(t)||c.set(t,[]),window.__SEER_LISTENER__||h(),c.get(t).push(e)}},removeListener:function(t){c.forEach(function(e,n){c.set(n,e.filter(function(e){return e!==t}))})},init:h,clean:function(){i&&window.__SEER_LISTENER__&&(window.removeEventListener("message",l),delete window.__SEER_LISTENER__)}}},kTsV:function(t,e){t.exports=function(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o);return t}},"kVK+":function(t,e){e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,d=t[e+h];for(h+=f,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+t[e+h],h+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=c}return(d?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(a++,u/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(e*u-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[n+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+d]=255&a,d+=p,a/=256,c-=8);t[n+d-p]|=128*v}},ket5:function(t,e,n){"use strict";var r=n("r9/M"),i=n("oWct");function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=i.b.navigator||{},n=t.userAgent||e.userAgent||"",r=-1!==n.indexOf("MSIE "),o=-1!==n.indexOf("Trident/");return r||o}var a=n("lvHR"),s={};function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";s[t]=s[t]||1;var e=s[t]++;return"".concat(t,"-").concat(e)}function c(t){return Object(a.a)("number"==typeof t,"Input must be a number"),t&&0==(t&t-1)}function l(t){var e=!0;for(var n in t){e=!1;break}return e}var h=n("0vGO");function f(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.isInteger,r=void 0!==n&&n;if(Array.isArray(t)||ArrayBuffer.isView(t))return function(t,e){for(var n=e.maxElts,r=void 0===n?16:n,i=e.size,o=void 0===i?1:i,a="[",s=0;s<t.length&&s<r;++s)s>0&&(a+=",".concat(s%o==0?" ":"")),a+=f(t[s],e);var u=t.length>r?"...":"]";return"".concat(a).concat(u)}(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<1e-16)return r?"0":"0.";if(r)return t.toFixed(0);if(Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);var i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function d(t,e,n,r){var i="See luma.gl ".concat(n," Upgrade Guide at http://uber.github.io/luma.gl/#/documentation/overview/upgrade-guide"),o=Object.getPrototypeOf(t);r.forEach(function(t){o.methodName||(o[t]=function(){throw h.a.removed("Calling removed method ".concat(e,".").concat(t,": "),i),new Error(t)})})}n.d(e,"c",function(){return r.a}),n.d(e,"e",function(){return o}),n.d(e,"i",function(){return u}),n.d(e,"f",function(){return c}),n.d(e,"d",function(){return l}),n.d(e,"g",function(){return h.a}),n.d(e,"b",function(){return f}),n.d(e,"a",function(){return a.a}),n.d(e,"h",function(){return d})},lSNA:function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},lXO8:function(t,e){t.exports=function(t,e,n){var r=new Float32Array(3);return r[0]=t,r[1]=e,r[2]=n,r}},lvHR:function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}n.d(e,"a",function(){return r})},mJ0t:function(t,e,n){"use strict";var r=n("L/7I"),i=n("hJkN"),o=n("OIVS"),a=r.s.fp64ify,s=r.s.fp64ifyMatrix4,u=(e.a={name:"project64",dependencies:[i.a,r.s],vs:"\nconst vec2 WORLD_SCALE_FP64 = vec2(81.4873275756836, 0.0000032873668232014097);\n\nuniform vec2 project64_uScale;\nuniform vec2 project_uViewProjectionMatrixFP64[16];\n\n// longitude: lnglat_fp64.xy; latitude: lnglat_fp64.zw\nvoid mercatorProject_fp64(vec4 lnglat_fp64, out vec2 out_val[2]) {\n\n#if defined(NVIDIA_FP64_WORKAROUND)\n  out_val[0] = sum_fp64(radians_fp64(lnglat_fp64.xy), PI_FP64 * ONE);\n#else\n  out_val[0] = sum_fp64(radians_fp64(lnglat_fp64.xy), PI_FP64);\n#endif\n  out_val[1] = sub_fp64(PI_FP64,\n    log_fp64(tan_fp64(sum_fp64(PI_4_FP64, radians_fp64(lnglat_fp64.zw) / 2.0))));\n  return;\n}\n\nvoid project_position_fp64(vec4 position_fp64, out vec2 out_val[2]) {\n  vec2 pos_fp64[2];\n  mercatorProject_fp64(position_fp64, pos_fp64);\n  vec2 x_fp64 = mul_fp64(pos_fp64[0], project64_uScale);\n  vec2 y_fp64 = mul_fp64(pos_fp64[1], project64_uScale);\n  out_val[0] = mul_fp64(x_fp64, WORLD_SCALE_FP64);\n  out_val[1] = mul_fp64(y_fp64, WORLD_SCALE_FP64);\n\n  return;\n}\n\nvoid project_position_fp64(vec2 position, vec2 position64xyLow, out vec2 out_val[2]) {\n  vec4 position64xy = vec4(\n    position.x, position64xyLow.x,\n    position.y, position64xyLow.y);\n\n  project_position_fp64(position64xy, out_val);\n}\n\nvec4 project_to_clipspace_fp64(vec2 vertex_pos_modelspace[4]) {\n  vec2 vertex_pos_clipspace[4];\n  mat4_vec4_mul_fp64(project_uViewProjectionMatrixFP64, vertex_pos_modelspace,\n    vertex_pos_clipspace);\n  return vec4(\n    vertex_pos_clipspace[0].x,\n    vertex_pos_clipspace[1].x,\n    vertex_pos_clipspace[2].x,\n    vertex_pos_clipspace[3].x\n    );\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec2 position64xyLow, vec3 offset, out vec4 worldPosition\n) {\n  // This is the local offset to the instance position\n  vec2 offset64[4];\n  vec4_fp64(vec4(offset, 0.0), offset64);\n\n  float z = project_scale(position.z);\n\n  // Apply web mercator projection (depends on coordinate system imn use)\n  vec2 projectedPosition64xy[2];\n  project_position_fp64(position.xy, position64xyLow, projectedPosition64xy);\n\n  vec2 worldPosition64[4];\n  worldPosition64[0] = sum_fp64(offset64[0], projectedPosition64xy[0]);\n  worldPosition64[1] = sum_fp64(offset64[1], projectedPosition64xy[1]);\n  worldPosition64[2] = sum_fp64(offset64[2], vec2(z, 0.0));\n  worldPosition64[3] = vec2(1.0, 0.0);\n\n  worldPosition = vec4(projectedPosition64xy[0].x, projectedPosition64xy[1].x, z, 1.0);\n\n  return project_to_clipspace_fp64(worldPosition64);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec2 position64xyLow, vec3 offset\n) {\n  vec4 worldPosition;\n  return project_position_to_clipspace(\n    position, position64xyLow, offset, worldPosition\n  );\n}\n",getUniforms:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.project_uViewProjectionMatrix,n=t.project_uScale;if(e&&n)return u({project_uViewProjectionMatrix:e,project_uScale:n});return{}},deprecations:[{type:"uniform vec2",old:"projectionFP64[16]",new:"project_uViewProjectionMatrixFP64"},{type:"uniform vec2",old:"projectionScaleFP64",new:"project64_uScale"}]},Object(o.a)(function(t){var e=t.project_uViewProjectionMatrix,n=t.project_uScale,r=s(e),i=a(n);return{project_uViewProjectionMatrixFP64:r,project64_uViewProjectionMatrix:r,project64_uScale:i}}))},mWlC:function(t,e){t.exports=function(t,e,n,r){var i,o,a,s,u,c,l,h,f,d,p,v,g,y,m,_,b,w,x,E,O,P,S,T,C=r[0],A=r[1],M=r[2],k=Math.sqrt(C*C+A*A+M*M);if(Math.abs(k)<1e-6)return null;C*=k=1/k,A*=k,M*=k,i=Math.sin(n),o=Math.cos(n),a=1-o,s=e[0],u=e[1],c=e[2],l=e[3],h=e[4],f=e[5],d=e[6],p=e[7],v=e[8],g=e[9],y=e[10],m=e[11],_=C*C*a+o,b=A*C*a+M*i,w=M*C*a-A*i,x=C*A*a-M*i,E=A*A*a+o,O=M*A*a+C*i,P=C*M*a+A*i,S=A*M*a-C*i,T=M*M*a+o,t[0]=s*_+h*b+v*w,t[1]=u*_+f*b+g*w,t[2]=c*_+d*b+y*w,t[3]=l*_+p*b+m*w,t[4]=s*x+h*E+v*O,t[5]=u*x+f*E+g*O,t[6]=c*x+d*E+y*O,t[7]=l*x+p*E+m*O,t[8]=s*P+h*S+v*T,t[9]=u*P+f*S+g*T,t[10]=c*P+d*S+y*T,t[11]=l*P+p*S+m*T,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t}},md7G:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n("U8pU"),i=n("JX7q");function o(t,e){return!e||"object"!==Object(r.a)(e)&&"function"!=typeof e?Object(i.a)(t):e}},nIko:function(t,e,n){"use strict";n.r(e);var r=n("L/7I"),i=n("hJkN"),o={name:"project32",dependencies:[i.a],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec2 position64xyLow, vec3 offset, out vec4 worldPosition\n) {\n  vec3 projectedPosition = project_position(position, position64xyLow);\n  worldPosition = vec4(projectedPosition + offset, 1.0);\n  return project_to_clipspace(worldPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec2 position64xyLow, vec3 offset\n) {\n  vec4 worldPosition;\n  return project_position_to_clipspace(position, position64xyLow, offset, worldPosition);\n}\n"},a=n("mJ0t"),s=n("oNJQ");function u(){Object(r.x)([r.r,r.s,i.a,o,a.a,s.a,r.w]),Object(r.y)([i.a])}n.d(e,"initializeShaderModules",function(){return u}),n.d(e,"fp32",function(){return r.r}),n.d(e,"fp64",function(){return r.s}),n.d(e,"picking",function(){return r.w}),n.d(e,"project",function(){return i.a}),n.d(e,"project64",function(){return a.a}),n.d(e,"lighting",function(){return s.a}),u()},nKJB:function(t,e){t.exports=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},oNJQ:function(t,e,n){"use strict";var r=n("hJkN"),i=n("5cL1"),o=n("OIVS"),a=(e.a={name:"lighting",dependencies:[r.a],vs:"#define MAX_NUM_OF_LIGHTS 5\n\n// TODO these should be using lighting_ prefix\nuniform vec3 lighting_lightPositions[MAX_NUM_OF_LIGHTS];\nuniform vec2 lighting_lightStrengths[MAX_NUM_OF_LIGHTS];\nuniform float lighting_ambientRatio;\nuniform float lighting_diffuseRatio;\nuniform float lighting_specularRatio;\nuniform int lighting_numberOfLights;\n\nfloat lighting_getLightWeight(vec3 position_worldspace_vec3, vec3 normals_worldspace) {\n  float lightWeight = 0.0;\n\n  vec3 normals_worldspace_vec3 = normals_worldspace.xyz;\n\n  vec3 camera_pos_worldspace = project_uCameraPosition;\n  vec3 view_direction = normalize(camera_pos_worldspace - position_worldspace_vec3);\n\n  for (int i = 0; i < MAX_NUM_OF_LIGHTS; i++) {\n    if (i >= lighting_numberOfLights) {\n      break;\n    }\n    vec3 light_position_worldspace = lighting_lightPositions[i];\n    vec3 light_direction = normalize(light_position_worldspace - position_worldspace_vec3);\n\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normals_worldspace_vec3);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normals_worldspace_vec3, halfway_direction), 0.0);\n      specular = pow(specular_angle, 32.0);\n    }\n    lambertian = max(lambertian, 0.0);\n    lightWeight += (lighting_ambientRatio + lambertian * lighting_diffuseRatio + specular * lighting_specularRatio) *\n      lighting_lightStrengths[i].x;\n  }\n\n  return lightWeight;\n}\n\n// DEPRECATED - Backwards compatibility\n\nfloat getLightWeight(vec3 position_worldspace_vec3, vec3 normals_worldspace) {\n  return lighting_getLightWeight(position_worldspace_vec3, normals_worldspace);\n}\n",getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;if(!t.lightSettings)return{};var e=t.coordinateSystem,n=t.coordinateOrigin,r=t.lightSettings,i=r.numberOfLights,o=void 0===i?1:i,d=r.lightsPosition,p=void 0===d?s:d,v=r.lightsStrength,g=void 0===v?u:v,y=r.coordinateSystem,m=r.coordinateOrigin,_=r.modelMatrix,b=void 0===_?null:_,w=r.ambientRatio,x=void 0===w?c:w,E=r.diffuseRatio,O=void 0===E?l:E,P=r.specularRatio,S=void 0===P?h:P;return{lighting_lightPositions:f({lightsPosition:p,numberOfLights:o,viewport:t.viewport,modelMatrix:b,coordinateSystem:e,coordinateOrigin:n,fromCoordinateSystem:y,fromCoordinateOrigin:m}),lighting_lightStrengths:g,lighting_ambientRatio:x,lighting_diffuseRatio:O,lighting_specularRatio:S,lighting_numberOfLights:o}},deprecations:[{type:"function",old:"getLightWeight",new:"lighting_getLightWeight",deprecated:!0}]},{}),s=[-122.45,37.75,8e3],u=[2,0],c=.4,l=.6,h=.8,f=Object(o.a)(function(t){for(var e=t.lightsPosition,n=t.numberOfLights,r=t.viewport,o=t.modelMatrix,a=t.coordinateSystem,s=t.coordinateOrigin,u=t.fromCoordinateSystem,c=t.fromCoordinateOrigin,l={viewport:r,modelMatrix:o,coordinateSystem:a,coordinateOrigin:s,fromCoordinateSystem:u,fromCoordinateOrigin:c},h=[],f=0;f<n;f++){var d=Object(i.b)(e.slice(3*f,3*f+3),l);h[3*f]=d[0],h[3*f+1]=d[1],h[3*f+2]=d[2]}return h})},oWct:function(t,e,n){"use strict";(function(t){n.d(e,"b",function(){return i}),n.d(e,"a",function(){return o});var r={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==t&&t,document:"undefined"!=typeof document&&document},i=r.window||r.self||r.global,o=r.global||r.self||r.window}).call(this,n("yLpj"))},puIE:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r={LNG_LAT:1,LNGLAT_AUTO_OFFSET:4,METER_OFFSETS:2,LNGLAT_OFFSETS:3,IDENTITY:0}},q1tI:function(t,e,n){"use strict";t.exports=n("viRO")},qjXE:function(t,e,n){"use strict";n.d(e,"c",function(){return r}),n.d(e,"a",function(){return i}),n.d(e,"f",function(){return a}),n.d(e,"h",function(){return c}),n.d(e,"d",function(){return l}),n.d(e,"b",function(){return h}),n.d(e,"g",function(){return f}),n.d(e,"e",function(){return d});var r={};function i(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function o(t){return Math.round(t/r.EPSILON)*r.EPSILON}function a(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).precision,n=void 0===e?r.precision||4:e;return t=o(t),parseFloat(t.toPrecision(n))}function s(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&void 0!==t.length}function u(t,e){if(s(t)){for(var n=(i=t).clone?i.clone():new Array(i),r=0;r<n.length;++r)n[r]=e(n[r],r,n);return n}var i;return e(t)}function c(t){return u(t,function(t){return t/180*Math.PI})}function l(t){return u(t,function(t){return 180*t/Math.PI})}function h(t,e,n){return u(t,function(t){return Math.max(e,Math.min(n,t))})}function f(t,e,n){return s(t)?t.map(function(t,r){return f(t,e[r],n)}):n*e+(1-n)*t}function d(t,e){if(s(t)&&s(e)){if(t===e)return!0;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!d(t[n],e[n]))return!1;return!0}return Math.abs(t-e)<=r.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}r.EPSILON=1e-12,r.debug=!0,r.precision=4,r.printTypes=!1,r.printDegrees=!1,r.printRowMajor=!0},"r+5q":function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return d}),n.d(e,"c",function(){return p}),n.d(e,"b",function(){return v});var r=n("1OyB"),i=n("vuIU"),o=n("rePB"),a=n("62Ki"),s=n("lvHR"),u=function(t,e){var n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return t===e},c={enable:function(t,e){return t(Object(o.a)({},e,!0))},disable:function(t,e){return t(Object(o.a)({},e,!1))},pixelStorei:function(t,e,n){return t(Object(o.a)({},e,n))},hint:function(t,e,n){return t(Object(o.a)({},e,n))},bindFramebuffer:function(t,e,n){var r;switch(e){case 36160:return t((r={},Object(o.a)(r,36006,n),Object(o.a)(r,36010,n),r));case 36009:return t(Object(o.a)({},36006,n));case 36008:return t(Object(o.a)({},36010,n));default:return null}},blendColor:function(t,e,n,r,i){return t(Object(o.a)({},32773,new Float32Array([e,n,r,i])))},blendEquation:function(t,e){var n;return t((n={},Object(o.a)(n,32777,e),Object(o.a)(n,34877,e),n))},blendEquationSeparate:function(t,e,n){var r;return t((r={},Object(o.a)(r,32777,e),Object(o.a)(r,34877,n),r))},blendFunc:function(t,e,n){var r;return t((r={},Object(o.a)(r,32969,e),Object(o.a)(r,32968,n),Object(o.a)(r,32971,e),Object(o.a)(r,32970,n),r))},blendFuncSeparate:function(t,e,n,r,i){var a;return t((a={},Object(o.a)(a,32969,e),Object(o.a)(a,32968,n),Object(o.a)(a,32971,r),Object(o.a)(a,32970,i),a))},clearColor:function(t,e,n,r,i){return t(Object(o.a)({},3106,new Float32Array([e,n,r,i])))},clearDepth:function(t,e){return t(Object(o.a)({},2931,e))},clearStencil:function(t,e){return t(Object(o.a)({},2961,e))},colorMask:function(t,e,n,r,i){return t(Object(o.a)({},3107,[e,n,r,i]))},cullFace:function(t,e){return t(Object(o.a)({},2885,e))},depthFunc:function(t,e){return t(Object(o.a)({},2932,e))},depthRange:function(t,e,n){return t(Object(o.a)({},2928,new Float32Array([e,n])))},depthMask:function(t,e){return t(Object(o.a)({},2930,e))},frontFace:function(t,e){return t(Object(o.a)({},2886,e))},lineWidth:function(t,e){return t(Object(o.a)({},2849,e))},polygonOffset:function(t,e,n){var r;return t((r={},Object(o.a)(r,32824,e),Object(o.a)(r,10752,n),r))},sampleCoverage:function(t,e,n){var r;return t((r={},Object(o.a)(r,32938,e),Object(o.a)(r,32939,n),r))},scissor:function(t,e,n,r,i){return t(Object(o.a)({},3088,new Int32Array([e,n,r,i])))},stencilMask:function(t,e){var n;return t((n={},Object(o.a)(n,2968,e),Object(o.a)(n,36005,e),n))},stencilMaskSeparate:function(t,e,n){return t(Object(o.a)({},1028===e?2968:36005,n))},stencilFunc:function(t,e,n,r){var i;return t((i={},Object(o.a)(i,2962,e),Object(o.a)(i,2967,n),Object(o.a)(i,2963,r),Object(o.a)(i,34816,e),Object(o.a)(i,36003,n),Object(o.a)(i,36004,r),i))},stencilFuncSeparate:function(t,e,n,r,i){var a;return t((a={},Object(o.a)(a,1028===e?2962:34816,n),Object(o.a)(a,1028===e?2967:36003,r),Object(o.a)(a,1028===e?2963:36004,i),a))},stencilOp:function(t,e,n,r){var i;return t((i={},Object(o.a)(i,2964,e),Object(o.a)(i,2965,n),Object(o.a)(i,2966,r),Object(o.a)(i,34817,e),Object(o.a)(i,34818,n),Object(o.a)(i,34819,r),i))},stencilOpSeparate:function(t,e,n,r,i){var a;return t((a={},Object(o.a)(a,1028===e?2964:34817,n),Object(o.a)(a,1028===e?2965:34818,r),Object(o.a)(a,1028===e?2966:34819,i),a))},viewport:function(t,e,n,r,i){return t(Object(o.a)({},2978,new Int32Array([e,n,r,i])))}};function l(t,e){var n=t[e].bind(t);t[e]=function(){var e=arguments.length<=0?void 0:arguments[0];return e in t.state.cache||(t.state.cache[e]=n.apply(void 0,arguments)),t.state.enable?t.state.cache[e]:n.apply(void 0,arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function h(t,e,n){var r=t[e].bind(t);t[e]=function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];var s,u=n.apply(void 0,[t.state._updateCache].concat(o)),c=u.valueChanged,l=u.oldValue;c&&((s=t.state).log.apply(s,["gl.".concat(e)].concat(o)),r.apply(void 0,o));return l},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}var f=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.copyState,o=void 0!==i&&i,s=n.log,u=void 0===s?function(){}:s;Object(r.a)(this,t),this.gl=e,this.stateStack=[],this.enable=!0,this.cache=o?Object(a.b)(e):Object.assign({},a.a),this.log=u,this._updateCache=this._updateCache.bind(this),Object.seal(this)}return Object(i.a)(t,[{key:"push",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.stateStack.push({})}},{key:"pop",value:function(){Object(s.a)(this.stateStack.length>0);var t=this.stateStack[this.stateStack.length-1];Object(a.d)(this.gl,t,this.cache),this.stateStack.pop()}},{key:"_updateCache",value:function(t){var e,n=!1,r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(var i in t)Object(s.a)(void 0!==i),u(t[i],this.cache[i])||(n=!0,e=this.cache[i],!r||i in r||(r[i]=this.cache[i]),this.cache[i]=t[i]);return{valueChanged:n,oldValue:e}}}]),t}();function d(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.enable,i=void 0===r||r,o=n.copyState;if(Object(s.a)(void 0!==o),!e.state){var a=void 0!==t?t:window;for(var u in a.polyfillContext&&a.polyfillContext(e),e.state=new f(e,{copyState:o,enable:i}),c){h(e,u,c[u])}l(e,"getParameter"),l(e,"isEnabled")}return e.state.enable=i,e}function p(t){t.state||d(t,{copyState:!1}),t.state.push()}function v(t){Object(s.a)(t.state),t.state.pop()}}).call(this,n("yLpj"))},r4zW:function(t,e,n){t.exports=n("hMOY")},"r9/M":function(t,e,n){"use strict";(function(t){var r=n("U8pU"),i=n("AyRc"),o=!("object"===(void 0===t?"undefined":Object(r.a)(t))&&"[object process]"===String(t)&&!t.browser)||i.a;e.a=o}).call(this,n("8oxB"))},rePB:function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",function(){return r})},s4An:function(t,e,n){"use strict";function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,"a",function(){return r})},sckk:function(t,e){t.exports=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],h=t[10],f=t[11],d=t[12],p=t[13],v=t[14],g=t[15];return(e*a-n*o)*(h*g-f*v)-(e*s-r*o)*(l*g-f*p)+(e*u-i*o)*(l*v-h*p)+(n*s-r*a)*(c*g-f*d)-(n*u-i*a)*(c*v-h*d)+(r*u-i*s)*(c*p-l*d)}},so2h:function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o});var r=n("5ku3"),i="2.0.1",o=Object(r.a)()},"t/Hr":function(t,e,n){(function(e){WebGLDebugUtils=function(){var t;void 0===t&&(t=e);var n=function(e){t.console&&t.console.error?t.console.error(e):function(e){t.console&&t.console.log&&t.console.log(e)}(e)},r={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},bindBuffer:{2:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}},bufferData:{3:{0:!0,2:!0},4:{0:!0,2:!0},5:{0:!0,2:!0}},bufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},copyBufferSubData:{5:{0:!0,1:!0}},getBufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},blitFramebuffer:{10:{8:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]},9:!0}},framebufferTextureLayer:{5:{0:!0,1:!0}},invalidateFramebuffer:{2:{0:!0}},invalidateSubFramebuffer:{6:{0:!0}},readBuffer:{1:{0:!0}},getInternalformatParameter:{3:{0:!0,1:!0,2:!0}},renderbufferStorageMultisample:{5:{0:!0,2:!0}},texStorage2D:{5:{0:!0,2:!0}},texStorage3D:{6:{0:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0},10:{0:!0,2:!0,6:!0,7:!0}},texImage3D:{10:{0:!0,2:!0,7:!0,8:!0},11:{0:!0,2:!0,7:!0,8:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0},10:{0:!0,6:!0,7:!0}},texSubImage3D:{11:{0:!0,8:!0,9:!0},12:{0:!0,8:!0,9:!0}},copyTexSubImage3D:{9:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0},8:{0:!0,2:!0},9:{0:!0,2:!0}},compressedTexImage3D:{8:{0:!0,2:!0},9:{0:!0,2:!0},10:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0},9:{0:!0,6:!0},10:{0:!0,6:!0}},compressedTexSubImage3D:{10:{0:!0,8:!0},11:{0:!0,8:!0},12:{0:!0,8:!0}},vertexAttribIPointer:{5:{2:!0}},drawArraysInstanced:{4:{0:!0}},drawElementsInstanced:{5:{0:!0,2:!0}},drawRangeElements:{6:{0:!0,4:!0}},readPixels:{7:{4:!0,5:!0},8:{4:!0,5:!0}},clearBufferfv:{3:{0:!0},4:{0:!0}},clearBufferiv:{3:{0:!0},4:{0:!0}},clearBufferuiv:{3:{0:!0},4:{0:!0}},clearBufferfi:{4:{0:!0}},beginQuery:{2:{0:!0}},endQuery:{1:{0:!0}},getQuery:{2:{0:!0,1:!0}},getQueryParameter:{2:{1:!0}},samplerParameteri:{3:{1:!0,2:!0}},samplerParameterf:{3:{1:!0}},getSamplerParameter:{2:{1:!0}},fenceSync:{2:{0:!0,1:{enumBitwiseOr:[]}}},clientWaitSync:{3:{1:{enumBitwiseOr:["SYNC_FLUSH_COMMANDS_BIT"]}}},waitSync:{3:{1:{enumBitwiseOr:[]}}},getSyncParameter:{2:{1:!0}},bindTransformFeedback:{2:{0:!0}},beginTransformFeedback:{1:{0:!0}},transformFeedbackVaryings:{3:{2:!0}},bindBufferBase:{3:{0:!0}},bindBufferRange:{5:{0:!0}},getIndexedParameter:{2:{0:!0}},getActiveUniforms:{3:{2:!0}},getActiveUniformBlockParameter:{3:{2:!0}}},i=null,o=null;function a(t){if(null==i)for(var e in i={},o={},t)"number"==typeof t[e]&&(i[t[e]]=e,o[e]=t[e])}function s(){if(null==i)throw"WebGLDebugUtils.init(ctx) not called"}function u(t){s();var e=i[t];return void 0!==e?"gl."+e:"/*UNKNOWN WebGL ENUM*/ 0x"+t.toString(16)}function c(t,e,n,i){var a;if(void 0!==(a=r[t])&&(void 0!==(a=a[e])&&a[n])){if("object"==typeof a[n]&&void 0!==a[n].enumBitwiseOr){for(var s=a[n].enumBitwiseOr,c=0,l=[],h=0;h<s.length;++h){var f=o[s[h]];0!=(i&f)&&(c|=f,l.push(u(f)))}return c===i?l.join(" | "):u(i)}return u(i)}return null===i?"null":void 0===i?"undefined":i.toString()}function l(t,e,n){t.__defineGetter__(n,function(){return e[n]}),t.__defineSetter__(n,function(t){e[n]=t})}function h(t){var e=!!t.createTransformFeedback;e&&t.bindVertexArray(null);var n=t.getParameter(t.MAX_VERTEX_ATTRIBS),r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r);for(var i=0;i<n;++i)t.disableVertexAttribArray(i),t.vertexAttribPointer(i,4,t.FLOAT,!1,0,0),t.vertexAttrib1f(i,0),e&&t.vertexAttribDivisor(i,0);t.deleteBuffer(r);var o=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);for(i=0;i<o;++i)t.activeTexture(t.TEXTURE0+i),t.bindTexture(t.TEXTURE_CUBE_MAP,null),t.bindTexture(t.TEXTURE_2D,null),e&&(t.bindTexture(t.TEXTURE_2D_ARRAY,null),t.bindTexture(t.TEXTURE_3D,null),t.bindSampler(i,null));if(t.activeTexture(t.TEXTURE0),t.useProgram(null),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.DITHER),t.disable(t.SCISSOR_TEST),t.blendColor(0,0,0,0),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.clearColor(0,0,0,0),t.clearDepth(1),t.clearStencil(-1),t.colorMask(!0,!0,!0,!0),t.cullFace(t.BACK),t.depthFunc(t.LESS),t.depthMask(!0),t.depthRange(0,1),t.frontFace(t.CCW),t.hint(t.GENERATE_MIPMAP_HINT,t.DONT_CARE),t.lineWidth(1),t.pixelStorei(t.PACK_ALIGNMENT,4),t.pixelStorei(t.UNPACK_ALIGNMENT,4),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.UNPACK_COLORSPACE_CONVERSION_WEBGL&&t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.BROWSER_DEFAULT_WEBGL),t.polygonOffset(0,0),t.sampleCoverage(1,!1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilMask(4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT),e){t.drawBuffers([t.BACK]),t.readBuffer(t.BACK),t.bindBuffer(t.COPY_READ_BUFFER,null),t.bindBuffer(t.COPY_WRITE_BUFFER,null),t.bindBuffer(t.PIXEL_PACK_BUFFER,null),t.bindBuffer(t.PIXEL_UNPACK_BUFFER,null);var a=t.getParameter(t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS);for(i=0;i<a;++i)t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,i,null);var s=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);for(i=0;i<s;++i)t.bindBufferBase(t.UNIFORM_BUFFER,i,null);t.disable(t.RASTERIZER_DISCARD),t.pixelStorei(t.UNPACK_IMAGE_HEIGHT,0),t.pixelStorei(t.UNPACK_SKIP_IMAGES,0),t.pixelStorei(t.UNPACK_ROW_LENGTH,0),t.pixelStorei(t.UNPACK_SKIP_ROWS,0),t.pixelStorei(t.UNPACK_SKIP_PIXELS,0),t.pixelStorei(t.PACK_ROW_LENGTH,0),t.pixelStorei(t.PACK_SKIP_ROWS,0),t.pixelStorei(t.PACK_SKIP_PIXELS,0),t.hint(t.FRAGMENT_SHADER_DERIVATIVE_HINT,t.DONT_CARE)}for(;t.getError(););}return{init:a,mightBeEnum:function(t){return s(),void 0!==i[t]},glEnumToString:u,glFunctionArgToString:c,glFunctionArgsToString:function(t,e){for(var n="",r=e.length,i=0;i<r;++i)n+=(0==i?"":", ")+c(t,r,i,e[i]);return n},makeDebugContext:function t(e,r,i,o){o=o||e,a(e),r=r||function(t,e,r){for(var i="",o=r.length,a=0;a<o;++a)i+=(0==a?"":", ")+c(e,o,a,r[a]);n("WebGL error "+u(t)+" in "+e+"("+i+")")};var s={};function h(t,e){return function(){i&&i(e,arguments);var n=t[e].apply(t,arguments),a=o.getError();return 0!=a&&(s[a]=!0,r(a,e,arguments)),n}}var f={};for(var d in e)if("function"==typeof e[d])if("getExtension"!=d)f[d]=h(e,d);else{var p=h(e,d);f[d]=function(){var n=p.apply(e,arguments);return n?t(n,r,i,o):null}}else l(f,e,d);return f.getError=function(){for(var t in s)if(s.hasOwnProperty(t)&&s[t])return s[t]=!1,t;return e.NO_ERROR},f},makeLostContextSimulatingCanvas:function(e){var n,r,i,o=[],a=[],s={},u=1,c=!1,f=[],d=0,p=0,v=!1,g=0,y={};function m(t){return"function"==typeof t?t:function(e){t.handleEvent(e)}}e.getContext=(i=e.getContext,function(){var o=i.apply(e,arguments);if(o instanceof WebGLRenderingContext||t.WebGL2RenderingContext&&o instanceof WebGL2RenderingContext){if(o!=n){if(n)throw"got different context";r=t.WebGL2RenderingContext&&o instanceof WebGL2RenderingContext,s=function(t){for(var e in t)"function"==typeof t[e]?s[e]=x(t,e):l(s,t,e);s.getError=function(){if(w(),!c)for(;t=n.getError();)y[t]=!0;for(var t in y)if(y[t])return delete y[t],t;return s.NO_ERROR};var i=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"];r&&i.push("createQuery","createSampler","fenceSync","createTransformFeedback","createVertexArray");for(var o=0;o<i.length;++o){var a=i[o];s[a]=function(e){return function(){if(w(),c)return null;var n=e.apply(t,arguments);return n.__webglDebugContextLostId__=u,f.push(n),n}}(t[a])}var h=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"];r&&h.push("getInternalformatParameter","getQuery","getQueryParameter","getSamplerParameter","getSyncParameter","getTransformFeedbackVarying","getIndexedParameter","getUniformIndices","getActiveUniforms","getActiveUniformBlockParameter","getActiveUniformBlockName");for(var o=0;o<h.length;++o){var a=h[o];s[a]=function(e){return function(){return w(),c?null:e.apply(t,arguments)}}(s[a])}var d,p=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"];r&&p.push("isQuery","isSampler","isSync","isTransformFeedback","isVertexArray");for(var o=0;o<p.length;++o){var a=p[o];s[a]=function(e){return function(){return w(),!c&&e.apply(t,arguments)}}(s[a])}return s.checkFramebufferStatus=(d=s.checkFramebufferStatus,function(){return w(),c?s.FRAMEBUFFER_UNSUPPORTED:d.apply(t,arguments)}),s.getAttribLocation=function(e){return function(){return w(),c?-1:e.apply(t,arguments)}}(s.getAttribLocation),s.getVertexAttribOffset=function(e){return function(){return w(),c?0:e.apply(t,arguments)}}(s.getVertexAttribOffset),s.isContextLost=function(){return c},r&&(s.getFragDataLocation=function(e){return function(){return w(),c?-1:e.apply(t,arguments)}}(s.getFragDataLocation),s.clientWaitSync=function(e){return function(){return w(),c?s.WAIT_FAILED:e.apply(t,arguments)}}(s.clientWaitSync),s.getUniformBlockIndex=function(e){return function(){return w(),c?s.INVALID_INDEX:e.apply(t,arguments)}}(s.getUniformBlockIndex)),s}(n=o)}return s}return o});var _=function(t){o.push(m(t))},b=function(t){a.push(m(t))};function w(){++p,c||d==p&&e.loseContext()}function x(t,e){var n=t[e];return function(){if(w(),!c)return n.apply(t,arguments)}}function E(t){return{statusMessage:t,preventDefault:function(){v=!0}}}return function(t){var e=t.addEventListener;t.addEventListener=function(n,r,i){switch(n){case"webglcontextlost":_(r);break;case"webglcontextrestored":b(r);break;default:e.apply(t,arguments)}}}(e),e.loseContext=function(){if(!c){for(c=!0,d=0,++u;n.getError(););!function(){for(var t=Object.keys(y),e=0;e<t.length;++e)delete y[t[e]]}(),y[n.CONTEXT_LOST_WEBGL]=!0;var t=E("context lost"),r=o.slice();setTimeout(function(){for(var n=0;n<r.length;++n)r[n](t);g>=0&&setTimeout(function(){e.restoreContext()},g)},0)}},e.restoreContext=function(){c&&a.length&&setTimeout(function(){if(!v)throw"can not restore. webglcontestlost listener did not call event.preventDefault";!function(){for(var t=0;t<f.length;++t){var e=f[t];e instanceof WebGLBuffer?n.deleteBuffer(e):e instanceof WebGLFramebuffer?n.deleteFramebuffer(e):e instanceof WebGLProgram?n.deleteProgram(e):e instanceof WebGLRenderbuffer?n.deleteRenderbuffer(e):e instanceof WebGLShader?n.deleteShader(e):e instanceof WebGLTexture?n.deleteTexture(e):r&&(e instanceof WebGLQuery?n.deleteQuery(e):e instanceof WebGLSampler?n.deleteSampler(e):e instanceof WebGLSync?n.deleteSync(e):e instanceof WebGLTransformFeedback?n.deleteTransformFeedback(e):e instanceof WebGLVertexArrayObject&&n.deleteVertexArray(e))}}(),h(n),c=!1,p=0,v=!1;for(var t=a.slice(),e=E("context restored"),i=0;i<t.length;++i)t[i](e)},0)},e.loseContextInNCalls=function(t){if(c)throw"You can not ask a lost contet to be lost";d=p+t},e.getNumCalls=function(){return p},e.setRestoreTimeout=function(t){g=t},e},resetToInitialState:h}}(),t.exports=WebGLDebugUtils}).call(this,n("yLpj"))},tVzf:function(t,e,n){t.exports=n("hf/P")},"tz+0":function(t,e){t.exports=function(t,e,n,r){var i=n[0],o=n[1],a=e[0]-i,s=e[1]-o,u=Math.sin(r),c=Math.cos(r);return t[0]=i+a*c-s*u,t[1]=o+a*u+s*c,t[2]=e[2],t}},u1xf:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqCAYAAADFw8lbAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAb9JREFUeNrsWIuNgzAMLdUNkBHYoGxw3eAYgdvgRmADRuA24G4C2gnaTkA3SDfIOZJPAit8QmwEEk+yaFTJeXGesc3xsBEcd6I70Z0oD944nBhjzvCwdgJT5O872APsJ4qi1+InBHIxWAGmzXRUeKjFSOYmDLU9qCTBBOxmeGBvIpu6d+RDEh61Q4MWVnsXsCtq8h8x6jbF3y58gna/OfWoe6JiZaAm+EjBmp7oZlxEXdd9m6OzAX0nEolTBvrMXAcPvXI+h13fX2wSwPck1WTM+Bapif9mriOaQLlA0aBIvcuiw4kSeDdXZI/CtymhpU6qVv+O7DtK9ETWD6GCdyHrxJeoGnHIAril5944r52oSFs29U0yRPRK1u9CwaJZ/vQleifrVIjoR1DS2isRa8e6e+jgPWyXRGsxZ3Xq6SXUHEeuMlpwTa4O33mIw4pbAjh7aZZoThhD8oBIahH947zTN/aePRKnGJhK2eambGROz2hTjeRSTMopHypYyWojCzayHB8hNEY6EyXbim4zg2DnO8AiZFsRLhyDWnv+L5GQ8tS/VNlmT9Z6lT2ng2x5WCswyWqUizpsDZsZRf4EGACV8WLhZsqU3gAAAABJRU5ErkJggg=="},vRGJ:function(t,e,n){var r=n("AqCL");t.exports=d,t.exports.parse=o,t.exports.compile=function(t,e){return s(o(t,e))},t.exports.tokensToFunction=s,t.exports.tokensToRegExp=f;var i=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function o(t,e){for(var n,r=[],o=0,a=0,s="",l=e&&e.delimiter||"/";null!=(n=i.exec(t));){var h=n[0],f=n[1],d=n.index;if(s+=t.slice(a,d),a=d+h.length,f)s+=f[1];else{var p=t[a],v=n[2],g=n[3],y=n[4],m=n[5],_=n[6],b=n[7];s&&(r.push(s),s="");var w=null!=v&&null!=p&&p!==v,x="+"===_||"*"===_,E="?"===_||"*"===_,O=n[2]||l,P=y||m;r.push({name:g||o++,prefix:v||"",delimiter:O,optional:E,repeat:x,partial:w,asterisk:!!b,pattern:P?c(P):b?".*":"[^"+u(O)+"]+?"})}}return a<t.length&&(s+=t.substr(a)),s&&r.push(s),r}function a(t){return encodeURI(t).replace(/[\/?#]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}function s(t){for(var e=new Array(t.length),n=0;n<t.length;n++)"object"==typeof t[n]&&(e[n]=new RegExp("^(?:"+t[n].pattern+")$"));return function(n,i){for(var o="",s=n||{},u=(i||{}).pretty?a:encodeURIComponent,c=0;c<t.length;c++){var l=t[c];if("string"!=typeof l){var h,f=s[l.name];if(null==f){if(l.optional){l.partial&&(o+=l.prefix);continue}throw new TypeError('Expected "'+l.name+'" to be defined')}if(r(f)){if(!l.repeat)throw new TypeError('Expected "'+l.name+'" to not repeat, but received `'+JSON.stringify(f)+"`");if(0===f.length){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to not be empty')}for(var d=0;d<f.length;d++){if(h=u(f[d]),!e[c].test(h))throw new TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'", but received `'+JSON.stringify(h)+"`");o+=(0===d?l.prefix:l.delimiter)+h}}else{if(h=l.asterisk?encodeURI(f).replace(/[?#]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()}):u(f),!e[c].test(h))throw new TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but received "'+h+'"');o+=l.prefix+h}}else o+=l}return o}}function u(t){return t.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function c(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function l(t,e){return t.keys=e,t}function h(t){return t.sensitive?"":"i"}function f(t,e,n){r(e)||(n=e||n,e=[]);for(var i=(n=n||{}).strict,o=!1!==n.end,a="",s=0;s<t.length;s++){var c=t[s];if("string"==typeof c)a+=u(c);else{var f=u(c.prefix),d="(?:"+c.pattern+")";e.push(c),c.repeat&&(d+="(?:"+f+d+")*"),a+=d=c.optional?c.partial?f+"("+d+")?":"(?:"+f+"("+d+"))?":f+"("+d+")"}}var p=u(n.delimiter||"/"),v=a.slice(-p.length)===p;return i||(a=(v?a.slice(0,-p.length):a)+"(?:"+p+"(?=$))?"),a+=o?"$":i&&v?"":"(?="+p+"|$)",l(new RegExp("^"+a,h(n)),e)}function d(t,e,n){return r(e)||(n=e||n,e=[]),n=n||{},t instanceof RegExp?function(t,e){var n=t.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)e.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return l(t,e)}(t,e):r(t)?function(t,e,n){for(var r=[],i=0;i<t.length;i++)r.push(d(t[i],e,n).source);return l(new RegExp("(?:"+r.join("|")+")",h(n)),e)}(t,e,n):function(t,e,n){return f(o(t,n),e,n)}(t,e,n)}},viRO:function(t,e,n){"use strict";
/** @license React v16.7.0
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n("MgzW"),i="function"==typeof Symbol&&Symbol.for,o=i?Symbol.for("react.element"):60103,a=i?Symbol.for("react.portal"):60106,s=i?Symbol.for("react.fragment"):60107,u=i?Symbol.for("react.strict_mode"):60108,c=i?Symbol.for("react.profiler"):60114,l=i?Symbol.for("react.provider"):60109,h=i?Symbol.for("react.context"):60110,f=i?Symbol.for("react.concurrent_mode"):60111,d=i?Symbol.for("react.forward_ref"):60112,p=i?Symbol.for("react.suspense"):60113,v=i?Symbol.for("react.memo"):60115,g=i?Symbol.for("react.lazy"):60116,y="function"==typeof Symbol&&Symbol.iterator;function m(t){for(var e=arguments.length-1,n="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=0;r<e;r++)n+="&args[]="+encodeURIComponent(arguments[r+1]);!function(t,e,n,r,i,o,a,s){if(!t){if(t=void 0,void 0===e)t=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,i,o,a,s],c=0;(t=Error(e.replace(/%s/g,function(){return u[c++]}))).name="Invariant Violation"}throw t.framesToPop=1,t}}(!1,"Minified React error #"+t+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b={};function w(t,e,n){this.props=t,this.context=e,this.refs=b,this.updater=n||_}function x(){}function E(t,e,n){this.props=t,this.context=e,this.refs=b,this.updater=n||_}w.prototype.isReactComponent={},w.prototype.setState=function(t,e){"object"!=typeof t&&"function"!=typeof t&&null!=t&&m("85"),this.updater.enqueueSetState(this,t,e,"setState")},w.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},x.prototype=w.prototype;var O=E.prototype=new x;O.constructor=E,r(O,w.prototype),O.isPureReactComponent=!0;var P={current:null,currentDispatcher:null},S=Object.prototype.hasOwnProperty,T={key:!0,ref:!0,__self:!0,__source:!0};function C(t,e,n){var r=void 0,i={},a=null,s=null;if(null!=e)for(r in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(a=""+e.key),e)S.call(e,r)&&!T.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(r in u=t.defaultProps)void 0===i[r]&&(i[r]=u[r]);return{$$typeof:o,type:t,key:a,ref:s,props:i,_owner:P.current}}function A(t){return"object"==typeof t&&null!==t&&t.$$typeof===o}var M=/\/+/g,k=[];function j(t,e,n,r){if(k.length){var i=k.pop();return i.result=t,i.keyPrefix=e,i.func=n,i.context=r,i.count=0,i}return{result:t,keyPrefix:e,func:n,context:r,count:0}}function R(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>k.length&&k.push(t)}function L(t,e,n){return null==t?0:function t(e,n,r,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case o:case a:u=!0}}if(u)return r(i,e,""===n?"."+I(e,0):n),1;if(u=0,n=""===n?".":n+":",Array.isArray(e))for(var c=0;c<e.length;c++){var l=n+I(s=e[c],c);u+=t(s,l,r,i)}else if(l=null===e||"object"!=typeof e?null:"function"==typeof(l=y&&e[y]||e["@@iterator"])?l:null,"function"==typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=t(s=s.value,l=n+I(s,c++),r,i);else"object"===s&&m("31","[object Object]"==(r=""+e)?"object with keys {"+Object.keys(e).join(", ")+"}":r,"");return u}(t,"",e,n)}function I(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,function(t){return e[t]})}(t.key):e.toString(36)}function D(t,e){t.func.call(t.context,e,t.count++)}function F(t,e,n){var r=t.result,i=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?N(t,r,n,function(t){return t}):null!=t&&(A(t)&&(t=function(t,e){return{$$typeof:o,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,i+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(M,"$&/")+"/")+n)),r.push(t))}function N(t,e,n,r,i){var o="";null!=n&&(o=(""+n).replace(M,"$&/")+"/"),L(t,F,e=j(e,o,r,i)),R(e)}var B={Children:{map:function(t,e,n){if(null==t)return t;var r=[];return N(t,r,null,e,n),r},forEach:function(t,e,n){if(null==t)return t;L(t,D,e=j(null,null,e,n)),R(e)},count:function(t){return L(t,function(){return null},null)},toArray:function(t){var e=[];return N(t,e,null,function(t){return t}),e},only:function(t){return A(t)||m("143"),t}},createRef:function(){return{current:null}},Component:w,PureComponent:E,createContext:function(t,e){return void 0===e&&(e=null),(t={$$typeof:h,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:l,_context:t},t.Consumer=t},forwardRef:function(t){return{$$typeof:d,render:t}},lazy:function(t){return{$$typeof:g,_ctor:t,_status:-1,_result:null}},memo:function(t,e){return{$$typeof:v,type:t,compare:void 0===e?null:e}},Fragment:s,StrictMode:u,Suspense:p,createElement:C,cloneElement:function(t,e,n){null==t&&m("267",t);var i=void 0,a=r({},t.props),s=t.key,u=t.ref,c=t._owner;if(null!=e){void 0!==e.ref&&(u=e.ref,c=P.current),void 0!==e.key&&(s=""+e.key);var l=void 0;for(i in t.type&&t.type.defaultProps&&(l=t.type.defaultProps),e)S.call(e,i)&&!T.hasOwnProperty(i)&&(a[i]=void 0===e[i]&&void 0!==l?l[i]:e[i])}if(1===(i=arguments.length-2))a.children=n;else if(1<i){l=Array(i);for(var h=0;h<i;h++)l[h]=arguments[h+2];a.children=l}return{$$typeof:o,type:t.type,key:s,ref:u,props:a,_owner:c}},createFactory:function(t){var e=C.bind(null,t);return e.type=t,e},isValidElement:A,version:"16.7.0",unstable_ConcurrentMode:f,unstable_Profiler:c,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:P,assign:r}},U={default:B},z=U&&B||U;t.exports=z.default||z},vuIU:function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}n.d(e,"a",function(){return i})},"wh/4":function(t,e,n){"use strict";function r(t){return t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s")}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function o(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));var o=t.width*n,a=t.height*n,s=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),s]}n.d(e,"b",function(){return r}),n.d(e,"c",function(){return i}),n.d(e,"a",function(){return o})},wp3f:function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}},xDUe:function(t,e){t.exports=function(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}},xnQO:function(t,e,n){"use strict";function r(t,e){this.x=t,this.y=e}t.exports=r,r.prototype={clone:function(){return new r(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=e*this.x-n*this.y,i=n*this.x+e*this.y;return this.x=r,this.y=i,this},_rotateAround:function(t,e){var n=Math.cos(t),r=Math.sin(t),i=e.x+n*(this.x-e.x)-r*(this.y-e.y),o=e.y+r*(this.x-e.x)+n*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},r.convert=function(t){return t instanceof r?t:Array.isArray(t)?new r(t[0],t[1]):t}},xo4u:function(t,e,n){"use strict";var r=n("JD4l"),i=n("WsjP");function o(t){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function a(t){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}var s=35632,u=35633;function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed",n=t.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return n?n[1]:e}function l(t,e,n,r){for(var i=t.split(/\r?\n/),o={},a={},l=r||c(e)||"(unnamed)",d="".concat(function(t){switch(t){case s:return"fragment";case u:return"vertex";default:return"unknown type"}}(n)," shader ").concat(l),p=0;p<i.length;p++){var v=i[p];if(!(v.length<=1)){var g=v.split(":"),y=g[0],m=parseInt(g[2],10);if(isNaN(m))throw new Error("GLSL compilation error in ".concat(d,": ").concat(t));"WARNING"!==y?o[m]=v:a[m]=v}}var _=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ",r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map(function(t,r){var o=r+e,a=String(o).length,s=f(o,i-a);return s+n+t})}(e);return{shaderName:d,errors:h(o,_),warnings:h(a,_)}}function h(t,e){for(var n="",r=0;r<e.length;r++){var i=e[r];if((t[r+3]||t[r+2]||t[r+1])&&(n+="".concat(i,"\n"),t[r+1])){var o=t[r+1],a=o.split(":",3),s=a[0],u=parseInt(a[1],10)||0,c=o.substring(a.join(":").length+1).trim();n+=f("^^^ ".concat(s,": ").concat(c,"\n\n"),u)}}return n}function f(t,e){for(var n="",r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}var d=n("7pNt"),p=n("ggbK");function v(t){var e=100,n=t.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){var r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}var g=n("gBGw");n.d(e,"c",function(){return r.c}),n.d(e,"a",function(){return r.a}),n.d(e,"b",function(){return r.b}),n.d(e,"m",function(){return i.c}),n.d(e,"n",function(){return i.d}),n.d(e,"e",function(){return i.b}),n.d(e,"d",function(){return i.a}),n.d(e,"p",function(){return o}),n.d(e,"f",function(){return a}),n.d(e,"o",function(){return l}),n.d(e,"k",function(){return c}),n.d(e,"h",function(){return d.a}),n.d(e,"q",function(){return d.d}),n.d(e,"j",function(){return p.b}),n.d(e,"i",function(){return p.a}),n.d(e,"l",function(){return v}),n.d(e,"g",function(){return g.a})},yLV6:function(t,e,n){var r;
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
!function(i,o,a,s){"use strict";var u,c=["","webkit","Moz","MS","ms","o"],l=o.createElement("div"),h="function",f=Math.round,d=Math.abs,p=Date.now;function v(t,e,n){return setTimeout(x(t,n),e)}function g(t,e,n){return!!Array.isArray(t)&&(y(t,n[e],n),!0)}function y(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==s)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function m(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),t.apply(this,arguments)}}u="function"!=typeof Object.assign?function(t){if(t===s||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==s&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var _=m(function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&t[r[i]]===s)&&(t[r[i]]=e[r[i]]),i++;return t},"extend","Use `assign`."),b=m(function(t,e){return _(t,e,!0)},"merge","Use `assign`.");function w(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&u(r,n)}function x(t,e){return function(){return t.apply(e,arguments)}}function E(t,e){return typeof t==h?t.apply(e&&e[0]||s,e):t}function O(t,e){return t===s?e:t}function P(t,e,n){y(A(e),function(e){t.addEventListener(e,n,!1)})}function S(t,e,n){y(A(e),function(e){t.removeEventListener(e,n,!1)})}function T(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function C(t,e){return t.indexOf(e)>-1}function A(t){return t.trim().split(/\s+/g)}function M(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function k(t){return Array.prototype.slice.call(t,0)}function j(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var a=e?t[o][e]:t[o];M(i,a)<0&&r.push(t[o]),i[o]=a,o++}return n&&(r=e?r.sort(function(t,n){return t[e]>n[e]}):r.sort()),r}function R(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<c.length;){if((r=(n=c[o])?n+i:e)in t)return r;o++}return s}var L=1;function I(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var D="ontouchstart"in i,F=R(i,"PointerEvent")!==s,N=D&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),B=25,U=1,z=2,G=4,V=8,W=1,Z=2,H=4,X=8,Y=16,J=Z|H,q=X|Y,Q=J|q,K=["x","y"],$=["clientX","clientY"];function tt(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){E(t.options.enable,[t])&&n.handler(e)},this.init()}function et(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=e&U&&r-i==0,a=e&(G|V)&&r-i==0;n.isFirst=!!o,n.isFinal=!!a,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=nt(e));i>1&&!n.firstMultiple?n.firstMultiple=nt(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,u=a?a.center:o.center,c=e.center=rt(r);e.timeStamp=p(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=st(u,c),e.distance=at(u,c),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};e.eventType!==U&&o.eventType!==G||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y});e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=ot(e.deltaX,e.deltaY);var l=it(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=l.x,e.overallVelocityY=l.y,e.overallVelocity=d(l.x)>d(l.y)?l.x:l.y,e.scale=a?(h=a.pointers,f=r,at(f[0],f[1],$)/at(h[0],h[1],$)):1,e.rotation=a?function(t,e){return st(e[1],e[0],$)+st(t[1],t[0],$)}(a.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,o,a=t.lastInterval||e,u=e.timeStamp-a.timeStamp;if(e.eventType!=V&&(u>B||a.velocity===s)){var c=e.deltaX-a.deltaX,l=e.deltaY-a.deltaY,h=it(u,c,l);r=h.x,i=h.y,n=d(h.x)>d(h.y)?h.x:h.y,o=ot(c,l),t.lastInterval=e}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}(n,e);var h,f;var v=t.element;T(e.srcEvent.target,v)&&(v=e.srcEvent.target);e.target=v}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function nt(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:f(t.pointers[n].clientX),clientY:f(t.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:e,center:rt(e),deltaX:t.deltaX,deltaY:t.deltaY}}function rt(t){var e=t.length;if(1===e)return{x:f(t[0].clientX),y:f(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:f(n/e),y:f(r/e)}}function it(t,e,n){return{x:e/t||0,y:n/t||0}}function ot(t,e){return t===e?W:d(t)>=d(e)?t<0?Z:H:e<0?X:Y}function at(t,e,n){n||(n=K);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function st(t,e,n){n||(n=K);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}tt.prototype={handler:function(){},init:function(){this.evEl&&P(this.element,this.evEl,this.domHandler),this.evTarget&&P(this.target,this.evTarget,this.domHandler),this.evWin&&P(I(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(I(this.element),this.evWin,this.domHandler)}};var ut={mousedown:U,mousemove:z,mouseup:G},ct="mousedown",lt="mousemove mouseup";function ht(){this.evEl=ct,this.evWin=lt,this.pressed=!1,tt.apply(this,arguments)}w(ht,tt,{handler:function(t){var e=ut[t.type];e&U&&0===t.button&&(this.pressed=!0),e&z&&1!==t.which&&(e=G),this.pressed&&(e&G&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var ft={pointerdown:U,pointermove:z,pointerup:G,pointercancel:V,pointerout:V},dt={2:"touch",3:"pen",4:"mouse",5:"kinect"},pt="pointerdown",vt="pointermove pointerup pointercancel";function gt(){this.evEl=pt,this.evWin=vt,tt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(pt="MSPointerDown",vt="MSPointerMove MSPointerUp MSPointerCancel"),w(gt,tt,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=ft[r],o=dt[t.pointerType]||t.pointerType,a="touch"==o,s=M(e,t.pointerId,"pointerId");i&U&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):i&(G|V)&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var yt={touchstart:U,touchmove:z,touchend:G,touchcancel:V},mt="touchstart",_t="touchstart touchmove touchend touchcancel";function bt(){this.evTarget=mt,this.evWin=_t,this.started=!1,tt.apply(this,arguments)}w(bt,tt,{handler:function(t){var e=yt[t.type];if(e===U&&(this.started=!0),this.started){var n=function(t,e){var n=k(t.touches),r=k(t.changedTouches);e&(G|V)&&(n=j(n.concat(r),"identifier",!0));return[n,r]}.call(this,t,e);e&(G|V)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var wt={touchstart:U,touchmove:z,touchend:G,touchcancel:V},xt="touchstart touchmove touchend touchcancel";function Et(){this.evTarget=xt,this.targetIds={},tt.apply(this,arguments)}w(Et,tt,{handler:function(t){var e=wt[t.type],n=function(t,e){var n=k(t.touches),r=this.targetIds;if(e&(U|z)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=k(t.changedTouches),s=[],u=this.target;if(o=n.filter(function(t){return T(t.target,u)}),e===U)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;i=0;for(;i<a.length;)r[a[i].identifier]&&s.push(a[i]),e&(G|V)&&delete r[a[i].identifier],i++;if(!s.length)return;return[j(o.concat(s),"identifier",!0),s]}.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}});var Ot=2500,Pt=25;function St(){tt.apply(this,arguments);var t=x(this.handler,this);this.touch=new Et(this.manager,t),this.mouse=new ht(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function Tt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout(function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)},Ot)}}w(St,tt,{handler:function(t,e,n){var r="touch"==n.pointerType,i="mouse"==n.pointerType;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)(function(t,e){t&U?(this.primaryTouch=e.changedPointers[0].identifier,Tt.call(this,e)):t&(G|V)&&Tt.call(this,e)}).call(this,e,n);else if(i&&function(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),a=Math.abs(n-i.y);if(o<=Pt&&a<=Pt)return!0}return!1}.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ct=R(l.style,"touchAction"),At=Ct!==s,Mt="auto",kt="manipulation",jt="none",Rt="pan-x",Lt="pan-y",It=function(){if(!At)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){t[n]=!e||i.CSS.supports("touch-action",n)}),t}();function Dt(t,e){this.manager=t,this.set(e)}Dt.prototype={set:function(t){"compute"==t&&(t=this.compute()),At&&this.manager.element.style&&It[t]&&(this.manager.element.style[Ct]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return y(this.manager.recognizers,function(e){E(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(C(t,jt))return jt;var e=C(t,Rt),n=C(t,Lt);if(e&&n)return jt;if(e||n)return e?Rt:Lt;if(C(t,kt))return kt;return Mt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=C(r,jt)&&!It[jt],o=C(r,Lt)&&!It[Lt],a=C(r,Rt)&&!It[Rt];if(i){var s=1===t.pointers.length,u=t.distance<2,c=t.deltaTime<250;if(s&&u&&c)return}if(!a||!o)return i||o&&n&J||a&&n&q?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Ft=1,Nt=2,Bt=4,Ut=8,zt=Ut,Gt=16;function Vt(t){this.options=u({},this.defaults,t||{}),this.id=L++,this.manager=null,this.options.enable=O(this.options.enable,!0),this.state=Ft,this.simultaneous={},this.requireFail=[]}function Wt(t){return t&Gt?"cancel":t&Ut?"end":t&Bt?"move":t&Nt?"start":""}function Zt(t){return t==Y?"down":t==X?"up":t==Z?"left":t==H?"right":""}function Ht(t,e){var n=e.manager;return n?n.get(t):t}function Xt(){Vt.apply(this,arguments)}function Yt(){Xt.apply(this,arguments),this.pX=null,this.pY=null}function Jt(){Xt.apply(this,arguments)}function qt(){Vt.apply(this,arguments),this._timer=null,this._input=null}function Qt(){Xt.apply(this,arguments)}function Kt(){Xt.apply(this,arguments)}function $t(){Vt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function te(t,e){return(e=e||{}).recognizers=O(e.recognizers,te.defaults.preset),new ee(t,e)}Vt.prototype={defaults:{},set:function(t){return u(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(g(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Ht(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return g(t,"dropRecognizeWith",this)?this:(t=Ht(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(g(t,"requireFailure",this))return this;var e=this.requireFail;return-1===M(e,t=Ht(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(g(t,"dropRequireFailure",this))return this;t=Ht(t,this);var e=M(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<Ut&&r(e.options.event+Wt(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=Ut&&r(e.options.event+Wt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|Ft)))return!1;t++}return!0},recognize:function(t){var e=u({},t);if(!E(this.options.enable,[this,e]))return this.reset(),void(this.state=32);this.state&(zt|Gt|32)&&(this.state=Ft),this.state=this.process(e),this.state&(Nt|Bt|Ut|Gt)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},w(Xt,Vt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=e&(Nt|Bt),i=this.attrTest(t);return r&&(n&V||!i)?e|Gt:r||i?n&G?e|Ut:e&Nt?e|Bt:Nt:32}}),w(Yt,Xt,{defaults:{event:"pan",threshold:10,pointers:1,direction:Q},getTouchAction:function(){var t=this.options.direction,e=[];return t&J&&e.push(Lt),t&q&&e.push(Rt),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,a=t.deltaY;return i&e.direction||(e.direction&J?(i=0===o?W:o<0?Z:H,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===a?W:a<0?X:Y,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return Xt.prototype.attrTest.call(this,t)&&(this.state&Nt||!(this.state&Nt)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Zt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),w(Jt,Xt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[jt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&Nt)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),w(qt,Vt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Mt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||t.eventType&(G|V)&&!i)this.reset();else if(t.eventType&U)this.reset(),this._timer=v(function(){this.state=zt,this.tryEmit()},e.time,this);else if(t.eventType&G)return zt;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===zt&&(t&&t.eventType&G?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),w(Qt,Xt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[jt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&Nt)}}),w(Kt,Xt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:J|q,pointers:1},getTouchAction:function(){return Yt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(J|q)?e=t.overallVelocity:n&J?e=t.overallVelocityX:n&q&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&d(e)>this.options.velocity&&t.eventType&G},emit:function(t){var e=Zt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),w($t,Vt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[kt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),t.eventType&U&&0===this.count)return this.failTimeout();if(r&&i&&n){if(t.eventType!=G)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||at(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=v(function(){this.state=zt,this.tryEmit()},e.interval,this),Nt):zt}return 32},failTimeout:function(){return this._timer=v(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==zt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),te.VERSION="2.0.7",te.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Qt,{enable:!1}],[Jt,{enable:!1},["rotate"]],[Kt,{direction:J}],[Yt,{direction:J},["swipe"]],[$t],[$t,{event:"doubletap",taps:2},["tap"]],[qt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function ee(t,e){var n;this.options=u({},te.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(F?gt:N?Et:D?St:ht))(n,et),this.touchAction=new Dt(this,this.options.touchAction),ne(this,!0),y(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function ne(t,e){var n,r=t.element;r.style&&(y(t.options.cssProps,function(i,o){n=R(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""}),e||(t.oldCssProps={}))}ee.prototype={set:function(t){return u(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&i.state&zt)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&n.state&(Nt|Bt|Ut)&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof Vt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(g(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(g(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=M(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==s&&e!==s){var n=this.handlers;return y(A(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this}},off:function(t,e){if(t!==s){var n=this.handlers;return y(A(t),function(t){e?n[t]&&n[t].splice(M(n[t],e),1):delete n[t]}),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&ne(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(te,{INPUT_START:U,INPUT_MOVE:z,INPUT_END:G,INPUT_CANCEL:V,STATE_POSSIBLE:Ft,STATE_BEGAN:Nt,STATE_CHANGED:Bt,STATE_ENDED:Ut,STATE_RECOGNIZED:zt,STATE_CANCELLED:Gt,STATE_FAILED:32,DIRECTION_NONE:W,DIRECTION_LEFT:Z,DIRECTION_RIGHT:H,DIRECTION_UP:X,DIRECTION_DOWN:Y,DIRECTION_HORIZONTAL:J,DIRECTION_VERTICAL:q,DIRECTION_ALL:Q,Manager:ee,Input:tt,TouchAction:Dt,TouchInput:Et,MouseInput:ht,PointerEventInput:gt,TouchMouseInput:St,SingleTouchInput:bt,Recognizer:Vt,AttrRecognizer:Xt,Tap:$t,Pan:Yt,Swipe:Kt,Pinch:Jt,Rotate:Qt,Press:qt,on:P,off:S,each:y,merge:b,extend:_,assign:u,inherit:w,bindFn:x,prefixed:R}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=te,(r=function(){return te}.call(e,n,e,t))===s||(t.exports=r)}(window,document)},yLpj:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},yU0y:function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return i}),n.d(e,"c",function(){return o});var r=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array,o=Math.random;Math.PI},yl30:function(t,e,n){"use strict";
/** @license React v16.7.0
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n("q1tI"),i=n("MgzW"),o=n("QCnb");function a(t){for(var e=arguments.length-1,n="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=0;r<e;r++)n+="&args[]="+encodeURIComponent(arguments[r+1]);!function(t,e,n,r,i,o,a,s){if(!t){if(t=void 0,void 0===e)t=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,i,o,a,s],c=0;(t=Error(e.replace(/%s/g,function(){return u[c++]}))).name="Invariant Violation"}throw t.framesToPop=1,t}}(!1,"Minified React error #"+t+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}r||a("227");var s=!1,u=null,c=!1,l=null,h={onError:function(t){s=!0,u=t}};function f(t,e,n,r,i,o,a,c,l){s=!1,u=null,function(t,e,n,r,i,o,a,s,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(t){this.onError(t)}}.apply(h,arguments)}var d=null,p={};function v(){if(d)for(var t in p){var e=p[t],n=d.indexOf(t);if(-1<n||a("96",t),!y[n])for(var r in e.extractEvents||a("97",t),y[n]=e,n=e.eventTypes){var i=void 0,o=n[r],s=e,u=r;m.hasOwnProperty(u)&&a("99",u),m[u]=o;var c=o.phasedRegistrationNames;if(c){for(i in c)c.hasOwnProperty(i)&&g(c[i],s,u);i=!0}else o.registrationName?(g(o.registrationName,s,u),i=!0):i=!1;i||a("98",r,t)}}}function g(t,e,n){_[t]&&a("100",t),_[t]=e,b[t]=e.eventTypes[n].dependencies}var y=[],m={},_={},b={},w=null,x=null,E=null;function O(t,e,n){var r=t.type||"unknown-event";t.currentTarget=E(n),function(t,e,n,r,i,o,h,d,p){if(f.apply(this,arguments),s){if(s){var v=u;s=!1,u=null}else a("198"),v=void 0;c||(c=!0,l=v)}}(r,e,void 0,t),t.currentTarget=null}function P(t,e){return null==e&&a("30"),null==t?e:Array.isArray(t)?Array.isArray(e)?(t.push.apply(t,e),t):(t.push(e),t):Array.isArray(e)?[t].concat(e):[t,e]}function S(t,e,n){Array.isArray(t)?t.forEach(e,n):t&&e.call(n,t)}var T=null;function C(t){if(t){var e=t._dispatchListeners,n=t._dispatchInstances;if(Array.isArray(e))for(var r=0;r<e.length&&!t.isPropagationStopped();r++)O(t,e[r],n[r]);else e&&O(t,e,n);t._dispatchListeners=null,t._dispatchInstances=null,t.isPersistent()||t.constructor.release(t)}}var A={injectEventPluginOrder:function(t){d&&a("101"),d=Array.prototype.slice.call(t),v()},injectEventPluginsByName:function(t){var e,n=!1;for(e in t)if(t.hasOwnProperty(e)){var r=t[e];p.hasOwnProperty(e)&&p[e]===r||(p[e]&&a("102",e),p[e]=r,n=!0)}n&&v()}};function M(t,e){var n=t.stateNode;if(!n)return null;var r=w(n);if(!r)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}return t?null:(n&&"function"!=typeof n&&a("231",e,typeof n),n)}function k(t){if(null!==t&&(T=P(T,t)),t=T,T=null,t&&(S(t,C),T&&a("95"),c))throw t=l,c=!1,l=null,t}var j=Math.random().toString(36).slice(2),R="__reactInternalInstance$"+j,L="__reactEventHandlers$"+j;function I(t){if(t[R])return t[R];for(;!t[R];){if(!t.parentNode)return null;t=t.parentNode}return 5===(t=t[R]).tag||6===t.tag?t:null}function D(t){return!(t=t[R])||5!==t.tag&&6!==t.tag?null:t}function F(t){if(5===t.tag||6===t.tag)return t.stateNode;a("33")}function N(t){return t[L]||null}function B(t){do{t=t.return}while(t&&5!==t.tag);return t||null}function U(t,e,n){(e=M(t,n.dispatchConfig.phasedRegistrationNames[e]))&&(n._dispatchListeners=P(n._dispatchListeners,e),n._dispatchInstances=P(n._dispatchInstances,t))}function z(t){if(t&&t.dispatchConfig.phasedRegistrationNames){for(var e=t._targetInst,n=[];e;)n.push(e),e=B(e);for(e=n.length;0<e--;)U(n[e],"captured",t);for(e=0;e<n.length;e++)U(n[e],"bubbled",t)}}function G(t,e,n){t&&n&&n.dispatchConfig.registrationName&&(e=M(t,n.dispatchConfig.registrationName))&&(n._dispatchListeners=P(n._dispatchListeners,e),n._dispatchInstances=P(n._dispatchInstances,t))}function V(t){t&&t.dispatchConfig.registrationName&&G(t._targetInst,null,t)}function W(t){S(t,z)}var Z=!("undefined"==typeof window||!window.document||!window.document.createElement);function H(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var X={animationend:H("Animation","AnimationEnd"),animationiteration:H("Animation","AnimationIteration"),animationstart:H("Animation","AnimationStart"),transitionend:H("Transition","TransitionEnd")},Y={},J={};function q(t){if(Y[t])return Y[t];if(!X[t])return t;var e,n=X[t];for(e in n)if(n.hasOwnProperty(e)&&e in J)return Y[t]=n[e];return t}Z&&(J=document.createElement("div").style,"AnimationEvent"in window||(delete X.animationend.animation,delete X.animationiteration.animation,delete X.animationstart.animation),"TransitionEvent"in window||delete X.transitionend.transition);var Q=q("animationend"),K=q("animationiteration"),$=q("animationstart"),tt=q("transitionend"),et="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nt=null,rt=null,it=null;function ot(){if(it)return it;var t,e,n=rt,r=n.length,i="value"in nt?nt.value:nt.textContent,o=i.length;for(t=0;t<r&&n[t]===i[t];t++);var a=r-t;for(e=1;e<=a&&n[r-e]===i[o-e];e++);return it=i.slice(t,1<e?1-e:void 0)}function at(){return!0}function st(){return!1}function ut(t,e,n,r){for(var i in this.dispatchConfig=t,this._targetInst=e,this.nativeEvent=n,t=this.constructor.Interface)t.hasOwnProperty(i)&&((e=t[i])?this[i]=e(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?at:st,this.isPropagationStopped=st,this}function ct(t,e,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,t,e,n,r),i}return new this(t,e,n,r)}function lt(t){t instanceof this||a("279"),t.destructor(),10>this.eventPool.length&&this.eventPool.push(t)}function ht(t){t.eventPool=[],t.getPooled=ct,t.release=lt}i(ut.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!=typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=at)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!=typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=at)},persist:function(){this.isPersistent=at},isPersistent:st,destructor:function(){var t,e=this.constructor.Interface;for(t in e)this[t]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=st,this._dispatchInstances=this._dispatchListeners=null}}),ut.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},ut.extend=function(t){function e(){}function n(){return r.apply(this,arguments)}var r=this;e.prototype=r.prototype;var o=new e;return i(o,n.prototype),n.prototype=o,n.prototype.constructor=n,n.Interface=i({},r.Interface,t),n.extend=r.extend,ht(n),n},ht(ut);var ft=ut.extend({data:null}),dt=ut.extend({data:null}),pt=[9,13,27,32],vt=Z&&"CompositionEvent"in window,gt=null;Z&&"documentMode"in document&&(gt=document.documentMode);var yt=Z&&"TextEvent"in window&&!gt,mt=Z&&(!vt||gt&&8<gt&&11>=gt),_t=String.fromCharCode(32),bt={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},wt=!1;function xt(t,e){switch(t){case"keyup":return-1!==pt.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function Et(t){return"object"==typeof(t=t.detail)&&"data"in t?t.data:null}var Ot=!1;var Pt={eventTypes:bt,extractEvents:function(t,e,n,r){var i=void 0,o=void 0;if(vt)t:{switch(t){case"compositionstart":i=bt.compositionStart;break t;case"compositionend":i=bt.compositionEnd;break t;case"compositionupdate":i=bt.compositionUpdate;break t}i=void 0}else Ot?xt(t,n)&&(i=bt.compositionEnd):"keydown"===t&&229===n.keyCode&&(i=bt.compositionStart);return i?(mt&&"ko"!==n.locale&&(Ot||i!==bt.compositionStart?i===bt.compositionEnd&&Ot&&(o=ot()):(rt="value"in(nt=r)?nt.value:nt.textContent,Ot=!0)),i=ft.getPooled(i,e,n,r),o?i.data=o:null!==(o=Et(n))&&(i.data=o),W(i),o=i):o=null,(t=yt?function(t,e){switch(t){case"compositionend":return Et(e);case"keypress":return 32!==e.which?null:(wt=!0,_t);case"textInput":return(t=e.data)===_t&&wt?null:t;default:return null}}(t,n):function(t,e){if(Ot)return"compositionend"===t||!vt&&xt(t,e)?(t=ot(),it=rt=nt=null,Ot=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return mt&&"ko"!==e.locale?null:e.data;default:return null}}(t,n))?((e=dt.getPooled(bt.beforeInput,e,n,r)).data=t,W(e)):e=null,null===o?e:null===e?o:[o,e]}},St=null,Tt=null,Ct=null;function At(t){if(t=x(t)){"function"!=typeof St&&a("280");var e=w(t.stateNode);St(t.stateNode,t.type,e)}}function Mt(t){Tt?Ct?Ct.push(t):Ct=[t]:Tt=t}function kt(){if(Tt){var t=Tt,e=Ct;if(Ct=Tt=null,At(t),e)for(t=0;t<e.length;t++)At(e[t])}}function jt(t,e){return t(e)}function Rt(t,e,n){return t(e,n)}function Lt(){}var It=!1;function Dt(t,e){if(It)return t(e);It=!0;try{return jt(t,e)}finally{It=!1,(null!==Tt||null!==Ct)&&(Lt(),kt())}}var Ft={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nt(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Ft[t.type]:"textarea"===e}function Bt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}function Ut(t){if(!Z)return!1;var e=(t="on"+t)in document;return e||((e=document.createElement("div")).setAttribute(t,"return;"),e="function"==typeof e[t]),e}function zt(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function Gt(t){t._valueTracker||(t._valueTracker=function(t){var e=zt(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(t){r=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function Vt(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=zt(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}var Wt=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zt=/^(.*)[\\\/]/,Ht="function"==typeof Symbol&&Symbol.for,Xt=Ht?Symbol.for("react.element"):60103,Yt=Ht?Symbol.for("react.portal"):60106,Jt=Ht?Symbol.for("react.fragment"):60107,qt=Ht?Symbol.for("react.strict_mode"):60108,Qt=Ht?Symbol.for("react.profiler"):60114,Kt=Ht?Symbol.for("react.provider"):60109,$t=Ht?Symbol.for("react.context"):60110,te=Ht?Symbol.for("react.concurrent_mode"):60111,ee=Ht?Symbol.for("react.forward_ref"):60112,ne=Ht?Symbol.for("react.suspense"):60113,re=Ht?Symbol.for("react.memo"):60115,ie=Ht?Symbol.for("react.lazy"):60116,oe="function"==typeof Symbol&&Symbol.iterator;function ae(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=oe&&t[oe]||t["@@iterator"])?t:null}function se(t){if(null==t)return null;if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case te:return"ConcurrentMode";case Jt:return"Fragment";case Yt:return"Portal";case Qt:return"Profiler";case qt:return"StrictMode";case ne:return"Suspense"}if("object"==typeof t)switch(t.$$typeof){case $t:return"Context.Consumer";case Kt:return"Context.Provider";case ee:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case re:return se(t.type);case ie:if(t=1===t._status?t._result:null)return se(t)}return null}function ue(t){var e="";do{t:switch(t.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break t;default:var r=t._debugOwner,i=t._debugSource,o=se(t.type);n=null,r&&(n=se(r.type)),r=o,o="",i?o=" (at "+i.fileName.replace(Zt,"")+":"+i.lineNumber+")":n&&(o=" (created by "+n+")"),n="\n    in "+(r||"Unknown")+o}e+=n,t=t.return}while(t);return e}var ce=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,le=Object.prototype.hasOwnProperty,he={},fe={};function de(t,e,n,r,i){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e}var pe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){pe[t]=new de(t,0,!1,t,null)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];pe[e]=new de(e,1,!1,t[1],null)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){pe[t]=new de(t,2,!1,t.toLowerCase(),null)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){pe[t]=new de(t,2,!1,t,null)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){pe[t]=new de(t,3,!1,t.toLowerCase(),null)}),["checked","multiple","muted","selected"].forEach(function(t){pe[t]=new de(t,3,!0,t,null)}),["capture","download"].forEach(function(t){pe[t]=new de(t,4,!1,t,null)}),["cols","rows","size","span"].forEach(function(t){pe[t]=new de(t,6,!1,t,null)}),["rowSpan","start"].forEach(function(t){pe[t]=new de(t,5,!1,t.toLowerCase(),null)});var ve=/[\-:]([a-z])/g;function ge(t){return t[1].toUpperCase()}function ye(t,e,n,r){var i=pe.hasOwnProperty(e)?pe[e]:null;(null!==i?0===i.type:!r&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(t,e,n,r){if(null==e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,i,r)&&(n=null),r||null===i?function(t){return!!le.call(fe,t)||!le.call(he,t)&&(ce.test(t)?fe[t]=!0:(he[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=null===n?3!==i.type&&"":n:(e=i.attributeName,r=i.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}function me(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function _e(t,e){var n=e.checked;return i({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function be(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=me(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function we(t,e){null!=(e=e.checked)&&ye(t,"checked",e,!1)}function xe(t,e){we(t,e);var n=me(e.value),r=e.type;if(null!=n)"number"===r?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?Oe(t,e.type,n):e.hasOwnProperty("defaultValue")&&Oe(t,e.type,me(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function Ee(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!t.defaultChecked,t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function Oe(t,e,n){"number"===e&&t.ownerDocument.activeElement===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ve,ge);pe[e]=new de(e,1,!1,t,null)}),"xlink:actuate xlink:arcrole xlink:href xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ve,ge);pe[e]=new de(e,1,!1,t,"http://www.w3.org/1999/xlink")}),["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ve,ge);pe[e]=new de(e,1,!1,t,"http://www.w3.org/XML/1998/namespace")}),pe.tabIndex=new de("tabIndex",1,!1,"tabindex",null);var Pe={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function Se(t,e,n){return(t=ut.getPooled(Pe.change,t,e,n)).type="change",Mt(n),W(t),t}var Te=null,Ce=null;function Ae(t){k(t)}function Me(t){if(Vt(F(t)))return t}function ke(t,e){if("change"===t)return e}var je=!1;function Re(){Te&&(Te.detachEvent("onpropertychange",Le),Ce=Te=null)}function Le(t){"value"===t.propertyName&&Me(Ce)&&Dt(Ae,t=Se(Ce,t,Bt(t)))}function Ie(t,e,n){"focus"===t?(Re(),Ce=n,(Te=e).attachEvent("onpropertychange",Le)):"blur"===t&&Re()}function De(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Me(Ce)}function Fe(t,e){if("click"===t)return Me(e)}function Ne(t,e){if("input"===t||"change"===t)return Me(e)}Z&&(je=Ut("input")&&(!document.documentMode||9<document.documentMode));var Be={eventTypes:Pe,_isInputEventSupported:je,extractEvents:function(t,e,n,r){var i=e?F(e):window,o=void 0,a=void 0,s=i.nodeName&&i.nodeName.toLowerCase();if("select"===s||"input"===s&&"file"===i.type?o=ke:Nt(i)?je?o=Ne:(o=De,a=Ie):(s=i.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(o=Fe),o&&(o=o(t,e)))return Se(o,n,r);a&&a(t,i,e),"blur"===t&&(t=i._wrapperState)&&t.controlled&&"number"===i.type&&Oe(i,"number",i.value)}},Ue=ut.extend({view:null,detail:null}),ze={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ge(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=ze[t])&&!!e[t]}function Ve(){return Ge}var We=0,Ze=0,He=!1,Xe=!1,Ye=Ue.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Ve,button:null,buttons:null,relatedTarget:function(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)},movementX:function(t){if("movementX"in t)return t.movementX;var e=We;return We=t.screenX,He?"mousemove"===t.type?t.screenX-e:0:(He=!0,0)},movementY:function(t){if("movementY"in t)return t.movementY;var e=Ze;return Ze=t.screenY,Xe?"mousemove"===t.type?t.screenY-e:0:(Xe=!0,0)}}),Je=Ye.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),qe={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Qe={eventTypes:qe,extractEvents:function(t,e,n,r){var i="mouseover"===t||"pointerover"===t,o="mouseout"===t||"pointerout"===t;if(i&&(n.relatedTarget||n.fromElement)||!o&&!i)return null;if(i=r.window===r?r:(i=r.ownerDocument)?i.defaultView||i.parentWindow:window,o?(o=e,e=(e=n.relatedTarget||n.toElement)?I(e):null):o=null,o===e)return null;var a=void 0,s=void 0,u=void 0,c=void 0;"mouseout"===t||"mouseover"===t?(a=Ye,s=qe.mouseLeave,u=qe.mouseEnter,c="mouse"):"pointerout"!==t&&"pointerover"!==t||(a=Je,s=qe.pointerLeave,u=qe.pointerEnter,c="pointer");var l=null==o?i:F(o);if(i=null==e?i:F(e),(t=a.getPooled(s,o,n,r)).type=c+"leave",t.target=l,t.relatedTarget=i,(n=a.getPooled(u,e,n,r)).type=c+"enter",n.target=i,n.relatedTarget=l,r=e,o&&r)t:{for(i=r,c=0,a=e=o;a;a=B(a))c++;for(a=0,u=i;u;u=B(u))a++;for(;0<c-a;)e=B(e),c--;for(;0<a-c;)i=B(i),a--;for(;c--;){if(e===i||e===i.alternate)break t;e=B(e),i=B(i)}e=null}else e=null;for(i=e,e=[];o&&o!==i&&(null===(c=o.alternate)||c!==i);)e.push(o),o=B(o);for(o=[];r&&r!==i&&(null===(c=r.alternate)||c!==i);)o.push(r),r=B(r);for(r=0;r<e.length;r++)G(e[r],"bubbled",t);for(r=o.length;0<r--;)G(o[r],"captured",n);return[t,n]}},Ke=Object.prototype.hasOwnProperty;function $e(t,e){return t===e?0!==t||0!==e||1/t==1/e:t!=t&&e!=e}function tn(t,e){if($e(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Ke.call(e,n[r])||!$e(t[n[r]],e[n[r]]))return!1;return!0}function en(t){var e=t;if(t.alternate)for(;e.return;)e=e.return;else{if(0!=(2&e.effectTag))return 1;for(;e.return;)if(0!=(2&(e=e.return).effectTag))return 1}return 3===e.tag?2:3}function nn(t){2!==en(t)&&a("188")}function rn(t){if(!(t=function(t){var e=t.alternate;if(!e)return 3===(e=en(t))&&a("188"),1===e?null:t;for(var n=t,r=e;;){var i=n.return,o=i?i.alternate:null;if(!i||!o)break;if(i.child===o.child){for(var s=i.child;s;){if(s===n)return nn(i),t;if(s===r)return nn(i),e;s=s.sibling}a("188")}if(n.return!==r.return)n=i,r=o;else{s=!1;for(var u=i.child;u;){if(u===n){s=!0,n=i,r=o;break}if(u===r){s=!0,r=i,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=i;break}if(u===r){s=!0,r=o,n=i;break}u=u.sibling}s||a("189")}}n.alternate!==r&&a("190")}return 3!==n.tag&&a("188"),n.stateNode.current===n?t:e}(t)))return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}var on=ut.extend({animationName:null,elapsedTime:null,pseudoElement:null}),an=ut.extend({clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),sn=Ue.extend({relatedTarget:null});function un(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}var cn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ln={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hn=Ue.extend({key:function(t){if(t.key){var e=cn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=un(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?ln[t.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Ve,charCode:function(t){return"keypress"===t.type?un(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?un(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),fn=Ye.extend({dataTransfer:null}),dn=Ue.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Ve}),pn=ut.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),vn=Ye.extend({deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null}),gn=[["abort","abort"],[Q,"animationEnd"],[K,"animationIteration"],[$,"animationStart"],["canplay","canPlay"],["canplaythrough","canPlayThrough"],["drag","drag"],["dragenter","dragEnter"],["dragexit","dragExit"],["dragleave","dragLeave"],["dragover","dragOver"],["durationchange","durationChange"],["emptied","emptied"],["encrypted","encrypted"],["ended","ended"],["error","error"],["gotpointercapture","gotPointerCapture"],["load","load"],["loadeddata","loadedData"],["loadedmetadata","loadedMetadata"],["loadstart","loadStart"],["lostpointercapture","lostPointerCapture"],["mousemove","mouseMove"],["mouseout","mouseOut"],["mouseover","mouseOver"],["playing","playing"],["pointermove","pointerMove"],["pointerout","pointerOut"],["pointerover","pointerOver"],["progress","progress"],["scroll","scroll"],["seeking","seeking"],["stalled","stalled"],["suspend","suspend"],["timeupdate","timeUpdate"],["toggle","toggle"],["touchmove","touchMove"],[tt,"transitionEnd"],["waiting","waiting"],["wheel","wheel"]],yn={},mn={};function _n(t,e){var n=t[0],r="on"+((t=t[1])[0].toUpperCase()+t.slice(1));e={phasedRegistrationNames:{bubbled:r,captured:r+"Capture"},dependencies:[n],isInteractive:e},yn[t]=e,mn[n]=e}[["blur","blur"],["cancel","cancel"],["click","click"],["close","close"],["contextmenu","contextMenu"],["copy","copy"],["cut","cut"],["auxclick","auxClick"],["dblclick","doubleClick"],["dragend","dragEnd"],["dragstart","dragStart"],["drop","drop"],["focus","focus"],["input","input"],["invalid","invalid"],["keydown","keyDown"],["keypress","keyPress"],["keyup","keyUp"],["mousedown","mouseDown"],["mouseup","mouseUp"],["paste","paste"],["pause","pause"],["play","play"],["pointercancel","pointerCancel"],["pointerdown","pointerDown"],["pointerup","pointerUp"],["ratechange","rateChange"],["reset","reset"],["seeked","seeked"],["submit","submit"],["touchcancel","touchCancel"],["touchend","touchEnd"],["touchstart","touchStart"],["volumechange","volumeChange"]].forEach(function(t){_n(t,!0)}),gn.forEach(function(t){_n(t,!1)});var bn={eventTypes:yn,isInteractiveTopLevelEventType:function(t){return void 0!==(t=mn[t])&&!0===t.isInteractive},extractEvents:function(t,e,n,r){var i=mn[t];if(!i)return null;switch(t){case"keypress":if(0===un(n))return null;case"keydown":case"keyup":t=hn;break;case"blur":case"focus":t=sn;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":t=Ye;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":t=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":t=dn;break;case Q:case K:case $:t=on;break;case tt:t=pn;break;case"scroll":t=Ue;break;case"wheel":t=vn;break;case"copy":case"cut":case"paste":t=an;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":t=Je;break;default:t=ut}return W(e=t.getPooled(i,e,n,r)),e}},wn=bn.isInteractiveTopLevelEventType,xn=[];function En(t){var e=t.targetInst,n=e;do{if(!n){t.ancestors.push(n);break}var r;for(r=n;r.return;)r=r.return;if(!(r=3!==r.tag?null:r.stateNode.containerInfo))break;t.ancestors.push(n),n=I(r)}while(n);for(n=0;n<t.ancestors.length;n++){e=t.ancestors[n];var i=Bt(t.nativeEvent);r=t.topLevelType;for(var o=t.nativeEvent,a=null,s=0;s<y.length;s++){var u=y[s];u&&(u=u.extractEvents(r,e,o,i))&&(a=P(a,u))}k(a)}}var On=!0;function Pn(t,e){if(!e)return null;var n=(wn(t)?Tn:Cn).bind(null,t);e.addEventListener(t,n,!1)}function Sn(t,e){if(!e)return null;var n=(wn(t)?Tn:Cn).bind(null,t);e.addEventListener(t,n,!0)}function Tn(t,e){Rt(Cn,t,e)}function Cn(t,e){if(On){var n=Bt(e);if(null===(n=I(n))||"number"!=typeof n.tag||2===en(n)||(n=null),xn.length){var r=xn.pop();r.topLevelType=t,r.nativeEvent=e,r.targetInst=n,t=r}else t={topLevelType:t,nativeEvent:e,targetInst:n,ancestors:[]};try{Dt(En,t)}finally{t.topLevelType=null,t.nativeEvent=null,t.targetInst=null,t.ancestors.length=0,10>xn.length&&xn.push(t)}}}var An={},Mn=0,kn="_reactListenersID"+(""+Math.random()).slice(2);function jn(t){return Object.prototype.hasOwnProperty.call(t,kn)||(t[kn]=Mn++,An[t[kn]]={}),An[t[kn]]}function Rn(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function Ln(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function In(t,e){var n,r=Ln(t);for(t=0;r;){if(3===r.nodeType){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=Ln(r)}}function Dn(){for(var t=window,e=Rn();e instanceof t.HTMLIFrameElement;){try{t=e.contentDocument.defaultView}catch(t){break}e=Rn(t.document)}return e}function Fn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var Nn=Z&&"documentMode"in document&&11>=document.documentMode,Bn={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Un=null,zn=null,Gn=null,Vn=!1;function Wn(t,e){var n=e.window===e?e.document:9===e.nodeType?e:e.ownerDocument;return Vn||null==Un||Un!==Rn(n)?null:("selectionStart"in(n=Un)&&Fn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Gn&&tn(Gn,n)?null:(Gn=n,(t=ut.getPooled(Bn.select,zn,t,e)).type="select",t.target=Un,W(t),t))}var Zn={eventTypes:Bn,extractEvents:function(t,e,n,r){var i,o=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;if(!(i=!o)){t:{o=jn(o),i=b.onSelect;for(var a=0;a<i.length;a++){var s=i[a];if(!o.hasOwnProperty(s)||!o[s]){o=!1;break t}}o=!0}i=!o}if(i)return null;switch(o=e?F(e):window,t){case"focus":(Nt(o)||"true"===o.contentEditable)&&(Un=o,zn=e,Gn=null);break;case"blur":Gn=zn=Un=null;break;case"mousedown":Vn=!0;break;case"contextmenu":case"mouseup":case"dragend":return Vn=!1,Wn(n,r);case"selectionchange":if(Nn)break;case"keydown":case"keyup":return Wn(n,r)}return null}};function Hn(t,e){return t=i({children:void 0},e),(e=function(t){var e="";return r.Children.forEach(t,function(t){null!=t&&(e+=t)}),e}(e.children))&&(t.children=e),t}function Xn(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+me(n),e=null,i=0;i<t.length;i++){if(t[i].value===n)return t[i].selected=!0,void(r&&(t[i].defaultSelected=!0));null!==e||t[i].disabled||(e=t[i])}null!==e&&(e.selected=!0)}}function Yn(t,e){return null!=e.dangerouslySetInnerHTML&&a("91"),i({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Jn(t,e){var n=e.value;null==n&&(n=e.defaultValue,null!=(e=e.children)&&(null!=n&&a("92"),Array.isArray(e)&&(1>=e.length||a("93"),e=e[0]),n=e),null==n&&(n="")),t._wrapperState={initialValue:me(n)}}function qn(t,e){var n=me(e.value),r=me(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=r&&(t.defaultValue=""+r)}function Qn(t){var e=t.textContent;e===t._wrapperState.initialValue&&(t.value=e)}A.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),w=N,x=D,E=F,A.injectEventPluginsByName({SimpleEventPlugin:bn,EnterLeaveEventPlugin:Qe,ChangeEventPlugin:Be,SelectEventPlugin:Zn,BeforeInputEventPlugin:Pt});var Kn={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function $n(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tr(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?$n(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var er,nr=void 0,rr=(er=function(t,e){if(t.namespaceURI!==Kn.svg||"innerHTML"in t)t.innerHTML=e;else{for((nr=nr||document.createElement("div")).innerHTML="<svg>"+e+"</svg>",e=nr.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,r){MSApp.execUnsafeLocalFunction(function(){return er(t,e)})}:er);function ir(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var or={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ar=["Webkit","ms","Moz","O"];function sr(t,e,n){return null==e||"boolean"==typeof e||""===e?"":n||"number"!=typeof e||0===e||or.hasOwnProperty(t)&&or[t]?(""+e).trim():e+"px"}function ur(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=sr(n,e[n],r);"float"===n&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}Object.keys(or).forEach(function(t){ar.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),or[e]=or[t]})});var cr=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function lr(t,e){e&&(cr[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML)&&a("137",t,""),null!=e.dangerouslySetInnerHTML&&(null!=e.children&&a("60"),"object"==typeof e.dangerouslySetInnerHTML&&"__html"in e.dangerouslySetInnerHTML||a("61")),null!=e.style&&"object"!=typeof e.style&&a("62",""))}function hr(t,e){if(-1===t.indexOf("-"))return"string"==typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function fr(t,e){var n=jn(t=9===t.nodeType||11===t.nodeType?t:t.ownerDocument);e=b[e];for(var r=0;r<e.length;r++){var i=e[r];if(!n.hasOwnProperty(i)||!n[i]){switch(i){case"scroll":Sn("scroll",t);break;case"focus":case"blur":Sn("focus",t),Sn("blur",t),n.blur=!0,n.focus=!0;break;case"cancel":case"close":Ut(i)&&Sn(i,t);break;case"invalid":case"submit":case"reset":break;default:-1===et.indexOf(i)&&Pn(i,t)}n[i]=!0}}}function dr(){}var pr=null,vr=null;function gr(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function yr(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"==typeof e.children||"number"==typeof e.children||"object"==typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var mr="function"==typeof setTimeout?setTimeout:void 0,_r="function"==typeof clearTimeout?clearTimeout:void 0;function br(t){for(t=t.nextSibling;t&&1!==t.nodeType&&3!==t.nodeType;)t=t.nextSibling;return t}function wr(t){for(t=t.firstChild;t&&1!==t.nodeType&&3!==t.nodeType;)t=t.nextSibling;return t}new Set;var xr=[],Er=-1;function Or(t){0>Er||(t.current=xr[Er],xr[Er]=null,Er--)}function Pr(t,e){xr[++Er]=t.current,t.current=e}var Sr={},Tr={current:Sr},Cr={current:!1},Ar=Sr;function Mr(t,e){var n=t.type.contextTypes;if(!n)return Sr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=e[i];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function kr(t){return null!=(t=t.childContextTypes)}function jr(t){Or(Cr),Or(Tr)}function Rr(t){Or(Cr),Or(Tr)}function Lr(t,e,n){Tr.current!==Sr&&a("168"),Pr(Tr,e),Pr(Cr,n)}function Ir(t,e,n){var r=t.stateNode;if(t=e.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var o in r=r.getChildContext())o in t||a("108",se(e)||"Unknown",o);return i({},n,r)}function Dr(t){var e=t.stateNode;return e=e&&e.__reactInternalMemoizedMergedChildContext||Sr,Ar=Tr.current,Pr(Tr,e),Pr(Cr,Cr.current),!0}function Fr(t,e,n){var r=t.stateNode;r||a("169"),n?(e=Ir(t,e,Ar),r.__reactInternalMemoizedMergedChildContext=e,Or(Cr),Or(Tr),Pr(Tr,e)):Or(Cr),Pr(Cr,n)}var Nr=null,Br=null;function Ur(t){return function(e){try{return t(e)}catch(t){}}}function zr(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.firstContextDependency=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function Gr(t,e,n,r){return new zr(t,e,n,r)}function Vr(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Wr(t,e){var n=t.alternate;return null===n?((n=Gr(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=t.childExpirationTime,n.expirationTime=t.expirationTime,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,n.firstContextDependency=t.firstContextDependency,n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Zr(t,e,n,r,i,o){var s=2;if(r=t,"function"==typeof t)Vr(t)&&(s=1);else if("string"==typeof t)s=5;else t:switch(t){case Jt:return Hr(n.children,i,o,e);case te:return Xr(n,3|i,o,e);case qt:return Xr(n,2|i,o,e);case Qt:return(t=Gr(12,n,e,4|i)).elementType=Qt,t.type=Qt,t.expirationTime=o,t;case ne:return(t=Gr(13,n,e,i)).elementType=ne,t.type=ne,t.expirationTime=o,t;default:if("object"==typeof t&&null!==t)switch(t.$$typeof){case Kt:s=10;break t;case $t:s=9;break t;case ee:s=11;break t;case re:s=14;break t;case ie:s=16,r=null;break t}a("130",null==t?t:typeof t,"")}return(e=Gr(s,n,e,i)).elementType=t,e.type=r,e.expirationTime=o,e}function Hr(t,e,n,r){return(t=Gr(7,t,r,e)).expirationTime=n,t}function Xr(t,e,n,r){return t=Gr(8,t,r,e),e=0==(1&e)?qt:te,t.elementType=e,t.type=e,t.expirationTime=n,t}function Yr(t,e,n){return(t=Gr(6,t,null,e)).expirationTime=n,t}function Jr(t,e,n){return(e=Gr(4,null!==t.children?t.children:[],t.key,e)).expirationTime=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function qr(t,e){t.didError=!1;var n=t.earliestPendingTime;0===n?t.earliestPendingTime=t.latestPendingTime=e:n<e?t.earliestPendingTime=e:t.latestPendingTime>e&&(t.latestPendingTime=e),$r(e,t)}function Qr(t,e){t.didError=!1,t.latestPingedTime>=e&&(t.latestPingedTime=0);var n=t.earliestPendingTime,r=t.latestPendingTime;n===e?t.earliestPendingTime=r===e?t.latestPendingTime=0:r:r===e&&(t.latestPendingTime=n),n=t.earliestSuspendedTime,r=t.latestSuspendedTime,0===n?t.earliestSuspendedTime=t.latestSuspendedTime=e:n<e?t.earliestSuspendedTime=e:r>e&&(t.latestSuspendedTime=e),$r(e,t)}function Kr(t,e){var n=t.earliestPendingTime;return n>e&&(e=n),(t=t.earliestSuspendedTime)>e&&(e=t),e}function $r(t,e){var n=e.earliestSuspendedTime,r=e.latestSuspendedTime,i=e.earliestPendingTime,o=e.latestPingedTime;0===(i=0!==i?i:o)&&(0===t||r<t)&&(i=r),0!==(t=i)&&n>t&&(t=n),e.nextExpirationTimeToWorkOn=i,e.expirationTime=t}var ti=!1;function ei(t){return{baseState:t,firstUpdate:null,lastUpdate:null,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function ni(t){return{baseState:t.baseState,firstUpdate:t.firstUpdate,lastUpdate:t.lastUpdate,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function ri(t){return{expirationTime:t,tag:0,payload:null,callback:null,next:null,nextEffect:null}}function ii(t,e){null===t.lastUpdate?t.firstUpdate=t.lastUpdate=e:(t.lastUpdate.next=e,t.lastUpdate=e)}function oi(t,e){var n=t.alternate;if(null===n){var r=t.updateQueue,i=null;null===r&&(r=t.updateQueue=ei(t.memoizedState))}else r=t.updateQueue,i=n.updateQueue,null===r?null===i?(r=t.updateQueue=ei(t.memoizedState),i=n.updateQueue=ei(n.memoizedState)):r=t.updateQueue=ni(i):null===i&&(i=n.updateQueue=ni(r));null===i||r===i?ii(r,e):null===r.lastUpdate||null===i.lastUpdate?(ii(r,e),ii(i,e)):(ii(r,e),i.lastUpdate=e)}function ai(t,e){var n=t.updateQueue;null===(n=null===n?t.updateQueue=ei(t.memoizedState):si(t,n)).lastCapturedUpdate?n.firstCapturedUpdate=n.lastCapturedUpdate=e:(n.lastCapturedUpdate.next=e,n.lastCapturedUpdate=e)}function si(t,e){var n=t.alternate;return null!==n&&e===n.updateQueue&&(e=t.updateQueue=ni(e)),e}function ui(t,e,n,r,o,a){switch(n.tag){case 1:return"function"==typeof(t=n.payload)?t.call(a,r,o):t;case 3:t.effectTag=-2049&t.effectTag|64;case 0:if(null==(o="function"==typeof(t=n.payload)?t.call(a,r,o):t))break;return i({},r,o);case 2:ti=!0}return r}function ci(t,e,n,r,i){ti=!1;for(var o=(e=si(t,e)).baseState,a=null,s=0,u=e.firstUpdate,c=o;null!==u;){var l=u.expirationTime;l<i?(null===a&&(a=u,o=c),s<l&&(s=l)):(c=ui(t,0,u,c,n,r),null!==u.callback&&(t.effectTag|=32,u.nextEffect=null,null===e.lastEffect?e.firstEffect=e.lastEffect=u:(e.lastEffect.nextEffect=u,e.lastEffect=u))),u=u.next}for(l=null,u=e.firstCapturedUpdate;null!==u;){var h=u.expirationTime;h<i?(null===l&&(l=u,null===a&&(o=c)),s<h&&(s=h)):(c=ui(t,0,u,c,n,r),null!==u.callback&&(t.effectTag|=32,u.nextEffect=null,null===e.lastCapturedEffect?e.firstCapturedEffect=e.lastCapturedEffect=u:(e.lastCapturedEffect.nextEffect=u,e.lastCapturedEffect=u))),u=u.next}null===a&&(e.lastUpdate=null),null===l?e.lastCapturedUpdate=null:t.effectTag|=32,null===a&&null===l&&(o=c),e.baseState=o,e.firstUpdate=a,e.firstCapturedUpdate=l,t.expirationTime=s,t.memoizedState=c}function li(t,e,n){null!==e.firstCapturedUpdate&&(null!==e.lastUpdate&&(e.lastUpdate.next=e.firstCapturedUpdate,e.lastUpdate=e.lastCapturedUpdate),e.firstCapturedUpdate=e.lastCapturedUpdate=null),hi(e.firstEffect,n),e.firstEffect=e.lastEffect=null,hi(e.firstCapturedEffect,n),e.firstCapturedEffect=e.lastCapturedEffect=null}function hi(t,e){for(;null!==t;){var n=t.callback;if(null!==n){t.callback=null;var r=e;"function"!=typeof n&&a("191",n),n.call(r)}t=t.nextEffect}}function fi(t,e){return{value:t,source:e,stack:ue(e)}}var di={current:null},pi=null,vi=null,gi=null;function yi(t,e){var n=t.type._context;Pr(di,n._currentValue),n._currentValue=e}function mi(t){var e=di.current;Or(di),t.type._context._currentValue=e}function _i(t){pi=t,gi=vi=null,t.firstContextDependency=null}function bi(t,e){return gi!==t&&!1!==e&&0!==e&&("number"==typeof e&&1073741823!==e||(gi=t,e=1073741823),e={context:t,observedBits:e,next:null},null===vi?(null===pi&&a("293"),pi.firstContextDependency=vi=e):vi=vi.next=e),t._currentValue}var wi={},xi={current:wi},Ei={current:wi},Oi={current:wi};function Pi(t){return t===wi&&a("174"),t}function Si(t,e){Pr(Oi,e),Pr(Ei,t),Pr(xi,wi);var n=e.nodeType;switch(n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:tr(null,"");break;default:e=tr(e=(n=8===n?e.parentNode:e).namespaceURI||null,n=n.tagName)}Or(xi),Pr(xi,e)}function Ti(t){Or(xi),Or(Ei),Or(Oi)}function Ci(t){Pi(Oi.current);var e=Pi(xi.current),n=tr(e,t.type);e!==n&&(Pr(Ei,t),Pr(xi,n))}function Ai(t){Ei.current===t&&(Or(xi),Or(Ei))}function Mi(t,e){if(t&&t.defaultProps)for(var n in e=i({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}var ki=Wt.ReactCurrentOwner,ji=(new r.Component).refs;function Ri(t,e,n,r){n=null==(n=n(r,e=t.memoizedState))?e:i({},e,n),t.memoizedState=n,null!==(r=t.updateQueue)&&0===t.expirationTime&&(r.baseState=n)}var Li={isMounted:function(t){return!!(t=t._reactInternalFiber)&&2===en(t)},enqueueSetState:function(t,e,n){t=t._reactInternalFiber;var r=Sa(),i=ri(r=Ko(r,t));i.payload=e,null!=n&&(i.callback=n),Xo(),oi(t,i),ea(t,r)},enqueueReplaceState:function(t,e,n){t=t._reactInternalFiber;var r=Sa(),i=ri(r=Ko(r,t));i.tag=1,i.payload=e,null!=n&&(i.callback=n),Xo(),oi(t,i),ea(t,r)},enqueueForceUpdate:function(t,e){t=t._reactInternalFiber;var n=Sa(),r=ri(n=Ko(n,t));r.tag=2,null!=e&&(r.callback=e),Xo(),oi(t,r),ea(t,n)}};function Ii(t,e,n,r,i,o,a){return"function"==typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,o,a):!e.prototype||!e.prototype.isPureReactComponent||(!tn(n,r)||!tn(i,o))}function Di(t,e,n){var r=!1,i=Sr,o=e.contextType;return"object"==typeof o&&null!==o?o=ki.currentDispatcher.readContext(o):(i=kr(e)?Ar:Tr.current,o=(r=null!=(r=e.contextTypes))?Mr(t,i):Sr),e=new e(n,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=Li,t.stateNode=e,e._reactInternalFiber=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function Fi(t,e,n,r){t=e.state,"function"==typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"==typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Li.enqueueReplaceState(e,e.state,null)}function Ni(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=ji;var o=e.contextType;"object"==typeof o&&null!==o?i.context=ki.currentDispatcher.readContext(o):(o=kr(e)?Ar:Tr.current,i.context=Mr(t,o)),null!==(o=t.updateQueue)&&(ci(t,o,n,i,r),i.state=t.memoizedState),"function"==typeof(o=e.getDerivedStateFromProps)&&(Ri(t,e,o,n),i.state=t.memoizedState),"function"==typeof e.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(e=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),e!==i.state&&Li.enqueueReplaceState(i,i.state,null),null!==(o=t.updateQueue)&&(ci(t,o,n,i,r),i.state=t.memoizedState)),"function"==typeof i.componentDidMount&&(t.effectTag|=4)}var Bi=Array.isArray;function Ui(t,e,n){if(null!==(t=n.ref)&&"function"!=typeof t&&"object"!=typeof t){if(n._owner){n=n._owner;var r=void 0;n&&(1!==n.tag&&a("289"),r=n.stateNode),r||a("147",t);var i=""+t;return null!==e&&null!==e.ref&&"function"==typeof e.ref&&e.ref._stringRef===i?e.ref:((e=function(t){var e=r.refs;e===ji&&(e=r.refs={}),null===t?delete e[i]:e[i]=t})._stringRef=i,e)}"string"!=typeof t&&a("284"),n._owner||a("290",t)}return t}function zi(t,e){"textarea"!==t.type&&a("31","[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e,"")}function Gi(t){function e(e,n){if(t){var r=e.lastEffect;null!==r?(r.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(t,e,n){return(t=Wr(t,e)).index=0,t.sibling=null,t}function o(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.effectTag=2,n):r:(e.effectTag=2,n):n}function s(e){return t&&null===e.alternate&&(e.effectTag=2),e}function u(t,e,n,r){return null===e||6!==e.tag?((e=Yr(n,t.mode,r)).return=t,e):((e=i(e,n)).return=t,e)}function c(t,e,n,r){return null!==e&&e.elementType===n.type?((r=i(e,n.props)).ref=Ui(t,e,n),r.return=t,r):((r=Zr(n.type,n.key,n.props,null,t.mode,r)).ref=Ui(t,e,n),r.return=t,r)}function l(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Jr(n,t.mode,r)).return=t,e):((e=i(e,n.children||[])).return=t,e)}function h(t,e,n,r,o){return null===e||7!==e.tag?((e=Hr(n,t.mode,r,o)).return=t,e):((e=i(e,n)).return=t,e)}function f(t,e,n){if("string"==typeof e||"number"==typeof e)return(e=Yr(""+e,t.mode,n)).return=t,e;if("object"==typeof e&&null!==e){switch(e.$$typeof){case Xt:return(n=Zr(e.type,e.key,e.props,null,t.mode,n)).ref=Ui(t,null,e),n.return=t,n;case Yt:return(e=Jr(e,t.mode,n)).return=t,e}if(Bi(e)||ae(e))return(e=Hr(e,t.mode,n,null)).return=t,e;zi(t,e)}return null}function d(t,e,n,r){var i=null!==e?e.key:null;if("string"==typeof n||"number"==typeof n)return null!==i?null:u(t,e,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case Xt:return n.key===i?n.type===Jt?h(t,e,n.props.children,r,i):c(t,e,n,r):null;case Yt:return n.key===i?l(t,e,n,r):null}if(Bi(n)||ae(n))return null!==i?null:h(t,e,n,r,null);zi(t,n)}return null}function p(t,e,n,r,i){if("string"==typeof r||"number"==typeof r)return u(e,t=t.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case Xt:return t=t.get(null===r.key?n:r.key)||null,r.type===Jt?h(e,t,r.props.children,i,r.key):c(e,t,r,i);case Yt:return l(e,t=t.get(null===r.key?n:r.key)||null,r,i)}if(Bi(r)||ae(r))return h(e,t=t.get(n)||null,r,i,null);zi(e,r)}return null}function v(i,a,s,u){for(var c=null,l=null,h=a,v=a=0,g=null;null!==h&&v<s.length;v++){h.index>v?(g=h,h=null):g=h.sibling;var y=d(i,h,s[v],u);if(null===y){null===h&&(h=g);break}t&&h&&null===y.alternate&&e(i,h),a=o(y,a,v),null===l?c=y:l.sibling=y,l=y,h=g}if(v===s.length)return n(i,h),c;if(null===h){for(;v<s.length;v++)(h=f(i,s[v],u))&&(a=o(h,a,v),null===l?c=h:l.sibling=h,l=h);return c}for(h=r(i,h);v<s.length;v++)(g=p(h,i,v,s[v],u))&&(t&&null!==g.alternate&&h.delete(null===g.key?v:g.key),a=o(g,a,v),null===l?c=g:l.sibling=g,l=g);return t&&h.forEach(function(t){return e(i,t)}),c}function g(i,s,u,c){var l=ae(u);"function"!=typeof l&&a("150"),null==(u=l.call(u))&&a("151");for(var h=l=null,v=s,g=s=0,y=null,m=u.next();null!==v&&!m.done;g++,m=u.next()){v.index>g?(y=v,v=null):y=v.sibling;var _=d(i,v,m.value,c);if(null===_){v||(v=y);break}t&&v&&null===_.alternate&&e(i,v),s=o(_,s,g),null===h?l=_:h.sibling=_,h=_,v=y}if(m.done)return n(i,v),l;if(null===v){for(;!m.done;g++,m=u.next())null!==(m=f(i,m.value,c))&&(s=o(m,s,g),null===h?l=m:h.sibling=m,h=m);return l}for(v=r(i,v);!m.done;g++,m=u.next())null!==(m=p(v,i,g,m.value,c))&&(t&&null!==m.alternate&&v.delete(null===m.key?g:m.key),s=o(m,s,g),null===h?l=m:h.sibling=m,h=m);return t&&v.forEach(function(t){return e(i,t)}),l}return function(t,r,o,u){var c="object"==typeof o&&null!==o&&o.type===Jt&&null===o.key;c&&(o=o.props.children);var l="object"==typeof o&&null!==o;if(l)switch(o.$$typeof){case Xt:t:{for(l=o.key,c=r;null!==c;){if(c.key===l){if(7===c.tag?o.type===Jt:c.elementType===o.type){n(t,c.sibling),(r=i(c,o.type===Jt?o.props.children:o.props)).ref=Ui(t,c,o),r.return=t,t=r;break t}n(t,c);break}e(t,c),c=c.sibling}o.type===Jt?((r=Hr(o.props.children,t.mode,u,o.key)).return=t,t=r):((u=Zr(o.type,o.key,o.props,null,t.mode,u)).ref=Ui(t,r,o),u.return=t,t=u)}return s(t);case Yt:t:{for(c=o.key;null!==r;){if(r.key===c){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(t,r.sibling),(r=i(r,o.children||[])).return=t,t=r;break t}n(t,r);break}e(t,r),r=r.sibling}(r=Jr(o,t.mode,u)).return=t,t=r}return s(t)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==r&&6===r.tag?(n(t,r.sibling),(r=i(r,o)).return=t,t=r):(n(t,r),(r=Yr(o,t.mode,u)).return=t,t=r),s(t);if(Bi(o))return v(t,r,o,u);if(ae(o))return g(t,r,o,u);if(l&&zi(t,o),void 0===o&&!c)switch(t.tag){case 1:case 0:a("152",(u=t.type).displayName||u.name||"Component")}return n(t,r)}}var Vi=Gi(!0),Wi=Gi(!1),Zi=null,Hi=null,Xi=!1;function Yi(t,e){var n=Gr(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=e,n.return=t,n.effectTag=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function Ji(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);default:return!1}}function qi(t){if(Xi){var e=Hi;if(e){var n=e;if(!Ji(t,e)){if(!(e=br(n))||!Ji(t,e))return t.effectTag|=2,Xi=!1,void(Zi=t);Yi(Zi,n)}Zi=t,Hi=wr(e)}else t.effectTag|=2,Xi=!1,Zi=t}}function Qi(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag;)t=t.return;Zi=t}function Ki(t){if(t!==Zi)return!1;if(!Xi)return Qi(t),Xi=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!yr(e,t.memoizedProps))for(e=Hi;e;)Yi(t,e),e=br(e);return Qi(t),Hi=Zi?br(t.stateNode):null,!0}function $i(){Hi=Zi=null,Xi=!1}var to=Wt.ReactCurrentOwner;function eo(t,e,n,r){e.child=null===t?Wi(e,null,n,r):Vi(e,t.child,n,r)}function no(t,e,n,r,i){n=n.render;var o=e.ref;return _i(e),r=n(r,o),e.effectTag|=1,eo(t,e,r,i),e.child}function ro(t,e,n,r,i,o){if(null===t){var a=n.type;return"function"!=typeof a||Vr(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Zr(n.type,null,r,null,e.mode,o)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=a,io(t,e,a,r,i,o))}return a=t.child,i<o&&(i=a.memoizedProps,(n=null!==(n=n.compare)?n:tn)(i,r)&&t.ref===e.ref)?ho(t,e,o):(e.effectTag|=1,(t=Wr(a,r)).ref=e.ref,t.return=e,e.child=t)}function io(t,e,n,r,i,o){return null!==t&&i<o&&tn(t.memoizedProps,r)&&t.ref===e.ref?ho(t,e,o):ao(t,e,n,r,o)}function oo(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.effectTag|=128)}function ao(t,e,n,r,i){var o=kr(n)?Ar:Tr.current;return o=Mr(e,o),_i(e),n=n(r,o),e.effectTag|=1,eo(t,e,n,i),e.child}function so(t,e,n,r,i){if(kr(n)){var o=!0;Dr(e)}else o=!1;if(_i(e),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),Di(e,n,r),Ni(e,n,r,i),r=!0;else if(null===t){var a=e.stateNode,s=e.memoizedProps;a.props=s;var u=a.context,c=n.contextType;"object"==typeof c&&null!==c?c=ki.currentDispatcher.readContext(c):c=Mr(e,c=kr(n)?Ar:Tr.current);var l=n.getDerivedStateFromProps,h="function"==typeof l||"function"==typeof a.getSnapshotBeforeUpdate;h||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||u!==c)&&Fi(e,a,r,c),ti=!1;var f=e.memoizedState;u=a.state=f;var d=e.updateQueue;null!==d&&(ci(e,d,r,a,i),u=e.memoizedState),s!==r||f!==u||Cr.current||ti?("function"==typeof l&&(Ri(e,n,l,r),u=e.memoizedState),(s=ti||Ii(e,n,s,r,f,u,c))?(h||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(e.effectTag|=4)):("function"==typeof a.componentDidMount&&(e.effectTag|=4),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=c,r=s):("function"==typeof a.componentDidMount&&(e.effectTag|=4),r=!1)}else a=e.stateNode,s=e.memoizedProps,a.props=e.type===e.elementType?s:Mi(e.type,s),u=a.context,"object"==typeof(c=n.contextType)&&null!==c?c=ki.currentDispatcher.readContext(c):c=Mr(e,c=kr(n)?Ar:Tr.current),(h="function"==typeof(l=n.getDerivedStateFromProps)||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||u!==c)&&Fi(e,a,r,c),ti=!1,u=e.memoizedState,f=a.state=u,null!==(d=e.updateQueue)&&(ci(e,d,r,a,i),f=e.memoizedState),s!==r||u!==f||Cr.current||ti?("function"==typeof l&&(Ri(e,n,l,r),f=e.memoizedState),(l=ti||Ii(e,n,s,r,u,f,c))?(h||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,c),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,c)),"function"==typeof a.componentDidUpdate&&(e.effectTag|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(e.effectTag|=256)):("function"!=typeof a.componentDidUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=256),e.memoizedProps=r,e.memoizedState=f),a.props=r,a.state=f,a.context=c,r=l):("function"!=typeof a.componentDidUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=256),r=!1);return uo(t,e,n,r,o,i)}function uo(t,e,n,r,i,o){oo(t,e);var a=0!=(64&e.effectTag);if(!r&&!a)return i&&Fr(e,n,!1),ho(t,e,o);r=e.stateNode,to.current=e;var s=a&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return e.effectTag|=1,null!==t&&a?(e.child=Vi(e,t.child,null,o),e.child=Vi(e,null,s,o)):eo(t,e,s,o),e.memoizedState=r.state,i&&Fr(e,n,!0),e.child}function co(t){var e=t.stateNode;e.pendingContext?Lr(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Lr(0,e.context,!1),Si(t,e.containerInfo)}function lo(t,e,n){var r=e.mode,i=e.pendingProps,o=e.memoizedState;if(0==(64&e.effectTag)){o=null;var a=!1}else o={timedOutAt:null!==o?o.timedOutAt:0},a=!0,e.effectTag&=-65;if(null===t)if(a){var s=i.fallback;t=Hr(null,r,0,null),0==(1&e.mode)&&(t.child=null!==e.memoizedState?e.child.child:e.child),r=Hr(s,r,n,null),t.sibling=r,(n=t).return=r.return=e}else n=r=Wi(e,null,i.children,n);else null!==t.memoizedState?(s=(r=t.child).sibling,a?(n=i.fallback,i=Wr(r,r.pendingProps),0==(1&e.mode)&&((a=null!==e.memoizedState?e.child.child:e.child)!==r.child&&(i.child=a)),r=i.sibling=Wr(s,n,s.expirationTime),n=i,i.childExpirationTime=0,n.return=r.return=e):n=r=Vi(e,r.child,i.children,n)):(s=t.child,a?(a=i.fallback,(i=Hr(null,r,0,null)).child=s,0==(1&e.mode)&&(i.child=null!==e.memoizedState?e.child.child:e.child),(r=i.sibling=Hr(a,r,n,null)).effectTag|=2,n=i,i.childExpirationTime=0,n.return=r.return=e):r=n=Vi(e,s,i.children,n)),e.stateNode=t.stateNode;return e.memoizedState=o,e.child=n,r}function ho(t,e,n){if(null!==t&&(e.firstContextDependency=t.firstContextDependency),e.childExpirationTime<n)return null;if(null!==t&&e.child!==t.child&&a("153"),null!==e.child){for(n=Wr(t=e.child,t.pendingProps,t.expirationTime),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Wr(t,t.pendingProps,t.expirationTime)).return=e;n.sibling=null}return e.child}function fo(t,e,n){var r=e.expirationTime;if(null!==t&&t.memoizedProps===e.pendingProps&&!Cr.current&&r<n){switch(e.tag){case 3:co(e),$i();break;case 5:Ci(e);break;case 1:kr(e.type)&&Dr(e);break;case 4:Si(e,e.stateNode.containerInfo);break;case 10:yi(e,e.memoizedProps.value);break;case 13:if(null!==e.memoizedState)return 0!==(r=e.child.childExpirationTime)&&r>=n?lo(t,e,n):null!==(e=ho(t,e,n))?e.sibling:null}return ho(t,e,n)}switch(e.expirationTime=0,e.tag){case 2:r=e.elementType,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps;var i=Mr(e,Tr.current);if(_i(e),i=r(t,i),e.effectTag|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof){if(e.tag=1,kr(r)){var o=!0;Dr(e)}else o=!1;e.memoizedState=null!==i.state&&void 0!==i.state?i.state:null;var s=r.getDerivedStateFromProps;"function"==typeof s&&Ri(e,r,s,t),i.updater=Li,e.stateNode=i,i._reactInternalFiber=e,Ni(e,r,t,n),e=uo(null,e,r,!0,o,n)}else e.tag=0,eo(null,e,i,n),e=e.child;return e;case 16:switch(i=e.elementType,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),o=e.pendingProps,t=function(t){var e=t._result;switch(t._status){case 1:return e;case 2:case 0:throw e;default:throw t._status=0,(e=(e=t._ctor)()).then(function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)},function(e){0===t._status&&(t._status=2,t._result=e)}),t._result=e,e}}(i),e.type=t,i=e.tag=function(t){if("function"==typeof t)return Vr(t)?1:0;if(null!=t){if((t=t.$$typeof)===ee)return 11;if(t===re)return 14}return 2}(t),o=Mi(t,o),s=void 0,i){case 0:s=ao(null,e,t,o,n);break;case 1:s=so(null,e,t,o,n);break;case 11:s=no(null,e,t,o,n);break;case 14:s=ro(null,e,t,Mi(t.type,o),r,n);break;default:a("306",t,"")}return s;case 0:return r=e.type,i=e.pendingProps,ao(t,e,r,i=e.elementType===r?i:Mi(r,i),n);case 1:return r=e.type,i=e.pendingProps,so(t,e,r,i=e.elementType===r?i:Mi(r,i),n);case 3:return co(e),null===(r=e.updateQueue)&&a("282"),i=null!==(i=e.memoizedState)?i.element:null,ci(e,r,e.pendingProps,null,n),(r=e.memoizedState.element)===i?($i(),e=ho(t,e,n)):(i=e.stateNode,(i=(null===t||null===t.child)&&i.hydrate)&&(Hi=wr(e.stateNode.containerInfo),Zi=e,i=Xi=!0),i?(e.effectTag|=2,e.child=Wi(e,null,r,n)):(eo(t,e,r,n),$i()),e=e.child),e;case 5:return Ci(e),null===t&&qi(e),r=e.type,i=e.pendingProps,o=null!==t?t.memoizedProps:null,s=i.children,yr(r,i)?s=null:null!==o&&yr(r,o)&&(e.effectTag|=16),oo(t,e),1!==n&&1&e.mode&&i.hidden?(e.expirationTime=1,e=null):(eo(t,e,s,n),e=e.child),e;case 6:return null===t&&qi(e),null;case 13:return lo(t,e,n);case 4:return Si(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=Vi(e,null,r,n):eo(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,no(t,e,r,i=e.elementType===r?i:Mi(r,i),n);case 7:return eo(t,e,e.pendingProps,n),e.child;case 8:case 12:return eo(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,yi(e,o=i.value),null!==s){var u=s.value;if(0===(o=u===o&&(0!==u||1/u==1/o)||u!=u&&o!=o?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(u,o):1073741823))){if(s.children===i.children&&!Cr.current){e=ho(t,e,n);break t}}else for(null!==(s=e.child)&&(s.return=e);null!==s;){if(null!==(u=s.firstContextDependency))do{if(u.context===r&&0!=(u.observedBits&o)){if(1===s.tag){var c=ri(n);c.tag=2,oi(s,c)}s.expirationTime<n&&(s.expirationTime=n),null!==(c=s.alternate)&&c.expirationTime<n&&(c.expirationTime=n);for(var l=s.return;null!==l;){if(c=l.alternate,l.childExpirationTime<n)l.childExpirationTime=n,null!==c&&c.childExpirationTime<n&&(c.childExpirationTime=n);else{if(!(null!==c&&c.childExpirationTime<n))break;c.childExpirationTime=n}l=l.return}}c=s.child,u=u.next}while(null!==u);else c=10===s.tag&&s.type===e.type?null:s.child;if(null!==c)c.return=s;else for(c=s;null!==c;){if(c===e){c=null;break}if(null!==(s=c.sibling)){s.return=c.return,c=s;break}c=c.return}s=c}}eo(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=(o=e.pendingProps).children,_i(e),r=r(i=bi(i,o.unstable_observedBits)),e.effectTag|=1,eo(t,e,r,n),e.child;case 14:return o=Mi(i=e.type,e.pendingProps),ro(t,e,i,o=Mi(i.type,o),r,n);case 15:return io(t,e,e.type,e.pendingProps,r,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Mi(r,i),null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),e.tag=1,kr(r)?(t=!0,Dr(e)):t=!1,_i(e),Di(e,r,i),Ni(e,r,i,n),uo(null,e,r,!0,t,n);default:a("156")}}function po(t){t.effectTag|=4}var vo=void 0,go=void 0,yo=void 0,mo=void 0;vo=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},go=function(){},yo=function(t,e,n,r,o){var a=t.memoizedProps;if(a!==r){var s=e.stateNode;switch(Pi(xi.current),t=null,n){case"input":a=_e(s,a),r=_e(s,r),t=[];break;case"option":a=Hn(s,a),r=Hn(s,r),t=[];break;case"select":a=i({},a,{value:void 0}),r=i({},r,{value:void 0}),t=[];break;case"textarea":a=Yn(s,a),r=Yn(s,r),t=[];break;default:"function"!=typeof a.onClick&&"function"==typeof r.onClick&&(s.onclick=dr)}lr(n,r),s=n=void 0;var u=null;for(n in a)if(!r.hasOwnProperty(n)&&a.hasOwnProperty(n)&&null!=a[n])if("style"===n){var c=a[n];for(s in c)c.hasOwnProperty(s)&&(u||(u={}),u[s]="")}else"dangerouslySetInnerHTML"!==n&&"children"!==n&&"suppressContentEditableWarning"!==n&&"suppressHydrationWarning"!==n&&"autoFocus"!==n&&(_.hasOwnProperty(n)?t||(t=[]):(t=t||[]).push(n,null));for(n in r){var l=r[n];if(c=null!=a?a[n]:void 0,r.hasOwnProperty(n)&&l!==c&&(null!=l||null!=c))if("style"===n)if(c){for(s in c)!c.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(u||(u={}),u[s]="");for(s in l)l.hasOwnProperty(s)&&c[s]!==l[s]&&(u||(u={}),u[s]=l[s])}else u||(t||(t=[]),t.push(n,u)),u=l;else"dangerouslySetInnerHTML"===n?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(t=t||[]).push(n,""+l)):"children"===n?c===l||"string"!=typeof l&&"number"!=typeof l||(t=t||[]).push(n,""+l):"suppressContentEditableWarning"!==n&&"suppressHydrationWarning"!==n&&(_.hasOwnProperty(n)?(null!=l&&fr(o,n),t||c===l||(t=[])):(t=t||[]).push(n,l))}u&&(t=t||[]).push("style",u),o=t,(e.updateQueue=o)&&po(e)}},mo=function(t,e,n,r){n!==r&&po(e)};var _o="function"==typeof WeakSet?WeakSet:Set;function bo(t,e){var n=e.source,r=e.stack;null===r&&null!==n&&(r=ue(n)),null!==n&&se(n.type),e=e.value,null!==t&&1===t.tag&&se(t.type);try{console.error(e)}catch(t){setTimeout(function(){throw t})}}function wo(t){var e=t.ref;if(null!==e)if("function"==typeof e)try{e(null)}catch(e){Qo(t,e)}else e.current=null}function xo(t){switch("function"==typeof Br&&Br(t),t.tag){case 0:case 11:case 14:case 15:var e=t.updateQueue;if(null!==e&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n.destroy;if(null!==r){var i=t;try{r()}catch(t){Qo(i,t)}}n=n.next}while(n!==e)}break;case 1:if(wo(t),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){Qo(t,e)}break;case 5:wo(t);break;case 4:Po(t)}}function Eo(t){return 5===t.tag||3===t.tag||4===t.tag}function Oo(t){t:{for(var e=t.return;null!==e;){if(Eo(e)){var n=e;break t}e=e.return}a("160"),n=void 0}var r=e=void 0;switch(n.tag){case 5:e=n.stateNode,r=!1;break;case 3:case 4:e=n.stateNode.containerInfo,r=!0;break;default:a("161")}16&n.effectTag&&(ir(e,""),n.effectTag&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||Eo(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag;){if(2&n.effectTag)continue e;if(null===n.child||4===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break t}}for(var i=t;;){if(5===i.tag||6===i.tag)if(n)if(r){var o=e,s=i.stateNode,u=n;8===o.nodeType?o.parentNode.insertBefore(s,u):o.insertBefore(s,u)}else e.insertBefore(i.stateNode,n);else r?(s=e,u=i.stateNode,8===s.nodeType?(o=s.parentNode).insertBefore(u,s):(o=s).appendChild(u),null!=(s=s._reactRootContainer)||null!==o.onclick||(o.onclick=dr)):e.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function Po(t){for(var e=t,n=!1,r=void 0,i=void 0;;){if(!n){n=e.return;t:for(;;){switch(null===n&&a("160"),n.tag){case 5:r=n.stateNode,i=!1;break t;case 3:case 4:r=n.stateNode.containerInfo,i=!0;break t}n=n.return}n=!0}if(5===e.tag||6===e.tag){t:for(var o=e,s=o;;)if(xo(s),null!==s.child&&4!==s.tag)s.child.return=s,s=s.child;else{if(s===o)break;for(;null===s.sibling;){if(null===s.return||s.return===o)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}i?(o=r,s=e.stateNode,8===o.nodeType?o.parentNode.removeChild(s):o.removeChild(s)):r.removeChild(e.stateNode)}else if(4===e.tag?(r=e.stateNode.containerInfo,i=!0):xo(e),null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return;4===(e=e.return).tag&&(n=!1)}e.sibling.return=e.return,e=e.sibling}}function So(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 1:break;case 5:var n=e.stateNode;if(null!=n){var r=e.memoizedProps;t=null!==t?t.memoizedProps:r;var i=e.type,o=e.updateQueue;e.updateQueue=null,null!==o&&function(t,e,n,r,i){t[L]=i,"input"===n&&"radio"===i.type&&null!=i.name&&we(t,i),hr(n,r),r=hr(n,i);for(var o=0;o<e.length;o+=2){var a=e[o],s=e[o+1];"style"===a?ur(t,s):"dangerouslySetInnerHTML"===a?rr(t,s):"children"===a?ir(t,s):ye(t,a,s,r)}switch(n){case"input":xe(t,i);break;case"textarea":qn(t,i);break;case"select":e=t._wrapperState.wasMultiple,t._wrapperState.wasMultiple=!!i.multiple,null!=(n=i.value)?Xn(t,!!i.multiple,n,!1):e!==!!i.multiple&&(null!=i.defaultValue?Xn(t,!!i.multiple,i.defaultValue,!0):Xn(t,!!i.multiple,i.multiple?[]:"",!1))}}(n,o,i,t,r)}break;case 6:null===e.stateNode&&a("162"),e.stateNode.nodeValue=e.memoizedProps;break;case 3:case 12:break;case 13:if(n=e.memoizedState,r=void 0,t=e,null===n?r=!1:(r=!0,t=e.child,0===n.timedOutAt&&(n.timedOutAt=Sa())),null!==t&&function(t,e){for(var n=t;;){if(5===n.tag){var r=n.stateNode;if(e)r.style.display="none";else{r=n.stateNode;var i=n.memoizedProps.style;i=null!=i&&i.hasOwnProperty("display")?i.display:null,r.style.display=sr("display",i)}}else if(6===n.tag)n.stateNode.nodeValue=e?"":n.memoizedProps;else{if(13===n.tag&&null!==n.memoizedState){(r=n.child.sibling).return=n,n=r;continue}if(null!==n.child){n.child.return=n,n=n.child;continue}}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}(t,r),null!==(n=e.updateQueue)){e.updateQueue=null;var s=e.stateNode;null===s&&(s=e.stateNode=new _o),n.forEach(function(t){var n=function(t,e){var n=t.stateNode;null!==n&&n.delete(e),e=Ko(e=Sa(),t),null!==(t=ta(t,e))&&(qr(t,e),0!==(e=t.expirationTime)&&Ta(t,e))}.bind(null,e,t);s.has(t)||(s.add(t),t.then(n,n))})}break;case 17:break;default:a("163")}}var To="function"==typeof WeakMap?WeakMap:Map;function Co(t,e,n){(n=ri(n)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Da(r),bo(t,e)},n}function Ao(t,e,n){(n=ri(n)).tag=3;var r=t.type.getDerivedStateFromError;if("function"==typeof r){var i=e.value;n.payload=function(){return r(i)}}var o=t.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===Zo?Zo=new Set([this]):Zo.add(this));var n=e.value,i=e.stack;bo(t,e),this.componentDidCatch(n,{componentStack:null!==i?i:""})}),n}function Mo(t){switch(t.tag){case 1:kr(t.type)&&jr();var e=t.effectTag;return 2048&e?(t.effectTag=-2049&e|64,t):null;case 3:return Ti(),Rr(),0!=(64&(e=t.effectTag))&&a("285"),t.effectTag=-2049&e|64,t;case 5:return Ai(t),null;case 13:return 2048&(e=t.effectTag)?(t.effectTag=-2049&e|64,t):null;case 4:return Ti(),null;case 10:return mi(t),null;default:return null}}var ko={readContext:bi},jo=Wt.ReactCurrentOwner,Ro=1073741822,Lo=0,Io=!1,Do=null,Fo=null,No=0,Bo=-1,Uo=!1,zo=null,Go=!1,Vo=null,Wo=null,Zo=null;function Ho(){if(null!==Do)for(var t=Do.return;null!==t;){var e=t;switch(e.tag){case 1:var n=e.type.childContextTypes;null!=n&&jr();break;case 3:Ti(),Rr();break;case 5:Ai(e);break;case 4:Ti();break;case 10:mi(e)}t=t.return}Fo=null,No=0,Bo=-1,Uo=!1,Do=null}function Xo(){null!==Wo&&(o.unstable_cancelCallback(Vo),Wo())}function Yo(t){for(;;){var e=t.alternate,n=t.return,r=t.sibling;if(0==(1024&t.effectTag)){Do=t;t:{var o=e,s=No,u=(e=t).pendingProps;switch(e.tag){case 2:case 16:break;case 15:case 0:break;case 1:kr(e.type)&&jr();break;case 3:Ti(),Rr(),(u=e.stateNode).pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),null!==o&&null!==o.child||(Ki(e),e.effectTag&=-3),go(e);break;case 5:Ai(e);var c=Pi(Oi.current);if(s=e.type,null!==o&&null!=e.stateNode)yo(o,e,s,u,c),o.ref!==e.ref&&(e.effectTag|=128);else if(u){var l=Pi(xi.current);if(Ki(e)){o=(u=e).stateNode;var h=u.type,f=u.memoizedProps,d=c;switch(o[R]=u,o[L]=f,s=void 0,c=h){case"iframe":case"object":Pn("load",o);break;case"video":case"audio":for(h=0;h<et.length;h++)Pn(et[h],o);break;case"source":Pn("error",o);break;case"img":case"image":case"link":Pn("error",o),Pn("load",o);break;case"form":Pn("reset",o),Pn("submit",o);break;case"details":Pn("toggle",o);break;case"input":be(o,f),Pn("invalid",o),fr(d,"onChange");break;case"select":o._wrapperState={wasMultiple:!!f.multiple},Pn("invalid",o),fr(d,"onChange");break;case"textarea":Jn(o,f),Pn("invalid",o),fr(d,"onChange")}for(s in lr(c,f),h=null,f)f.hasOwnProperty(s)&&(l=f[s],"children"===s?"string"==typeof l?o.textContent!==l&&(h=["children",l]):"number"==typeof l&&o.textContent!==""+l&&(h=["children",""+l]):_.hasOwnProperty(s)&&null!=l&&fr(d,s));switch(c){case"input":Gt(o),Ee(o,f,!0);break;case"textarea":Gt(o),Qn(o);break;case"select":case"option":break;default:"function"==typeof f.onClick&&(o.onclick=dr)}s=h,u.updateQueue=s,(u=null!==s)&&po(e)}else{f=e,o=s,d=u,h=9===c.nodeType?c:c.ownerDocument,l===Kn.html&&(l=$n(o)),l===Kn.html?"script"===o?((o=h.createElement("div")).innerHTML="<script><\/script>",h=o.removeChild(o.firstChild)):"string"==typeof d.is?h=h.createElement(o,{is:d.is}):(h=h.createElement(o),"select"===o&&d.multiple&&(h.multiple=!0)):h=h.createElementNS(l,o),(o=h)[R]=f,o[L]=u,vo(o,e,!1,!1),d=o;var p=c,v=hr(h=s,f=u);switch(h){case"iframe":case"object":Pn("load",d),c=f;break;case"video":case"audio":for(c=0;c<et.length;c++)Pn(et[c],d);c=f;break;case"source":Pn("error",d),c=f;break;case"img":case"image":case"link":Pn("error",d),Pn("load",d),c=f;break;case"form":Pn("reset",d),Pn("submit",d),c=f;break;case"details":Pn("toggle",d),c=f;break;case"input":be(d,f),c=_e(d,f),Pn("invalid",d),fr(p,"onChange");break;case"option":c=Hn(d,f);break;case"select":d._wrapperState={wasMultiple:!!f.multiple},c=i({},f,{value:void 0}),Pn("invalid",d),fr(p,"onChange");break;case"textarea":Jn(d,f),c=Yn(d,f),Pn("invalid",d),fr(p,"onChange");break;default:c=f}lr(h,c),l=void 0;var g=h,y=d,m=c;for(l in m)if(m.hasOwnProperty(l)){var b=m[l];"style"===l?ur(y,b):"dangerouslySetInnerHTML"===l?null!=(b=b?b.__html:void 0)&&rr(y,b):"children"===l?"string"==typeof b?("textarea"!==g||""!==b)&&ir(y,b):"number"==typeof b&&ir(y,""+b):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(_.hasOwnProperty(l)?null!=b&&fr(p,l):null!=b&&ye(y,l,b,v))}switch(h){case"input":Gt(d),Ee(d,f,!1);break;case"textarea":Gt(d),Qn(d);break;case"option":null!=f.value&&d.setAttribute("value",""+me(f.value));break;case"select":(c=d).multiple=!!f.multiple,null!=(d=f.value)?Xn(c,!!f.multiple,d,!1):null!=f.defaultValue&&Xn(c,!!f.multiple,f.defaultValue,!0);break;default:"function"==typeof c.onClick&&(d.onclick=dr)}(u=gr(s,u))&&po(e),e.stateNode=o}null!==e.ref&&(e.effectTag|=128)}else null===e.stateNode&&a("166");break;case 6:o&&null!=e.stateNode?mo(o,e,o.memoizedProps,u):("string"!=typeof u&&(null===e.stateNode&&a("166")),o=Pi(Oi.current),Pi(xi.current),Ki(e)?(s=(u=e).stateNode,o=u.memoizedProps,s[R]=u,(u=s.nodeValue!==o)&&po(e)):(s=e,(u=(9===o.nodeType?o:o.ownerDocument).createTextNode(u))[R]=e,s.stateNode=u));break;case 11:break;case 13:if(u=e.memoizedState,0!=(64&e.effectTag)){e.expirationTime=s,Do=e;break t}u=null!==u,s=null!==o&&null!==o.memoizedState,null!==o&&!u&&s&&(null!==(o=o.child.sibling)&&(null!==(c=e.firstEffect)?(e.firstEffect=o,o.nextEffect=c):(e.firstEffect=e.lastEffect=o,o.nextEffect=null),o.effectTag=8)),(u!==s||0==(1&e.effectTag)&&u)&&(e.effectTag|=4);break;case 7:case 8:case 12:break;case 4:Ti(),go(e);break;case 10:mi(e);break;case 9:case 14:break;case 17:kr(e.type)&&jr();break;default:a("156")}Do=null}if(e=t,1===No||1!==e.childExpirationTime){for(u=0,s=e.child;null!==s;)(o=s.expirationTime)>u&&(u=o),(c=s.childExpirationTime)>u&&(u=c),s=s.sibling;e.childExpirationTime=u}if(null!==Do)return Do;null!==n&&0==(1024&n.effectTag)&&(null===n.firstEffect&&(n.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==n.lastEffect&&(n.lastEffect.nextEffect=t.firstEffect),n.lastEffect=t.lastEffect),1<t.effectTag&&(null!==n.lastEffect?n.lastEffect.nextEffect=t:n.firstEffect=t,n.lastEffect=t))}else{if(null!==(t=Mo(t)))return t.effectTag&=1023,t;null!==n&&(n.firstEffect=n.lastEffect=null,n.effectTag|=1024)}if(null!==r)return r;if(null===n)break;t=n}return null}function Jo(t){var e=fo(t.alternate,t,No);return t.memoizedProps=t.pendingProps,null===e&&(e=Yo(t)),jo.current=null,e}function qo(t,e){Io&&a("243"),Xo(),Io=!0,jo.currentDispatcher=ko;var n=t.nextExpirationTimeToWorkOn;n===No&&t===Fo&&null!==Do||(Ho(),No=n,Do=Wr((Fo=t).current,null),t.pendingCommitExpirationTime=0);for(var r=!1;;){try{if(e)for(;null!==Do&&!Ma();)Do=Jo(Do);else for(;null!==Do;)Do=Jo(Do)}catch(e){if(gi=vi=pi=null,null===Do)r=!0,Da(e);else{null===Do&&a("271");var i=Do,o=i.return;if(null!==o){t:{var s=t,u=o,c=i,l=e;if(o=No,c.effectTag|=1024,c.firstEffect=c.lastEffect=null,null!==l&&"object"==typeof l&&"function"==typeof l.then){var h=l;l=u;var f=-1,d=-1;do{if(13===l.tag){var p=l.alternate;if(null!==p&&null!==(p=p.memoizedState)){d=10*(1073741822-p.timedOutAt);break}"number"==typeof(p=l.pendingProps.maxDuration)&&(0>=p?f=0:(-1===f||p<f)&&(f=p))}l=l.return}while(null!==l);l=u;do{if((p=13===l.tag)&&(p=void 0!==l.memoizedProps.fallback&&null===l.memoizedState),p){if(null===(u=l.updateQueue)?l.updateQueue=new Set([h]):u.add(h),0==(1&l.mode)){l.effectTag|=64,c.effectTag&=-1957,1===c.tag&&(null===c.alternate?c.tag=17:((o=ri(1073741823)).tag=2,oi(c,o))),c.expirationTime=1073741823;break t}null===(c=s.pingCache)?(c=s.pingCache=new To,u=new Set,c.set(h,u)):void 0===(u=c.get(h))&&(u=new Set,c.set(h,u)),u.has(o)||(u.add(o),c=$o.bind(null,s,h,o),h.then(c,c)),-1===f?s=1073741823:(-1===d&&(d=10*(1073741822-Kr(s,o))-5e3),s=d+f),0<=s&&Bo<s&&(Bo=s),l.effectTag|=2048,l.expirationTime=o;break t}l=l.return}while(null!==l);l=Error((se(c.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+ue(c))}Uo=!0,l=fi(l,c),s=u;do{switch(s.tag){case 3:s.effectTag|=2048,s.expirationTime=o,ai(s,o=Co(s,l,o));break t;case 1:if(h=l,f=s.type,d=s.stateNode,0==(64&s.effectTag)&&("function"==typeof f.getDerivedStateFromError||null!==d&&"function"==typeof d.componentDidCatch&&(null===Zo||!Zo.has(d)))){s.effectTag|=2048,s.expirationTime=o,ai(s,o=Ao(s,h,o));break t}}s=s.return}while(null!==s)}Do=Yo(i);continue}r=!0,Da(e)}}break}if(Io=!1,gi=vi=pi=jo.currentDispatcher=null,r)Fo=null,t.finishedWork=null;else if(null!==Do)t.finishedWork=null;else{if(null===(r=t.current.alternate)&&a("281"),Fo=null,Uo){if(i=t.latestPendingTime,o=t.latestSuspendedTime,s=t.latestPingedTime,0!==i&&i<n||0!==o&&o<n||0!==s&&s<n)return Qr(t,n),void Pa(t,r,n,t.expirationTime,-1);if(!t.didError&&e)return t.didError=!0,n=t.nextExpirationTimeToWorkOn=n,e=t.expirationTime=1073741823,void Pa(t,r,n,e,-1)}e&&-1!==Bo?(Qr(t,n),(e=10*(1073741822-Kr(t,n)))<Bo&&(Bo=e),e=10*(1073741822-Sa()),e=Bo-e,Pa(t,r,n,t.expirationTime,0>e?0:e)):(t.pendingCommitExpirationTime=n,t.finishedWork=r)}}function Qo(t,e){for(var n=t.return;null!==n;){switch(n.tag){case 1:var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Zo||!Zo.has(r)))return oi(n,t=Ao(n,t=fi(e,t),1073741823)),void ea(n,1073741823);break;case 3:return oi(n,t=Co(n,t=fi(e,t),1073741823)),void ea(n,1073741823)}n=n.return}3===t.tag&&(oi(t,n=Co(t,n=fi(e,t),1073741823)),ea(t,1073741823))}function Ko(t,e){return 0!==Lo?t=Lo:Io?t=Go?1073741823:No:1&e.mode?(t=va?1073741822-10*(1+((1073741822-t+15)/10|0)):1073741822-25*(1+((1073741822-t+500)/25|0)),null!==Fo&&t===No&&--t):t=1073741823,va&&(0===la||t<la)&&(la=t),t}function $o(t,e,n){var r=t.pingCache;null!==r&&r.delete(e),null!==Fo&&No===n?Fo=null:(e=t.earliestSuspendedTime,r=t.latestSuspendedTime,0!==e&&n<=e&&n>=r&&(t.didError=!1,(0===(e=t.latestPingedTime)||e>n)&&(t.latestPingedTime=n),$r(n,t),0!==(n=t.expirationTime)&&Ta(t,n)))}function ta(t,e){t.expirationTime<e&&(t.expirationTime=e);var n=t.alternate;null!==n&&n.expirationTime<e&&(n.expirationTime=e);var r=t.return,i=null;if(null===r&&3===t.tag)i=t.stateNode;else for(;null!==r;){if(n=r.alternate,r.childExpirationTime<e&&(r.childExpirationTime=e),null!==n&&n.childExpirationTime<e&&(n.childExpirationTime=e),null===r.return&&3===r.tag){i=r.stateNode;break}r=r.return}return i}function ea(t,e){null!==(t=ta(t,e))&&(!Io&&0!==No&&e>No&&Ho(),qr(t,e),Io&&!Go&&Fo===t||Ta(t,t.expirationTime),wa>ba&&(wa=0,a("185")))}function na(t,e,n,r,i){var o=Lo;Lo=1073741823;try{return t(e,n,r,i)}finally{Lo=o}}var ra=null,ia=null,oa=0,aa=void 0,sa=!1,ua=null,ca=0,la=0,ha=!1,fa=null,da=!1,pa=!1,va=!1,ga=null,ya=o.unstable_now(),ma=1073741822-(ya/10|0),_a=ma,ba=50,wa=0,xa=null;function Ea(){ma=1073741822-((o.unstable_now()-ya)/10|0)}function Oa(t,e){if(0!==oa){if(e<oa)return;null!==aa&&o.unstable_cancelCallback(aa)}oa=e,t=o.unstable_now()-ya,aa=o.unstable_scheduleCallback(ka,{timeout:10*(1073741822-e)-t})}function Pa(t,e,n,r,i){t.expirationTime=r,0!==i||Ma()?0<i&&(t.timeoutHandle=mr(function(t,e,n){t.pendingCommitExpirationTime=n,t.finishedWork=e,Ea(),_a=ma,Ra(t,n)}.bind(null,t,e,n),i)):(t.pendingCommitExpirationTime=n,t.finishedWork=e)}function Sa(){return sa?_a:(Ca(),0!==ca&&1!==ca||(Ea(),_a=ma),_a)}function Ta(t,e){null===t.nextScheduledRoot?(t.expirationTime=e,null===ia?(ra=ia=t,t.nextScheduledRoot=t):(ia=ia.nextScheduledRoot=t).nextScheduledRoot=ra):e>t.expirationTime&&(t.expirationTime=e),sa||(da?pa&&(ua=t,ca=1073741823,La(t,1073741823,!1)):1073741823===e?ja(1073741823,!1):Oa(t,e))}function Ca(){var t=0,e=null;if(null!==ia)for(var n=ia,r=ra;null!==r;){var i=r.expirationTime;if(0===i){if((null===n||null===ia)&&a("244"),r===r.nextScheduledRoot){ra=ia=r.nextScheduledRoot=null;break}if(r===ra)ra=i=r.nextScheduledRoot,ia.nextScheduledRoot=i,r.nextScheduledRoot=null;else{if(r===ia){(ia=n).nextScheduledRoot=ra,r.nextScheduledRoot=null;break}n.nextScheduledRoot=r.nextScheduledRoot,r.nextScheduledRoot=null}r=n.nextScheduledRoot}else{if(i>t&&(t=i,e=r),r===ia)break;if(1073741823===t)break;n=r,r=r.nextScheduledRoot}}ua=e,ca=t}var Aa=!1;function Ma(){return!!Aa||!!o.unstable_shouldYield()&&(Aa=!0)}function ka(){try{if(!Ma()&&null!==ra){Ea();var t=ra;do{var e=t.expirationTime;0!==e&&ma<=e&&(t.nextExpirationTimeToWorkOn=ma),t=t.nextScheduledRoot}while(t!==ra)}ja(0,!0)}finally{Aa=!1}}function ja(t,e){if(Ca(),e)for(Ea(),_a=ma;null!==ua&&0!==ca&&t<=ca&&!(Aa&&ma>ca);)La(ua,ca,ma>ca),Ca(),Ea(),_a=ma;else for(;null!==ua&&0!==ca&&t<=ca;)La(ua,ca,!1),Ca();if(e&&(oa=0,aa=null),0!==ca&&Oa(ua,ca),wa=0,xa=null,null!==ga)for(t=ga,ga=null,e=0;e<t.length;e++){var n=t[e];try{n._onComplete()}catch(t){ha||(ha=!0,fa=t)}}if(ha)throw t=fa,fa=null,ha=!1,t}function Ra(t,e){sa&&a("253"),ua=t,ca=e,La(t,e,!1),ja(1073741823,!1)}function La(t,e,n){if(sa&&a("245"),sa=!0,n){var r=t.finishedWork;null!==r?Ia(t,r,e):(t.finishedWork=null,-1!==(r=t.timeoutHandle)&&(t.timeoutHandle=-1,_r(r)),qo(t,n),null!==(r=t.finishedWork)&&(Ma()?t.finishedWork=r:Ia(t,r,e)))}else null!==(r=t.finishedWork)?Ia(t,r,e):(t.finishedWork=null,-1!==(r=t.timeoutHandle)&&(t.timeoutHandle=-1,_r(r)),qo(t,n),null!==(r=t.finishedWork)&&Ia(t,r,e));sa=!1}function Ia(t,e,n){var r=t.firstBatch;if(null!==r&&r._expirationTime>=n&&(null===ga?ga=[r]:ga.push(r),r._defer))return t.finishedWork=e,void(t.expirationTime=0);t.finishedWork=null,t===xa?wa++:(xa=t,wa=0),Go=Io=!0,t.current===e&&a("177"),0===(n=t.pendingCommitExpirationTime)&&a("261"),t.pendingCommitExpirationTime=0,r=e.expirationTime;var i=e.childExpirationTime;if(r=i>r?i:r,t.didError=!1,0===r?(t.earliestPendingTime=0,t.latestPendingTime=0,t.earliestSuspendedTime=0,t.latestSuspendedTime=0,t.latestPingedTime=0):(r<t.latestPingedTime&&(t.latestPingedTime=0),0!==(i=t.latestPendingTime)&&(i>r?t.earliestPendingTime=t.latestPendingTime=0:t.earliestPendingTime>r&&(t.earliestPendingTime=t.latestPendingTime)),0===(i=t.earliestSuspendedTime)?qr(t,r):r<t.latestSuspendedTime?(t.earliestSuspendedTime=0,t.latestSuspendedTime=0,t.latestPingedTime=0,qr(t,r)):r>i&&qr(t,r)),$r(0,t),jo.current=null,1<e.effectTag?null!==e.lastEffect?(e.lastEffect.nextEffect=e,r=e.firstEffect):r=e:r=e.firstEffect,pr=On,Fn(i=Dn())){if("selectionStart"in i)var o={start:i.selectionStart,end:i.selectionEnd};else t:{var s=(o=(o=i.ownerDocument)&&o.defaultView||window).getSelection&&o.getSelection();if(s&&0!==s.rangeCount){o=s.anchorNode;var u=s.anchorOffset,c=s.focusNode;s=s.focusOffset;try{o.nodeType,c.nodeType}catch(t){o=null;break t}var l=0,h=-1,f=-1,d=0,p=0,v=i,g=null;e:for(;;){for(var y;v!==o||0!==u&&3!==v.nodeType||(h=l+u),v!==c||0!==s&&3!==v.nodeType||(f=l+s),3===v.nodeType&&(l+=v.nodeValue.length),null!==(y=v.firstChild);)g=v,v=y;for(;;){if(v===i)break e;if(g===o&&++d===u&&(h=l),g===c&&++p===s&&(f=l),null!==(y=v.nextSibling))break;g=(v=g).parentNode}v=y}o=-1===h||-1===f?null:{start:h,end:f}}else o=null}o=o||{start:0,end:0}}else o=null;for(vr={focusedElem:i,selectionRange:o},On=!1,zo=r;null!==zo;){i=!1,o=void 0;try{for(;null!==zo;){if(256&zo.effectTag)t:{var m=zo.alternate;switch((u=zo).tag){case 0:case 11:case 15:break t;case 1:if(256&u.effectTag&&null!==m){var _=m.memoizedProps,b=m.memoizedState,w=u.stateNode,x=w.getSnapshotBeforeUpdate(u.elementType===u.type?_:Mi(u.type,_),b);w.__reactInternalSnapshotBeforeUpdate=x}break t;case 3:case 5:case 6:case 4:case 17:break t;default:a("163")}}zo=zo.nextEffect}}catch(t){i=!0,o=t}i&&(null===zo&&a("178"),Qo(zo,o),null!==zo&&(zo=zo.nextEffect))}for(zo=r;null!==zo;){m=!1,_=void 0;try{for(;null!==zo;){var E=zo.effectTag;if(16&E&&ir(zo.stateNode,""),128&E){var O=zo.alternate;if(null!==O){var P=O.ref;null!==P&&("function"==typeof P?P(null):P.current=null)}}switch(14&E){case 2:Oo(zo),zo.effectTag&=-3;break;case 6:Oo(zo),zo.effectTag&=-3,So(zo.alternate,zo);break;case 4:So(zo.alternate,zo);break;case 8:Po(b=zo),b.return=null,b.child=null,b.memoizedState=null,b.updateQueue=null;var S=b.alternate;null!==S&&(S.return=null,S.child=null,S.memoizedState=null,S.updateQueue=null)}zo=zo.nextEffect}}catch(t){m=!0,_=t}m&&(null===zo&&a("178"),Qo(zo,_),null!==zo&&(zo=zo.nextEffect))}if(P=vr,O=Dn(),E=P.focusedElem,m=P.selectionRange,O!==E&&E&&E.ownerDocument&&function t(e,n){return!(!e||!n)&&(e===n||(!e||3!==e.nodeType)&&(n&&3===n.nodeType?t(e,n.parentNode):"contains"in e?e.contains(n):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(n))))}(E.ownerDocument.documentElement,E)){null!==m&&Fn(E)&&(O=m.start,void 0===(P=m.end)&&(P=O),"selectionStart"in E?(E.selectionStart=O,E.selectionEnd=Math.min(P,E.value.length)):(P=(O=E.ownerDocument||document)&&O.defaultView||window).getSelection&&(P=P.getSelection(),_=E.textContent.length,S=Math.min(m.start,_),m=void 0===m.end?S:Math.min(m.end,_),!P.extend&&S>m&&(_=m,m=S,S=_),_=In(E,S),b=In(E,m),_&&b&&(1!==P.rangeCount||P.anchorNode!==_.node||P.anchorOffset!==_.offset||P.focusNode!==b.node||P.focusOffset!==b.offset)&&((O=O.createRange()).setStart(_.node,_.offset),P.removeAllRanges(),S>m?(P.addRange(O),P.extend(b.node,b.offset)):(O.setEnd(b.node,b.offset),P.addRange(O))))),O=[];for(P=E;P=P.parentNode;)1===P.nodeType&&O.push({element:P,left:P.scrollLeft,top:P.scrollTop});for("function"==typeof E.focus&&E.focus(),E=0;E<O.length;E++)(P=O[E]).element.scrollLeft=P.left,P.element.scrollTop=P.top}for(vr=null,On=!!pr,pr=null,t.current=e,zo=r;null!==zo;){r=!1,E=void 0;try{for(O=n;null!==zo;){var T=zo.effectTag;if(36&T){var C=zo.alternate;switch(S=O,(P=zo).tag){case 0:case 11:case 15:break;case 1:var A=P.stateNode;if(4&P.effectTag)if(null===C)A.componentDidMount();else{var M=P.elementType===P.type?C.memoizedProps:Mi(P.type,C.memoizedProps);A.componentDidUpdate(M,C.memoizedState,A.__reactInternalSnapshotBeforeUpdate)}var k=P.updateQueue;null!==k&&li(0,k,A);break;case 3:var j=P.updateQueue;if(null!==j){if(m=null,null!==P.child)switch(P.child.tag){case 5:m=P.child.stateNode;break;case 1:m=P.child.stateNode}li(0,j,m)}break;case 5:var R=P.stateNode;null===C&&4&P.effectTag&&gr(P.type,P.memoizedProps)&&R.focus();break;case 6:case 4:case 12:case 13:case 17:break;default:a("163")}}if(128&T){var L=zo.ref;if(null!==L){var I=zo.stateNode;switch(zo.tag){case 5:var D=I;break;default:D=I}"function"==typeof L?L(D):L.current=D}}zo=zo.nextEffect}}catch(t){r=!0,E=t}r&&(null===zo&&a("178"),Qo(zo,E),null!==zo&&(zo=zo.nextEffect))}Io=Go=!1,"function"==typeof Nr&&Nr(e.stateNode),T=e.expirationTime,0===(e=(e=e.childExpirationTime)>T?e:T)&&(Zo=null),t.expirationTime=e,t.finishedWork=null}function Da(t){null===ua&&a("246"),ua.expirationTime=0,ha||(ha=!0,fa=t)}function Fa(t,e){var n=da;da=!0;try{return t(e)}finally{(da=n)||sa||ja(1073741823,!1)}}function Na(t,e){if(da&&!pa){pa=!0;try{return t(e)}finally{pa=!1}}return t(e)}function Ba(t,e,n){if(va)return t(e,n);da||sa||0===la||(ja(la,!1),la=0);var r=va,i=da;da=va=!0;try{return t(e,n)}finally{va=r,(da=i)||sa||ja(1073741823,!1)}}function Ua(t,e,n,r,i){var o=e.current;t:if(n){e:{2===en(n=n._reactInternalFiber)&&1===n.tag||a("170");var s=n;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(kr(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(null!==s);a("171"),s=void 0}if(1===n.tag){var u=n.type;if(kr(u)){n=Ir(n,u,s);break t}}n=s}else n=Sr;return null===e.context?e.context=n:e.pendingContext=n,e=i,(i=ri(r)).payload={element:t},null!==(e=void 0===e?null:e)&&(i.callback=e),Xo(),oi(o,i),ea(o,r),r}function za(t,e,n,r){var i=e.current;return Ua(t,e,n,i=Ko(Sa(),i),r)}function Ga(t){if(!(t=t.current).child)return null;switch(t.child.tag){case 5:default:return t.child.stateNode}}function Va(t){var e=1073741822-25*(1+((1073741822-Sa()+500)/25|0));e>=Ro&&(e=Ro-1),this._expirationTime=Ro=e,this._root=t,this._callbacks=this._next=null,this._hasChildren=this._didComplete=!1,this._children=null,this._defer=!0}function Wa(){this._callbacks=null,this._didCommit=!1,this._onCommit=this._onCommit.bind(this)}function Za(t,e,n){t={current:e=Gr(3,null,null,e?3:0),containerInfo:t,pendingChildren:null,pingCache:null,earliestPendingTime:0,latestPendingTime:0,earliestSuspendedTime:0,latestSuspendedTime:0,latestPingedTime:0,didError:!1,pendingCommitExpirationTime:0,finishedWork:null,timeoutHandle:-1,context:null,pendingContext:null,hydrate:n,nextExpirationTimeToWorkOn:0,expirationTime:0,firstBatch:null,nextScheduledRoot:null},this._internalRoot=e.stateNode=t}function Ha(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Xa(t,e,n,r,i){Ha(n)||a("200");var o=n._reactRootContainer;if(o){if("function"==typeof i){var s=i;i=function(){var t=Ga(o._internalRoot);s.call(t)}}null!=t?o.legacy_renderSubtreeIntoContainer(t,e,i):o.render(e,i)}else{if(o=n._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var n;n=t.lastChild;)t.removeChild(n);return new Za(t,!1,e)}(n,r),"function"==typeof i){var u=i;i=function(){var t=Ga(o._internalRoot);u.call(t)}}Na(function(){null!=t?o.legacy_renderSubtreeIntoContainer(t,e,i):o.render(e,i)})}return Ga(o._internalRoot)}function Ya(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return Ha(e)||a("200"),function(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Yt,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}(t,e,null,n)}St=function(t,e,n){switch(e){case"input":if(xe(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=N(r);i||a("90"),Vt(r),xe(r,i)}}}break;case"textarea":qn(t,n);break;case"select":null!=(e=n.value)&&Xn(t,!!n.multiple,e,!1)}},Va.prototype.render=function(t){this._defer||a("250"),this._hasChildren=!0,this._children=t;var e=this._root._internalRoot,n=this._expirationTime,r=new Wa;return Ua(t,e,null,n,r._onCommit),r},Va.prototype.then=function(t){if(this._didComplete)t();else{var e=this._callbacks;null===e&&(e=this._callbacks=[]),e.push(t)}},Va.prototype.commit=function(){var t=this._root._internalRoot,e=t.firstBatch;if(this._defer&&null!==e||a("251"),this._hasChildren){var n=this._expirationTime;if(e!==this){this._hasChildren&&(n=this._expirationTime=e._expirationTime,this.render(this._children));for(var r=null,i=e;i!==this;)r=i,i=i._next;null===r&&a("251"),r._next=i._next,this._next=e,t.firstBatch=this}this._defer=!1,Ra(t,n),e=this._next,this._next=null,null!==(e=t.firstBatch=e)&&e._hasChildren&&e.render(e._children)}else this._next=null,this._defer=!1},Va.prototype._onComplete=function(){if(!this._didComplete){this._didComplete=!0;var t=this._callbacks;if(null!==t)for(var e=0;e<t.length;e++)(0,t[e])()}},Wa.prototype.then=function(t){if(this._didCommit)t();else{var e=this._callbacks;null===e&&(e=this._callbacks=[]),e.push(t)}},Wa.prototype._onCommit=function(){if(!this._didCommit){this._didCommit=!0;var t=this._callbacks;if(null!==t)for(var e=0;e<t.length;e++){var n=t[e];"function"!=typeof n&&a("191",n),n()}}},Za.prototype.render=function(t,e){var n=this._internalRoot,r=new Wa;return null!==(e=void 0===e?null:e)&&r.then(e),za(t,n,null,r._onCommit),r},Za.prototype.unmount=function(t){var e=this._internalRoot,n=new Wa;return null!==(t=void 0===t?null:t)&&n.then(t),za(null,e,null,n._onCommit),n},Za.prototype.legacy_renderSubtreeIntoContainer=function(t,e,n){var r=this._internalRoot,i=new Wa;return null!==(n=void 0===n?null:n)&&i.then(n),za(e,r,t,i._onCommit),i},Za.prototype.createBatch=function(){var t=new Va(this),e=t._expirationTime,n=this._internalRoot,r=n.firstBatch;if(null===r)n.firstBatch=t,t._next=null;else{for(n=null;null!==r&&r._expirationTime>=e;)n=r,r=r._next;t._next=r,null!==n&&(n._next=t)}return t},jt=Fa,Rt=Ba,Lt=function(){sa||0===la||(ja(la,!1),la=0)};var Ja={createPortal:Ya,findDOMNode:function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternalFiber;return void 0===e&&("function"==typeof t.render?a("188"):a("268",Object.keys(t))),t=null===(t=rn(e))?null:t.stateNode},hydrate:function(t,e,n){return Xa(null,t,e,!0,n)},render:function(t,e,n){return Xa(null,t,e,!1,n)},unstable_renderSubtreeIntoContainer:function(t,e,n,r){return(null==t||void 0===t._reactInternalFiber)&&a("38"),Xa(t,e,n,!1,r)},unmountComponentAtNode:function(t){return Ha(t)||a("40"),!!t._reactRootContainer&&(Na(function(){Xa(null,null,t,!1,function(){t._reactRootContainer=null})}),!0)},unstable_createPortal:function(){return Ya.apply(void 0,arguments)},unstable_batchedUpdates:Fa,unstable_interactiveUpdates:Ba,flushSync:function(t,e){sa&&a("187");var n=da;da=!0;try{return na(t,e)}finally{da=n,ja(1073741823,!1)}},unstable_createRoot:function(t,e){return Ha(t)||a("299","unstable_createRoot"),new Za(t,!0,null!=e&&!0===e.hydrate)},unstable_flushControlled:function(t){var e=da;da=!0;try{na(t)}finally{(da=e)||sa||ja(1073741823,!1)}},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{Events:[D,F,N,A.injectEventPluginsByName,m,W,function(t){S(t,V)},Mt,kt,Cn,k]}};!function(t){var e=t.findFiberByHostInstance;(function(t){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var e=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(e.isDisabled||!e.supportsFiber)return!0;try{var n=e.inject(t);Nr=Ur(function(t){return e.onCommitFiberRoot(n,t)}),Br=Ur(function(t){return e.onCommitFiberUnmount(n,t)})}catch(t){}})(i({},t,{overrideProps:null,findHostInstanceByFiber:function(t){return null===(t=rn(t))?null:t.stateNode},findFiberByHostInstance:function(t){return e?e(t):null}}))}({findFiberByHostInstance:I,bundleType:0,version:"16.7.0",rendererPackageName:"react-dom"});var qa={default:Ja},Qa=qa&&Ja||qa;t.exports=Qa.default||Qa},zGma:function(t,e,n){"use strict";var r=n("ODXe"),i=n("KQm4"),o=n("1OyB"),a=n("vuIU"),s=n("md7G"),u=n("foSv"),c=n("Ji7U"),l=n("g9fj"),h=n("qjXE"),f=n("S4Ro"),d=n("dByZ"),p=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return Object(o.a)(this,e),t=Object(s.a)(this,Object(u.a)(e).call(this)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,r,i,a),t}return Object(c.a)(e,t),Object(a.a)(e,[{key:"applyMatrix4",value:function(t){return t.transformVector(this,this),this}},{key:"ELEMENTS",get:function(){return 4}},{key:"z",get:function(){return this[2]},set:function(t){return this[2]=Object(h.a)(t)}},{key:"w",get:function(){return this[3]},set:function(t){return this[3]=Object(h.a)(t)}}]),e}(n("h6m0").a),v=n("sckk"),g=n.n(v),y=n("WSjQ"),m=n.n(y),_=n("19qB"),b=n.n(_),w=n("5YEP"),x=n.n(w),E=n("+Ik0"),O=n.n(E),P=n("etCb"),S=n.n(P),T=n("7S6R"),C=n.n(T),A=n("k0P+"),M=n.n(A),k=n("FBcx"),j=n.n(k),R=n("mWlC"),L=n.n(R),I=n("nKJB"),D=n.n(I),F=n("b1F2"),N=n.n(F),B=n("AEOw"),U=n.n(B),z=n("wp3f"),G=n.n(z),V=n("YllZ"),W=n.n(V),Z=n("6eGt"),H=n.n(Z),X=n("RP4a"),Y=n.n(X),J=n("/BFQ"),q=n.n(J);n.d(e,"a",function(){return $});var Q=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function K(t,e){return t.length===e&&t.every(Number.isFinite)}var $=function(t){function e(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Object(o.a)(this,e),t=Object(s.a)(this,Object(u.a)(e).call(this)),Array.isArray(r[0])&&1===arguments.length?t.copy(r[0]):t.identity(),t}return Object(c.a)(e,t),Object(a.a)(e,[{key:"setRowMajor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,h=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,f=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,d=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,p=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,v=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1;return this[0]=t,this[1]=i,this[2]=u,this[3]=f,this[4]=e,this[5]=o,this[6]=c,this[7]=d,this[8]=n,this[9]=a,this[10]=l,this[11]=p,this[12]=r,this[13]=s,this[14]=h,this[15]=v,this.check()}},{key:"setColumnMajor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,h=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,f=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,d=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,p=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,v=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1;return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=a,this[7]=s,this[8]=u,this[9]=c,this[10]=l,this[11]=h,this[12]=f,this[13]=d,this[14]=p,this[15]=v,this.check()}},{key:"copy",value:function(t){return this.setColumnMajor.apply(this,Object(i.a)(t))}},{key:"set",value:function(){return this.setColumnMajor.apply(this,arguments)}},{key:"getElement",value:function(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this[t][e]:this[e][t]}},{key:"setElement",value:function(t,e,n){return arguments.length>3&&void 0!==arguments[3]&&arguments[3]?this[t][e]=Object(h.a)(n):this[e][t]=Object(h.a)(n),this}},{key:"determinant",value:function(){return g()(this)}},{key:"identity",value:function(){return this.copy(Q)}},{key:"fromQuaternion",value:function(t){return m()(this,t),this.check()}},{key:"frustum",value:function(t){var e=t.left,n=t.right,r=t.bottom,i=t.top,o=t.near,a=t.far;return b()(this,e,n,r,i,o,a),this.check()}},{key:"lookAt",value:function(t){var e=t.eye,n=t.center,r=void 0===n?[0,0,0]:n,i=t.up,o=void 0===i?[0,1,0]:i;return x()(this,e,r,o),this.check()}},{key:"ortho",value:function(t){var e=t.left,n=t.right,r=t.bottom,i=t.top,o=t.near,a=void 0===o?.1:o,s=t.far,u=void 0===s?500:s;return O()(this,e,n,r,i,a,u),this.check()}},{key:"orthographic",value:function(t){var n=t.fovy,r=void 0===n?45*Math.PI/180:n,i=t.aspect,o=void 0===i?1:i,a=t.focalDistance,s=void 0===a?1:a,u=t.near,c=void 0===u?.1:u,l=t.far,h=void 0===l?500:l;if(r>2*Math.PI)throw Error("radians");var f=r/2,d=s*Math.tan(f),p=d*o;return(new e).ortho({left:-p,right:p,bottom:-d,top:d,near:c,far:h})}},{key:"perspective",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.fovy,n=t.fov,r=void 0===n?45*Math.PI/180:n,i=t.aspect,o=void 0===i?1:i,a=t.near,s=void 0===a?.1:a,u=t.far,c=void 0===u?500:u;if((e=e||r)>2*Math.PI)throw Error("radians");return S()(this,e,o,s,c),this.check()}},{key:"transpose",value:function(){return C()(this,this),this.check()}},{key:"invert",value:function(){return M()(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return j()(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return j()(this,this,t),this.check()}},{key:"rotateX",value:function(t){return H()(this,this,t),this.check()}},{key:"rotateY",value:function(t){return Y()(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return q()(this,this,t),this.check()}},{key:"rotateXYZ",value:function(t){var e=Object(r.a)(t,3),n=e[0],i=e[1],o=e[2];return this.rotateX(n).rotateY(i).rotateZ(o)}},{key:"rotateAxis",value:function(t,e){return L()(this,this,t,e),this.check()}},{key:"scale",value:function(t){return D()(this,this,t),this.check()}},{key:"translate",value:function(t){return N()(this,this,t),this.check()}},{key:"transformVector2",value:function(t,e){return e=e||new f.a,U()(e,t,this),K(e,2),e}},{key:"transformVector3",value:function(t,e){return e=e||new d.a,G()(e,t,this),K(e,3),e}},{key:"transformVector4",value:function(t,e){return e=e||new p,W()(e,t,this),K(e,4),e.check()}},{key:"transformVector",value:function(t,e){switch(t.length){case 2:return this.transformVector2(t,e);case 3:return this.transformVector3(t,e);case 4:return this.transformVector4(t,e);default:throw new Error("Illegal vector")}}},{key:"transformDirection",value:function(t,e){return this._transformVector(t,e,0)}},{key:"transformPoint",value:function(t,e){return this._transformVector(t,e,1)}},{key:"_transformVector",value:function(t,e,n){switch(t.length){case 2:e=e||new f.a,W()(e,[t[0],t[1],0,n],this),e.length=2,K(e,2);break;case 3:e=e||new d.a,W()(e,[t[0],t[1],t[2],n],this),e.length=3,K(e,3);break;case 4:if(Boolean(n)!==Boolean(t[3]))throw new Error("math.gl: Matrix4.transformPoint - invalid vector");e=e||new p,W()(e,t,this),K(e,4);break;default:throw new Error("Illegal vector")}return e}},{key:"makeRotationX",value:function(t){return this.identity().rotateX(t)}},{key:"makeTranslation",value:function(t,e,n){return this.identity().translate([t,e,n])}},{key:"ELEMENTS",get:function(){return 16}}]),e}(l.a)}},[["akFz",1]]]);